/*! For license information please see app.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[773],{6650:(e,t,n)=>{"use strict";var o=n(6685),a=(n(975),n(8877));window.bootstrap=a;var r=n(5673),i=function(){if(document.getElementsByClassName("js-simplebar")[0]){var e=new r.Z(document.getElementsByClassName("js-simplebar")[0]);document.querySelectorAll(".js-sidebar [data-bs-parent]").forEach((function(t){t.addEventListener("shown.bs.collapse",(function(){e.recalculate()})),t.addEventListener("hidden.bs.collapse",(function(){e.recalculate()}))}))}},l=function(){var e=document.getElementsByClassName("js-sidebar")[0],t=document.getElementsByClassName("js-sidebar-toggle")[0];e&&t&&t.addEventListener("click",(function(){e.classList.toggle("collapsed"),e.addEventListener("transitionend",(function(){window.dispatchEvent(new Event("resize"))}))}))};document.addEventListener("DOMContentLoaded",(function(){return i(),void l()}));n(8571);var s=n(8508),c=n.n(s);document.addEventListener("DOMContentLoaded",(function(){c().replace()})),window.feather=c();var u=n(4953),p=n.n(u);window.flatpickr=p();var d=n(3868),f=n(6249),g=n(3624),h=n.n(g),m=n(2201),b={class:"container"},v=[(0,d.uE)('<div class="row justify-content-center"><div class="col-md-8"><div class="card"><div class="card-header">Example Component</div><div class="card-body">I&#39;m an example component.</div></div></div></div>',1)];const y={mounted:function(){console.log("Component mounted.");var e=window.location.pathname;console.log(e)}};var w=n(3744);const x=(0,w.Z)(y,[["render",function(e,t,n,o,a,r){return(0,d.wg)(),(0,d.iD)("div",b,v)}]]);var _={"aria-label":"breadcrumb"},C={class:"breadcrumb bg-transparent p-0 mt-1 mb-0"},L={class:"breadcrumb-item"},k={href:"/home"},P=["href"],S={class:"breadcrumb-item"},I=(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1);var A=n(6252),E=n(9669),$=n.n(E);function R(){var e=(0,d.iH)([]),t=(0,d.iH)(""),n=(0,d.iH)("");(0,m.tv)();return{urls:e,whereurl:n,getUrl:function(){var t=window.location.pathname.split("/");t.shift(),t.length>0&&(t[0]="/"+t[0]);for(var n=1;n<t.length;n++)t[n]=t[n-1]+"/"+t[n];e.value=t},getPageNames:function(){var e=window.location.pathname.split("/");if(e.shift(),e.length>0){var t="";"barcode"===e[0]?t="barcodeGenerator":"basic"===e[0]?t="basicInfoLang":"bu"===e[0]?t="bupagelang":"call"===e[0]?t="callpageLang":"checking"===e[0]?t="checkInvLang":"inbound"===e[0]?t="inboundpageLang":"member"===e[0]?t="loginPageLang":"month"===e[0]?t="monthlyPRpageLang":"obound"===e[0]?t="oboundpageLang":"outbound"===e[0]&&(t="outboundpageLang");for(var o=1;o<e.length;o++);n.value=t}},errors:t}}const O={setup:function(){var e=R(),t=e.urls,n=e.getUrl,o=R(),a=o.whereurl,r=o.getPageNames;(0,A.wF)(n),(0,A.wF)(r);var i=document.getElementsByClassName("sidebar-item active")[1].textContent.replace(/&nbsp;/g,"");return{urls:t,whereurl:a,op:i=i.replace(/\s+/g," ").trim()}},mounted:function(){var e=document.getElementsByTagName("HTML")[0].getAttribute("lang");this.$lang.setLocale(e)}},T=(0,w.Z)(O,[["render",function(e,t,n,o,a,r){return(0,d.wg)(),(0,d.iD)("nav",_,[(0,d._)("ol",C,[(0,d._)("li",L,[(0,d._)("a",k,(0,d.zw)(e.$t("templateWords.websiteName")),1)]),((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(o.urls.slice(0,-1),(function(t,n){return(0,d.wg)(),(0,d.iD)("li",{key:n,class:"breadcrumb-item"},[(0,d._)("a",{href:t},(0,d.zw)(e.$t(o.whereurl+".page_name")),9,P)])})),128)),(0,d._)("li",S,[(0,d._)("span",null,(0,d.zw)(o.op),1)]),I])])}]]);var j=[{path:"/vuetest",name:"test.example",component:x},{path:"/catchAll(.*)",name:"breadcrumb.nav",component:T}];const M=(0,m.p7)({history:(0,m.PO)(),routes:j});var N=function(e){return(0,d.dD)("data-v-79889ab7"),e=e(),(0,d.Cn)(),e},B={class:"row justify-content-between"},D={class:"row col col-auto"},F={class:"col col-auto"},U={for:"pnInput",class:"col-form-label"},q={class:"col col-6 p-0 m-0"},G=["placeholder"],z={class:"col col-auto"},H=[N((function(){return(0,d._)("i",{class:"bi bi-trash3-fill fs-4"},null,-1)}))],J=[N((function(){return(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill fs-4"},null,-1)}))],Y=N((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Q={key:0,class:"invalid-feedback d-block",role:"alert"},X={key:0},Z=["onChange","id","name"],V={value:"是",selected:""},K={value:"否"},W={key:1},ee=["onChange","id","name"],te={value:"是"},ne={value:"否",selected:""},oe={key:0},ae=["onChange","id","name","value"],re={key:1},ie=N((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),le={class:"row justify-content-center"},se={class:"col col-auto"},ce=N((function(){return(0,d._)("i",{class:"bi bi-cloud-upload-fill"},null,-1)}));var ue=n(4105),pe=function(e){return(0,d.dD)("data-v-1c4b483e"),e=e(),(0,d.Cn)(),e},de={class:"vtl vtl-card p-2"},fe={key:0,class:"vtl-card-title"},ge={class:"vtl-card-body"},he={class:"vtl-row"},me={key:0,class:"vtl-loading-mask"},be=[pe((function(){return(0,d._)("div",{class:"vtl-loading-content"},[(0,d._)("span",{style:{color:"white"}},"Loading...")],-1)}))],ve={class:"vtl-thead"},ye={class:"vtl-thead-tr m-0 p-0"},we=["onClick","innerHTML"],xe=["set"],_e=["colspan"],Ce={class:"flex"},Le={key:0,class:"animation"},ke=["onClick"],Pe=["innerHTML"],Se=["name","onClick"],Ie=["id","onClick","value"],Ae=["innerHTML"],Ee=["onChange","innerHTML"],$e={key:2,style:{width:"max-content",margin:"0 auto"}},Re={key:0,style:{width:"max-content",margin:"0 auto"}},Oe={key:1},Te=["set"],je=["colspan"],Me={class:"flex"},Ne={key:0,class:"animation"},Be=["onClick"],De=["innerHTML"],Fe=["name","onClick"],Ue=["id","value","onClick"],qe=["innerHTML"],Ge=["onChange","innerHTML"],ze={key:2,style:{width:"max-content",margin:"0 auto"}},He={key:0,style:{width:"max-content",margin:"0 auto"}},Je={key:1},Ye={key:0,class:"vtl-paging vtl-row"},Qe={class:"vtl-paging-info col col-auto p-0 m-0"},Xe={role:"status","aria-live":"polite"},Ze=pe((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Ve={class:"row w-100 justify-content-between align-items-center p-0 m-0"},Ke={class:"vtl-paging-change-div col col-auto p-0 m-0"},We={class:"vtl-paging-count-label col col-auto"},et=["value"],tt={class:"vtl-paging-page-label col col-auto"},nt=["value"],ot={class:"vtl-paging-pagination-div align-items-center col col-auto p-0 m-0"},at={class:"dataTables_paginate"},rt={class:"vtl-paging-pagination-ul vtl-pagination p-0 m-0"},it=[pe((function(){return(0,d._)("span",{"aria-hidden":"true"},[(0,d._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-skip-start-fill",viewBox:"0 0 16 16"},[(0,d._)("path",{d:"M4 4a.5.5 0 0 1 1 0v3.248l6.267-3.636c.54-.313 1.232.066 1.232.696v7.384c0 .63-.692 1.01-1.232.697L5 8.753V12a.5.5 0 0 1-1 0V4z"})])],-1)})),pe((function(){return(0,d._)("span",{class:"sr-only"},"First",-1)}))],lt=[pe((function(){return(0,d._)("span",{"aria-hidden":"true"},[(0,d._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-caret-left-fill",viewBox:"0 0 16 16"},[(0,d._)("path",{d:"m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z"})])],-1)})),pe((function(){return(0,d._)("span",{class:"sr-only"},"Prev",-1)}))],st=["onClick"],ct=[pe((function(){return(0,d._)("span",{"aria-hidden":"true"},[(0,d._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-caret-right-fill",viewBox:"0 0 16 16"},[(0,d._)("path",{d:"m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"})])],-1)})),pe((function(){return(0,d._)("span",{class:"sr-only"},"Next",-1)}))],ut=[pe((function(){return(0,d._)("span",{"aria-hidden":"true"},[(0,d._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-skip-end-fill",viewBox:"0 0 16 16"},[(0,d._)("path",{d:"M12.5 4a.5.5 0 0 0-1 0v3.248L5.233 3.612C4.693 3.3 4 3.678 4 4.308v7.384c0 .63.692 1.01 1.233.697L11.5 8.753V12a.5.5 0 0 0 1 0V4z"})])],-1)})),pe((function(){return(0,d._)("span",{class:"sr-only"},"Last",-1)}))],pt={key:1,class:"vtl-row"},dt={class:"vtl-empty-msg col-12 text-center"};function ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,r,i,l=[],s=!0,c=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=r.call(n)).done)&&(l.push(o.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}const ht=(0,d.aZ)({name:"my-table",emits:["return-checked-rows","do-search","is-finished","get-now-page","row-clicked","row-toggled","row-input"],props:{isLoading:{type:Boolean,require:!0},isReSearch:{type:Boolean,require:!0},hasCheckbox:{type:Boolean,default:!1},checkedReturnType:{type:String,default:"row"},title:{type:String,default:""},isFixedFirstColumn:{type:Boolean,default:!1},columns:{type:Array,default:function(){return[]}},rows:{type:Array,default:function(){return[]}},rowClasses:{type:[Array,Function],default:function(){return[]}},pageSize:{type:Number,default:10},total:{type:Number,default:100},page:{type:Number,default:1},sortable:{type:Object,default:function(){return{order:"id",sort:"asc"}}},messages:{type:Object,default:function(){return{pagingInfo:"Showing {0}-{1} of {2}",pageSizeChangeLabel:"Row count:",gotoPageLabel:"Go to page:",noDataAvailable:"No data"}}},isStaticMode:{type:Boolean,default:!1},isSlotMode:{type:Boolean,default:!1},isHidePaging:{type:Boolean,default:!1},pageOptions:{type:Array,default:function(){return[{value:10,text:10},{value:25,text:25},{value:50,text:50}]}},groupingKey:{type:String,default:""},hasGroupToggle:{type:Boolean,default:!1},groupingDisplay:{type:Function,default:null},maxHeight:{default:"auto"},startCollapsed:{type:Boolean,default:!1},isKeepCollapsed:{type:Boolean,default:!1}},setup:function(e,t){var n=t.emit,o=t.slots,a=(0,d.iH)(null),r=e.pageOptions.length>0?(0,d.iH)(e.pageOptions[0].value):(0,d.iH)(e.pageSize);e.pageOptions.length>0&&e.pageOptions.forEach((function(t){Object.prototype.hasOwnProperty.call(t,"value")&&Object.prototype.hasOwnProperty.call(t,"text")&&e.pageSize==t.value&&(r.value=t.value)}));var i=(0,d.qj)({isSlotMode:e.isSlotMode,isCheckAll:!1,isHidePaging:e.isHidePaging,keyColumn:(0,d.Fl)((function(){var t="";return Object.assign(e.columns).forEach((function(e){e.isKey&&(t=e.field)})),t})),page:e.page,pageSize:r.value,maxPage:(0,d.Fl)((function(){if(e.total<=0)return 0;var t=Math.floor(e.total/i.pageSize);return e.total%i.pageSize>0&&t++,t})),offset:(0,d.Fl)((function(){return(i.page-1)*i.pageSize+1})),limit:(0,d.Fl)((function(){var t=i.page*i.pageSize;return e.total>=t?t:e.total})),paging:(0,d.Fl)((function(){var e=i.page-2<=0?1:i.page-2;i.maxPage-i.page<=2&&(e=i.maxPage-4);for(var t=[],n=e=e<=0?1:e;n<=i.maxPage;n++)t.length<5&&t.push(n);return t})),order:e.sortable.order,sort:e.sortable.sort,pageOptions:e.pageOptions}),l=(0,d.iH)([]),s=(0,d.Fl)((function(){var t=e.rows,n=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),o="desc"===i.sort?-1:1;t.sort((function(e,t){return n.compare(e[i.order],t[i.order])*o}));var a=null;if(e.groupingKey){var r={};t.forEach((function(t){r[t[e.groupingKey]]||(r[t[e.groupingKey]]=[]),r[t[e.groupingKey]].push(t)})),a={};for(var l=i.offset-1;l<i.limit;l++)a[t[l][e.groupingKey]]=r[t[l][e.groupingKey]]}else{a=[];for(var s=i.offset-1;s<i.limit;s++)a.push(t[s])}return(0,d.Y3)((function(){f()})),a})),c=(0,d.iH)([]);(0,d.Xn)((function(){c.value=[]})),(0,d.YP)((function(){return i.isCheckAll}),(function(t){if(e.hasCheckbox){if(l.value=[],t){var o=e.isStaticMode?e.rows.slice(i.offset-1,i.limit):e.rows;"row"==e.checkedReturnType?l.value=o:o.forEach((function(e){l.value.push(e[i.keyColumn])}))}c.value.forEach((function(e){e&&(e.checked=t)})),n("return-checked-rows",l.value)}})),(0,d.YP)((function(){return e.hasCheckbox}),(function(e){e||(i.isCheckAll=!1)}));var u=function(){l.value=[],c.value.forEach((function(e){e&&e.checked&&(e.checked=!1)})),n("return-checked-rows",l.value)},p=function(t,o){i.isCheckAll=!1,e.hasCheckbox&&(l.value=[]);var a=i.order,r=i.sort,s=(t-1)*i.pageSize,c=i.pageSize;(!e.isReSearch||t>1||t==o)&&n("do-search",s,c,a,r)};(0,d.YP)((function(){return i.page}),p),(0,d.YP)((function(){return e.page}),(function(e){e<=1?(i.page=1,n("get-now-page",i.page)):e>=i.maxPage?(i.page=i.maxPage,n("get-now-page",i.page)):i.page=e}));(0,d.YP)((function(){return i.pageSize}),(function(){1===i.page?p(i.page,i.page):(i.page=1,i.isCheckAll=!1)})),(0,d.YP)((function(){return e.pageSize}),(function(e){i.pageSize=e}));(0,d.YP)((function(){return e.rows}),(function(){(e.isReSearch||e.isStaticMode)&&(i.page=1),(0,d.Y3)((function(){e.isStaticMode||f()}))}));var f=function(){if(a.value){var e=a.value.getElementsByClassName("is-rows-el");n("is-finished",e)}n("get-now-page",i.page)},g=(0,d.iH)({}),h=(0,d.iH)({}),m=(0,d.iH)({}),b=(0,d.Fl)((function(){var t={};return e.rows.forEach((function(n){t[n[e.groupingKey]]||(t[n[e.groupingKey]]=[]),t[n[e.groupingKey]].push(n)})),(0,d.Y3)((function(){if(e.startCollapsed||e.isKeepCollapsed)for(var t=0,n=Object.entries(g.value);t<n.length;t++){var o=ft(n[t],2),a=o[0],r=o[1];if(r){var i=!e.startCollapsed;e.isKeepCollapsed&&void 0!==m.value[a]&&(i=!m.value[a]),(i&&r.parentElement.classList.contains("rotated-90")||!i&&!r.parentElement.classList.contains("rotated-90"))&&r.parentElement.classList.toggle("rotated-90"),i||h.value[a].forEach((function(e){e&&e.classList.add("hidden")}))}}f()})),t}));return(0,d.bv)((function(){(0,d.Y3)((function(){e.rows.length>0&&f()}))})),{slots:o,localTable:a,localRows:s,setting:i,rowCheckbox:c,clickChild:function(t){e.isFixedFirstColumn&&null!==t.target.firstElementChild&&t.target.firstElementChild.click()},checked:function(t,o){o.stopPropagation();var a=t[i.keyColumn];if("row"==e.checkedReturnType&&(a=t),o.target.checked)l.value.push(a);else{var r=l.value.indexOf(a);r>=0&&l.value.splice(r,1)}l.value.length==e.rows.length?i.isCheckAll=!0:n("return-checked-rows",l.value)},clearChecked:u,doSort:function(t){var o="asc";t==i.order&&"asc"==i.sort&&(o="desc");var a=(i.page-1)*i.pageSize,r=i.pageSize;i.order=t,i.sort=o,n("do-search",a,r,t,o),i.isCheckAll?i.isCheckAll=!1:e.hasCheckbox&&u()},prevPage:function(){if(1==i.page)return!1;i.page--},movePage:function(e){i.page=e},nextPage:function(){if(i.page>=i.maxPage)return!1;i.page++},stringFormat:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return e.replace(/{(\d+)}/g,(function(e,t){return void 0!==n[t]?n[t]:e}))},toggleButtonRefs:g,groupingRowsRefs:h,groupingRows:b,toggleGroup:function(e){var t=g.value[e];if(t){t.parentElement.classList.toggle("rotated-90");var o=t.parentElement.classList.contains("rotated-90");h.value[e].forEach((function(e){e&&(o?e.classList.add("hidden"):e.classList.remove("hidden"))})),m.value[e]=o,n("row-toggled",b.value[e],o)}}}}});var mt=n(2446),bt=n.n(mt),vt=n(7762),yt={insert:"head",singleton:!1};bt()(vt.Z,yt);vt.Z.locals;const wt=(0,w.Z)(ht,[["render",function(e,t,n,o,a,r){return(0,d.wg)(),(0,d.iD)("div",de,[e.title?((0,d.wg)(),(0,d.iD)("div",fe,(0,d.zw)(e.title),1)):(0,d.kq)("",!0),(0,d._)("div",ge,[(0,d._)("div",he,[(0,d._)("div",{class:(0,d.C_)(["col-sm-12 dataTables_wrapper CustomScrollbar",{"fixed-first-column":e.isFixedFirstColumn,"fixed-first-second-column":e.isFixedFirstColumn&&e.hasCheckbox}])},[e.isLoading?((0,d.wg)(),(0,d.iD)("div",me,be)):(0,d.kq)("",!0),(0,d._)("table",{class:"vtl-table vtl-table-bordered table table-hover align-items-center align-middle text-center justify-content-center",ref:"localTable",style:(0,d.j5)("max-height: "+e.maxHeight+"px;")},[(0,d._)("thead",ve,[(0,d._)("tr",ye,[e.hasCheckbox?((0,d.wg)(),(0,d.iD)("th",{key:0,class:"vtl-thead-th vtl-checkbox-th m-0 p-0 align-items-center align-middle",onClick:t[1]||(t[1]=function(t){return e.clickChild(t)})},[(0,d.wy)((0,d._)("input",{type:"checkbox",class:"vtl-thead-checkbox","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.setting.isCheckAll=t})},null,512),[[d.e8,e.setting.isCheckAll]])])):(0,d.kq)("",!0),((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.columns,(function(n,o){return(0,d.wg)(),(0,d.iD)("th",{class:(0,d.C_)(["vtl-thead-th m-0 p-0",n.headerClasses]),key:o,style:(0,d.j5)(Object.assign({width:n.width?n.width:"auto"},n.headerStyles)),onClick:t[2]||(t[2]=function(t){return e.clickChild(t)})},[(0,d._)("div",{class:(0,d.C_)(["vtl-thead-column",{"vtl-sortable":n.sortable,"vtl-both":n.sortable,"vtl-asc":e.setting.order===n.field&&"asc"===e.setting.sort,"vtl-desc":e.setting.order===n.field&&"desc"===e.setting.sort}]),onClick:(0,d.iM)((function(t){return!!n.sortable&&e.doSort(n.field)}),["prevent"]),innerHTML:n.label},null,10,we)],6)})),128))])]),e.rows.length>0?((0,d.wg)(),(0,d.iD)(d.HY,{key:0},[e.isStaticMode?((0,d.wg)(),(0,d.iD)("tbody",{key:0,class:"vtl-tbody",set:e.templateRows=""==e.groupingKey?[e.localRows]:e.localRows},[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.templateRows,(function(n,o){return(0,d.wg)(),(0,d.iD)(d.HY,null,[""!=e.groupingKey?((0,d.wg)(),(0,d.iD)("tr",{key:o,class:"vtl-tbody-tr vtl-group-tr m-0 p-0"},[(0,d._)("td",{colspan:e.hasCheckbox?2:1,class:"vtl-tbody-td vtl-group-td m-0 p-0"},[(0,d._)("div",Ce,[e.hasGroupToggle?((0,d.wg)(),(0,d.iD)("div",Le,[(0,d._)("a",{ref_for:!0,ref:function(t){return e.toggleButtonRefs[o]=t},class:"cursor-pointer",style:{"text-decoration":"none"},onClick:(0,d.iM)((function(t){return e.toggleGroup(o)}),["prevent"])},"▼",8,ke)])):(0,d.kq)("",!0),(0,d._)("div",{class:"ml-2",innerHTML:e.groupingDisplay?e.groupingDisplay(o):o},null,8,Pe)])],8,_e)])):(0,d.kq)("",!0),((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(n,(function(n,a){return(0,d.wg)(),(0,d.iD)("tr",{key:n[e.setting.keyColumn]?n[e.setting.keyColumn]:a,ref_for:!0,ref:function(t){e.groupingRowsRefs[o]||(e.groupingRowsRefs[o]=[]),e.groupingRowsRefs[o][a]=t},name:"vtl-group-"+o,class:(0,d.C_)(["vtl-tbody-tr m-0 p-0","function"==typeof e.rowClasses?e.rowClasses(n):e.rowClasses]),onClick:function(t){return e.$emit("row-clicked",n)}},[e.hasCheckbox?((0,d.wg)(),(0,d.iD)("td",{key:0,class:"vtl-tbody-td vtl-checkbox-td m-0 p-0",onClick:t[3]||(t[3]=function(t){return e.clickChild(t)})},[(0,d._)("input",{type:"checkbox",class:"vtl-tbody-checkbox",id:"checkbox"+a,onClick:function(t){return e.checked(n,t)},ref_for:!0,ref:function(t){e.rowCheckbox.push(t)},value:n[e.setting.keyColumn]},null,8,Ie)])):(0,d.kq)("",!0),((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.columns,(function(t,o){return(0,d.wg)(),(0,d.iD)("td",{key:o,class:(0,d.C_)(["vtl-tbody-td px-1 py-0",["vtl-tbody-td"+o].concat(t.columnClasses)]),style:(0,d.j5)(t.columnStyles)},[t.display?((0,d.wg)(),(0,d.iD)("div",{key:0,innerHTML:t.display(n,a)},null,8,Ae)):t.hasInput?((0,d.wg)(),(0,d.iD)("div",{key:1,style:{width:"max-content",margin:"0 auto"},onChange:function(t){return e.$emit("row-input",n,a)},innerHTML:t.hasInput(n,a)},null,40,Ee)):((0,d.wg)(),(0,d.iD)("div",$e,[e.setting.isSlotMode&&e.slots[t.field]?((0,d.wg)(),(0,d.iD)("div",Re,[(0,d.WI)(e.$slots,t.field,{row:n,key:a},void 0,!0)])):((0,d.wg)(),(0,d.iD)("span",Oe,(0,d.zw)(n[t.field]),1))]))],6)})),128))],10,Se)})),128))],64)})),256))],8,xe)):((0,d.wg)(),(0,d.iD)("tbody",{key:1,set:e.templateRows=""==e.groupingKey?[e.rows]:e.groupingRows},[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.templateRows,(function(n,o){return(0,d.wg)(),(0,d.iD)(d.HY,null,[""!=e.groupingKey?((0,d.wg)(),(0,d.iD)("tr",{class:"vtl-tbody-tr vtl-group-tr m-0 p-0",key:o},[(0,d._)("td",{colspan:e.hasCheckbox?e.columns.length+1:e.columns.length,class:"vtl-tbody-td vtl-group-td m-0 p-0"},[(0,d._)("div",Me,[e.hasGroupToggle?((0,d.wg)(),(0,d.iD)("div",Ne,[(0,d._)("a",{ref_for:!0,ref:function(t){return e.toggleButtonRefs[o]=t},class:"cursor-pointer",style:{"text-decoration":"none"},onClick:(0,d.iM)((function(t){return e.toggleGroup(o)}),["prevent"])},"▼",8,Be)])):(0,d.kq)("",!0),(0,d._)("div",{class:"ml-2",innerHTML:e.groupingDisplay?e.groupingDisplay(o):o},null,8,De)])],8,je)])):(0,d.kq)("",!0),((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(n,(function(n,a){return(0,d.wg)(),(0,d.iD)("tr",{ref_for:!0,ref:function(t){e.groupingRowsRefs[o]||(e.groupingRowsRefs[o]=[]),e.groupingRowsRefs[o][a]=t},name:"vtl-group-"+o,key:n[e.setting.keyColumn]?n[e.setting.keyColumn]:a,class:(0,d.C_)(["vtl-tbody-tr m-0 p-0","function"==typeof e.rowClasses?e.rowClasses(n):e.rowClasses]),onClick:function(t){return e.$emit("row-clicked",n)}},[e.hasCheckbox?((0,d.wg)(),(0,d.iD)("td",{key:0,class:"vtl-tbody-td vtl-checkbox-td m-0 p-0",onClick:t[4]||(t[4]=function(t){return e.clickChild(t)})},[(0,d._)("input",{type:"checkbox",class:"vtl-tbody-checkbox",id:"checkbox"+a,ref_for:!0,ref:function(t){e.rowCheckbox.push(t)},value:n[e.setting.keyColumn],onClick:function(t){return e.checked(n,t)}},null,8,Ue)])):(0,d.kq)("",!0),((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.columns,(function(t,o){return(0,d.wg)(),(0,d.iD)("td",{key:o,class:(0,d.C_)(["vtl-tbody-td px-1 py-0",["vtl-tbody-td"+o].concat(t.columnClasses)]),style:(0,d.j5)(t.columnStyles)},[t.display?((0,d.wg)(),(0,d.iD)("div",{key:0,innerHTML:t.display(n,a)},null,8,qe)):t.hasInput?((0,d.wg)(),(0,d.iD)("div",{key:1,style:{width:"max-content",margin:"0 auto"},onChange:function(t){return e.$emit("row-input",n,a)},innerHTML:t.hasInput(n,a)},null,40,Ge)):((0,d.wg)(),(0,d.iD)("div",ze,[e.setting.isSlotMode&&e.slots[t.field]?((0,d.wg)(),(0,d.iD)("div",He,[(0,d.WI)(e.$slots,t.field,{row:n,key:a},void 0,!0)])):((0,d.wg)(),(0,d.iD)("span",Je,(0,d.zw)(n[t.field]),1))]))],6)})),128))],10,Fe)})),128))],64)})),256))],8,Te))],64)):(0,d.kq)("",!0)],4)],2)]),e.rows.length>0?((0,d.wg)(),(0,d.iD)("div",Ye,[e.setting.isHidePaging?(0,d.kq)("",!0):((0,d.wg)(),(0,d.iD)(d.HY,{key:0},[(0,d._)("div",Qe,[(0,d._)("div",Xe,(0,d.zw)(e.stringFormat(e.messages.pagingInfo,e.setting.offset,e.setting.limit,e.total)),1)]),Ze,(0,d._)("div",Ve,[(0,d._)("div",Ke,[(0,d._)("span",We,(0,d.zw)(e.messages.pageSizeChangeLabel),1),(0,d.wy)((0,d._)("select",{class:"vtl-paging-count-dropdown","onUpdate:modelValue":t[5]||(t[5]=function(t){return e.setting.pageSize=t})},[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.pageOptions,(function(e){return(0,d.wg)(),(0,d.iD)("option",{value:e.value,key:e.value},(0,d.zw)(e.text),9,et)})),128))],512),[[d.bM,e.setting.pageSize]]),(0,d.Uk)("    "),(0,d._)("span",tt,(0,d.zw)(e.messages.gotoPageLabel),1),(0,d.wy)((0,d._)("select",{class:"vtl-paging-page-dropdown col col-auto","onUpdate:modelValue":t[6]||(t[6]=function(t){return e.setting.page=t})},[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.setting.maxPage,(function(e){return(0,d.wg)(),(0,d.iD)("option",{key:e,value:parseInt(e)},(0,d.zw)(e),9,nt)})),128))],512),[[d.bM,e.setting.page]])]),(0,d._)("div",ot,[(0,d._)("div",at,[(0,d._)("ul",rt,[(0,d._)("li",{class:(0,d.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-first page-item",{disabled:e.setting.page<=1}])},[(0,d._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-first page-link cursor-pointer",href:"javascript:void(0)","aria-label":"Previous",onClick:t[7]||(t[7]=(0,d.iM)((function(t){return e.setting.page=1}),["prevent"]))},it)],2),(0,d._)("li",{class:(0,d.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-prev page-item",{disabled:e.setting.page<=1}])},[(0,d._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-prev page-link cursor-pointer",href:"javascript:void(0)","aria-label":"Previous",onClick:t[8]||(t[8]=(0,d.iM)((function(){return e.prevPage&&e.prevPage.apply(e,arguments)}),["prevent"]))},lt)],2),((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.setting.paging,(function(t){return(0,d.wg)(),(0,d.iD)("li",{class:(0,d.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-number page-item",{disabled:e.setting.page===t}]),key:t},[(0,d._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-number page-link cursor-pointer",href:"javascript:void(0)",onClick:(0,d.iM)((function(n){return e.movePage(t)}),["prevent"])},(0,d.zw)(t),9,st)],2)})),128)),(0,d._)("li",{class:(0,d.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-next page-item",{disabled:e.setting.page>=e.setting.maxPage}])},[(0,d._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-next page-link cursor-pointer",href:"javascript:void(0)","aria-label":"Next",onClick:t[9]||(t[9]=(0,d.iM)((function(){return e.nextPage&&e.nextPage.apply(e,arguments)}),["prevent"]))},ct)],2),(0,d._)("li",{class:(0,d.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-last page-item",{disabled:e.setting.page>=e.setting.maxPage}])},[(0,d._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-last page-link cursor-pointer",href:"javascript:void(0)","aria-label":"Next",onClick:t[10]||(t[10]=(0,d.iM)((function(t){return e.setting.page=e.setting.maxPage}),["prevent"]))},ut)],2)])])])])],64))])):((0,d.wg)(),(0,d.iD)("div",pt,[(0,d._)("div",dt,(0,d.zw)(e.messages.noDataAvailable),1)]))])])}],["__scopeId","data-v-1c4b483e"]]);function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function _t(){_t=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==xt(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Ct(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Lt(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Ct(r,o,a,i,l,"next",e)}function l(e){Ct(r,o,a,i,l,"throw",e)}i(void 0)}))}}function kt(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=(0,d.iH)(""),o=((0,m.tv)(),function(){var t=Lt(_t().mark((function t(){var o,a,r,i,l,s;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.value="",t.next=3,$().post("/getCurrentDB");case 3:return o=t.sent,a=sessionStorage.getItem("lookInTargets"),r=sessionStorage.getItem("lookInType"),i=sessionStorage.getItem("lookInSend"),t.prev=7,t.next=10,$().post("/api/basic/mats",{DB:o.data,LookInTargets:a,LookInType:r,LookInSend:i});case 10:l=t.sent,e.value=JSON.stringify(l.data),t.next=19;break;case 14:for(s in t.prev=14,t.t0=t.catch(7),console.log(t.t0),t.t0.response.data.errors)n.value+=t.t0.response.data.errors[s][0]+"  ";console.log(n.value);case 19:case"end":return t.stop()}}),t,null,[[7,14]])})));return function(){return t.apply(this,arguments)}}()),a=function(){var e=Lt(_t().mark((function e(){var o,a;return _t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return o=e.sent,e.prev=4,e.next=7,$().post("/api/basic/get_dispatcher",{DB:o.data});case 7:return a=e.sent,t.value=JSON.stringify(a.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(){return e.apply(this,arguments)}}(),r=function(){var e=Lt(_t().mark((function e(t){var o,a;return _t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return o=e.sent,e.prev=4,e.next=7,$().post("/api/basic/delete_pn",{DB:o.data,pn:JSON.stringify(t)});case 7:return a=e.sent,console.log(a.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Lt(_t().mark((function e(o,a,r,i,l,s,c,u,p,d,f,g,h){var m,b;return _t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return m=e.sent,e.prev=4,e.next=7,$().post("/api/basic/update_pn",{DB:m.data,pn:JSON.stringify(o),name:JSON.stringify(a),spec:JSON.stringify(r),price:JSON.stringify(i),unit:JSON.stringify(l),currency:JSON.stringify(s),mpq:JSON.stringify(c),moq:JSON.stringify(u),lt:JSON.stringify(p),gradea:JSON.stringify(d),monthly:JSON.stringify(f),dispatcher:JSON.stringify(g),safe:JSON.stringify(h)});case 7:return b=e.sent,t.value=JSON.stringify(b.data),console.log(b.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 13:return e.prev=13,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,n,o,a,r,i,l,s,c,u,p,d,f){return e.apply(this,arguments)}}();return{mats:e,queryResult:t,getMats:o,getDispatchers:a,deletePN:r,uploadToDB:i}}var Pt=n(9755);function St(e){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},St(e)}function It(){It=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==St(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function At(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Et(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){At(r,o,a,i,l,"next",e)}function l(e){At(r,o,a,i,l,"throw",e)}i(void 0)}))}}const $t=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=kt(),t=e.mats,n=e.queryResult,o=e.getMats,a=e.deletePN,r=e.uploadToDB,i=(0,d.iH)(!1),l=(0,d.iH)("");(0,A.wF)(o);var s=(0,d.iH)(""),c=(0,A.FN)(),u=document.getElementsByTagName("HTML")[0].getAttribute("lang");c.appContext.config.globalProperties.$lang.setLocale(u);var p=(0,d.qj)([]),f=(0,d.qj)([]),g=[],h=function(){var e=Et(It().mark((function e(){var t,n,o,r;return It().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],0!=g.length){e.next=4;break}return notyf.open({type:"warning",message:c.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),e.abrupt("return");case 4:for(n=0;n<g.length;n++)t.push(g[n].料號);return e.next=7,b();case 7:return e.next=9,a(t);case 9:if("success"===e.sent){for(o=function(e){var t=p.findIndex((function(t){return parseInt(t.id)===parseInt(g[e].id)}));-1!=t&&p.splice(t,1)},r=0;r<g.length;r++)o(r);notyf.open({type:"success",message:c.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+c.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),document.querySelectorAll(".vtl-tbody-checkbox").forEach((function(e){return e.checked=!1})),document.querySelector(".vtl-thead-checkbox").checked&&document.querySelector(".vtl-thead-checkbox").click(),g=[]}else notyf.open({type:"error",message:c.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});Pt("body").loadingModal("hide"),Pt("body").loadingModal("destroy");case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Et(It().mark((function e(){var t,n,o,a,r,i,l,s,u;return It().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:for(t=new Date,n=String(t.getDate()).padStart(2,"0"),o=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear(),t=a+"_"+o+"_"+n,r=Array(),i=0;i<p.length;i++)(l=new Object).料號=p[i].料號,l.品名=p[i].品名,l.規格=p[i].規格,l.單價=parseFloat(p[i].單價.toString()),l.幣別=p[i].幣別,l.單位=p[i].單位,l.MPQ=parseInt(p[i].MPQ.toString()),l.MOQ=parseInt(p[i].MOQ.toString()),l.LT=parseInt(p[i].LT.toString()),l.月請購=p[i].月請購,l.A級資材=p[i].A級資材,l.發料部門=p[i].發料部門,l.安全庫存=p[i].安全庫存,r.push(l);s=ue.P6.json_to_sheet(r),u=ue.P6.book_new(),ue.P6.book_append_sheet(u,s,c.appContext.config.globalProperties.$t("basicInfoLang.matssearch")),ue.NC(u,c.appContext.config.globalProperties.$t("basicInfoLang.matssearch")+"_"+t+".xlsx",{compression:!0}),Pt("body").loadingModal("hide"),Pt("body").loadingModal("destroy");case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Et(It().mark((function e(){return It().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pt("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Et(It().mark((function e(){var t,o,a,s,u,d,f,g,h,m,v,y,w,x,_,C,L,k,P;return It().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:if(i.value=!1,0,t=!1,!(p.length<=0)){e.next=10;break}return notyf.open({type:"warning",message:c.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Pt("body").loadingModal("hide"),Pt("body").loadingModal("destroy"),e.abrupt("return");case 10:for(o=0;o<p.length&&!1===t;o++)p[o].料號=p[o].料號.toString().trim(),p[o].品名=p[o].品名.toString().trim(),p[o].規格=p[o].規格.toString().trim(),p[o].單價=p[o].單價.toString().trim(),p[o].幣別=p[o].幣別.toString().trim(),p[o].單位=p[o].單位.toString().trim(),p[o].MPQ=p[o].MPQ.toString().trim(),p[o].MOQ=p[o].MOQ.toString().trim(),p[o].LT=p[o].LT.toString().trim(),p[o].A級資材=p[o].A級資材.toString().trim(),p[o].月請購=p[o].月請購.toString().trim(),p[o].發料部門=p[o].發料部門.toString().trim(),"否"===p[o].月請購?null===p[o].安全庫存?(t=!0,l.value=c.appContext.config.globalProperties.$t("basicInfoLang.entersafe")+" ( "+p[o].料號+" ) "):p[o].安全庫存=p[o].安全庫存.toString().trim():p[o].安全庫存="null";if(!t){e.next=17;break}return i.value=!0,notyf.open({type:"error",message:c.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Pt("body").loadingModal("hide"),Pt("body").loadingModal("destroy"),e.abrupt("return");case 17:for(a=[],s=[],u=[],d=[],f=[],g=[],h=[],m=[],v=[],y=[],w=[],x=[],_=[],C=0;C<p.length;C++)a.push(p[C].料號),s.push(p[C].品名),u.push(p[C].規格),d.push(p[C].單價),f.push(p[C].幣別),g.push(p[C].單位),h.push(p[C].MPQ),m.push(p[C].MOQ),v.push(p[C].LT),y.push(p[C].A級資材),w.push(p[C].月請購),x.push(p[C].發料部門),_.push(p[C].安全庫存);return L=Date.now(),e.next=34,r(a,s,u,d,g,f,h,m,v,y,w,x,_);case 34:k=e.sent,P=Date.now()-L,console.log("Total time taken : "+P+" milliseconds"),Pt("body").loadingModal("hide"),Pt("body").loadingModal("destroy"),"success"===k?notyf.open({type:"success",message:c.appContext.config.globalProperties.$t("monthlyPRpageLang.total")+" "+JSON.parse(n.value).record+" "+c.appContext.config.globalProperties.$t("monthlyPRpageLang.record")+" "+c.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+c.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}):notyf.open({type:"error",message:c.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});case 40:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,A.YP)(t,Et(It().mark((function e(){var n,o,a;return It().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:for(n=JSON.parse(t.value),o=0;o<n.senders.length;o++)f.push(n.senders[o]);for(a=0;a<n.datas.length;a++)n.datas[a].id=a,p.push(n.datas[a]);Pt("body").loadingModal("hide"),Pt("body").loadingModal("destroy"),y.isLoading=!1;case 8:case"end":return e.stop()}}),e)}))));var y=(0,d.qj)({isLoading:!0,columns:[{label:c.appContext.config.globalProperties.$t("basicInfoLang.isn"),field:"料號",width:"14ch",sortable:!0,isKey:!0,display:function(e,t){return'<input type="hidden" id="number'+e.id+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:c.appContext.config.globalProperties.$t("basicInfoLang.pName"),field:"品名",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:c.appContext.config.globalProperties.$t("basicInfoLang.format"),field:"規格",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:c.appContext.config.globalProperties.$t("basicInfoLang.price")+" & "+c.appContext.config.globalProperties.$t("basicInfoLang.money"),field:"單價_幣別",width:"19ch",sortable:!1,hasInput:function(e,t){var n="";return n+='<div class="row"><input style="width: 7ch;" type="number" step="0.00001" id="price'+e.id+'" class="col form-control text-center align-self-center p-0 m-0" name="price'+t+'" value="'+parseFloat(e.單價)+'">',n+='<select style="width: 8ch;" class="col form-select form-select-lg ps-2 p-0 m-0" id="money'+e.id+'" name="money'+t+'">',["RMB","USD","JPY","TWD","VND","IDR"].forEach((function(t){e.幣別===t?n+='<option value="'+t+'" selected>'+t+"</option>":n+='<option value="'+t+'">'+t+"</option>"})),n+="</select></div>"}},{label:c.appContext.config.globalProperties.$t("basicInfoLang.unit"),field:"單位",width:"8ch",sortable:!0,hasInput:function(e,t){return'<input style="width:5ch;" type="text" id="unit'+e.id+'" name="unit'+t+'" value="'+e.單位+'" class="form-control text-center p-0 m-0">'}},{label:c.appContext.config.globalProperties.$t("basicInfoLang.mpq"),field:"MPQ",width:"9ch",sortable:!0,hasInput:function(e,t){return'<div class="row"><input style="width:5ch;" type="number" id="mpq'+e.id+'" name="mpq'+t+'" value="'+e.MPQ+'" class="form-control text-center col p-0 m-0" min="0"><div class="col input-group-text overflow-scroll py-0 px-1 m-0" style="width: 4ch;"><small>'+e.單位+"</small></div></div>"}},{label:c.appContext.config.globalProperties.$t("basicInfoLang.moq"),field:"MOQ",width:"9ch",sortable:!0,hasInput:function(e,t){return'<div class="row"><input style="width:5ch;" type="number" id="moq'+e.id+'" name="moq'+t+'" value="'+e.MOQ+'" class="form-control text-center col p-0 m-0" min="0"><div class="col input-group-text overflow-scroll py-0 px-1 m-0" style="width: 4ch;"><small>'+e.單位+"</small></div></div>"}},{label:c.appContext.config.globalProperties.$t("basicInfoLang.lt"),field:"LT",width:"8ch",sortable:!0,hasInput:function(e,t){return'<input style="width:8ch;" type="number" id="lt'+e.id+'" name="lt'+t+'" value="'+Math.round(e.LT)+'" class="form-control text-center p-0 m-0" min="0">'}},{label:c.appContext.config.globalProperties.$t("basicInfoLang.month"),field:"月請購",width:"12ch",sortable:!0},{label:c.appContext.config.globalProperties.$t("basicInfoLang.gradea"),field:"A級資材",width:"9ch",sortable:!0,hasInput:function(e,t){return"是"===e.A級資材?'<select style="width: 7ch;" class="col col-auto form-select form-select-lg ps-2 p-0 m-0" id="gradea'+e.id+'" name="gradea'+t+'"><option value="是" selected>'+c.appContext.config.globalProperties.$t("basicInfoLang.yes")+'</option><option value="否">'+c.appContext.config.globalProperties.$t("basicInfoLang.no")+"</option></select>":'<select style="width: 7ch;" class="col col-auto form-select form-select-lg ps-2 p-0 m-0" id="gradea'+e.id+'" name="gradea'+t+'"><option value="是">'+c.appContext.config.globalProperties.$t("basicInfoLang.yes")+'</option><option value="否" selected>'+c.appContext.config.globalProperties.$t("basicInfoLang.no")+"</option></select>"}},{label:c.appContext.config.globalProperties.$t("basicInfoLang.senddep"),field:"發料部門",width:"10ch",sortable:!0,hasInput:function(e,t){var n="";return n+='<select style="width: 10ch;" class="form-select form-select-lg ps-2 p-0 m-0" id="send'+e.id+'" name="send'+t+'">',f.forEach((function(t){e.發料部門===t?n+='<option value="'+t+'" selected>'+t+"</option>":n+='<option value="'+t+'">'+t+"</option>"})),n+="</select>"}},{label:c.appContext.config.globalProperties.$t("basicInfoLang.safe"),field:"安全庫存",width:"13ch",sortable:!0}],rows:(0,d.Fl)((function(){return p.filter((function(e){return e.料號.toLowerCase().includes(s.value.toLowerCase())||e.品名.includes(s.value)}))})),totalRecordCount:(0,d.Fl)((function(){return y.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:c.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+c.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+c.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+c.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:c.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:c.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:c.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:s,table:y,isInvalid_DB:i,validation_err_msg:l,updateCheckedRows:function(e){g=e},deleteRow:h,OutputExcelClick:m,rowUserInput:function(e,t){p[e.id].單價=document.getElementById("price"+e.id).value,p[e.id].幣別=document.getElementById("money"+e.id).value,p[e.id].單位=document.getElementById("unit"+e.id).value,p[e.id].MPQ=document.getElementById("mpq"+e.id).value,p[e.id].MOQ=document.getElementById("moq"+e.id).value,p[e.id].LT=document.getElementById("lt"+e.id).value,p[e.id].月請購=document.getElementById("month"+e.id).value,p[e.id].A級資材=document.getElementById("gradea"+e.id).value,p[e.id].發料部門=document.getElementById("send"+e.id).value,null==document.getElementById("safe"+e.id)?p[e.id].安全庫存=null:p[e.id].安全庫存=document.getElementById("safe"+e.id).value},onSendToDBClick:v}}});var Rt=n(2399),Ot={insert:"head",singleton:!1};bt()(Rt.Z,Ot);Rt.Z.locals;const Tt=(0,w.Z)($t,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",B,[(0,d._)("div",D,[(0,d._)("div",F,[(0,d._)("label",U,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",q,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,G),[[d.nr,e.searchTerm]])])]),(0,d._)("div",z,[(0,d._)("button",{type:"submit",id:"delete",name:"delete",class:"col col-auto btn btn-lg btn-danger",onClick:t[1]||(t[1]=function(){return e.deleteRow&&e.deleteRow.apply(e,arguments)})},H),(0,d.Uk)("   "),(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",onClick:t[2]||(t[2]=function(){return e.OutputExcelClick&&e.OutputExcelClick.apply(e,arguments)})},J)])]),Y,e.isInvalid_DB?((0,d.wg)(),(0,d.iD)("span",Q,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0),(0,d.Wm)(i,{id:"searchTable","is-fixed-first-column":!0,isStaticMode:!0,isSlotMode:!0,hasCheckbox:!0,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onDoSearch:e.doSearch,onIsFinished:t[3]||(t[3]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows,onRowInput:e.rowUserInput},{月請購:(0,d.w5)((function(t){var n=t.row,o=t.key;return["是"===n.月請購?((0,d.wg)(),(0,d.iD)("div",X,[(0,d._)("select",{onChange:function(t){n.月請購=t.target.value,e.rowUserInput(n,o)},style:{width:"7ch"},class:"col col-auto form-select form-select-lg ps-2 p-0 m-0",id:"month"+n.id,name:"month"+o},[(0,d._)("option",V,(0,d.zw)(e.$t("basicInfoLang.yes")),1),(0,d._)("option",K,(0,d.zw)(e.$t("basicInfoLang.no")),1)],40,Z)])):((0,d.wg)(),(0,d.iD)("div",W,[(0,d._)("select",{onChange:function(t){n.月請購=t.target.value,e.rowUserInput(n,o)},style:{width:"7ch"},class:"col col-auto form-select form-select-lg ps-2 p-0 m-0",id:"month"+n.id,name:"month"+o},[(0,d._)("option",te,(0,d.zw)(e.$t("basicInfoLang.yes")),1),(0,d._)("option",ne,(0,d.zw)(e.$t("basicInfoLang.no")),1)],40,ee)]))]})),安全庫存:(0,d.w5)((function(t){var n=t.row,o=t.key;return["否"===n.月請購?((0,d.wg)(),(0,d.iD)("div",oe,[(0,d._)("input",{onChange:function(t){return e.rowUserInput(n,o)},class:(0,d.C_)([{"is-invalid":null===n.安全庫存},"form-control text-center p-0 m-0"]),style:{width:"8ch"},type:"number",id:"safe"+n.id,name:"safe"+o,value:n.安全庫存},null,42,ae)])):((0,d.wg)(),(0,d.iD)("div",re,(0,d.zw)(e.$t("basicInfoLang.differ_by_client")),1))]})),_:1},8,["messages","columns","rows","total","page-options","sortable","onDoSearch","onReturnCheckedRows","onRowInput"]),ie,(0,d._)("div",le,[(0,d._)("div",se,[(0,d._)("button",{type:"submit",id:"change",name:"change",class:"col col-auto fs-3 text-center btn btn-lg btn-info",onClick:t[4]||(t[4]=function(){return e.onSendToDBClick&&e.onSendToDBClick.apply(e,arguments)})},[ce,(0,d.Uk)(" "+(0,d.zw)(e.$t("basicInfoLang.change")),1)])])])],64)}],["__scopeId","data-v-79889ab7"]]);var jt=function(e){return(0,d.dD)("data-v-ec460f3a"),e=e(),(0,d.Cn)(),e},Mt={class:"card"},Nt={class:"card-header"},Bt={class:"card-body"},Dt={class:"row justify-content-center mb-3"},Ft={class:"col col-auto"},Ut=["href"],qt=jt((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Gt={class:"col col-auto form-label"},zt=jt((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Ht={class:"col col-auto"},Jt={key:0,class:"invalid-feedback d-block",role:"alert"},Yt=jt((function(){return(0,d._)("div",{class:"w-100",style:{height:"2ch"}},null,-1)})),Qt={class:"row justify-content-center"},Xt=jt((function(){return(0,d._)("button",{id:"togglebtn",class:"btn btn-primary col col-auto",type:"button","data-bs-toggle":"collapse","data-bs-target":"#importedtable","aria-expanded":"false","aria-controls":"importedtable",style:{display:"none"}},null,-1)})),Zt={class:"card collapse",id:"importedtable"},Vt={class:"card-body"},Kt={class:"row justify-content-between"},Wt={class:"row col col-auto"},en={class:"col col-auto"},tn={for:"pnInput",class:"col-form-label"},nn={class:"col col-6 p-0 m-0"},on=["placeholder"],an=jt((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),rn={key:0,class:"invalid-feedback d-block",role:"alert"},ln=jt((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),sn={class:"row justify-content-center"},cn={class:"col col-auto"},un=jt((function(){return(0,d._)("i",{class:"bi bi-cloud-upload-fill"},null,-1)}));var pn=n(9755);function dn(e){return dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dn(e)}function fn(){fn=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==dn(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function gn(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function hn(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){gn(r,o,a,i,l,"next",e)}function l(e){gn(r,o,a,i,l,"throw",e)}i(void 0)}))}}const mn=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=(0,d.iH)(window.location.origin+"/download/MaterialExample.xlsx"),t=(0,A.FN)(),n=document.getElementsByTagName("HTML")[0].getAttribute("lang");t.appContext.config.globalProperties.$lang.setLocale(n);var o,a=kt(),r=a.mats,i=a.queryResult,l=a.uploadToDB,s=a.getDispatchers,c=(0,d.iH)(!1),u=(0,d.iH)(!1),p=(0,d.iH)(""),f=(0,d.iH)(!1),g=[],h=(0,d.iH)(),m=function(e){for(var t=e.slice().sort(),n=[],o=0;o<t.length-1;o++)t[o+1]==t[o]&&n.push(t[o]);return n},b=function(){var e=hn(fn().mark((function e(){var n;return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.value=!1,r.value="",e.next=4,w();case 4:h.value?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==h.value.type||"application/vnd.ms-excel"==h.value.type||"application/vnd.ms-excel"==h.value.type||".csv"==h.value.type?((n=new FileReader).onload=function(){var e=hn(fn().mark((function e(n){var a,r,i,l,u,d;return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.target.result,r=ue.ij(a,{type:"binary"}),i=r.SheetNames[0],l=r.Sheets[i],void 0!==(o=ue.P6.sheet_to_json(l,{header:1}))&&void 0!==o[0]&&void 0!==o[0][0]&&void 0!==o[0][1]&&void 0!==o[0][2]){e.next=10;break}c.value=!0,p.value=t.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors"),e.next=21;break;case 10:if("料號"===o[0][0].trim()&&"品名"===o[0][1].trim()&&"規格"===o[0][2].trim()){e.next=15;break}c.value=!0,p.value=t.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors"),e.next=21;break;case 15:for(u=Array(),d=1;d<o.length;d++)null!=o[d][0]&&o[d].length>2&&""!=o[d][0].trim()&&null!=o[d][0].trim()?u.push(o[d][0].trim()):(o.splice(d,1),d-=1);return e.next=19,w();case 19:return e.next=21,s();case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.readAsBinaryString(h.value)):(c.value=!0,p.value=t.appContext.config.globalProperties.$t("validation.mimetypes")):(c.value=!0,p.value=t.appContext.config.globalProperties.$t("validation.required")),h.value=null,document.getElementById("excel_input").value="",pn("body").loadingModal("hide"),pn("body").loadingModal("destroy");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=(0,d.iH)(""),y=(0,d.qj)([]),w=function(){var e=hn(fn().mark((function e(){return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pn("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=hn(fn().mark((function e(){var n,o,a,r,i,s,c,d,g,h,b,v,x,_,C,L,k,P,S,I,A,E,$;return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:if(u.value=!1,n=0,o=!1,!(y.length<=0)){e.next=10;break}return notyf.open({type:"warning",message:t.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),pn("body").loadingModal("hide"),pn("body").loadingModal("destroy"),e.abrupt("return");case 10:for(a=Array(),r=0;r<y.length;r++)null!=y[r].料號&&""!=y[r].料號.trim()&&a.push(y[r].料號.toString().trim());if(!((i=m(a)).length>0)){e.next=20;break}return u.value=!0,p.value=t.appContext.config.globalProperties.$t("monthlyPRpageLang.repeated_isn")+" : "+i[0],notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),pn("body").loadingModal("hide"),pn("body").loadingModal("destroy"),e.abrupt("return");case 20:if(document.getElementsByClassName("text-danger").length>0&&(s=document.getElementsByClassName("text-danger")[0].parentNode.childNodes[0].getAttribute("id"),n=s.replace(/[^0-9]/g,""),o=!0,console.log(s,n)),!o){e.next=28;break}return u.value=!0,p.value="Excel "+t.appContext.config.globalProperties.$t("barcodeGenerator.temp_save_error")+" "+t.appContext.config.globalProperties.$t("inboundpageLang.row")+" "+n+" ("+document.getElementById("number"+n).value+") ",notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),pn("body").loadingModal("hide"),pn("body").loadingModal("destroy"),e.abrupt("return");case 28:for(c=[],d=[],g=[],h=[],b=[],v=[],x=[],_=[],C=[],L=[],k=[],P=[],S=[],I=0;I<y.length;I++)c.push(y[I].料號),d.push(y[I].品名),g.push(y[I].規格),h.push(y[I].單價),b.push(y[I].幣別),v.push(y[I].單位),x.push(y[I].MPQ),_.push(y[I].MOQ),C.push(y[I].LT),"是"===y[I].A級資材.trim()||"yes"===y[I].A級資材.trim().toLowerCase()?L.push("是"):L.push("否"),"是"===y[I].月請購.trim()||"yes"===y[I].月請購.trim().toLowerCase()?k.push("是"):k.push("否"),P.push(y[I].發料部門),"是"===y[I].月請購.trim()||"yes"===y[I].月請購.trim().toLowerCase()?S.push("null"):S.push(y[I].安全庫存);return A=Date.now(),e.next=45,l(c,d,g,h,v,b,x,_,C,L,k,P,S);case 45:E=e.sent,$=Date.now()-A,console.log("Total time taken : "+$+" milliseconds"),pn("body").loadingModal("hide"),pn("body").loadingModal("destroy"),"success"===E?(f.value=!1,notyf.open({type:"success",message:t.appContext.config.globalProperties.$t("inboundpageLang.change")+" "+t.appContext.config.globalProperties.$t("inboundpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}})):notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});case 51:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,A.YP)(i,hn(fn().mark((function e(){var t,n,a;return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:if(""!==i.value&&null!=i.value&&void 0!==JSON.parse(i.value).data){e.next=6;break}return pn("body").loadingModal("hide"),pn("body").loadingModal("destroy"),e.abrupt("return");case 6:for(t=0;t<JSON.parse(i.value).data.length;t++)g.push(JSON.parse(i.value).data[t].發料部門);for(n={},a=1;a<o.length;a++)void 0!==o[a][0]&&void 0!==o[a][1]&&void 0!==o[a][2]&&void 0!==o[a][3]&&void 0!==o[a][4]&&void 0!==o[a][5]&&void 0!==o[a][6]&&void 0!==o[a][7]&&void 0!==o[a][8]&&void 0!==o[a][9]&&void 0!==o[a][10]&&void 0!==o[a][11]&&(n.料號=o[a][0].toString().trim(),n.品名=o[a][1].toString().trim(),n.規格=o[a][2].toString().trim(),n.單價=parseFloat(o[a][3]),n.幣別=o[a][4].toString().trim(),n.單位=o[a][5].toString().trim(),n.MPQ=parseInt(o[a][6]),n.MOQ=parseInt(o[a][7]),n.LT=parseFloat(o[a][8]),n.月請購=o[a][9].toString().trim(),n.A級資材=o[a][10].toString().trim(),n.發料部門=o[a][11].toString().trim(),n.安全庫存=parseInt(o[a][12]),g.includes(n.發料部門)?n.dispatcherError=!1:n.dispatcherError=!0,n.id=a+1,y.push(n),n={});pn("#importedtable").hasClass("show")||pn("#togglebtn").click(),f.value=!0,pn("body").loadingModal("hide"),pn("body").loadingModal("destroy"),_.isLoading=!1;case 14:case"end":return e.stop()}}),e)})))),(0,A.YP)(y,(function(){document.getElementsByClassName("vtl-table")[0].scrollIntoView({behavior:"smooth"})}));var _=(0,d.qj)({isLoading:!0,columns:[{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return""===e.料號||null===e.料號?'<input type="hidden" id="number'+e.id+'" name="number'+t+'" value=""><div class="text-nowrap text-danger CustomScrollbar" style="overflow-x: auto; width: 100%;">Missing</div>':'<input type="hidden" id="number'+e.id+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.pName"),field:"品名",width:"13ch",sortable:!0,display:function(e,t){return""===e.品名||null===e.品名?'<input type="hidden" id="name'+e.id+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap text-danger CustomScrollbar" style="overflow-x: auto; width: 100%;">Missing</div>':'<input type="hidden" id="name'+e.id+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.format"),field:"規格",width:"13ch",sortable:!0,display:function(e,t){return""===e.規格||null===e.規格?'<input type="hidden" id="format'+e.id+'" name="format'+t+'" value="'+e.規格+'"><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">Missing</div>':'<input type="hidden" id="format'+e.id+'" name="format'+t+'" value="'+e.規格+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.price"),field:"單價",width:"13ch",sortable:!0,display:function(e,t){return Number.isNaN(e.單價)?'<input type="hidden" id="price'+e.id+'" name="price'+t+'" value=""><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+parseFloat(e.單價)+"</div>":'<input type="hidden" id="price'+e.id+'" name="price'+t+'" value="'+parseFloat(e.單價)+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+parseFloat(e.單價)+"</div>"}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.money"),field:"幣別",width:"10ch",sortable:!0,display:function(e,t){var n=!1,o="";return o+='<input type="hidden" id="money'+e.id+'" name="money'+t,["RMB","USD","JPY","TWD","VND","IDR"].forEach((function(t){e.幣別.toString().trim().toLowerCase()===t.toLowerCase()&&(o+='" value="'+t+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+t+"</div>",n=!0)})),n||(o+='" value=""><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+e.幣別+"</div>"),o}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.unit"),field:"單位",width:"8ch",sortable:!0,display:function(e,t){return""===e.單位||null===e.單位?'<input type="hidden" id="unit'+e.id+'" name="unit'+t+'" value=""><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">Missing</div>':'<input type="hidden" id="unit'+e.id+'" name="unit'+t+'" value="'+e.單位+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.單位+"</div>"}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.mpq"),field:"MPQ",width:"8ch",sortable:!0,display:function(e,t){return Number.isNaN(e.MPQ)?'<input type="hidden" id="mpq'+e.id+'" name="mpq'+t+'" value=""><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+e.MPQ+" <small>"+e.單位+"</small></div>":'<input type="hidden" id="mpq'+e.id+'" name="mpq'+t+'" value="'+e.MPQ+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.MPQ+" <small>"+e.單位+"</small></div>"}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.moq"),field:"MOQ",width:"8ch",sortable:!0,display:function(e,t){return Number.isNaN(e.MOQ)?'<input type="hidden" id="moq'+e.id+'" name="moq'+t+'" value=""><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+e.MOQ+" <small>"+e.單位+"</small></div>":'<input type="hidden" id="moq'+e.id+'" name="moq'+t+'" value="'+e.MOQ+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.MOQ+" <small>"+e.單位+"</small></div>"}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.lt"),field:"LT",width:"8ch",sortable:!0,display:function(e,t){return Number.isNaN(e.LT)?'<input type="hidden" id="lt'+e.id+'" name="lt'+t+'" value=""><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+e.LT+"</div>":'<input type="hidden" id="lt'+e.id+'" name="lt'+t+'" value="'+e.LT+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.LT+"</div>"}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.month"),field:"月請購",width:"10ch",sortable:!0,display:function(e,n){return"是"===e.月請購.trim()||"yes"===e.月請購.trim().toLowerCase()?'<input type="hidden" id="monthly'+e.id+'" name="monthly'+n+'" value="是"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+t.appContext.config.globalProperties.$t("basicInfoLang.yes")+"</div>":'<input type="hidden" id="monthly'+e.id+'" name="monthly'+n+'" value="否"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+t.appContext.config.globalProperties.$t("basicInfoLang.no")+"</div>"}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.gradea"),field:"A級資材",width:"7ch",sortable:!0,display:function(e,n){return"是"===e.A級資材.trim()||"yes"===e.A級資材.trim().toLowerCase()?'<input type="hidden" id="gradea'+e.id+'" name="gradea'+n+'" value="是"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+t.appContext.config.globalProperties.$t("basicInfoLang.yes")+"</div>":'<input type="hidden" id="gradea'+e.id+'" name="gradea'+n+'" value="否"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+t.appContext.config.globalProperties.$t("basicInfoLang.no")+"</div>"}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.senddep"),field:"發料部門",width:"10ch",sortable:!0,display:function(e,t){return e.dispatcherError?""===e.發料部門||null===e.發料部門?'<input type="hidden" id="send'+e.id+'" name="send'+t+'" value=""><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">Missing</div>':'<input type="hidden" id="send'+e.id+'" name="send'+t+'" value=""><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+e.發料部門+"</div>":'<input type="hidden" id="send'+e.id+'" name="send'+t+'" value="'+e.發料部門+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.發料部門+"</div>"}},{label:t.appContext.config.globalProperties.$t("basicInfoLang.safe"),field:"安全庫存",width:"10ch",sortable:!0,display:function(e,n){return"是"===e.月請購.trim()||"yes"===e.月請購.trim().toLowerCase()?'<input type="hidden" id="safe'+e.id+'" name="safe'+n+'" value=""><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+t.appContext.config.globalProperties.$t("basicInfoLang.differ_by_client")+"</div>":Number.isNaN(e.安全庫存)?'<input type="hidden" id="safe'+e.id+'" name="safe'+n+'" value=""><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+e.安全庫存+"</div>":'<input type="hidden" id="safe'+e.id+'" name="safe'+n+'" value="'+e.安全庫存+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.安全庫存+"</div>"}}],rows:(0,d.Fl)((function(){return y.filter((function(e){return e.料號.toLowerCase().includes(v.value.toLowerCase())||e.品名.includes(v.value)}))})),totalRecordCount:(0,d.Fl)((function(){return _.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:t.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+t.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+t.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+t.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:t.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:t.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:t.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{exampleUrl:e,isInvalid:c,isInvalid_DB:u,validation_err_msg:p,uploadToDBReady:f,searchTerm:v,table:_,updateCheckedRows:function(e){},onUploadClick:b,onInputChange:function(e){c.value=!1,y.splice(0),i.value="",h.value=e.target.files?e.target.files[0]:null,pn("#importedtable").hasClass("show")&&pn("#togglebtn").click()},onSendToDBClick:x}}});var bn=n(8677),vn={insert:"head",singleton:!1};bt()(bn.Z,vn);bn.Z.locals;const yn=(0,w.Z)(mn,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",Mt,[(0,d._)("div",Nt,[(0,d._)("h3",null,(0,d.zw)(e.$t("basicInfoLang.upload")),1)]),(0,d._)("div",Bt,[(0,d._)("div",Dt,[(0,d._)("div",Ft,[(0,d._)("a",{href:e.exampleUrl,download:""},(0,d.zw)(e.$t("inboundpageLang.exampleExcel")),9,Ut)]),qt,(0,d._)("label",Gt,(0,d.zw)(e.$t("inboundpageLang.plz_upload")),1),zt,(0,d._)("div",Ht,[(0,d._)("input",{class:(0,d.C_)(["form-control",{"is-invalid":e.isInvalid}]),id:"excel_input",type:"file",name:"select_file",onChange:t[0]||(t[0]=function(){return e.onInputChange&&e.onInputChange.apply(e,arguments)})},null,34),e.isInvalid?((0,d.wg)(),(0,d.iD)("span",Jt,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0)]),Yt,(0,d._)("div",Qt,[(0,d._)("button",{type:"submit",name:"upload",class:"col col-auto btn btn-lg btn-primary",onClick:t[1]||(t[1]=function(){return e.onUploadClick&&e.onUploadClick.apply(e,arguments)})},(0,d.zw)(e.$t("basicInfoLang.upload1")),1)])])])]),Xt,(0,d._)("div",Zt,[(0,d._)("div",Vt,[(0,d._)("div",Kt,[(0,d._)("div",Wt,[(0,d._)("div",en,[(0,d._)("label",tn,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",nn,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.searchTerm=t})},null,8,on),[[d.nr,e.searchTerm]])])])]),an,e.isInvalid_DB?((0,d.wg)(),(0,d.iD)("span",rn,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0),(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!1,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[3]||(t[3]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"]),ln,(0,d._)("div",sn,[(0,d._)("div",cn,[e.uploadToDBReady?((0,d.wg)(),(0,d.iD)("button",{key:0,type:"submit",name:"upload",class:"col col-auto fs-3 text-center btn btn-lg btn-info",onClick:t[4]||(t[4]=function(){return e.onSendToDBClick&&e.onSendToDBClick.apply(e,arguments)})},[un,(0,d.Uk)(" "+(0,d.zw)(e.$t("inboundpageLang.upload1")),1)])):(0,d.kq)("",!0)])])])])],64)}],["__scopeId","data-v-ec460f3a"]]);var wn=function(e){return(0,d.dD)("data-v-9c9c5594"),e=e(),(0,d.Cn)(),e},xn={class:"row justify-content-between"},_n={class:"row col col-auto"},Cn={class:"col col-auto"},Ln={for:"pnInput",class:"col-form-label"},kn={class:"col col-6 p-0 m-0"},Pn=["placeholder"],Sn={class:"col col-auto"},In=[wn((function(){return(0,d._)("i",{class:"bi bi-trash3-fill fs-4"},null,-1)}))],An=["value"],En=[wn((function(){return(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill fs-4"},null,-1)}))],$n=wn((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Rn={class:"invalid-feedback d-block",role:"alert"};function On(e){return On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},On(e)}function Tn(){Tn=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==On(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function jn(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Mn(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){jn(r,o,a,i,l,"next",e)}function l(e){jn(r,o,a,i,l,"throw",e)}i(void 0)}))}}var Nn=n(9755);function Bn(e){return Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bn(e)}function Dn(){Dn=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==Bn(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Fn(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}const Un=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=function(){var e=(0,d.iH)(""),t=((0,m.tv)(),function(){var t=Mn(Tn().mark((function t(){var n,o,a,r,i,l,s,c;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$().post("/getCurrentDB");case 2:return n=t.sent,o=sessionStorage.getItem("inboundclient"),a=sessionStorage.getItem("inboundisn"),r=sessionStorage.getItem("inboundlist"),i=sessionStorage.getItem("inboundcheck"),l=sessionStorage.getItem("inboundbegin"),s=sessionStorage.getItem("inboundend"),t.prev=9,t.next=12,$().post("/api/inbound/search",{DB:n.data,inboundclient:o,inboundisn:a,inboundlist:r,inboundcheck:i,inboundbegin:l,inboundend:s});case 12:c=t.sent,e.value=JSON.stringify(c.data),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(9),console.log(t.t0);case 19:case"end":return t.stop()}}),t,null,[[9,16]])})));return function(){return t.apply(this,arguments)}}()),n=function(){var e=Mn(Tn().mark((function e(t){var n;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$().post("/getCurrentDB");case 2:return n=e.sent,e.prev=3,e.next=6,$().post("/api/inbound/delete",{DB:n.data,list:JSON.stringify(t.list),isn:JSON.stringify(t.isn),amount:JSON.stringify(t.amount),position:JSON.stringify(t.position),inpeople:JSON.stringify(t.inpeople),inreason:JSON.stringify(t.inreason),inboundtime:JSON.stringify(t.intime)});case 6:return e.sent,e.abrupt("return",new Promise((function(e,t){e("success")})));case 10:return e.prev=10,e.t0=e.catch(3),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}();return{mats:e,getMats:t,deleteRows:n}}(),t=e.mats,n=e.getMats,o=e.deleteRows;(0,A.wF)(n);var a=(0,d.iH)(""),r=(0,A.FN)(),i=document.getElementsByTagName("HTML")[0].getAttribute("lang");r.appContext.config.globalProperties.$lang.setLocale(i);var l=[],s=function(){var e,t=(e=Dn().mark((function e(){var t,n,a,i;return Dn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Nn("body").loadingModal({text:"Loading...",animation:"circle"}),t={list:[],isn:[],amount:[],position:[],inpeople:[],inreason:[],intime:[]},!(void 0!==l&&l.length>0)){e.next=8;break}return l.forEach((function(e){t.list.push(e.入庫單號),t.isn.push(e.料號),t.amount.push(e.入庫數量),t.position.push(e.儲位),t.inpeople.push(e.入庫人員),t.inreason.push(e.入庫原因),t.intime.push(e.入庫時間)})),e.next=6,o(t);case 6:"success"===(n=e.sent)?(notyf.open({type:"success",message:r.appContext.config.globalProperties.$t("inboundpageLang.change")+" "+r.appContext.config.globalProperties.$t("inboundpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),t.intime.forEach((function(e){var t=l.findIndex((function(t){return t.入庫時間===e.replace("inboundtime","")}));-1!=t&&c.splice(t,1)})),document.getElementsByClassName("vtl-tbody-checkbox").forEach((function(e){e.checked&&e.click()})),l=[]):(console.log(n.response.data),420===n.response.status?(a=r.appContext.config.globalProperties.$t("inboundpageLang.lessstock"),notyf.open({type:"warning",message:a,duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),n.response.data.success_list.forEach((function(e){var t=c.findIndex((function(t){return parseInt(t.id)===parseInt(e[3].replace("inboundtime",""))}));-1!=t&&c.splice(t,1)}))):421===n.response.status&&(i=n.response.data.message,alert(i)));case 8:Nn("body").loadingModal("hide"),Nn("body").loadingModal("destroy");case 10:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Fn(r,o,a,i,l,"next",e)}function l(e){Fn(r,o,a,i,l,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}(),c=(0,d.qj)([]);(0,A.YP)(t,(function(){for(var e=JSON.parse(t.value),n=0;n<e.datas.length;n++)e.datas[n].id=n,c.push(e.datas[n]);u.isLoading=!1}));var u=(0,d.qj)({isLoading:!0,columns:[{label:r.appContext.config.globalProperties.$t("inboundpageLang.inlist"),field:"入庫單號",width:"14ch",sortable:!0,iskey:!0,display:function(e,t){return'<input type="hidden" id="inboundlist'+t+'" name="inboundlist'+t+'" value="'+e.入庫單號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.入庫單號+"</div>"}},{label:r.appContext.config.globalProperties.$t("inboundpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return null===e.單位?'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-danger text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>":'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:r.appContext.config.globalProperties.$t("inboundpageLang.inboundnum"),field:"入庫數量",width:"14ch",sortable:!0,display:function(e,t){return null===e.單位?'<input type="hidden" id="inboundnum'+t+'" name="inboundnum'+t+'" value="'+e.入庫數量+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.入庫數量+' <small class="text-danger">'+r.appContext.config.globalProperties.$t("inboundpageLang.no_basic")+"</small></div>":'<input type="hidden" id="inboundnum'+t+'" name="inboundnum'+t+'" value="'+e.入庫數量+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.入庫數量+" <small>"+e.單位+"</small></div>"}},{label:r.appContext.config.globalProperties.$t("inboundpageLang.loc"),field:"儲位",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="position'+t+'" name="position'+t+'" value="'+e.儲位+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.儲位+"</div>"}},{label:r.appContext.config.globalProperties.$t("inboundpageLang.inpeople"),field:"入庫人員",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="inboundpeople'+t+'" name="inboundpeople'+t+'" value="'+e.入庫人員+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.入庫人員+"</div>"}},{label:r.appContext.config.globalProperties.$t("inboundpageLang.inreason"),field:"入庫原因",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="inboundreason'+t+'" name="inboundreason'+t+'" value="'+e.入庫原因+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.入庫原因+"</div>"}},{label:r.appContext.config.globalProperties.$t("inboundpageLang.inboundtime"),field:"入庫時間",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="inboundtime'+e.id+'" name="inboundtime'+t+'" value="'+e.入庫時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.入庫時間+"</div>"}},{label:r.appContext.config.globalProperties.$t("inboundpageLang.mark"),field:"備註",width:"10ch",sortable:!0,display:function(e,t){return null===e.備註&&(e.備註=""),'<input type="hidden" id="remark'+t+'" name="remark'+t+'" value="'+e.備註+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.備註+"</div>"}}],rows:(0,d.Fl)((function(){return c.filter((function(e){return e.料號.toLowerCase().includes(a.value.toLowerCase())}))})),totalRecordCount:(0,d.Fl)((function(){return u.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:r.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+r.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+r.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+r.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:r.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:r.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:r.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:a,table:u,updateCheckedRows:function(e){console.log(e),l=e},DeleteRowsClick:s,OutputExcelClick:function(){Nn("body").loadingModal({text:"Loading...",animation:"circle"});var e=new Date,t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();e=o+"_"+n+"_"+t;for(var a=Array(),i=0;i<c.length;i++){var l=new Object;l.入庫單號=c[i].入庫單號,l.料號=c[i].料號,l.入庫數量=c[i].入庫數量,l.儲位=c[i].儲位,l.入庫人員=c[i].入庫人員,l.入庫原因=c[i].入庫原因,l.入庫時間=c[i].入庫時間,l.備註=c[i].備註,a.push(l)}var s=ue.P6.json_to_sheet(a),u=ue.P6.book_new();ue.P6.book_append_sheet(u,s,r.appContext.config.globalProperties.$t("inboundpageLang.inlist")),ue.NC(u,r.appContext.config.globalProperties.$t("inboundpageLang.inlist")+"_"+e+".xlsx",{compression:!0}),Nn("body").loadingModal("hide"),Nn("body").loadingModal("destroy")}}}});var qn=n(4896),Gn={insert:"head",singleton:!1};bt()(qn.Z,Gn);qn.Z.locals;const zn=(0,w.Z)(Un,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",xn,[(0,d._)("div",_n,[(0,d._)("div",Cn,[(0,d._)("label",Ln,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",kn,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("basicInfoLang.enterisn"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,Pn),[[d.nr,e.searchTerm]])])]),(0,d._)("div",Sn,[(0,d._)("button",{type:"submit",id:"delete",name:"delete",class:"col col-auto btn btn-lg btn-danger",onClick:t[1]||(t[1]=function(){return e.DeleteRowsClick&&e.DeleteRowsClick.apply(e,arguments)})},In),(0,d.Uk)("   "),(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("inboundpageLang.download"),onClick:t[2]||(t[2]=function(){return e.OutputExcelClick&&e.OutputExcelClick.apply(e,arguments)})},En,8,An)])]),$n,(0,d._)("span",Rn,[(0,d._)("strong",null,(0,d.zw)(e.$t("inboundpageLang.no_basic_are_highlighted")),1)]),(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!0,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[3]||(t[3]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])],64)}],["__scopeId","data-v-9c9c5594"]]);var Hn=function(e){return(0,d.dD)("data-v-b0a09f1e"),e=e(),(0,d.Cn)(),e},Jn={class:"row justify-content-between"},Yn={class:"row col col-auto"},Qn={class:"col col-auto"},Xn={for:"pnInput",class:"col-form-label"},Zn={class:"col col-6 p-0 m-0"},Vn=["placeholder"],Kn={class:"col col-auto"},Wn=["value"],eo=[Hn((function(){return(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill"},null,-1)}))],to=Hn((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)}));function no(e){return no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},no(e)}function oo(){oo=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==no(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function ao(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function ro(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){ao(r,o,a,i,l,"next",e)}function l(e){ao(r,o,a,i,l,"throw",e)}i(void 0)}))}}function io(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=((0,m.tv)(),function(){var n=ro(oo().mark((function n(){var o,a,r,i,l,s,c,u,p;return oo().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.value="",n.next=3,$().post("/getCurrentDB");case 3:return o=n.sent,a=sessionStorage.getItem("inboundstockclient"),r=sessionStorage.getItem("inboundstockisn"),i=sessionStorage.getItem("inboundstockloc"),l=sessionStorage.getItem("inboundstocksend"),s=sessionStorage.getItem("inboundstockmonth"),c=sessionStorage.getItem("inboundstocknogood"),n.prev=10,n.next=13,$().post("/api/inbound/searchstock",{DB:o.data,inboundclient:a,inboundisn:r,inboundloc:i,inboundsend:l,inboundmonth:s,inboundnogood:c});case 13:u=n.sent,e.value=JSON.stringify(u.data),n.next=22;break;case 17:for(p in n.prev=17,n.t0=n.catch(10),console.log(n.t0),n.t0.response.data.errors)t.value+=n.t0.response.data.errors[p][0]+"  ";console.log(t.value);case 22:case"end":return n.stop()}}),n,null,[[10,17]])})));return function(){return n.apply(this,arguments)}}()),o=function(){var n=ro(oo().mark((function n(o,a){var r,i;return oo().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.value="",n.next=3,$().post("/getCurrentDB");case 3:return r=n.sent,n.prev=4,n.next=7,$().post("/api/inbound/getExistingStock",{DB:r.data,isnArray:JSON.stringify(o),locArray:JSON.stringify(a)});case 7:return i=n.sent,e.value=JSON.stringify(i.data),n.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return n.prev=12,n.t0=n.catch(4),console.log(n.t0),n.abrupt("return",n.t0);case 16:case"end":return n.stop()}}),n,null,[[4,12]])})));return function(e,t){return n.apply(this,arguments)}}(),a=function(){var e=ro(oo().mark((function e(n,o,a){var r,i,l;return oo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.value="",e.next=3,$().post("/getCurrentDB");case 3:return r=e.sent,e.next=6,$().post("/getCurrentUsername");case 6:return i=e.sent,l=i.data+"_"+Date.now(),e.prev=8,e.next=11,$().post("/api/inbound/uploadToDB",{DB:r.data,User:i.data,newStock:JSON.stringify(n),inboundCount:JSON.stringify(o),newInTransit:JSON.stringify(a),serialNum:JSON.stringify(l)});case 11:return e.sent,e.abrupt("return",new Promise((function(e,t){e("success")})));case 15:return e.prev=15,e.t0=e.catch(8),console.log(e.t0),e.abrupt("return",e.t0);case 19:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(t,n,o){return e.apply(this,arguments)}}();return{mats:e,getMats:n,getExistingStock:o,uploadToDB:a}}var lo=n(9755);const so=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=io(),t=e.mats,n=e.getMats;(0,A.wF)(n);var o=(0,d.iH)(""),a=(0,A.FN)(),r=document.getElementsByTagName("HTML")[0].getAttribute("lang");a.appContext.config.globalProperties.$lang.setLocale(r);var i=(0,d.qj)([]);(0,A.YP)(t,(function(){for(var e=JSON.parse(t.value),n=0;n<e.datas.length;n++)i.push(e.datas[n]);l.isLoading=!1}));var l=(0,d.qj)({isLoading:!0,columns:[{label:a.appContext.config.globalProperties.$t("inboundpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="isn'+t+'" name="isn'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:a.appContext.config.globalProperties.$t("inboundpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:a.appContext.config.globalProperties.$t("inboundpageLang.format"),field:"規格",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:a.appContext.config.globalProperties.$t("inboundpageLang.stock"),field:"庫存",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="stock'+t+'" name="stock'+t+'" value="'+e.現有庫存+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.現有庫存+"&nbsp;<small>"+e.單位+"</small></div>"}},{label:a.appContext.config.globalProperties.$t("inboundpageLang.loc"),field:"儲位",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="loc'+t+'" name="loc'+t+'" value="'+e.儲位+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.儲位+"</div>"}},{label:a.appContext.config.globalProperties.$t("basicInfoLang.month"),field:"月請購",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="month'+t+'" name="month'+t+'" value="'+e.月請購+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.月請購+"</div>"}},{label:a.appContext.config.globalProperties.$t("inboundpageLang.safe"),field:"安全庫存",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="safe'+t+'" name="safe'+t+'" value="'+e.安全庫存+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.安全庫存+"&nbsp;<small>"+e.單位+"</small></div>"}},{label:a.appContext.config.globalProperties.$t("basicInfoLang.price"),field:"單價",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="price'+t+'" name="price'+t+'" value="'+e.單價+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.單價+"</div>"}},{label:a.appContext.config.globalProperties.$t("basicInfoLang.money"),field:"幣別",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="money'+t+'" name="money'+t+'" value="'+e.幣別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.幣別+"</div>"}},{label:a.appContext.config.globalProperties.$t("inboundpageLang.days"),field:"呆滯天數",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="days'+t+'" name="days'+t+'" value="'+e.呆滯天數+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.呆滯天數+"</div>"}}],rows:(0,d.Fl)((function(){return i.filter((function(e){return e.料號.toLowerCase().includes(o.value.toLowerCase())||e.品名.includes(o.value)}))})),totalRecordCount:(0,d.Fl)((function(){return l.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:a.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+a.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+a.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+a.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:a.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:a.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:a.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:o,table:l,updateCheckedRows:function(e){console.log(e)},OutputExcelClick:function(){lo("body").loadingModal({text:"Loading...",animation:"circle"});var e=new Date,t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();e=o+"_"+n+"_"+t;for(var r=Array(),l=0;l<i.length;l++){var s=new Object;s.料號=i[l].料號,s.品名=i[l].品名,s.規格=i[l].規格,s.現有庫存=i[l].現有庫存,s.單位=i[l].單位,s.儲位=i[l].儲位,s.月請購=i[l].月請購,s.安全庫存=i[l].安全庫存,s.單價=i[l].單價,s.幣別=i[l].幣別,s.呆滯天數=i[l].呆滯天數,r.push(s)}var c=ue.P6.json_to_sheet(r),u=ue.P6.book_new();ue.P6.book_append_sheet(u,c,a.appContext.config.globalProperties.$t("inboundpageLang.stock")),ue.NC(u,a.appContext.config.globalProperties.$t("inboundpageLang.stock")+"_"+e+".xlsx",{compression:!0}),lo("body").loadingModal("hide"),lo("body").loadingModal("destroy")}}}});var co=n(3479),uo={insert:"head",singleton:!1};bt()(co.Z,uo);co.Z.locals;const po=(0,w.Z)(so,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",Jn,[(0,d._)("div",Yn,[(0,d._)("div",Qn,[(0,d._)("label",Xn,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",Zn,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,Vn),[[d.nr,e.searchTerm]])])]),(0,d._)("div",Kn,[(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("inboundpageLang.download"),onClick:t[1]||(t[1]=function(){return e.OutputExcelClick&&e.OutputExcelClick.apply(e,arguments)})},eo,8,Wn)])]),to,(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!1,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[2]||(t[2]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])],64)}],["__scopeId","data-v-b0a09f1e"]]);var fo=function(e){return(0,d.dD)("data-v-79e2d760"),e=e(),(0,d.Cn)(),e},go={class:"row justify-content-between"},ho={class:"row col col-auto"},mo={class:"col col-auto"},bo={for:"pnInput",class:"col-form-label"},vo={class:"col col-6 p-0 m-0"},yo=["placeholder"],wo={class:"col col-auto"},xo=["value"],_o=[fo((function(){return(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill"},null,-1)}))],Co=fo((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)}));var Lo=n(9755);const ko=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=io(),t=e.mats,n=e.getMats;(0,A.wF)(n);var o=(0,d.iH)(""),a=(0,A.FN)(),r=document.getElementsByTagName("HTML")[0].getAttribute("lang");a.appContext.config.globalProperties.$lang.setLocale(r);var i=(0,d.qj)([]);(0,A.YP)(t,(function(){console.log(JSON.parse(t.value));for(var e=JSON.parse(t.value),n=0;n<e.datas.length;n++)i.push(e.datas[n]);l.isLoading=!1}));var l=(0,d.qj)({isLoading:!0,columns:[{label:a.appContext.config.globalProperties.$t("inboundpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="isn'+t+'" name="isn'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:a.appContext.config.globalProperties.$t("inboundpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:a.appContext.config.globalProperties.$t("inboundpageLang.format"),field:"規格",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:a.appContext.config.globalProperties.$t("inboundpageLang.nowstock"),field:"現有庫存",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="stock'+t+'" name="stock'+t+'" value="'+e.現有庫存+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.現有庫存+"&nbsp;<small>"+e.單位+"</small></div>"}},{label:a.appContext.config.globalProperties.$t("inboundpageLang.monthuse"),field:"月使用量",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="monthuse'+t+'" name="monthuse'+t+'" value="'+e.月使用量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.月使用量+"&nbsp;<small>"+e.單位+"</small></div>"}},{label:a.appContext.config.globalProperties.$t("inboundpageLang.stockmonth"),field:"庫存使用月數",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="monthstock'+t+'" name="monthstock'+t+'" value="'+e.庫存使用月數+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.庫存使用月數+"</div>"}},{label:a.appContext.config.globalProperties.$t("basicInfoLang.price"),field:"單價",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="price'+t+'" name="price'+t+'" value="'+e.單價+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.單價+"</div>"}},{label:a.appContext.config.globalProperties.$t("basicInfoLang.money"),field:"幣別",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="money'+t+'" name="money'+t+'" value="'+e.幣別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.幣別+"</div>"}},{label:a.appContext.config.globalProperties.$t("basicInfoLang.month"),field:"月請購",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="month'+t+'" name="month'+t+'" value="'+e.月請購+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.月請購+"</div>"}}],rows:(0,d.Fl)((function(){return i.filter((function(e){return e.料號.toLowerCase().includes(o.value.toLowerCase())||e.品名.includes(o.value)}))})),totalRecordCount:(0,d.Fl)((function(){return l.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:a.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+a.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+a.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+a.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:a.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:a.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:a.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:o,table:l,updateCheckedRows:function(e){console.log(e)},OutputExcelClick:function(){Lo("body").loadingModal({text:"Loading...",animation:"circle"});var e=new Date,t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();e=o+"_"+n+"_"+t;for(var r=Array(),l=0;l<i.length;l++){var s=new Object;s.料號=i[l].料號,s.品名=i[l].品名,s.規格=i[l].規格,s.現有庫存=i[l].現有庫存,s.單位=i[l].單位,s.月使用量=i[l].月使用量,s.庫存使用月數=i[l].庫存使用月數,s.單價=i[l].單價,s.幣別=i[l].幣別,s.月請購=i[l].月請購,r.push(s)}var c=ue.P6.json_to_sheet(r),u=ue.P6.book_new();ue.P6.book_append_sheet(u,c,a.appContext.config.globalProperties.$t("inboundpageLang.stockmonth")),ue.NC(u,a.appContext.config.globalProperties.$t("inboundpageLang.stockmonth")+"_"+e+".xlsx",{compression:!0}),Lo("body").loadingModal("hide"),Lo("body").loadingModal("destroy")}}}});var Po=n(4823),So={insert:"head",singleton:!1};bt()(Po.Z,So);Po.Z.locals;const Io=(0,w.Z)(ko,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",go,[(0,d._)("div",ho,[(0,d._)("div",mo,[(0,d._)("label",bo,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",vo,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,yo),[[d.nr,e.searchTerm]])])]),(0,d._)("div",wo,[(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("inboundpageLang.download"),onClick:t[1]||(t[1]=function(){return e.OutputExcelClick&&e.OutputExcelClick.apply(e,arguments)})},_o,8,xo)])]),Co,(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!1,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[2]||(t[2]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])],64)}],["__scopeId","data-v-79e2d760"]]);var Ao=function(e){return(0,d.dD)("data-v-a28d14da"),e=e(),(0,d.Cn)(),e},Eo={class:"card"},$o={class:"card-header"},Ro={class:"card-body"},Oo={class:"row justify-content-center mb-3"},To={class:"col col-auto"},jo=["href"],Mo=Ao((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),No={class:"col col-auto form-label"},Bo=Ao((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Do={class:"col col-auto"},Fo={key:0,class:"invalid-feedback d-block",role:"alert"},Uo=Ao((function(){return(0,d._)("div",{class:"w-100",style:{height:"2ch"}},null,-1)})),qo={class:"row justify-content-center"},Go=Ao((function(){return(0,d._)("button",{id:"togglebtn",class:"btn btn-primary col col-auto",type:"button","data-bs-toggle":"collapse","data-bs-target":"#importedtable","aria-expanded":"false","aria-controls":"importedtable",style:{display:"none"}},null,-1)})),zo={class:"card collapse",id:"importedtable"},Ho={class:"card-body"},Jo={class:"row justify-content-between"},Yo={class:"row col col-auto"},Qo={class:"col col-auto"},Xo={for:"pnInput",class:"col-form-label"},Zo={class:"col col-6 p-0 m-0"},Vo=["placeholder"],Ko={class:"col col-auto"},Wo=[Ao((function(){return(0,d._)("i",{class:"bi bi-trash3-fill fs-4"},null,-1)}))],ea=Ao((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),ta={key:0,class:"invalid-feedback d-block",role:"alert"},na={class:"col col-auto align-items-center m-0 p-0"},oa=["onClick","id","name"],aa=Ao((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),ra={class:"row justify-content-center"},ia={class:"col col-auto"},la=Ao((function(){return(0,d._)("i",{class:"bi bi-inboxes-fill"},null,-1)})),sa={class:"modal fade",id:"detailTable",tabindex:"-1","aria-labelledby":"detailTable","aria-hidden":"true"},ca={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},ua={class:"modal-content"},pa={class:"modal-header justify-content-center"},da={class:"col col-auto modal-title m-0 p-0 fs-4"},fa=Ao((function(){return(0,d._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)})),ga={class:"modal-body"},ha={class:"row justify-content-between"},ma={class:"row col col-auto"},ba={class:"col col-auto"},va={for:"pnInput",class:"col-form-label"},ya={class:"col col-auto p-0 m-0"},wa=["placeholder"],xa={class:"col col-auto"},_a=["value"],Ca=[Ao((function(){return(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill fs-4"},null,-1)}))],La=Ao((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),ka={key:0,class:"modal-footer justify-content-between"};function Pa(e){return Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pa(e)}function Sa(){Sa=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==Pa(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Ia(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Aa(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Ia(r,o,a,i,l,"next",e)}function l(e){Ia(r,o,a,i,l,"throw",e)}i(void 0)}))}}function Ea(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=((0,m.tv)(),function(){var n=Aa(Sa().mark((function n(){var o,a;return Sa().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.value="",n.next=3,$().post("/getCurrentDB");case 3:return o=n.sent,n.prev=4,n.next=7,$().post("/api/month/getTransit",{DB:o.data});case 7:return a=n.sent,e.value=JSON.stringify(a.data),n.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return n.prev=12,n.t0=n.catch(4),console.log(n.t0),n.abrupt("return",n.t0);case 16:case"end":return n.stop()}}),n,null,[[4,12]])})));return function(){return n.apply(this,arguments)}}()),o=function(){var e=Aa(Sa().mark((function e(n,o,a){var r,i,l;return Sa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.value="",e.next=3,$().post("/getCurrentDB");case 3:return r=e.sent,e.next=6,$().post("/getCurrentUsername");case 6:return i=e.sent,e.prev=7,e.next=10,$().post("/api/month/updateTransit",{DB:r.data,username:i.data,isn:JSON.stringify(n),qty:JSON.stringify(o),descr:JSON.stringify(a)});case 10:return l=e.sent,console.log(l.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 15:return e.prev=15,e.t0=e.catch(7),console.log(e.t0),e.abrupt("return",e.t0);case 19:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t,n,o){return e.apply(this,arguments)}}();return{mats_inTransit:e,getTransit:n,updateInTransit:o}}function $a(e){return $a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$a(e)}function Ra(){Ra=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==$a(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Oa(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Ta(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Oa(r,o,a,i,l,"next",e)}function l(e){Oa(r,o,a,i,l,"throw",e)}i(void 0)}))}}function ja(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=(0,d.iH)(""),o=(0,d.iH)(""),a=((0,m.tv)(),function(){var t=Ta(Ra().mark((function t(o){var a,r;return Ra().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.value="",t.next=3,$().post("/getCurrentDB");case 3:return a=t.sent,t.prev=4,t.next=7,$().post("/api/validateISN",{DB:a.data,isnArray:JSON.stringify(o)});case 7:return r=t.sent,e.value=JSON.stringify(r.data),t.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return t.prev=12,t.t0=t.catch(4),console.log(t.t0),t.abrupt("return",t.t0);case 16:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}()),r=function(){var e=Ta(Ra().mark((function e(t){var a,r;return Ra().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return a=e.sent,e.prev=4,e.next=7,$().post("/api/validateISN",{DB:a.data,isnArray:JSON.stringify(t)});case 7:return r=e.sent,o.value=JSON.stringify(r.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Ta(Ra().mark((function e(){var o,a;return Ra().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return o=e.sent,e.prev=4,e.next=7,$().post("/api/getLocs",{DB:o.data});case 7:return a=e.sent,t.value=JSON.stringify(a.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(){return e.apply(this,arguments)}}();return{queryResult:e,manualResult:o,locations:t,validateISN:a,validateISN_manual:r,getLocs:i}}var Ma=n(9755);function Na(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ba(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==Ba(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ba(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ba(e){return Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ba(e)}function Da(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,r,i,l=[],s=!0,c=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=r.call(n)).done)&&(l.push(o.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Fa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Ua(){Ua=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==Ba(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function qa(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Ga(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){qa(r,o,a,i,l,"next",e)}function l(e){qa(r,o,a,i,l,"throw",e)}i(void 0)}))}}const za=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e,t=(0,d.iH)(window.location.origin+"/download/StockExample.xlsx"),n=(0,A.FN)(),o=document.getElementsByTagName("HTML")[0].getAttribute("lang");n.appContext.config.globalProperties.$lang.setLocale(o);var a=io(),r=a.mats,i=a.uploadToDB,l=a.getExistingStock,s=Ea(),c=s.mats_inTransit,u=s.getTransit,p=ja(),f=p.queryResult,g=p.locations,h=p.validateISN,m=p.getLocs;(0,A.wF)(Ga(Ua().mark((function e(){return Ua().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:return e.next=4,m();case 4:case"end":return e.stop()}}),e)}))));var b,v=(0,d.iH)(!1),y=(0,d.iH)(!1),w=(0,d.iH)(""),x=(0,d.iH)(!1),_=[],C=(0,d.iH)(),L={},k=function(e){for(var t=e.slice().sort(),n=[],o=0;o<t.length-1;o++)t[o+1]==t[o]&&n.push(t[o]);return n},P=function e(t){for(var n={},o=0,a=Object.entries(t);o<a.length;o++){var r=Da(a[o],2),i=r[0],l=r[1];Array.isArray(l)?n[i]=S(l):"object"===Ba(l)?n[i]=e(l):n[i]=l}return n},S=function e(t){var n=[];return t.forEach((function(t){Array.isArray(t)?n.push(e(t)):"object"===Ba(t)?n.push(P(t)):n.push(t)})),n},I=function(){var e=Ga(Ua().mark((function e(){var t;return Ua().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y.value=!1,r.value="",e.next=4,M();case 4:C.value?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==C.value.type||"application/vnd.ms-excel"==C.value.type||"application/vnd.ms-excel"==C.value.type||".csv"==C.value.type?((t=new FileReader).onload=function(){var e=Ga(Ua().mark((function e(t){var o,a,r,i,l,s;return Ua().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.target.result,a=ue.ij(o,{type:"binary"}),r=a.SheetNames[0],i=a.Sheets[r],void 0!==(b=ue.P6.sheet_to_json(i,{header:1}))&&void 0!==b[0]&&void 0!==b[0][0]&&void 0!==b[0][1]&&void 0!==b[0][2]&&void 0!==b[0][3]){e.next=10;break}v.value=!0,w.value=n.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors"),e.next=16;break;case 10:for(l=Array(),s=1;s<b.length;s++)null!=b[s][0]&&b[s].length>2&&""!=b[s][0].toString().trim()&&null!=b[s][0].toString().trim()?l.push(b[s][0].toString().trim()):(b.splice(s,1),s-=1);return e.next=14,M();case 14:return e.next=16,h(l);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.readAsBinaryString(C.value)):(v.value=!0,w.value=n.appContext.config.globalProperties.$t("validation.mimetypes")):(v.value=!0,w.value=n.appContext.config.globalProperties.$t("validation.required")),C.value=null,document.getElementById("excel_input").value="",Ma("body").loadingModal("hide"),Ma("body").loadingModal("destroy");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=(0,d.iH)(""),$=(0,d.iH)(""),R=(0,d.iH)(""),O=(0,d.iH)(!1),T=(0,d.qj)([]),j=(0,d.qj)([]),M=function(){var e=Ga(Ua().mark((function e(){return Ua().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ma("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Ga(Ua().mark((function e(){var t,o,a,s,p,d,g,h,v,_,C,P,I,A,E,$,R,O,j,N;return Ua().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M();case 2:if(y.value=!1,t=[],o=!1,!(T.length<=0)){e.next=10;break}return notyf.open({type:"warning",message:n.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ma("body").loadingModal("hide"),Ma("body").loadingModal("destroy"),e.abrupt("return");case 10:for(a=0;a<T.length;a++)""!==T[a].月請購&&null!==T[a].月請購&&"null"!==T[a].月請購.toLowerCase()||(o=!0,t.push(a));if(!o){e.next=18;break}return y.value=!0,w.value="Excel "+n.appContext.config.globalProperties.$t("inboundpageLang.row")+" "+t.map((function(e){return e+1})).join(", ")+" ("+t.map((function(e){return T[e].料號})).join(", ")+") "+n.appContext.config.globalProperties.$t("inboundpageLang.noisn"),notyf.open({type:"error",message:n.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ma("body").loadingModal("hide"),Ma("body").loadingModal("destroy"),e.abrupt("return");case 18:for(t=[],s=0;s<T.length;s++)B.includes(T[s].新儲位)||(o=!0,t.push(s));if(!o){e.next=27;break}return y.value=!0,w.value="Excel "+n.appContext.config.globalProperties.$t("inboundpageLang.row")+" "+t.map((function(e){return e+1})).join(", ")+" ("+t.map((function(e){return T[e].新儲位})).join(", ")+") "+n.appContext.config.globalProperties.$t("inboundpageLang.noloc"),notyf.open({type:"error",message:n.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ma("body").loadingModal("hide"),Ma("body").loadingModal("destroy"),e.abrupt("return");case 27:for(p=Array(),d=0;d<T.length;d++)null!=T[d].料號&&""!=T[d].料號.trim()&&p.push(T[d].料號.toString().trim()+"_"+T[d].新儲位.toString().trim());if(!((g=k(p)).length>0)){e.next=37;break}return y.value=!0,w.value=n.appContext.config.globalProperties.$t("inboundpageLang.repeated_isn_loc_pair")+" : "+g.map((function(e){return e.split("_")[0]+" ("+e.split("_")[1]+")"})).join(", "),notyf.open({type:"error",message:n.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ma("body").loadingModal("hide"),Ma("body").loadingModal("destroy"),e.abrupt("return");case 37:for(t=[],h=0;h<T.length;h++)v=T[h].料號,_=parseInt(T[h].在途量),L[v]>_&&(o=!0,t.push(h));if(!o){e.next=46;break}return y.value=!0,w.value="Excel "+n.appContext.config.globalProperties.$t("inboundpageLang.row")+" "+t.map((function(e){return e+1})).join(", ")+" ("+t.map((function(e){return T[e].料號})).join(", ")+") "+n.appContext.config.globalProperties.$t("inboundpageLang.inboundnum")+" > "+n.appContext.config.globalProperties.$t("inboundpageLang.transit"),notyf.open({type:"error",message:n.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ma("body").loadingModal("hide"),Ma("body").loadingModal("destroy"),e.abrupt("return");case 46:for(C=Array(),P=Array(),I=1;I<b.length;I++)""!=b[I][0].trim()&&null!=b[I][0].trim()&&(C.push(b[I][0].trim()),P.push(b[I][2].trim()));return A=Date.now(),E=S(b),e.next=53,l(C,P);case 53:if("success"!==(R=e.sent)){e.next=60;break}for(O=function(e){C.push(),P.push(E[e][2].trim());var t=JSON.parse(r.value).data.find((function(t){return t.料號===E[e][0].trim()&&t.儲位===b[e][2].trim()}));void 0!==t&&(E[e][1]=parseInt(E[e][1])+parseInt(t.現有庫存))},j=1;j<E.length;j++)O(j);$=JSON.parse(c.value).data.flatMap((function(e){var t=parseInt(e.請購數量)-L[e.料號];return t=t<0?0:t,C.includes(e.料號)?[[e.料號,t]]:[]})),e.next=65;break;case 60:return Ma("body").loadingModal("hide"),Ma("body").loadingModal("destroy"),console.log("Failed to get existing stock"),notyf.open({type:"error",message:n.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),e.abrupt("return");case 65:return N=Date.now()-A,console.log("Total time taken : "+N+" milliseconds"),A=Date.now(),e.next=70,i(E,b,$);case 70:if(R=e.sent,N=Date.now()-A,console.log("Total time taken : "+N+" milliseconds"),Ma("body").loadingModal("hide"),Ma("body").loadingModal("destroy"),"success"!==R){e.next=86;break}return x.value=!1,notyf.open({type:"success",message:n.appContext.config.globalProperties.$t("inboundpageLang.change")+" "+n.appContext.config.globalProperties.$t("inboundpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),T.splice(0),f.value="",e.next=82,u();case 82:return e.next=84,m();case 84:e.next=87;break;case 86:notyf.open({type:"error",message:n.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});case 87:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=Array();(0,A.YP)(f,Ga(Ua().mark((function e(){var t,o,a,i,s,u,p,d,h,m;return Ua().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M();case 2:if(""!=f.value){e.next=6;break}return Ma("body").loadingModal("hide"),Ma("body").loadingModal("destroy"),e.abrupt("return");case 6:for(t=JSON.parse(f.value),o=JSON.parse(c.value),i={},s=Array(),u=1;u<b.length;u++)""!=b[u][0].trim()&&null!=b[u][0].trim()&&s.push(b[u][0].trim());return e.next=13,l(s,[]);case 13:if("success"!==e.sent){e.next=19;break}p=JSON.parse(r.value).data,a=Object.values(p.reduce((function(e,t){var n=e[t.料號];return n?n.現有庫存+=parseInt(t.現有庫存):(t.現有庫存=parseInt(t.現有庫存),e[t.料號]=t),e}),{})),e.next=24;break;case 19:return Ma("body").loadingModal("hide"),Ma("body").loadingModal("destroy"),console.log("Failed to get existing stock"),notyf.open({type:"error",message:n.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),e.abrupt("return");case 24:for(d=1;d<b.length;d++)i.料號=b[d][0].toString().trim(),s.push(i.料號),i.入庫量=Math.abs(parseInt(b[d][1])),h=o.data.find((function(e){return e.料號===i.料號})),i.在途量=h?parseFloat(h.請購數量):0,(h=a.find((function(e){return e.料號===i.料號})))?i.現有庫存=parseFloat(h.現有庫存):(i.原儲位="N/A",i.現有庫存=0),i.新儲位=b[d][2].toString().trim(),i.入庫原因=b[d][3].toString().trim(),i.excel_row_num=d+1,0==T.length?i.id=0:i.id=parseInt(T[T.length-1].id)+1,-1!=(m=t.data.findIndex((function(e){return e.料號===i.料號})))?i=Object.assign(i,t.data[m]):i.月請購="",T.push(i),i={};L={},L=T.reduce((function(e,t){var n=t.料號,o=parseInt(t.入庫量);return e[n]?e[n]+=o:e[n]=o,e}),{}),JSON.parse(g.value).data.forEach((function(e){B.push(e.儲存位置)})),Ma("#importedtable").hasClass("show")||Ma("#togglebtn").click(),x.value=!0,Ma("body").loadingModal("hide"),Ma("body").loadingModal("destroy"),D.isLoading=!1;case 33:case"end":return e.stop()}}),e)})))),(0,A.YP)(T,(function(){document.getElementsByClassName("vtl-table")[0].scrollIntoView({behavior:"smooth"})}));var D=(0,d.qj)({isLoading:!0,columns:[{label:n.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return""===e.月請購||null===e.月請購||"null"===e.月請購.toLowerCase()?'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap text-danger CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>":'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:n.appContext.config.globalProperties.$t("monthlyPRpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,t){return""===e.月請購||null===e.月請購||"null"===e.月請購.toLowerCase()?'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+n.appContext.config.globalProperties.$t("inboundpageLang.noisn")+"</div>":'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:n.appContext.config.globalProperties.$t("inboundpageLang.format"),field:"規格",width:"14ch",sortable:!0,display:function(e,t){return""===e.月請購||null===e.月請購||"null"===e.月請購.toLowerCase()?'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar text-danger" style="overflow-x: auto; width: 100%;">'+n.appContext.config.globalProperties.$t("inboundpageLang.noisn")+"</div>":'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:n.appContext.config.globalProperties.$t("inboundpageLang.stock"),field:"庫存",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="stock'+t+'" name="stock'+t+'" value="'+e.現有庫存+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.現有庫存+"&nbsp;<small>"+e.單位+"</small></div>"}},{label:n.appContext.config.globalProperties.$t("monthlyPRpageLang.transit"),field:"在途量",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="intransit'+t+'" name="intransit'+t+'" value="'+e.在途量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.在途量+"&nbsp;<small>"+e.單位+"</small></div>"}},{label:n.appContext.config.globalProperties.$t("inboundpageLang.inboundnum"),field:"入庫量",width:"10ch",sortable:!0,display:function(e,t){return L[e.料號]>e.在途量?'<input type="hidden" id="inbound'+t+'" name="inbound'+t+'" value="'+e.入庫量+'"><div class="text-nowrap CustomScrollbar text-danger" style="overflow-x: auto; width: 100%;">'+e.入庫量+"&nbsp;<small>"+e.單位+"</small></div>":'<input type="hidden" id="inbound'+t+'" name="inbound'+t+'" value="'+e.入庫量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.入庫量+"&nbsp;<small>"+e.單位+"</small></div>"}},{label:n.appContext.config.globalProperties.$t("inboundpageLang.inreason"),field:"入庫原因",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="oldloc'+t+'" name="oldloc'+t+'" value="'+e.入庫原因+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.入庫原因+"</div>"}},{label:n.appContext.config.globalProperties.$t("inboundpageLang.oldloc"),field:"原儲位",width:"10ch",sortable:!1},{label:n.appContext.config.globalProperties.$t("inboundpageLang.newloc"),field:"新儲位",width:"12ch",sortable:!0,display:function(e,t){return B.includes(e.新儲位)?'<input type="hidden" id="newloc'+t+'" name="newloc'+t+'" value="'+e.新儲位+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.新儲位+"</div>":'<input type="hidden" id="newloc'+t+'" name="newloc'+t+'" value="'+e.新儲位+'"><div class="text-nowrap CustomScrollbar text-danger" style="overflow-x: auto; width: 100%;">'+e.新儲位+" ("+n.appContext.config.globalProperties.$t("inboundpageLang.noloc")+")</div>"}}],rows:(0,d.Fl)((function(){return T.filter((function(e){return e.料號.toLowerCase().includes(E.value.toLowerCase())||e.品名.includes(E.value)}))})),totalRecordCount:(0,d.Fl)((function(){return D.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:n.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+n.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+n.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+n.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:n.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:n.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:n.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]}),F=(0,d.qj)({isLoading:!0,columns:[{label:n.appContext.config.globalProperties.$t("basicInfoLang.isn"),field:"料號",width:"14ch",sortable:!0,isKey:!0,display:function(e,t){return'<input type="hidden" id="number'+e.id+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:n.appContext.config.globalProperties.$t("basicInfoLang.pName"),field:"品名",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:n.appContext.config.globalProperties.$t("basicInfoLang.moq"),field:"MOQ",width:"8ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="moq'+e.id+'" name="moq'+t+'" value="'+e.MOQ+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.MOQ+" <small>"+e.單位+"</small></div>"}},{label:n.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount"),field:"本次請購數量",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="buyamount'+e.id+'" name="buyamount'+t+'" value="'+e.本次請購數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.本次請購數量).toLocaleString("en-US")+" <small>"+e.單位+"</small></div>"}},{label:n.appContext.config.globalProperties.$t("monthlyPRpageLang.buyprice"),field:"請購金額",width:"11ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="buyprice'+e.id+'" name="buyprice'+t+'" value="'+e.請購金額+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.請購金額).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")+" <small>"+e.幣別+"</small></div>"}}],rows:(0,d.Fl)((function(){return j.filter((function(e){return e.料號.toLowerCase().includes($.value.toLowerCase())||e.品名.includes($.value)}))})),totalRecordCount:(0,d.Fl)((function(){return F.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:n.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+n.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+n.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+n.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:n.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:n.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:n.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]}),U=function(e){_=e};return Na(e={exampleUrl:t,isInvalid:v,isInvalid_DB:y,validation_err_msg:w,uploadToDBReady:x,searchTerm:E,searchTerm2:$,table:D,table2:F,modalTitle:R,openLocDetails:function(e){R.value=e,j.splice(0);for(var t=0;t<AllRecords.length;t++)AllRecords[t].SXB單號===e&&j.push(AllRecords[t]);"未簽核"===j[0].狀態?O.value=!0:O.value=!1},showFooter:O,updateCheckedRows:U,onUploadClick:I,onInputChange:function(e){v.value=!1,T.splice(0),f.value="",C.value=e.target.files?e.target.files[0]:null,Ma("#importedtable").hasClass("show")&&Ma("#togglebtn").click()},onSendToDBClick:N},"updateCheckedRows",U),Na(e,"deleteRow",(function(){if(0!=_.length){for(var e=function(e){var t=T.findIndex((function(t){return parseInt(t.id)===parseInt(_[e].id)}));-1!=t&&T.splice(t,1)},t=0;t<_.length;t++)e(t);document.querySelectorAll(".vtl-tbody-checkbox").forEach((function(e){return e.checked=!1})),document.querySelector(".vtl-thead-checkbox").checked&&document.querySelector(".vtl-thead-checkbox").click(),_=[]}else notyf.open({type:"warning",message:n.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}})})),e}});var Ha=n(1167),Ja={insert:"head",singleton:!1};bt()(Ha.Z,Ja);Ha.Z.locals;const Ya=(0,w.Z)(za,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",Eo,[(0,d._)("div",$o,[(0,d._)("h3",null,(0,d.zw)(e.$t("inboundpageLang.upload")),1)]),(0,d._)("div",Ro,[(0,d._)("div",Oo,[(0,d._)("div",To,[(0,d._)("a",{href:e.exampleUrl,download:""},(0,d.zw)(e.$t("inboundpageLang.exampleExcel")),9,jo)]),Mo,(0,d._)("label",No,(0,d.zw)(e.$t("inboundpageLang.plz_upload")),1),Bo,(0,d._)("div",Do,[(0,d._)("input",{class:(0,d.C_)(["form-control",{"is-invalid":e.isInvalid}]),id:"excel_input",type:"file",name:"select_file",onChange:t[0]||(t[0]=function(){return e.onInputChange&&e.onInputChange.apply(e,arguments)})},null,34),e.isInvalid?((0,d.wg)(),(0,d.iD)("span",Fo,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0)]),Uo,(0,d._)("div",qo,[(0,d._)("button",{type:"submit",name:"upload",class:"col col-auto btn btn-lg btn-primary",onClick:t[1]||(t[1]=function(){return e.onUploadClick&&e.onUploadClick.apply(e,arguments)})},(0,d.zw)(e.$t("inboundpageLang.upload1")),1)])])])]),Go,(0,d._)("div",zo,[(0,d._)("div",Ho,[(0,d._)("div",Jo,[(0,d._)("div",Yo,[(0,d._)("div",Qo,[(0,d._)("label",Xo,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",Zo,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.searchTerm=t})},null,8,Vo),[[d.nr,e.searchTerm]])])]),(0,d._)("div",Ko,[(0,d._)("button",{id:"delete",name:"delete",class:"col col-auto btn btn-lg btn-danger",onClick:t[3]||(t[3]=function(){return e.deleteRow&&e.deleteRow.apply(e,arguments)})},Wo)])]),ea,e.isInvalid_DB?((0,d.wg)(),(0,d.iD)("span",ta,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0),(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,isSlotMode:!0,hasCheckbox:!0,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[4]||(t[4]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},{原儲位:(0,d.w5)((function(t){var n=t.row,o=t.key;return[(0,d._)("div",na,[(0,d._)("button",{onClick:function(t){return e.openLocDetails(n.料號)},type:"button","data-bs-toggle":"modal","data-bs-target":"#detailTable",class:"btn btn-outline-info my-0 px-1 py-0",style:{"border-radius":"20px"},id:"oldloc"+n.id,name:"oldloc"+o},"Info",8,oa)])]})),_:1},8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"]),aa,(0,d._)("div",ra,[(0,d._)("div",ia,[e.uploadToDBReady?((0,d.wg)(),(0,d.iD)("button",{key:0,type:"submit",name:"upload",class:"col col-auto fs-3 text-center btn btn-lg btn-info",onClick:t[5]||(t[5]=function(){return e.onSendToDBClick&&e.onSendToDBClick.apply(e,arguments)})},[la,(0,d.Uk)(" "+(0,d.zw)(e.$t("templateWords.inbound")),1)])):(0,d.kq)("",!0)])])])]),(0,d._)("div",sa,[(0,d._)("div",ca,[(0,d._)("div",ua,[(0,d._)("div",pa,[(0,d._)("h1",da,(0,d.zw)(e.modalTitle),1),fa]),(0,d._)("div",ga,[(0,d._)("div",ha,[(0,d._)("div",ma,[(0,d._)("div",ba,[(0,d._)("label",va,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",ya,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.searchTerm2=t})},null,8,wa),[[d.nr,e.searchTerm2]])])]),(0,d._)("div",xa,[(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("monthlyPRpageLang.download"),onClick:t[7]||(t[7]=function(t){return e.OutputExcelClick(e.modalTitle)})},Ca,8,_a)])]),La,(0,d.Wm)(i,{"is-static-mode":!0,isSlotMode:!0,hasCheckbox:!1,messages:e.table2.messages,columns:e.table2.columns,rows:e.table2.rows,total:e.table2.totalRecordCount,"page-options":e.table2.pageOptions,sortable:e.table2.sortable,"is-fixed-first-column":!1,onRowClicked:e.rowClicked},null,8,["messages","columns","rows","total","page-options","sortable","onRowClicked"])]),e.showFooter?((0,d.wg)(),(0,d.iD)("div",ka,[(0,d._)("button",{onClick:t[8]||(t[8]=function(){return e.sxb_reject&&e.sxb_reject.apply(e,arguments)}),type:"button",class:"btn btn-lg btn-danger",style:{"border-radius":"5px"}},(0,d.zw)(e.$t("monthlyPRpageLang.review_cancel")),1),(0,d._)("button",{onClick:t[9]||(t[9]=function(){return e.sxb_approve&&e.sxb_approve.apply(e,arguments)}),type:"button",class:"btn btn-lg btn-success",style:{"border-radius":"5px"}},(0,d.zw)(e.$t("monthlyPRpageLang.review_complete")),1)])):(0,d.kq)("",!0)])])])],64)}],["__scopeId","data-v-a28d14da"]]);var Qa={class:"row",style:{"text-align":"left"}},Xa={class:"col col-auto"},Za={for:"pnInput",class:"col-form-label"},Va={class:"col col-3 p-0 m-0"},Ka=["placeholder"],Wa=function(e){return(0,d.dD)("data-v-fd2c4972"),e=e(),(0,d.Cn)(),e}((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)}));function er(e){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(e)}function tr(){tr=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==er(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function nr(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function or(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=((0,m.tv)(),function(){var n,o=(n=tr().mark((function n(){var o,a,r,i,l,s,c,u,p,d;return tr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.value="",n.next=3,$().post("/getCurrentDB");case 3:return o=n.sent,a=sessionStorage.getItem("pickrecordclient"),r=sessionStorage.getItem("pickrecordproduction"),i=sessionStorage.getItem("pickrecordsend"),l=sessionStorage.getItem("pickrecordisn"),s=sessionStorage.getItem("pickrecordcheck"),c=sessionStorage.getItem("pickrecordbegin"),u=sessionStorage.getItem("pickrecordend"),n.prev=11,n.next=14,$().post("/api/outbound/pickrecord",{DB:o.data,pickrecordclient:a,pickrecordproduction:r,pickrecordsend:i,pickrecordisn:l,pickrecordcheck:s,pickrecordbegin:c,pickrecordend:u});case 14:p=n.sent,e.value=JSON.stringify(p.data),n.next=24;break;case 18:for(d in n.prev=18,n.t0=n.catch(11),console.log(n.t0),n.t0.response.data.errors)t.value+=n.t0.response.data.errors[d][0]+"  ";return console.log(t.value),n.abrupt("return",n.t0);case 24:case"end":return n.stop()}}),n,null,[[11,18]])})),function(){var e=this,t=arguments;return new Promise((function(o,a){var r=n.apply(e,t);function i(e){nr(r,o,a,i,l,"next",e)}function l(e){nr(r,o,a,i,l,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}());return{mats:e,getMats:n}}const ar=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=or(),t=e.mats,n=e.getMats;(0,A.wF)(n);var o=(0,d.iH)(""),a=(0,A.FN)(),r=document.getElementsByTagName("HTML")[0].getAttribute("lang");a.appContext.config.globalProperties.$lang.setLocale(r);var i=(0,d.qj)([]);(0,A.YP)(t,(function(){console.log(JSON.parse(t.value));for(var e=JSON.parse(t.value),n=0;n<e.datas.length;n++)i.push(e.datas[n]);document.getElementById("QueryFlag").click(),l.isLoading=!1}));var l=(0,d.qj)({isLoading:!0,columns:[{label:a.appContext.config.globalProperties.$t("outboundpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.usereason"),field:"領用原因",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="usereason'+t+'" name="usereason'+t+'" value="'+e.領用原因+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.領用原因+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.line"),field:"線別",width:"8ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="line'+t+'" name="line'+t+'" value="'+e.線別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.線別+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.format"),field:"規格",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.pickamount"),field:"預領數量",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="pickamount'+t+'" name="pickamount'+t+'" value="'+e.預領數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.預領數量+"&nbsp;<small>"+e.單位+"</small></div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.realpickamount"),field:"實際領用數量",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="realpickamount'+t+'" name="realpickamount'+t+'" value="'+e.實際領用數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.實際領用數量+"&nbsp;<small>"+e.單位+"</small></div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.mark"),field:"備註",width:"10ch",sortable:!0,display:function(e,t){return null===e.備註&&(e.備註=""),'<input type="hidden" id="remark'+t+'" name="remark'+t+'" value="'+e.備註+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.備註+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.diffreason"),field:"實領差異原因",width:"12ch",sortable:!0,display:function(e,t){return null===e.實領差異原因&&(e.實領差異原因=""),'<input type="hidden" id="diffreason'+t+'" name="diffreason'+t+'" value="'+e.實領差異原因+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.實領差異原因+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.loc"),field:"儲位",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="location'+t+'" name="location'+t+'" value="'+e.儲位+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.儲位+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.pickpeople"),field:"領料人員",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="pickpeople'+t+'" name="pickpeople'+t+'" value="'+e.領料人員+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.領料人員+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.pickpeoplenum"),field:"領料人員工號",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="pickpeoplenum'+t+'" name="pickpeoplenum'+t+'" value="'+e.領料人員工號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.領料人員工號+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.sendpeople"),field:"發料人員",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="sendpeople'+t+'" name="sendpeople'+t+'" value="'+e.發料人員+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.發料人員+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.sendpeoplenum"),field:"發料人員工號",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="sendpeoplenum'+t+'" name="sendpeoplenum'+t+'" value="'+e.發料人員工號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.發料人員工號+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.picklistnum"),field:"領料單號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="picklist'+t+'" name="picklist'+t+'" value="'+e.領料單號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.領料單號+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.opentime"),field:"開單時間",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="opentime'+t+'" name="opentime'+t+'" value="'+e.開單時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.開單時間+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.outboundtime"),field:"出庫時間",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="outboundtime'+t+'" name="outboundtime'+t+'" value="'+e.出庫時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.出庫時間+"</div>"}}],rows:(0,d.Fl)((function(){return i.filter((function(e){return e.料號.toLowerCase().includes(o.value.toLowerCase())||e.品名.includes(o.value)}))})),totalRecordCount:(0,d.Fl)((function(){return l.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:a.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+a.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+a.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+a.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:a.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:a.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:a.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:o,table:l,updateCheckedRows:function(e){console.log(e)}}}});var rr=n(9780),ir={insert:"head",singleton:!1};bt()(rr.Z,ir);rr.Z.locals;const lr=(0,w.Z)(ar,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",Qa,[(0,d._)("div",Xa,[(0,d._)("label",Za,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",Va,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,Ka),[[d.nr,e.searchTerm]])])]),Wa,(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!1,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[1]||(t[1]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])],64)}],["__scopeId","data-v-fd2c4972"]]);var sr={class:"row",style:{"text-align":"left"}},cr={class:"col col-auto"},ur={for:"pnInput",class:"col-form-label"},pr={class:"col col-3 p-0 m-0"},dr=["placeholder"],fr=function(e){return(0,d.dD)("data-v-26c90384"),e=e(),(0,d.Cn)(),e}((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)}));function gr(e){return gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gr(e)}function hr(){hr=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==gr(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function mr(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function br(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=((0,m.tv)(),function(){var n,o=(n=hr().mark((function n(){var o,a,r,i,l,s,c,u,p,d;return hr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.value="",n.next=3,$().post("/getCurrentDB");case 3:return o=n.sent,a=sessionStorage.getItem("backrecordclient"),r=sessionStorage.getItem("backrecordproduction"),i=sessionStorage.getItem("backrecordsend"),l=sessionStorage.getItem("backrecordisn"),s=sessionStorage.getItem("backrecordcheck"),c=sessionStorage.getItem("backrecordbegin"),u=sessionStorage.getItem("backrecordend"),n.prev=11,n.next=14,$().post("/api/outbound/backrecord",{DB:o.data,backrecordclient:a,backrecordproduction:r,backrecordsend:i,backrecordisn:l,backrecordcheck:s,backrecordbegin:c,backrecordend:u});case 14:p=n.sent,e.value=JSON.stringify(p.data),n.next=23;break;case 18:for(d in n.prev=18,n.t0=n.catch(11),console.log(n.t0),n.t0.response.data.errors)t.value+=n.t0.response.data.errors[d][0]+"  ";console.log(t.value);case 23:case"end":return n.stop()}}),n,null,[[11,18]])})),function(){var e=this,t=arguments;return new Promise((function(o,a){var r=n.apply(e,t);function i(e){mr(r,o,a,i,l,"next",e)}function l(e){mr(r,o,a,i,l,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}());return{mats:e,getMats:n}}const vr=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=br(),t=e.mats,n=e.getMats;(0,A.wF)(n);var o=(0,d.iH)(""),a=(0,A.FN)(),r=document.getElementsByTagName("HTML")[0].getAttribute("lang");a.appContext.config.globalProperties.$lang.setLocale(r);var i=(0,d.qj)([]);(0,A.YP)(t,(function(){console.log(JSON.parse(t.value));for(var e=JSON.parse(t.value),n=0;n<e.datas.length;n++)i.push(e.datas[n]);document.getElementById("QueryFlag").click(),l.isLoading=!1}));var l=(0,d.qj)({isLoading:!0,columns:[{label:a.appContext.config.globalProperties.$t("outboundpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.backreason"),field:"退回原因",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="backreason'+t+'" name="backreason'+t+'" value="'+e.退回原因+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.退回原因+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.line"),field:"線別",width:"8ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="line'+t+'" name="line'+t+'" value="'+e.線別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.線別+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.format"),field:"規格",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.backamount"),field:"預退數量",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="backamount'+t+'" name="backamount'+t+'" value="'+e.預退數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.預退數量+"&nbsp;<small>"+e.單位+"</small></div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.realbackamount"),field:"實際退回數量",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="realbackamount'+t+'" name="realbackamount'+t+'" value="'+e.實際退回數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.實際退回數量+"&nbsp;<small>"+e.單位+"</small></div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.mark"),field:"備註",width:"10ch",sortable:!0,display:function(e,t){return null===e.備註&&(e.備註=""),'<input type="hidden" id="remark'+t+'" name="remark'+t+'" value="'+e.備註+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.備註+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.backdiffreason"),field:"實退差異原因",width:"23ch",sortable:!0,display:function(e,t){return null===e.實退差異原因&&(e.實退差異原因=""),'<input type="hidden" id="backdiffreason'+t+'" name="backdiffreason'+t+'" value="'+e.實退差異原因+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.實退差異原因+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.loc"),field:"儲位",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="location'+t+'" name="location'+t+'" value="'+e.儲位+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.儲位+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.receivepeople"),field:"收料人員",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="receivepeople'+t+'" name="receivepeople'+t+'" value="'+e.收料人員+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.收料人員+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.receivepeoplenum"),field:"收料人員工號",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="receivepeoplenum'+t+'" name="receivepeoplenum'+t+'" value="'+e.收料人員工號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.收料人員工號+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.backpeople"),field:"退料人員",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="backpeople'+t+'" name="backpeople'+t+'" value="'+e.退料人員+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.退料人員+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.backpeoplenum"),field:"退料人員工號",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="backpeoplenum'+t+'" name="backpeoplenum'+t+'" value="'+e.退料人員工號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.退料人員工號+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.backlistnum"),field:"退料單號",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="backlistnum'+t+'" name="backlistnum'+t+'" value="'+e.退料單號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.退料單號+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.opentime"),field:"開單時間",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="opentime'+t+'" name="opentime'+t+'" value="'+e.開單時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.開單時間+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.inboundtime"),field:"入庫時間",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="inboundtime'+t+'" name="inboundtime'+t+'" value="'+e.入庫時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.入庫時間+"</div>"}},{label:a.appContext.config.globalProperties.$t("outboundpageLang.status"),field:"功能狀況",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="status'+t+'" name="status'+t+'" value="'+e.功能狀況+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.功能狀況+"</div>"}}],rows:(0,d.Fl)((function(){return i.filter((function(e){return e.料號.toLowerCase().includes(o.value.toLowerCase())||e.品名.includes(o.value)}))})),totalRecordCount:(0,d.Fl)((function(){return l.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:a.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+a.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+a.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+a.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:a.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:a.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:a.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:o,table:l,updateCheckedRows:function(e){console.log(e)}}}});var yr=n(2552),wr={insert:"head",singleton:!1};bt()(yr.Z,wr);yr.Z.locals;const xr=(0,w.Z)(vr,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",sr,[(0,d._)("div",cr,[(0,d._)("label",ur,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",pr,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,dr),[[d.nr,e.searchTerm]])])]),fr,(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!1,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[1]||(t[1]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])],64)}],["__scopeId","data-v-26c90384"]]);var _r=function(e){return(0,d.dD)("data-v-304fd098"),e=e(),(0,d.Cn)(),e},Cr={class:"row justify-content-between"},Lr={class:"row col col-auto"},kr={class:"col col-auto"},Pr={for:"sxbInput",class:"col-form-label"},Sr={class:"col col-auto p-0 m-0"},Ir=["placeholder"],Ar={class:"col col-auto"},Er=["value"],$r=[_r((function(){return(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill fs-4"},null,-1)}))],Rr=_r((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Or={class:"col col-auto align-items-center m-0 p-0"},Tr={class:"m-0 p-0",style:{width:"12ch"}},jr=["onClick","id","name"],Mr={class:"modal fade",id:"detailTable",tabindex:"-1","aria-labelledby":"detailTable","aria-hidden":"true"},Nr={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},Br={class:"modal-content"},Dr={class:"modal-header justify-content-center"},Fr={class:"col col-auto modal-title m-0 p-0 fs-4"},Ur=_r((function(){return(0,d._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)})),qr={class:"modal-body"},Gr={class:"row g-3"},zr={class:"col-md-4"},Hr={for:"inputQty",class:"form-label"},Jr={class:"input-group"},Yr=["placeholder"],Qr={class:"input-group-text"},Xr={key:0,class:"invalid-feedback d-block",role:"alert"},Zr={class:"col-md-8"},Vr={for:"inputDescr",class:"form-label"},Kr={key:0,class:"invalid-feedback d-block",role:"alert"},Wr={class:"modal-footer justify-content-between"},ei={type:"button",class:"btn btn-lg btn-danger",style:{"border-radius":"5px"},"data-bs-dismiss":"modal","aria-label":"Close"};var ti=n(9755);function ni(e){return ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ni(e)}function oi(){oi=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==ni(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function ai(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function ri(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){ai(r,o,a,i,l,"next",e)}function l(e){ai(r,o,a,i,l,"throw",e)}i(void 0)}))}}const ii=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=(0,A.FN)(),t=document.getElementsByTagName("HTML")[0].getAttribute("lang");e.appContext.config.globalProperties.$lang.setLocale(t);var n=Ea(),o=n.mats_inTransit,a=n.getTransit,r=n.updateInTransit;(0,A.wF)(a);var i=(0,d.iH)(!1),l=(0,d.iH)(!1),s=(0,d.iH)(""),c=(0,d.iH)(""),u=(0,d.iH)(""),p=(0,d.iH)(""),f=(0,d.iH)(""),g=(0,d.iH)(""),h=(0,d.iH)(""),m=((0,d.iH)(),(0,d.iH)("")),b=(0,d.qj)([]),v=function(){var e=ri(oi().mark((function e(){return oi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ti("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var t=ri(oi().mark((function t(){var n,o,a,r,i,l,s,c,u;return oi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v();case 2:for(n=new Date,o=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0"),r=n.getFullYear(),n=r+"_"+a+"_"+o,i=Array(),l=0;l<b.length;l++)(s=new Object).料號=b[l].料號,s.在途數量=b[l].請購數量,s.說明=b[l].說明,s.修改人員=b[l].修改人員,s.最後更新時間=b[l].最後更新時間,i.push(s);c=ue.P6.json_to_sheet(i),u=ue.P6.book_new(),ue.P6.book_append_sheet(u,c,e.appContext.config.globalProperties.$t("monthlyPRpageLang.on_the_way_search")),ue.NC(u,e.appContext.config.globalProperties.$t("monthlyPRpageLang.on_the_way_search")+"_"+n+".xlsx",{compression:!0}),ti("body").loadingModal("hide"),ti("body").loadingModal("destroy");case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),w=function(){var t=ri(oi().mark((function t(){var n,o,p,d;return oi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.value=!1,l.value=!1,""!==g.value.toString().trim()&&null!==g.value&&void 0!==g.value||(s.value=e.appContext.config.globalProperties.$t("validation.required"),i.value=!0),""!==h.value.trim()&&null!==h.value&&void 0!==h.value||(c.value=e.appContext.config.globalProperties.$t("validation.required"),l.value=!0),!0!==i.value&&!0!==l.value){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,v();case 8:return n=[u.value],o=[g.value],p=[h.value],t.next=13,r(n,o,p);case 13:return d=t.sent,t.next=16,a();case 16:"success"===d?notyf.open({type:"success",message:e.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}):notyf.open({type:"error",message:e.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),ti("body").loadingModal("hide"),ti("body").loadingModal("destroy");case 19:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,A.YP)(o,ri(oi().mark((function e(){var t,n;return oi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:if(b.splice(0),""!=o.value){e.next=7;break}return ti("body").loadingModal("hide"),ti("body").loadingModal("destroy"),e.abrupt("return");case 7:for(t=JSON.parse(o.value),n=0;n<t.data.length;n++)t.data[n].id=n,b.push(t.data[n]);ti("body").loadingModal("hide"),ti("body").loadingModal("destroy"),x.isLoading=!1;case 12:case"end":return e.stop()}}),e)}))));var x=(0,d.qj)({isLoading:!0,columns:[{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="isn'+e.id+'" name="isn'+e.id+'" value="'+e.料號+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.transit"),field:"請購數量",width:"12ch",sortable:!0},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.transit_reviser"),field:"修改人員",width:"10ch",sortable:!0,display:function(e,t){return null!==e.修改人員&&void 0!==e.修改人員||(e.修改人員="N/A"),'<input type="hidden" id="reviser'+t+'" name="reviser'+t+'" value="'+e.修改人員+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.修改人員+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.description"),field:"說明",width:"10ch",sortable:!0,display:function(e,t){return null!==e.說明&&void 0!==e.說明||(e.說明="N/A"),'<input type="hidden" id="remark'+t+'" name="remark'+t+'" value="'+e.說明+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.說明+"</div>"}},{label:e.appContext.config.globalProperties.$t("inboundpageLang.updatetime"),field:"最後更新時間",width:"13ch",sortable:!0,display:function(e,t){return null!==e.最後更新時間&&void 0!==e.最後更新時間||(e.最後更新時間="N/A"),'<input type="hidden" id="updatetime'+t+'" name="updatetime'+t+'" value="'+e.最後更新時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.最後更新時間+"</div>"}}],rows:(0,d.Fl)((function(){return b.filter((function(e){return e.料號.toLowerCase().includes(m.value.toLowerCase())||e.品名.includes(m.value)}))})),totalRecordCount:(0,d.Fl)((function(){return x.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:e.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+e.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+e.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+e.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:e.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:e.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:e.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{isInvalid:i,isInvalid2:l,validation_err_msg:s,validation_err_msg2:c,searchTerm:m,modalTitle:u,unit:f,originalQty:p,inputQty:g,inputDescr:h,table:x,updateCheckedRows:function(e){e},OutputExcelClick:y,openQtyDetails:function(e){u.value=e.料號,f.value=e.單位,p.value=parseInt(e.請購數量).toLocaleString("en",{useGrouping:!0})},sxb_approve:w}}});var li=n(4701),si={insert:"head",singleton:!1};bt()(li.Z,si);li.Z.locals;const ci=(0,w.Z)(ii,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",Cr,[(0,d._)("div",Lr,[(0,d._)("div",kr,[(0,d._)("label",Pr,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",Sr,[(0,d.wy)((0,d._)("input",{id:"sxbInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,Ir),[[d.nr,e.searchTerm]])])]),(0,d._)("div",Ar,[(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("monthlyPRpageLang.download"),onClick:t[1]||(t[1]=function(t){return e.OutputExcelClick("All")})},$r,8,Er)])]),Rr,(0,d.Wm)(i,{id:"searchTable","is-fixed-first-column":!0,hasCheckbox:!1,isStaticMode:!0,isSlotMode:!0,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onReturnCheckedRows:e.updateCheckedRows},{請購數量:(0,d.w5)((function(t){var n=t.row,o=t.key;return[(0,d._)("div",Or,[(0,d._)("span",Tr,[(0,d.Uk)((0,d.zw)(parseInt(n.請購數量).toLocaleString("en",{useGrouping:!0}))+" ",1),(0,d._)("small",null,(0,d.zw)(n.單位),1)]),(0,d._)("button",{onClick:function(t){return e.openQtyDetails(n)},type:"button","data-bs-toggle":"modal","data-bs-target":"#detailTable",class:"btn btn-outline-info btn-sm ms-1 my-0 px-1 py-0",style:{"border-radius":"20px"},id:"sxb"+n.id,name:"sxb"+o},"Edit",8,jr)])]})),_:1},8,["messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"]),(0,d._)("div",Mr,[(0,d._)("div",Nr,[(0,d._)("div",Br,[(0,d._)("div",Dr,[(0,d._)("h1",Fr,(0,d.zw)(e.modalTitle),1),Ur]),(0,d._)("div",qr,[(0,d._)("div",Gr,[(0,d._)("div",zr,[(0,d._)("label",Hr,(0,d.zw)(e.$t("monthlyPRpageLang.on_the_way_search")),1),(0,d._)("div",Jr,[(0,d.wy)((0,d._)("input",{"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.inputQty=t}),type:"number",class:(0,d.C_)([{"is-invalid":e.isInvalid},"form-control"]),id:"inputQty",placeholder:e.originalQty,min:"0"},null,10,Yr),[[d.nr,e.inputQty]]),(0,d._)("div",Qr,(0,d.zw)(e.unit),1)]),e.isInvalid?((0,d.wg)(),(0,d.iD)("span",Xr,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0)]),(0,d._)("div",Zr,[(0,d._)("label",Vr,(0,d.zw)(e.$t("monthlyPRpageLang.description")),1),(0,d.wy)((0,d._)("input",{"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.inputDescr=t}),type:"text",class:(0,d.C_)([{"is-invalid":e.isInvalid2},"form-control"]),id:"inputDescr"},null,2),[[d.nr,e.inputDescr]]),e.isInvalid2?((0,d.wg)(),(0,d.iD)("span",Kr,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg2),1)])):(0,d.kq)("",!0)])])]),(0,d._)("div",Wr,[(0,d._)("button",ei,(0,d.zw)(e.$t("templateWords.cancel")),1),(0,d._)("button",{onClick:t[4]||(t[4]=function(){return e.sxb_approve&&e.sxb_approve.apply(e,arguments)}),type:"button",class:"btn btn-lg btn-success",style:{"border-radius":"5px"}},(0,d.zw)(e.$t("checkInvLang.edit")),1)])])])])],64)}],["__scopeId","data-v-304fd098"]]);var ui=function(e){return(0,d.dD)("data-v-5f859c9f"),e=e(),(0,d.Cn)(),e},pi={class:"row justify-content-between"},di={class:"row col col-auto"},fi={class:"col col-auto"},gi={for:"sxbInput",class:"col-form-label"},hi={class:"col col-auto p-0 m-0"},mi=["placeholder"],bi={class:"col col-auto"},vi=["value"],yi=[ui((function(){return(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill fs-4"},null,-1)}))],wi=ui((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),xi={class:"col col-auto align-items-center m-0 p-0"},_i=["onClick","id","name"],Ci={class:"col col-auto align-items-center m-0 p-0"},Li=["onClick"],ki=["onClick"],Pi=["onClick"],Si={class:"modal fade",id:"detailTable",tabindex:"-1","aria-labelledby":"detailTable","aria-hidden":"true"},Ii={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},Ai={class:"modal-content"},Ei={class:"modal-header justify-content-center"},$i={class:"col col-auto modal-title m-0 p-0 fs-4"},Ri=ui((function(){return(0,d._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)})),Oi={class:"modal-body"},Ti={class:"row justify-content-between"},ji={class:"row col col-auto"},Mi={class:"col col-auto"},Ni={for:"pnInput",class:"col-form-label"},Bi={class:"col col-auto p-0 m-0"},Di=["placeholder"],Fi={class:"col col-auto"},Ui=["value"],qi=[ui((function(){return(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill fs-4"},null,-1)}))],Gi=ui((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),zi={key:0,class:"modal-footer justify-content-between"};function Hi(e){return Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hi(e)}function Ji(){Ji=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==Hi(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Yi(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Qi(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Yi(r,o,a,i,l,"next",e)}function l(e){Yi(r,o,a,i,l,"throw",e)}i(void 0)}))}}function Xi(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=(0,d.iH)(""),o=((0,m.tv)(),function(){var t=Qi(Ji().mark((function t(){var o,a,r,i,l,s,c;return Ji().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.value="",t.next=3,$().post("/getCurrentDB");case 3:return o=t.sent,a=sessionStorage.getItem("sxbisn"),r=sessionStorage.getItem("sxbsend"),i=sessionStorage.getItem("sxbbegin"),l=sessionStorage.getItem("sxbend"),t.prev=8,t.next=11,$().post("/api/month/sxb",{DB:o.data,sxbisn:a,sxbsend:r,sxbbegin:i,sxbend:l});case 11:s=t.sent,e.value=JSON.stringify(s.data),t.next=20;break;case 15:for(c in t.prev=15,t.t0=t.catch(8),console.log(t.t0),t.t0.response.data.errors)n.value+=t.t0.response.data.errors[c][0]+"  ";console.log(n.value);case 20:case"end":return t.stop()}}),t,null,[[8,15]])})));return function(){return t.apply(this,arguments)}}()),a=function(){var e=Qi(Ji().mark((function e(t){var o,a;return Ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return o=e.sent,e.prev=4,e.next=7,$().post("/api/month/rejectSXB",{DB:o.data,sxb:JSON.stringify(t)});case 7:return a=e.sent,console.log(a.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}(),r=function(){var e=Qi(Ji().mark((function e(t,o,a){var r,i;return Ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return r=e.sent,e.prev=4,e.next=7,$().post("/api/month/approveSXB",{DB:r.data,sxb:JSON.stringify(t),isn:JSON.stringify(o),amount:JSON.stringify(a)});case 7:return i=e.sent,console.log(i.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,n,o){return e.apply(this,arguments)}}(),i=function(){var e=Qi(Ji().mark((function e(o){var a,r;return Ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return a=e.sent,e.prev=4,e.next=7,$().post("/api/month/getTransit",{DB:a.data,transitisn:JSON.stringify(o)});case 7:return r=e.sent,t.value=JSON.stringify(r.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}();return{mats_SXB:e,inTransit:t,getMats:o,SXB_Reject:a,SXB_Approve:r,getTransit:i}}var Zi=n(9755);function Vi(e){return Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vi(e)}function Ki(){Ki=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==Vi(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Wi(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function el(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Wi(r,o,a,i,l,"next",e)}function l(e){Wi(r,o,a,i,l,"throw",e)}i(void 0)}))}}const tl=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=Xi(),t=e.mats_SXB,n=e.inTransit,o=e.getMats,a=e.SXB_Reject,r=e.SXB_Approve,i=e.getTransit;(0,A.wF)(o);var l=(0,d.iH)(""),s=(0,d.iH)(""),c=(0,d.iH)(""),u=(0,d.iH)(!1),p=[],f=(0,A.FN)(),g=document.getElementsByTagName("HTML")[0].getAttribute("lang");f.appContext.config.globalProperties.$lang.setLocale(g);var h=(0,d.qj)([]),m=(0,d.qj)([]),b=function(){var e=el(Ki().mark((function e(){return Ki().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Zi("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=el(Ki().mark((function e(t){var n,o,a,r,i,l,s,c,u,d,g,h,v,y;return Ki().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:if(n=new Date,o=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0"),r=n.getFullYear(),n=r+"_"+a+"_"+o,"All"===t){for(i=Array(),l=0;l<p.length;l++)(s=new Object).單號=p[l].SXB單號,s.料號=p[l].料號,s.品名=p[l].品名,s.MOQ=p[l].MOQ,s.本次請購數量=p[l].本次請購數量,s.總價=parseFloat(p[l].請購金額).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")+" "+p[l].幣別,s.請購時間=p[l].請購時間,i.push(s);c=ue.P6.json_to_sheet(i),u=ue.P6.book_new(),ue.P6.book_append_sheet(u,c,"ALL"),ue.NC(u,f.appContext.config.globalProperties.$t("monthlyPRpageLang.SXB_search")+"(ALL)_"+n+".xlsx",{compression:!0})}else{for(d=Array(),g=0;g<m.length;g++)(h=new Object).單號=m[g].SXB單號,h.料號=m[g].料號,h.品名=m[g].品名,h.MOQ=m[g].MOQ,h.本次請購數量=m[g].本次請購數量,h.總價=parseFloat(m[g].請購金額).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")+" "+m[g].幣別,h.請購時間=m[g].請購時間,d.push(h);v=ue.P6.json_to_sheet(d),y=ue.P6.book_new(),ue.P6.book_append_sheet(y,v,m[0].SXB單號),ue.NC(y,f.appContext.config.globalProperties.$t("monthlyPRpageLang.SXB_search")+"("+m[0].SXB單號+")_"+n+".xlsx",{compression:!0})}Zi("body").loadingModal("hide"),Zi("body").loadingModal("destroy");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=el(Ki().mark((function e(){return Ki().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:return e.next=4,a(m[0].SXB單號);case 4:if("success"!==e.sent){e.next=12;break}return u.value=!1,notyf.open({type:"success",message:f.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+f.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),e.next=10,o();case 10:e.next=13;break;case 12:notyf.open({type:"error",message:f.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});case 13:Zi("body").loadingModal("hide"),Zi("body").loadingModal("destroy");case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=el(Ki().mark((function e(){var t,a,l,s,c,p,d;return Ki().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:for(t=[],a=0;a<m.length;a++)t.push(m[a].料號);return e.next=6,i(t);case 6:for(l=JSON.parse(n.value).data,s=[],c=[],p=function(e){s.push(m[e].料號);var t=l.findIndex((function(t){return t.料號===m[e].料號}));-1===t?c.push(parseInt(m[e].本次請購數量)):c.push(parseInt(m[e].本次請購數量)+parseInt(l[t].請購數量))},d=0;d<m.length;d++)p(d);return e.next=13,r(m[0].SXB單號,s,c);case 13:if("success"!==e.sent){e.next=21;break}return u.value=!1,notyf.open({type:"success",message:f.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+f.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),e.next=19,o();case 19:e.next=22;break;case 21:notyf.open({type:"error",message:f.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});case 22:Zi("body").loadingModal("hide"),Zi("body").loadingModal("destroy");case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,A.YP)(t,el(Ki().mark((function e(){var n,o,a;return Ki().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:for(n=JSON.parse(t.value),h.splice(0),p=[],o=function(e){n.datas[e].本次請購數量=parseInt(n.datas[e].本次請購數量),n.datas[e].狀態=n.datas[e].SRM單號,n.datas[e].id=e+1,p.push(n.datas[e]),-1===h.findIndex((function(t){return t.SXB單號===n.datas[e].SXB單號}))&&h.push(n.datas[e])},a=0;a<n.datas.length;a++)o(a);Zi("body").loadingModal("hide"),Zi("body").loadingModal("destroy"),x.isLoading=!1;case 10:case"end":return e.stop()}}),e)}))));var x=(0,d.qj)({isLoading:!0,columns:[{label:f.appContext.config.globalProperties.$t("monthlyPRpageLang.buytime"),field:"請購時間",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="srm'+t+'" name="srm'+t+'" value="'+e.請購時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.請購時間+"</div>"}},{label:f.appContext.config.globalProperties.$t("monthlyPRpageLang.status"),field:"狀態",width:"6ch",sortable:!0},{label:f.appContext.config.globalProperties.$t("monthlyPRpageLang.info"),field:"SXB單號",width:"4ch",sortable:!1}],rows:(0,d.Fl)((function(){return h.filter((function(e){return e.SXB單號.toLowerCase().includes(l.value.toLowerCase())}))})),totalRecordCount:(0,d.Fl)((function(){return x.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:f.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+f.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+f.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+f.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:f.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:f.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:f.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]}),_=(0,d.qj)({isLoading:!0,columns:[{label:f.appContext.config.globalProperties.$t("basicInfoLang.isn"),field:"料號",width:"14ch",sortable:!0,isKey:!0,display:function(e,t){return'<input type="hidden" id="number'+e.id+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:f.appContext.config.globalProperties.$t("basicInfoLang.pName"),field:"品名",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:f.appContext.config.globalProperties.$t("basicInfoLang.moq"),field:"MOQ",width:"8ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="moq'+e.id+'" name="moq'+t+'" value="'+e.MOQ+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.MOQ+" <small>"+e.單位+"</small></div>"}},{label:f.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount"),field:"本次請購數量",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="buyamount'+e.id+'" name="buyamount'+t+'" value="'+e.本次請購數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.本次請購數量).toLocaleString("en-US")+" <small>"+e.單位+"</small></div>"}},{label:f.appContext.config.globalProperties.$t("monthlyPRpageLang.buyprice"),field:"請購金額",width:"11ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="buyprice'+e.id+'" name="buyprice'+t+'" value="'+e.請購金額+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.請購金額).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")+" <small>"+e.幣別+"</small></div>"}}],rows:(0,d.Fl)((function(){return m.filter((function(e){return e.料號.toLowerCase().includes(s.value.toLowerCase())||e.品名.includes(s.value)}))})),totalRecordCount:(0,d.Fl)((function(){return _.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:f.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+f.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+f.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+f.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:f.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:f.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:f.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:l,searchTerm2:s,table:x,table2:_,modalTitle:c,showFooter:u,rowClicked:function(e){},openSXBDetails:function(e){c.value=e,m.splice(0);for(var t=0;t<p.length;t++)p[t].SXB單號===e&&m.push(p[t]);"未簽核"===m[0].狀態?u.value=!0:u.value=!1},sxb_approve:w,sxb_reject:y,OutputExcelClick:v}}});var nl=n(9120),ol={insert:"head",singleton:!1};bt()(nl.Z,ol);nl.Z.locals;const al=(0,w.Z)(tl,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",pi,[(0,d._)("div",di,[(0,d._)("div",fi,[(0,d._)("label",gi,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",hi,[(0,d.wy)((0,d._)("input",{id:"sxbInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.entersxb"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,mi),[[d.nr,e.searchTerm]])])]),(0,d._)("div",bi,[(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("monthlyPRpageLang.download"),onClick:t[1]||(t[1]=function(t){return e.OutputExcelClick("All")})},yi,8,vi)])]),wi,(0,d.Wm)(i,{"is-static-mode":!0,isSlotMode:!0,hasCheckbox:!1,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,"is-fixed-first-column":!1},{SXB單號:(0,d.w5)((function(t){var n=t.row,o=t.key;return[(0,d._)("div",xi,[(0,d._)("button",{onClick:function(t){return e.openSXBDetails(n.SXB單號)},type:"button","data-bs-toggle":"modal","data-bs-target":"#detailTable",class:"btn btn-outline-info btn-sm ms-1 my-0 px-1 py-0",style:{"border-radius":"20px"},id:"sxb"+n.id,name:"sxb"+o},"More",8,_i)])]})),狀態:(0,d.w5)((function(t){var n=t.row;t.key;return[(0,d._)("div",Ci,["未簽核"===n.狀態?((0,d.wg)(),(0,d.iD)("a",{key:0,onClick:function(t){return e.openSXBDetails(n.SXB單號)},"data-bs-toggle":"modal","data-bs-target":"#detailTable",class:"m-0 p-0",style:{color:"#dca120"}},(0,d.zw)(e.$t("monthlyPRpageLang.review_pending")),9,Li)):"已退單"===n.狀態?((0,d.wg)(),(0,d.iD)("a",{key:1,onClick:function(t){return e.openSXBDetails(n.SXB單號)},"data-bs-toggle":"modal","data-bs-target":"#detailTable",class:"m-0 p-0",style:{color:"#808080"}},(0,d.zw)(e.$t("monthlyPRpageLang.review_cancel")),9,ki)):((0,d.wg)(),(0,d.iD)("a",{key:2,class:"m-0 p-0",onClick:function(t){return e.openSXBDetails(n.SXB單號)},"data-bs-toggle":"modal","data-bs-target":"#detailTable",style:{color:"#2bb91b"}},(0,d.zw)(e.$t("monthlyPRpageLang.review_complete")),9,Pi))])]})),_:1},8,["messages","columns","rows","total","page-options","sortable"]),(0,d._)("div",Si,[(0,d._)("div",Ii,[(0,d._)("div",Ai,[(0,d._)("div",Ei,[(0,d._)("h1",$i,(0,d.zw)(e.modalTitle),1),Ri]),(0,d._)("div",Oi,[(0,d._)("div",Ti,[(0,d._)("div",ji,[(0,d._)("div",Mi,[(0,d._)("label",Ni,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",Bi,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.searchTerm2=t})},null,8,Di),[[d.nr,e.searchTerm2]])])]),(0,d._)("div",Fi,[(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("monthlyPRpageLang.download"),onClick:t[3]||(t[3]=function(t){return e.OutputExcelClick(e.modalTitle)})},qi,8,Ui)])]),Gi,(0,d.Wm)(i,{"is-static-mode":!0,isSlotMode:!0,hasCheckbox:!1,messages:e.table2.messages,columns:e.table2.columns,rows:e.table2.rows,total:e.table2.totalRecordCount,"page-options":e.table2.pageOptions,sortable:e.table2.sortable,"is-fixed-first-column":!1,onRowClicked:e.rowClicked},null,8,["messages","columns","rows","total","page-options","sortable","onRowClicked"])]),e.showFooter?((0,d.wg)(),(0,d.iD)("div",zi,[(0,d._)("button",{onClick:t[4]||(t[4]=function(){return e.sxb_reject&&e.sxb_reject.apply(e,arguments)}),type:"button",class:"btn btn-lg btn-danger",style:{"border-radius":"5px"}},(0,d.zw)(e.$t("monthlyPRpageLang.review_cancel")),1),(0,d._)("button",{onClick:t[5]||(t[5]=function(){return e.sxb_approve&&e.sxb_approve.apply(e,arguments)}),type:"button",class:"btn btn-lg btn-success",style:{"border-radius":"5px"}},(0,d.zw)(e.$t("monthlyPRpageLang.review_complete")),1)])):(0,d.kq)("",!0)])])])],64)}],["__scopeId","data-v-5f859c9f"]]);var rl=function(e){return(0,d.dD)("data-v-3ee34f82"),e=e(),(0,d.Cn)(),e},il={class:"card"},ll={class:"card-header"},sl={class:"card-body"},cl={class:"row justify-content-center mb-3"},ul={class:"col col-auto"},pl=["href"],dl=rl((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),fl={class:"col col-auto form-label"},gl=rl((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),hl={class:"col col-auto"},ml={key:0,class:"invalid-feedback d-block",role:"alert"},bl=rl((function(){return(0,d._)("div",{class:"w-100",style:{height:"2ch"}},null,-1)})),vl={class:"row justify-content-center"},yl={class:"card"},wl={class:"card-body"},xl={class:"row justify-content-between"},_l={class:"row col col-auto"},Cl={class:"col col-auto"},Ll={for:"pnInput",class:"col-form-label"},kl={class:"col col-6 p-0 m-0"},Pl=["placeholder"],Sl={class:"col col-auto"},Il={class:"fs-4"},Al=[rl((function(){return(0,d._)("i",{class:"bi bi-trash3-fill fs-4"},null,-1)}))],El=rl((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),$l={key:0,class:"invalid-feedback d-block",role:"alert"},Rl=rl((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Ol={class:"row justify-content-between align-items-center"},Tl={class:"form-label col col-auto"},jl=rl((function(){return(0,d._)("div",{class:"w-100",style:{height:"0ch"}},null,-1)})),Ml={class:"col col-auto"},Nl={class:"input-group"},Bl={style:{display:"none"},disabled:"",selected:"",value:""},Dl=["value"],Fl={class:"input-group-text input-group-text-lg",id:"emailTail"},Ul={class:"col col-auto"},ql=rl((function(){return(0,d._)("i",{class:"bi bi-envelope-check-fill"},null,-1)}));function Gl(e){return Gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gl(e)}function zl(){zl=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==Gl(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Hl(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Jl(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Hl(r,o,a,i,l,"next",e)}function l(e){Hl(r,o,a,i,l,"throw",e)}i(void 0)}))}}function Yl(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=(0,d.iH)(""),o=(0,d.iH)(""),a=((0,m.tv)(),function(){var t=Jl(zl().mark((function t(){var o,a;return zl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.value="",t.next=3,$().post("/getCurrentDB");case 3:return o=t.sent,t.prev=4,t.next=7,$().post("/api/month/allUC",{DB:o.data});case 7:a=t.sent,e.value=JSON.stringify(a.data),t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(4),console.log(t.t0),t.abrupt("return",t.t0);case 15:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(){return t.apply(this,arguments)}}()),r=function(){var t=Jl(zl().mark((function t(){var o,a;return zl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.value="",t.next=3,$().post("/getCurrentDB");case 3:return o=t.sent,t.prev=4,t.next=7,$().post("/api/month/rejectedUC",{DB:o.data});case 7:a=t.sent,e.value=JSON.stringify(a.data),t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(4),console.log(t.t0),t.abrupt("return",t.t0);case 15:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(){return t.apply(this,arguments)}}(),i=function(){var e=Jl(zl().mark((function e(){var o,a;return zl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return o=e.sent,e.prev=4,e.next=7,$().post("/api/month/checkersMail",{DB:o.data});case 7:return a=e.sent,t.value=JSON.stringify(a.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Jl(zl().mark((function e(t,a,r,i){var l,s,c;return zl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return l=e.sent,e.next=6,$().post("/getCurrentUsername");case 6:return s=e.sent,e.prev=7,e.next=10,$().post("/api/month/send_UC_to_DB",{DB:l.data,username:s.data,number:JSON.stringify(t),number90:JSON.stringify(a),consume:JSON.stringify(r),email:i});case 10:return c=e.sent,o.value=JSON.stringify(c.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 15:return e.prev=15,e.t0=e.catch(7),console.log(e.t0),e.abrupt("return",e.t0);case 19:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t,n,o,a){return e.apply(this,arguments)}}(),s=function(){var e=Jl(zl().mark((function e(t,a){var r,i;return zl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return r=e.sent,e.prev=4,e.next=7,$().post("/api/month/deleteUC",{DB:r.data,number:JSON.stringify(t),number90:JSON.stringify(a)});case 7:return i=e.sent,o.value=JSON.stringify(i.data),console.log(JSON.stringify(i.data)),e.abrupt("return",new Promise((function(e,t){e("success")})));case 13:return e.prev=13,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,n){return e.apply(this,arguments)}}();return{mats:e,mails:t,recordCount:o,getAll:a,getRejected:r,getCheckersMails:i,uploadToDB:l,deleteUC:s}}var Ql=n(9755);function Xl(e){return Xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xl(e)}function Zl(){Zl=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==Xl(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Vl(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Kl(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Vl(r,o,a,i,l,"next",e)}function l(e){Vl(r,o,a,i,l,"throw",e)}i(void 0)}))}}const Wl=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=(0,d.iH)(window.location.origin+"/download/ConsumeExample.xlsx"),t=(0,A.FN)(),n=document.getElementsByTagName("HTML")[0].getAttribute("lang");t.appContext.config.globalProperties.$lang.setLocale(n);var o=Yl(),a=o.mats,r=o.mails,i=o.recordCount,l=o.getRejected,s=o.getCheckersMails,c=o.uploadToDB,u=ja(),p=u.queryResult,f=(u.manualResult,u.validateISN);u.validateISN_manual;(0,A.wF)(s);var g,h=(0,d.iH)(!1),m=(0,d.iH)(!1),b=(0,d.iH)(""),v=(0,d.iH)(!1),y=(0,d.qj)([]),w=(0,d.iH)(),x=[],_=(0,d.iH)(""),C=(0,d.iH)(""),L=(0,d.qj)([]),k=function(e){for(var t=e.slice().sort(),n=[],o=0;o<t.length-1;o++)t[o+1]==t[o]&&n.push(t[o]);return n},P=function(){var e=Kl(Zl().mark((function e(){return Zl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:JSON.parse(a.value).datas.length<1?notyf.open({type:"warning",message:t.appContext.config.globalProperties.$t("monthlyPRpageLang.noload"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}):function(){for(var e=0;e<L.length;e++)L[e].doubleCheck&&L.splice(e,1);for(var n=JSON.parse(a.value),o=function(e){0==L.length?n.datas[e].id=0:n.datas[e].id=parseInt(L[L.length-1].id)+1,n.datas[e].doubleCheck=!0;var t=L.findIndex((function(t){return t.料號90===n.datas[e].料號90&&t.料號===n.datas[e].料號}));-1!=t&&L.splice(t,1),L.push(n.datas[e])},r=0;r<n.datas.length;r++)o(r);notyf.open({type:"success",message:t.appContext.config.globalProperties.$t("monthlyPRpageLang.total")+" "+n.datas.length+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.record")+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.loadsuccess"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}})}();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Kl(Zl().mark((function e(){var n;return Zl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m.value=!1,e.next=3,I();case 3:w.value?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==w.value.type||"application/vnd.ms-excel"==w.value.type||"application/vnd.ms-excel"==w.value.type||".csv"==w.value.type?((n=new FileReader).onload=function(){var e=Kl(Zl().mark((function e(n){var o,a,r,i,l,s;return Zl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.target.result,a=ue.ij(o,{type:"binary"}),r=a.SheetNames[0],i=a.Sheets[r],void 0!==(g=ue.P6.sheet_to_json(i,{header:1}))&&void 0!==g[0]&&void 0!==g[0][0]&&void 0!==g[0][1]&&void 0!==g[0][2]){e.next=10;break}h.value=!0,b.value=t.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors"),e.next=21;break;case 10:if("90料號"===g[0][0].trim()&&"料號"===g[0][1].trim()&&"單耗"===g[0][2].trim()){e.next=15;break}h.value=!0,b.value=t.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors"),e.next=21;break;case 15:for(l=Array(),s=1;s<g.length;s++)null!=g[s][1]&&g[s].length>2&&""!=g[s][0].trim()&&null!=g[s][0].trim()?l.push(g[s][1].trim()):(g.splice(s,1),s-=1);return e.next=19,I();case 19:return e.next=21,f(l);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.readAsBinaryString(w.value)):(h.value=!0,b.value=t.appContext.config.globalProperties.$t("validation.mimetypes")):(h.value=!0,b.value=t.appContext.config.globalProperties.$t("validation.required")),w.value=null,document.getElementById("excel_input").value="",Ql("body").loadingModal("hide"),Ql("body").loadingModal("destroy");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Kl(Zl().mark((function e(){return Zl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ql("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Kl(Zl().mark((function e(){var n,o,a,r,l,s,u,p,d,f,g,h,y;return Zl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:if(m.value=!1,n=0,o=!1,!(L.length<=0)){e.next=10;break}return notyf.open({type:"warning",message:t.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ql("body").loadingModal("hide"),Ql("body").loadingModal("destroy"),e.abrupt("return");case 10:for(a=0;a<L.length&&0==o;a++)""!==L[a].月請購&&null!==L[a].月請購&&"null"!==L[a].月請購.toLowerCase()||(o=!0,n=a);if(!o){e.next=18;break}return m.value=!0,b.value=L[n].料號+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.noisn"),notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ql("body").loadingModal("hide"),Ql("body").loadingModal("destroy"),e.abrupt("return");case 18:for(r=Array(),l=0;l<L.length;l++)null!=L[l].料號&&""!=L[l].料號.trim()&&r.push(L[l].料號.toString().trim()+"_"+L[l].料號90.toString().trim());if(!((s=k(r)).length>0)){e.next=28;break}return m.value=!0,b.value=t.appContext.config.globalProperties.$t("inboundpageLang.repeated_isn_90_pair")+" : "+s[0].split("_")[0]+" ("+s[0].split("_")[1]+")",notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ql("body").loadingModal("hide"),Ql("body").loadingModal("destroy"),e.abrupt("return");case 28:for(u=[],p=[],d=[],f=0;f<L.length;f++)u.push(L[f].料號),p.push(L[f].料號90),d.push(L[f].單耗);return g=Date.now(),e.next=35,c(u,p,d,C.value);case 35:h=e.sent,y=Date.now()-g,console.log("Total time taken : "+y+" milliseconds"),Ql("body").loadingModal("hide"),Ql("body").loadingModal("destroy"),"success"===h?(v.value=!1,notyf.open({type:"success",message:t.appContext.config.globalProperties.$t("monthlyPRpageLang.total")+" "+JSON.parse(i.value).record+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.record")+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}})):notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});case 41:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,A.YP)(p,Kl(Zl().mark((function e(){var t,n,o,a;return Zl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:if(""!=p.value){e.next=7;break}return Ql("body").loadingModal("hide"),Ql("body").loadingModal("destroy"),$.isLoading=!1,e.abrupt("return");case 7:for(t=JSON.parse(p.value),n={},o=1;o<g.length;o++)n.料號90=g[o][0].toString().trim(),n.料號=g[o][1].toString().trim(),n.單耗=g[o][2],n.doubleCheck=!1,0==L.length?n.id=0:n.id=parseInt(L[L.length-1].id)+1,-1!=(a=t.data.findIndex((function(e){return e.料號===n.料號})))?n=Object.assign(n,t.data[a]):n.月請購="",L.push(n),n={};Ql("body").loadingModal("hide"),Ql("body").loadingModal("destroy"),$.isLoading=!1;case 13:case"end":return e.stop()}}),e)})))),(0,A.YP)(r,Kl(Zl().mark((function e(){var t,n;return Zl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=JSON.parse(r.value),n=0;n<t.data.length;n++)y.push(t.data[n]);$.isLoading=!1;case 3:case"end":return e.stop()}}),e)})))),(0,A.YP)(C,(function(){null!=C.value&&""!=C.value&&null!=C.value&&(v.value=!0)})),(0,A.YP)(L,(function(){document.getElementsByClassName("vtl-table")[0].scrollIntoView({behavior:"smooth"})}));var $=(0,d.qj)({isLoading:!0,columns:[{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return""===e.月請購||null===e.月請購||"null"===e.月請購.toLowerCase()?'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap text-danger CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>":e.doubleCheck?'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%; color: #e67300;">'+e.料號+"</div>":'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.90isn"),field:"料號90",width:"14ch",sortable:!0,display:function(e,t){return""===e.月請購||null===e.月請購||"null"===e.月請購.toLowerCase()?'<input type="hidden" id="number90'+t+'" name="number90'+t+'" value="'+e.料號90+'"><div class="text-nowrap text-danger CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號90+"</div>":e.doubleCheck?'<input type="hidden" id="number90'+t+'" name="number90'+t+'" value="'+e.料號90+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%; color: #e67300;">'+e.料號90+"</div>":'<input type="hidden" id="number90'+t+'" name="number90'+t+'" value="'+e.料號90+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號90+"</div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.consume"),field:"單耗",width:"13ch",sortable:!0,hasInput:function(e,t){return'<input style="width:10ch; display:inline;" type="number" oninput="ScientificNotaionToFixed(this)" id="unitConsumption'+e.id+'" name="unitConsumption'+e.id+'" value="'+(n=e.單耗,Math.abs(n)<1?(o=parseInt(n.toString().split("e-")[1]))&&(n*=Math.pow(10,o-1),n="0."+new Array(o).join("0")+n.toString().substring(2)):(o=parseInt(n.toString().split("+")[1]))>20&&(o-=20,n/=Math.pow(10,o),n+=new Array(o+1).join("0")),n+'" class="form-control text-center p-0 m-0" step="0.000001">&nbsp;<small>')+e.單位+"</small>";var n,o}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,n){return""===e.月請購||null===e.月請購||"null"===e.月請購.toLowerCase()?'<input type="hidden" id="name'+n+'" name="name'+n+'" value="'+e.品名+'"><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+t.appContext.config.globalProperties.$t("monthlyPRpageLang.noisn")+"</div>":'<input type="hidden" id="name'+n+'" name="name'+n+'" value="'+e.品名+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.format"),field:"規格",width:"14ch",sortable:!0,display:function(e,n){return""===e.月請購||null===e.月請購||"null"===e.月請購.toLowerCase()?'<input type="hidden" id="format'+n+'" name="format'+n+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar text-danger" style="overflow-x: auto; width: 100%;">'+t.appContext.config.globalProperties.$t("monthlyPRpageLang.noisn")+"</div>":'<input type="hidden" id="format'+n+'" name="format'+n+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.lt"),field:"LT",width:"8ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="lt'+t+'" name="lt'+t+'" value="'+Math.round(e.LT)+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+Math.round(e.LT)+"</div>"}}],rows:(0,d.Fl)((function(){return L.filter((function(e){return e.料號.toLowerCase().includes(_.value.toLowerCase())||e.品名.includes(_.value)}))})),totalRecordCount:(0,d.Fl)((function(){return $.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:t.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+t.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+t.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+t.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:t.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:t.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:t.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{exampleUrl:e,isInvalid:h,isInvalid_DB:m,validation_err_msg:b,uploadToDBReady:v,searchTerm:_,table:$,all_mails:y,selected_mail:C,updateCheckedRows:function(e){x=e},rowUserInput:function(e,t){L[e.id].單耗=document.getElementById("unitConsumption"+e.id).value},addRejectedToTable:P,onUploadClick:S,onInputChange:function(e){h.value=!1,p.value="",w.value=e.target.files?e.target.files[0]:null},onSendToDBClick:E,deleteRow:function(){for(var e=function(e){var t=L.findIndex((function(t){return parseInt(t.id)===parseInt(x[e].id)}));-1!=t&&L.splice(t,1)},t=0;t<x.length;t++)e(t);document.querySelectorAll(".vtl-tbody-checkbox").forEach((function(e){return e.checked=!1})),document.querySelector(".vtl-thead-checkbox").checked&&document.querySelector(".vtl-thead-checkbox").click(),x=[]}}}});var es=n(9875),ts={insert:"head",singleton:!1};bt()(es.Z,ts);es.Z.locals;const ns=(0,w.Z)(Wl,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",il,[(0,d._)("div",ll,[(0,d._)("h3",null,(0,d.zw)(e.$t("monthlyPRpageLang.isnConsumeAdd")),1)]),(0,d._)("div",sl,[(0,d._)("div",cl,[(0,d._)("div",ul,[(0,d._)("a",{href:e.exampleUrl,download:""},(0,d.zw)(e.$t("monthlyPRpageLang.exampleExcel")),9,pl)]),dl,(0,d._)("label",fl,(0,d.zw)(e.$t("monthlyPRpageLang.plz_upload")),1),gl,(0,d._)("div",hl,[(0,d._)("input",{class:(0,d.C_)(["form-control",{"is-invalid":e.isInvalid}]),id:"excel_input",type:"file",name:"select_file",onChange:t[0]||(t[0]=function(){return e.onInputChange&&e.onInputChange.apply(e,arguments)})},null,34),e.isInvalid?((0,d.wg)(),(0,d.iD)("span",ml,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0)]),bl,(0,d._)("div",vl,[(0,d._)("button",{type:"submit",name:"upload",class:"col col-auto btn btn-lg btn-primary",onClick:t[1]||(t[1]=function(){return e.onUploadClick&&e.onUploadClick.apply(e,arguments)})},(0,d.zw)(e.$t("monthlyPRpageLang.upload1")),1)])])])]),(0,d._)("div",yl,[(0,d._)("div",wl,[(0,d._)("div",xl,[(0,d._)("div",_l,[(0,d._)("div",Cl,[(0,d._)("label",Ll,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",kl,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.searchTerm=t})},null,8,Pl),[[d.nr,e.searchTerm]])])]),(0,d._)("div",Sl,[(0,d._)("button",{class:"col col-auto btn btn-lg btn-warning",onClick:t[3]||(t[3]=function(){return e.addRejectedToTable&&e.addRejectedToTable.apply(e,arguments)})},[(0,d._)("span",Il,(0,d.zw)(e.$t("monthlyPRpageLang.loadconsume")),1)]),(0,d.Uk)("   "),(0,d._)("button",{id:"delete",name:"delete",class:"col col-auto btn btn-lg btn-danger",onClick:t[4]||(t[4]=function(){return e.deleteRow&&e.deleteRow.apply(e,arguments)})},Al)])]),El,e.isInvalid_DB?((0,d.wg)(),(0,d.iD)("span",$l,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0),(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!0,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[5]||(t[5]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows,onRowInput:e.rowUserInput},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows","onRowInput"]),Rl,(0,d._)("div",Ol,[(0,d._)("label",Tl,(0,d.zw)(e.$t("monthlyPRpageLang.surepeopleemail"))+":",1),jl,(0,d._)("div",Ml,[(0,d._)("div",Nl,[(0,d.wy)((0,d._)("select",{class:"form-select form-select-lg col col-auto text-center","onUpdate:modelValue":t[6]||(t[6]=function(t){return e.selected_mail=t})},[(0,d._)("option",Bl,(0,d.zw)(e.$t("monthlyPRpageLang.noemail")),1),((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.all_mails,(function(e){return(0,d.wg)(),(0,d.iD)("option",{value:e.email},(0,d.zw)(e.姓名),9,Dl)})),256))],512),[[d.bM,e.selected_mail]]),(0,d._)("span",Fl,(0,d.zw)(e.selected_mail),1)])]),(0,d._)("div",Ul,[e.uploadToDBReady?((0,d.wg)(),(0,d.iD)("button",{key:0,name:"upload",class:"col col-auto fs-3 text-center btn btn-lg btn-info",onClick:t[7]||(t[7]=function(){return e.onSendToDBClick&&e.onSendToDBClick.apply(e,arguments)})},[ql,(0,d.Uk)(" "+(0,d.zw)(e.$t("monthlyPRpageLang.submit")),1)])):(0,d.kq)("",!0)])])])])],64)}],["__scopeId","data-v-3ee34f82"]]);var os=function(e){return(0,d.dD)("data-v-3cc05342"),e=e(),(0,d.Cn)(),e},as={class:"card"},rs={class:"card-header"},is={class:"card-body"},ls={class:"row justify-content-between"},ss={class:"row col col-auto"},cs={class:"col col-auto"},us={for:"pnInput",class:"col-form-label"},ps={class:"col col-6 p-0 m-0"},ds=["placeholder"],fs={class:"col col-auto"},gs=[os((function(){return(0,d._)("i",{class:"bi bi-trash3-fill fs-4"},null,-1)}))],hs=["value"],ms=[os((function(){return(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill fs-4"},null,-1)}))],bs=os((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),vs={key:0,class:"invalid-feedback d-block",role:"alert"},ys=["id","name","value","onUpdate:modelValue"],ws=os((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),xs={class:"row justify-content-between align-items-center"},_s={class:"form-label col col-auto"},Cs=os((function(){return(0,d._)("div",{class:"w-100",style:{height:"0ch"}},null,-1)})),Ls={class:"col col-auto"},ks={class:"input-group"},Ps={style:{display:"none"},disabled:"",selected:"",value:""},Ss=["value"],Is={class:"input-group-text input-group-text-lg",id:"emailTail"},As={class:"col col-auto"},Es=os((function(){return(0,d._)("i",{class:"bi bi-envelope-check-fill"},null,-1)}));var $s=n(9755);function Rs(e){return Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rs(e)}function Os(){Os=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==Rs(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Ts(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function js(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Ts(r,o,a,i,l,"next",e)}function l(e){Ts(r,o,a,i,l,"throw",e)}i(void 0)}))}}const Ms=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){(0,d.iH)(window.location.origin+"/download/ConsumeExample.xlsx");var e=(0,A.FN)(),t=document.getElementsByTagName("HTML")[0].getAttribute("lang");e.appContext.config.globalProperties.$lang.setLocale(t);var n=Yl(),o=n.mats,a=n.mails,r=n.recordCount,i=n.getAll,l=n.getCheckersMails,s=n.uploadToDB,c=n.deleteUC;(0,A.wF)(js(Os().mark((function e(){return Os().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:return e.next=4,i();case 4:case"end":return e.stop()}}),e)}))));var u=(0,d.iH)(!1),p=(0,d.iH)(!1),f=(0,d.iH)(""),g=(0,d.iH)(!1),h=(0,d.qj)([]),m=((0,d.iH)(),[]),b=(0,d.iH)(""),v=(0,d.iH)(""),y=(0,d.qj)([]),w=function(){var t=js(Os().mark((function t(){var n,o,a,r,l,s,c,u,p;return Os().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:return t.next=4,i();case 4:for(n=new Date,o=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0"),r=n.getFullYear(),n=r+"_"+a+"_"+o,l=Array(),s=0;s<y.length;s++)(c=new Object)[e.appContext.config.globalProperties.$t("monthlyPRpageLang.isn")]=y[s].料號,c[e.appContext.config.globalProperties.$t("monthlyPRpageLang.90isn")]=y[s].料號90,c[e.appContext.config.globalProperties.$t("monthlyPRpageLang.pName")]=y[s].品名,c[e.appContext.config.globalProperties.$t("monthlyPRpageLang.format")]=y[s].規格,c[e.appContext.config.globalProperties.$t("monthlyPRpageLang.consume")]=y[s].單耗,c[e.appContext.config.globalProperties.$t("monthlyPRpageLang.email")]=y[s].畫押信箱,"已完成"===y[s].狀態?c[e.appContext.config.globalProperties.$t("monthlyPRpageLang.status")]=e.appContext.config.globalProperties.$t("monthlyPRpageLang.review_complete"):c[e.appContext.config.globalProperties.$t("monthlyPRpageLang.status")]=e.appContext.config.globalProperties.$t("monthlyPRpageLang.review_pending"),l.push(c);u=ue.P6.json_to_sheet(l),p=ue.P6.book_new(),ue.P6.book_append_sheet(p,u,e.appContext.config.globalProperties.$t("monthlyPRpageLang.consume")),ue.NC(p,e.appContext.config.globalProperties.$t("monthlyPRpageLang.consume")+"_"+n+".xlsx",{compression:!0}),$s("body").loadingModal("hide"),$s("body").loadingModal("destroy");case 17:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),x=function(){var e=js(Os().mark((function e(){return Os().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $s("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var t=js(Os().mark((function t(){var n,o,a,i,l;return Os().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:for(n=[],o=[],a=0;a<m.length;a++)n.push(m[a].料號),o.push(m[a].料號90);return t.next=7,c(n,o);case 7:if("success"===t.sent){for(notyf.open({type:"success",message:e.appContext.config.globalProperties.$t("monthlyPRpageLang.total")+" "+JSON.parse(r.value).record+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.record")+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.delete")+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),i=function(e){var t=y.findIndex((function(t){return parseInt(t.id)===parseInt(m[e].id)}));-1!=t&&y.splice(t,1)},l=0;l<m.length;l++)i(l);document.querySelectorAll(".vtl-tbody-checkbox").forEach((function(e){return e.checked=!1})),document.querySelector(".vtl-thead-checkbox").checked&&document.querySelector(".vtl-thead-checkbox").click(),m=[]}else notyf.open({type:"error",message:e.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});$s("body").loadingModal("hide"),$s("body").loadingModal("destroy");case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),C=function(){var t=js(Os().mark((function t(){var n,o,a,l,c,u,d;return Os().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:if(p.value=!1,0,!1,!(m.length<=0)){t.next=10;break}return notyf.open({type:"warning",message:e.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),$s("body").loadingModal("hide"),$s("body").loadingModal("destroy"),t.abrupt("return");case 10:for(n=[],o=[],a=[],l=0;l<m.length;l++)n.push(m[l].料號),o.push(m[l].料號90),a.push(m[l].單耗.toString());return c=Date.now(),t.next=17,s(n,o,a,v.value);case 17:return u=t.sent,d=Date.now()-c,console.log("Total time taken : "+d+" milliseconds"),$s("body").loadingModal("hide"),$s("body").loadingModal("destroy"),t.next=24,i();case 24:"success"===u?notyf.open({type:"success",message:e.appContext.config.globalProperties.$t("monthlyPRpageLang.total")+" "+JSON.parse(r.value).record+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.record")+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}):notyf.open({type:"error",message:e.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});case 25:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,A.YP)(o,js(Os().mark((function e(){var t,n,a;return Os().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:if(y.splice(0),g.value=!1,v.value="",""!=o.value){e.next=9;break}return $s("body").loadingModal("hide"),$s("body").loadingModal("destroy"),e.abrupt("return");case 9:for(t=JSON.parse(o.value),n={},a=0;a<t.data.length;a++)(n=t.data[a]).id=a,y.push(n),n={};$s("body").loadingModal("hide"),$s("body").loadingModal("destroy"),L.isLoading=!1;case 15:case"end":return e.stop()}}),e)})))),(0,A.YP)(a,js(Os().mark((function e(){var t,n;return Os().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=JSON.parse(a.value),n=0;n<t.data.length;n++)h.push(t.data[n]);case 2:case"end":return e.stop()}}),e)})))),(0,A.YP)(v,(function(){null!=v.value&&""!=v.value&&null!=v.value&&(g.value=!0)}));var L=(0,d.qj)({isLoading:!0,columns:[{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.90isn"),field:"料號90",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="number90'+t+'" name="number90'+t+'" value="'+e.料號90+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號90+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.consume"),field:"單耗",width:"12ch",sortable:!0},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.pName"),field:"品名",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.format"),field:"規格",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto !important; width: 100%; -ms-overflow-style: none !important;">'+e.規格+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.surepeopleemail"),field:"畫押信箱",width:"13ch",sortable:!0,display:function(e,t){return'<div class="text-nowrap CustomScrollbar" style="overflow-x: auto !important; width: 100%; -ms-overflow-style: none !important;">'+e.畫押信箱+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.remark"),field:"狀態",width:"8ch",sortable:!0,display:function(t,n){return"已完成"===t.狀態?'<div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.appContext.config.globalProperties.$t("monthlyPRpageLang.review_complete")+"</div>":'<div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.appContext.config.globalProperties.$t("monthlyPRpageLang.review_pending")+"</div>"}}],rows:(0,d.Fl)((function(){return y.filter((function(e){return e.料號.toLowerCase().includes(b.value.toLowerCase())||e.料號90.toLowerCase().includes(b.value.toLowerCase())||e.品名.includes(b.value)}))})),rowClasses:function(e){return"已完成"===e.狀態?["table-success"]:["table-danger"]},totalRecordCount:(0,d.Fl)((function(){return L.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:e.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+e.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+e.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+e.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:e.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:e.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:e.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{isInvalid:u,isInvalid_DB:p,validation_err_msg:f,uploadToDBReady:g,searchTerm:b,table:L,all_mails:h,selected_mail:v,updateCheckedRows:function(e){m=e},rowUserInput:function(e,t){y[e.id].單耗=document.getElementById("unitConsumption"+e.id).value},onSendToDBClick:C,deleteRow:_,ScientificNotaionToFixed:function(e){var t;return Math.abs(e)<1?(t=parseInt(e.toString().split("e-")[1]))&&(e*=Math.pow(10,t-1),e="0."+new Array(t).join("0")+e.toString().substring(2)):(t=parseInt(e.toString().split("+")[1]))>20&&(t-=20,e/=Math.pow(10,t),e+=new Array(t+1).join("0")),e},CheckCurrentRow:function(e){e.target.closest("tr").firstChild.firstChild.checked||e.target.closest("tr").firstChild.firstChild.click()},OutputExcelClick:w}}});var Ns=n(8667),Bs={insert:"head",singleton:!1};bt()(Ns.Z,Bs);Ns.Z.locals;const Ds=(0,w.Z)(Ms,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)("div",as,[(0,d._)("div",rs,[(0,d._)("h3",null,(0,d.zw)(e.$t("monthlyPRpageLang.isnConsumeUpdate")),1)]),(0,d._)("div",is,[(0,d._)("div",ls,[(0,d._)("div",ss,[(0,d._)("div",cs,[(0,d._)("label",us,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",ps,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_90pn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,ds),[[d.nr,e.searchTerm]])])]),(0,d._)("div",fs,[(0,d._)("button",{type:"submit",id:"delete",name:"delete",class:"col col-auto btn btn-lg btn-danger",onClick:t[1]||(t[1]=function(){return e.deleteRow&&e.deleteRow.apply(e,arguments)})},gs),(0,d.Uk)("   "),(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("monthlyPRpageLang.download"),onClick:t[2]||(t[2]=function(){return e.OutputExcelClick&&e.OutputExcelClick.apply(e,arguments)})},ms,8,hs)])]),bs,e.isInvalid_DB?((0,d.wg)(),(0,d.iD)("span",vs,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0),(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,isSlotMode:!0,hasCheckbox:!0,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,rowClasses:e.table.rowClasses,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[4]||(t[4]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows,onRowInput:e.rowUserInput},{單耗:(0,d.w5)((function(n){var o=n.row;n.key;return[(0,d.wy)((0,d._)("input",{style:{width:"13ch"},type:"number",id:"unitConsumption"+o.id,name:"unitConsumption"+o.id,value:e.ScientificNotaionToFixed(parseFloat(o.單耗)),"onUpdate:modelValue":function(e){return o.單耗=e},onInput:t[3]||(t[3]=function(t){return e.CheckCurrentRow(t)}),class:"form-control text-center p-0 m-0",step:"0.000001",min:"0"},null,40,ys),[[d.nr,o.單耗]])]})),_:1},8,["isLoading","messages","columns","rows","rowClasses","total","page-options","sortable","onReturnCheckedRows","onRowInput"]),ws,(0,d._)("div",xs,[(0,d._)("label",_s,(0,d.zw)(e.$t("monthlyPRpageLang.surepeopleemail"))+":",1),Cs,(0,d._)("div",Ls,[(0,d._)("div",ks,[(0,d.wy)((0,d._)("select",{class:"form-select form-select-lg col col-auto text-center","onUpdate:modelValue":t[5]||(t[5]=function(t){return e.selected_mail=t})},[(0,d._)("option",Ps,(0,d.zw)(e.$t("monthlyPRpageLang.noemail")),1),((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.all_mails,(function(e){return(0,d.wg)(),(0,d.iD)("option",{value:e.email},(0,d.zw)(e.姓名),9,Ss)})),256))],512),[[d.bM,e.selected_mail]]),(0,d._)("span",Is,(0,d.zw)(e.selected_mail),1)])]),(0,d._)("div",As,[e.uploadToDBReady?((0,d.wg)(),(0,d.iD)("button",{key:0,name:"upload",class:"col col-auto fs-3 text-center btn btn-lg btn-info",onClick:t[6]||(t[6]=function(){return e.onSendToDBClick&&e.onSendToDBClick.apply(e,arguments)})},[Es,(0,d.Uk)(" "+(0,d.zw)(e.$t("monthlyPRpageLang.submit")),1)])):(0,d.kq)("",!0)])])])])}],["__scopeId","data-v-3cc05342"]]);var Fs={class:"flip-card",ref:"detectclasschange"},Us={class:"flip-card-inner row w-100"},qs={class:"flip-card-front col col-12",id:"cardFront"},Gs={class:"flip-card-back col col-12",id:"cardBack"};var zs=function(e){return(0,d.dD)("data-v-62fd8e97"),e=e(),(0,d.Cn)(),e},Hs={class:"card"},Js={class:"card-header"},Ys={class:"row"},Qs={class:"col col-auto m-0"},Xs=zs((function(){return(0,d._)("i",{class:"bi bi-arrow-left-right"},null,-1)})),Zs={class:"card-body"},Vs={class:"row justify-content-center mb-3"},Ks={class:"col col-auto"},Ws=["href"],ec=zs((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),tc={class:"col col-auto form-label"},nc=zs((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),oc={class:"col col-auto"},ac={key:0,class:"invalid-feedback d-block",role:"alert"},rc=zs((function(){return(0,d._)("div",{class:"w-100",style:{height:"2ch"}},null,-1)})),ic={class:"row justify-content-center"},lc=zs((function(){return(0,d._)("button",{id:"togglebtn",class:"btn btn-primary col col-auto",type:"button","data-bs-toggle":"collapse","data-bs-target":"#importedtable","aria-expanded":"false","aria-controls":"importedtable",style:{display:"none"}},null,-1)})),sc={class:"card collapse",id:"importedtable"},cc={class:"card-body"},uc={class:"row justify-content-between"},pc={class:"row col col-auto"},dc={class:"col col-auto"},fc={for:"pnInput1",class:"col-form-label"},gc={class:"col col-auto p-0 m-0"},hc=["placeholder"],mc={class:"col col-auto"},bc=["value"],vc=[zs((function(){return(0,d._)("i",{class:"bi bi-trash3-fill fs-4"},null,-1)}))],yc=zs((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),wc={key:0,class:"invalid-feedback d-block",role:"alert"},xc=zs((function(){return(0,d._)("div",{class:"w-100",style:{height:"2ch"}},null,-1)})),_c={class:"row justify-content-center"},Cc={class:"col col-auto"},Lc=zs((function(){return(0,d._)("i",{class:"bi bi-cloud-upload-fill"},null,-1)}));function kc(e){return kc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kc(e)}function Pc(){Pc=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==kc(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Sc(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Ic(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Sc(r,o,a,i,l,"next",e)}function l(e){Sc(r,o,a,i,l,"throw",e)}i(void 0)}))}}function Ac(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=(0,d.iH)(""),o=(0,d.iH)(""),a=((0,m.tv)(),function(){var e=Ic(Pc().mark((function e(o,a){var r,i;return Pc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return r=e.sent,e.prev=4,e.next=7,$().post("/api/month/validateUC",{DB:r.data,number:JSON.stringify(o),number90:JSON.stringify(a)});case 7:return i=e.sent,t.value=JSON.stringify(i.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,n){return e.apply(this,arguments)}}()),r=function(){var t=Ic(Pc().mark((function t(){var o,a;return Pc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.value="",t.next=3,$().post("/getCurrentDB");case 3:return o=t.sent,t.prev=4,t.next=7,$().post("/api/month/mps",{DB:o.data});case 7:return a=t.sent,e.value=JSON.stringify(a.data),t.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return t.prev=12,t.t0=t.catch(4),console.log(t.t0),t.abrupt("return",t.t0);case 16:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(){return t.apply(this,arguments)}}(),i=function(){var e=Ic(Pc().mark((function e(t,o){var a,r;return Pc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return a=e.sent,e.prev=4,e.next=7,$().post("/api/month/delete_mps",{DB:a.data,isn90:JSON.stringify(t),isn:JSON.stringify(o)});case 7:return r=e.sent,console.log(r.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=Ic(Pc().mark((function e(t){var o,a;return Pc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return o=e.sent,e.prev=4,e.next=7,$().post("/api/month/delete_nonmps",{DB:o.data,number:JSON.stringify(t)});case 7:return a=e.sent,console.log(a.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}(),s=function(){var t=Ic(Pc().mark((function t(){var o,a,r;return Pc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.value="",t.next=3,$().post("/getCurrentDB");case 3:return o=t.sent,sessionStorage.getItem("notmonthclient"),sessionStorage.getItem("notmonthisn"),t.prev=6,t.next=9,$().post("/api/month/notmonth",{DB:o.data});case 9:return a=t.sent,e.value=JSON.stringify(a.data),t.abrupt("return",new Promise((function(e,t){e("success")})));case 14:for(r in t.prev=14,t.t0=t.catch(6),console.log(t.t0),t.t0.response.data.errors)n.value+=t.t0.response.data.errors[r][0]+"  ";console.log(n.value);case 19:case"end":return t.stop()}}),t,null,[[6,14]])})));return function(){return t.apply(this,arguments)}}(),c=function(){var e=Ic(Pc().mark((function e(t,o,a,r,i,l){var s,c;return Pc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return s=e.sent,e.prev=4,e.next=7,$().post("/api/month/submit_monthlypr",{DB:s.data,number:JSON.stringify(t),number90:JSON.stringify(o),nextmps:JSON.stringify(a),nextday:JSON.stringify(r),nowmps:JSON.stringify(i),nowday:JSON.stringify(l)});case 7:return c=e.sent,console.log(c.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,n,o,a,r,i){return e.apply(this,arguments)}}(),u=function(){var e=Ic(Pc().mark((function e(t,o,a,r,i){var l,s;return Pc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return l=e.sent,e.prev=4,e.next=7,$().post("/api/month/submit_nonmonthlypr",{DB:l.data,number:JSON.stringify(t),thisdemand:JSON.stringify(o),nextdemand:JSON.stringify(a),amount:JSON.stringify(r),desc:JSON.stringify(i)});case 7:return s=e.sent,console.log(s.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),e.abrupt("return",e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,n,o,a,r){return e.apply(this,arguments)}}(),p=function(){var e=Ic(Pc().mark((function e(){var t,n;return Pc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$().post("/getCurrentDB");case 2:return t=e.sent,e.prev=3,e.next=6,$().post("/api/month/getCurrency",{DB:t.data});case 6:return'""'===(n=e.sent).data.data?o.value="Not Found":o.value=JSON.parse(JSON.parse(n.data.data)),e.abrupt("return",new Promise((function(e,t){e("success")})));case 11:return e.prev=11,e.t0=e.catch(3),console.log(e.t0),e.abrupt("return",e.t0);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(){return e.apply(this,arguments)}}(),f=function(){var t=Ic(Pc().mark((function t(){var n,o;return Pc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$().post("/getCurrentDB");case 2:return n=t.sent,t.prev=3,t.next=6,$().post("/api/month/generate_buylist",{DB:n.data});case 6:return o=t.sent,e.value=JSON.stringify(o.data),t.abrupt("return",new Promise((function(e,t){e("success")})));case 11:return t.prev=11,t.t0=t.catch(3),console.log(t.t0),t.abrupt("return",t.t0);case 15:case"end":return t.stop()}}),t,null,[[3,11]])})));return function(){return t.apply(this,arguments)}}(),g=function(){var e=Ic(Pc().mark((function e(t,o,a,r,i,l,s,c,u,p,d,f,g){var h,m,b;return Pc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return h=e.sent,e.next=6,$().post("/getCurrentUser");case 6:return m=e.sent,e.prev=7,e.next=10,$().post("/api/month/sendPRMail",{DB:h.data,User:m.data,PN:JSON.stringify(t),pName:JSON.stringify(o),Spec:JSON.stringify(a),Unit_price:JSON.stringify(r),nowNeed:JSON.stringify(i),nextNeed:JSON.stringify(l),Stock:JSON.stringify(s),in_Transit:JSON.stringify(c),ReqAmount:JSON.stringify(u),total_price1:JSON.stringify(p),currency_name:JSON.stringify(d),total_price2:JSON.stringify(f),MOQ:JSON.stringify(g)});case 10:return b=e.sent,console.log(b.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 15:return e.prev=15,e.t0=e.catch(7),console.log(e.t0),e.abrupt("return",e.t0);case 19:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t,n,o,a,r,i,l,s,c,u,p,d,f){return e.apply(this,arguments)}}(),h=function(){var e=Ic(Pc().mark((function e(t,o,a,r,i,l,s,c,u,p,d,f,g,h,m,b){var v,y,w;return Pc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return v=e.sent,e.next=6,$().post("/getCurrentUser");case 6:return y=e.sent,e.prev=7,e.next=10,$().post("/api/month/submit_buylist",{DB:v.data,User:y.data,PN:JSON.stringify(t),pName:JSON.stringify(o),Spec:JSON.stringify(a),Unit_price:JSON.stringify(r),nowNeed:JSON.stringify(i),nextNeed:JSON.stringify(l),Stock:JSON.stringify(s),in_Transit:JSON.stringify(c),ReqAmount:JSON.stringify(u),total_price1:JSON.stringify(p),currency_name:JSON.stringify(d),total_price2:JSON.stringify(f),MOQ:JSON.stringify(g),nonMPS_PN_Array:JSON.stringify(h),MPS_PN_Array:JSON.stringify(b),MPS_90PN_Array:JSON.stringify(m)});case 10:return w=e.sent,console.log(w.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 15:return e.prev=15,e.t0=e.catch(7),console.log(e.t0),e.abrupt("return",e.t0);case 19:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t,n,o,a,r,i,l,s,c,u,p,d,f,g,h,m){return e.apply(this,arguments)}}();return{mats:e,uc:t,Currency:o,validate_UnitConsume:a,getMats_MPS:r,deleteMPS:i,getMats_nonMonthly:s,deleteNonMPS:l,uploadMonthlyToDB:c,uploadNonMonthlyToDB:u,getCurrency:p,getMats_Buylist:f,sendBuylistMail:g,submitBuylist:h}}var Ec=n(9755);function $c(e){return $c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$c(e)}function Rc(){Rc=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==$c(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Oc(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Tc(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Oc(r,o,a,i,l,"next",e)}function l(e){Oc(r,o,a,i,l,"throw",e)}i(void 0)}))}}const jc=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=(0,d.iH)(window.location.origin+"/download/ImportMonthExample.xlsx"),t=(0,A.FN)(),n=document.getElementsByTagName("HTML")[0].getAttribute("lang");t.appContext.config.globalProperties.$lang.setLocale(n);var o,a=Ac(),r=a.mats,i=a.uc,l=a.uploadMonthlyToDB,s=a.validate_UnitConsume,c=ja(),u=c.queryResult,p=c.validateISN,f=(0,d.iH)(!1),g=(0,d.iH)(!1),h=(0,d.iH)(""),m=(0,d.iH)(!1),b=(0,d.iH)(),v=[],y=function(e){for(var t=e.slice().sort(),n=[],o=0;o<t.length-1;o++)t[o+1]==t[o]&&n.push(t[o]);return n},w=function(){var e=Tc(Rc().mark((function e(){var n;return Rc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g.value=!1,r.value="",e.next=4,C();case 4:b.value?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==b.value.type||"application/vnd.ms-excel"==b.value.type||"application/vnd.ms-excel"==b.value.type||".csv"==b.value.type?((n=new FileReader).onload=function(){var e=Tc(Rc().mark((function e(n){var a,r,i,l,c,u,d;return Rc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.target.result,r=ue.ij(a,{type:"binary"}),i=r.SheetNames[0],l=r.Sheets[i],void 0!==(o=ue.P6.sheet_to_json(l,{header:1}))&&void 0!==o[0]&&void 0!==o[0][0]&&void 0!==o[0][1]&&void 0!==o[0][2]){e.next=10;break}f.value=!0,h.value=t.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors"),e.next=24;break;case 10:if("90料號"===o[0][0].toString().trim()&&"料號"===o[0][1].toString().trim()&&o[0][2].toString().trim().toLowerCase().includes("mps")){e.next=15;break}f.value=!0,h.value=t.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors"),e.next=24;break;case 15:for(c=Array(),u=Array(),d=1;d<o.length;d++)null!=o[d][0]&&o[d].length>2&&""!=o[d][0].toString().trim()&&null!=o[d][0].toString().trim()?(c.push(o[d][1].toString().trim()),u.push(o[d][0].toString().trim())):(o.splice(d,1),d-=1);return e.next=20,C();case 20:return e.next=22,p(c);case 22:return e.next=24,s(c,u);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.readAsBinaryString(b.value)):(f.value=!0,h.value=t.appContext.config.globalProperties.$t("validation.mimetypes")):(f.value=!0,h.value=t.appContext.config.globalProperties.$t("validation.required")),b.value=null,document.getElementById("excel_input").value="",Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=(0,d.iH)(""),_=(0,d.qj)([]),C=function(){var e=Tc(Rc().mark((function e(){return Rc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ec("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Tc(Rc().mark((function e(){var n,o,a,r,i,s,c,u,p,d,f,b,v,w,x,L,k,P,S,I;return Rc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:if(g.value=!1,n=0,o=!1,!(_.length<=0)){e.next=10;break}return notyf.open({type:"warning",message:t.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy"),e.abrupt("return");case 10:for(a=0;a<_.length&&0==o;a++)""!==_[a].月請購&&null!==_[a].月請購&&"null"!==_[a].月請購.toLowerCase()||(o=!0,n=a);if(!o){e.next=18;break}return g.value=!0,h.value="Excel "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.row")+" "+_[n].excel_row_num+" ("+_[n].料號+") "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.noisn"),notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy"),e.abrupt("return");case 18:for(r=0;r<_.length&&0==o;r++)""!==_[r].單耗&&null!==_[r].單耗&&"null"!==_[r].單耗.toLowerCase()&&"已完成"===_[r].狀態||(o=!0,n=r);if(!o){e.next=26;break}return g.value=!0,h.value="Excel "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.row")+" "+_[n].excel_row_num+": "+_[n].料號90+"("+_[n].料號+") "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.nounitconsumption"),notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy"),e.abrupt("return");case 26:for(i=Array(),s=0;s<_.length;s++)null!=_[s].料號&&""!=_[s].料號.trim()&&i.push(_[s].料號.toString().trim()+"_"+_[s].料號90.toString().trim());if(!((c=y(i)).length>0)){e.next=36;break}return g.value=!0,h.value=t.appContext.config.globalProperties.$t("inboundpageLang.repeated_isn_90_pair")+" : "+c[0].split("_")[0]+" ("+c[0].split("_")[1]+")",notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy"),e.abrupt("return");case 36:for(u=[],p=[],d=[],f=[],b=[],v=[],w=0;w<_.length;w++)u.push(_[w].料號),p.push(_[w].料號90),d.push(_[w].下月MPS),f.push(_[w].下月生產天數),b.push(_[w].本月MPS),v.push(_[w].本月生產天數);return x=Date.now(),e.next=46,l(u,p,d,f,b,v);case 46:if(L=e.sent,k=Date.now()-x,console.log("Total time taken : "+k+" milliseconds"),Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy"),"success"===L)m.value=!1,notyf.open({type:"success",message:t.appContext.config.globalProperties.$t("monthlyPRpageLang.total")+" "+_.length+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.record")+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});else{if(420==L.response.status){for(g.value=!0,P=JSON.parse(L.response.data.PR_ALREADY),S=1,h.value=t.appContext.config.globalProperties.$t("monthlyPRpageLang.nonmonthly_pr_already_sxb")+"\n",I=0;I<P.length;I++)2===S?(h.value=h.value+P[I].料號90+"("+P[I].料號+")、\n",S=0):h.value=h.value+P[I].料號90+"("+P[I].料號+")、",S++;h.value=h.value.slice(0,-1)}notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}})}case 52:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,A.YP)(i,Tc(Rc().mark((function e(){var n,a,r,l,s;return Rc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:if(""!=u.value){e.next=6;break}return Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy"),e.abrupt("return");case 6:n=JSON.parse(u.value),a=JSON.parse(i.value),r={},l=1;case 10:if(!(l<o.length)){e.next=52;break}if(r.料號90=o[l][0].toString().trim(),r.料號=o[l][1].toString().trim(),null!=o[l][2]&&""!=o[l][2].toString().trim()){e.next=19;break}return f.value=!0,h.value=r.料號90+"->"+r.料號+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.nowmps")+" "+t.appContext.config.globalProperties.$t("validation.required"),Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy"),e.abrupt("return");case 19:if(r.本月MPS=parseFloat(o[l][2].toString().replace(/,/g,"")),null!=o[l][3]&&""!=o[l][3].toString().trim()){e.next=26;break}return f.value=!0,h.value=r.料號90+"->"+r.料號+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.nowday")+" "+t.appContext.config.globalProperties.$t("validation.required"),Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy"),e.abrupt("return");case 26:if(r.本月生產天數=parseFloat(o[l][3].toString().replace(/,/g,"")),null!=o[l][4]&&""!=o[l][4].toString().trim()){e.next=33;break}return f.value=!0,h.value=r.料號90+"->"+r.料號+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.nextmps")+" "+t.appContext.config.globalProperties.$t("validation.required"),Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy"),e.abrupt("return");case 33:if(r.下月MPS=parseFloat(o[l][4].toString().replace(/,/g,"")),null!=o[l][5]&&""!=o[l][5].toString().trim()){e.next=40;break}return f.value=!0,h.value=r.料號90+"->"+r.料號+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.nextday")+" "+t.appContext.config.globalProperties.$t("validation.required"),Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy"),e.abrupt("return");case 40:r.下月生產天數=parseFloat(o[l][5].toString().replace(/,/g,"")),r.excel_row_num=l+1,0==_.length?r.id=0:r.id=parseInt(_[_.length-1].id)+1,-1!=(s=n.data.findIndex((function(e){return e.料號===r.料號})))?r=Object.assign(r,n.data[s]):r.月請購="",-1!=(s=a.data.findIndex((function(e){return e.料號===r.料號&&e.料號90===r.料號90})))?(r.單耗=a.data[s].單耗,r.狀態=a.data[s].狀態):(r.單耗=null,r.狀態=null),_.push(r),r={};case 49:l++,e.next=10;break;case 52:Ec("#importedtable").hasClass("show")||Ec("#togglebtn").click(),console.log(_),m.value=!0,Ec("body").loadingModal("hide"),Ec("body").loadingModal("destroy"),k.isLoading=!1;case 58:case"end":return e.stop()}}),e)})))),(0,A.YP)(_,(function(){document.getElementsByClassName("vtl-table")[0].scrollIntoView({behavior:"smooth"})}));var k=(0,d.qj)({isLoading:!0,columns:[{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.90isn"),field:"料號90",width:"14ch",sortable:!0,display:function(e,t){return null===e.單耗?'<input type="hidden" id="ninetyisn'+e.excel_row_num+'" name="ninetyisn'+t+'" value="'+e.料號90+'"><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+e.料號90+"</div>":'<input type="hidden" id="ninetyisn'+e.excel_row_num+'" name="ninetyisn'+t+'" value="'+e.料號90+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.料號90+"</div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return""===e.月請購||null===e.月請購||"null"===e.月請購.toLowerCase()||null===e.單耗?'<input type="hidden" id="isn'+e.excel_row_num+'" name="isn'+t+'" value="'+e.料號+'"><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>":'<input type="hidden" id="isn'+e.excel_row_num+'" name="isn'+t+'" value="'+e.料號+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.nowmps"),field:"本月MPS",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nowmps'+t+'" name="nowmps'+t+'" value="'+e.本月MPS+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.本月MPS).toLocaleString("en",{useGrouping:!0})+"</div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.nowday"),field:"本月生產天數",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nowday'+t+'" name="nowday'+t+'" value="'+e.本月生產天數+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.本月生產天數).toLocaleString("en",{useGrouping:!0})+"</div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.nextmps"),field:"下月MPS",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nextmps'+t+'" name="nextmps'+t+'" value="'+e.下月MPS+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.下月MPS).toLocaleString("en",{useGrouping:!0})+"</div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.nextday"),field:"下月生產天數",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nextday'+t+'" name="nextday'+t+'" value="'+e.下月生產天數+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.下月生產天數).toLocaleString("en",{useGrouping:!0})+"</div>"}}],rows:(0,d.Fl)((function(){return _.filter((function(e){return e.料號90.toLowerCase().includes(x.value.toLowerCase())}))})),totalRecordCount:(0,d.Fl)((function(){return k.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:t.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+t.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+t.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+t.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:t.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:t.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:t.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{flip:(0,d.iH)(!1),exampleUrl:e,isInvalid:f,isInvalid_DB:g,validation_err_msg:h,uploadToDBReady:m,searchTerm:x,table:k,updateCheckedRows:function(e){v=e},rowUserInput:function(e,t){_[e.excel_row_num].單耗=document.getElementById("unitConsumption"+e.excel_row_num).value},onUploadClick:w,onInputChange:function(e){f.value=!1,_.splice(0),u.value="",b.value=e.target.files?e.target.files[0]:null,Ec("#importedtable").hasClass("show")&&Ec("#togglebtn").click()},onSendToDBClick:L,deleteRow:function(){for(var e=function(e){var t=_.findIndex((function(t){return parseInt(t.excel_row_num)===parseInt(v[e].excel_row_num)}));-1!=t&&_.splice(t,1)},t=0;t<v.length;t++)e(t);document.querySelectorAll(".vtl-tbody-checkbox").forEach((function(e){return e.checked=!1})),document.querySelector(".vtl-thead-checkbox").checked&&document.querySelector(".vtl-thead-checkbox").click(),v=[]}}}});var Mc=n(6115),Nc={insert:"head",singleton:!1};bt()(Mc.Z,Nc);Mc.Z.locals;const Bc=(0,w.Z)(jc,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",Hs,[(0,d._)("div",Js,[(0,d._)("div",Ys,[(0,d._)("h3",Qs,(0,d.zw)(e.$t("monthlyPRpageLang.importMonthlyData")),1),(0,d._)("button",{class:"col col-auto btn btn-light m-0 p-0 flip-btn",onClick:t[0]||(t[0]=function(t){return e.flip=!e.flip})},[Xs,(0,d.Uk)(" "+(0,d.zw)(e.$t("monthlyPRpageLang.search")),1)])])]),(0,d._)("div",Zs,[(0,d._)("div",Vs,[(0,d._)("div",Ks,[(0,d._)("a",{href:e.exampleUrl,download:""},(0,d.zw)(e.$t("monthlyPRpageLang.exampleExcel")),9,Ws)]),ec,(0,d._)("label",tc,(0,d.zw)(e.$t("monthlyPRpageLang.plz_upload")),1),nc,(0,d._)("div",oc,[(0,d._)("input",{class:(0,d.C_)(["form-control",{"is-invalid":e.isInvalid}]),id:"excel_input",type:"file",name:"select_file",onChange:t[1]||(t[1]=function(){return e.onInputChange&&e.onInputChange.apply(e,arguments)})},null,34),e.isInvalid?((0,d.wg)(),(0,d.iD)("span",ac,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0)]),rc,(0,d._)("div",ic,[(0,d._)("button",{type:"submit",name:"upload",class:"col col-auto btn btn-lg btn-primary",onClick:t[2]||(t[2]=function(){return e.onUploadClick&&e.onUploadClick.apply(e,arguments)})},(0,d.zw)(e.$t("monthlyPRpageLang.upload1")),1)])])])]),lc,(0,d._)("div",sc,[(0,d._)("div",cc,[(0,d._)("div",uc,[(0,d._)("div",pc,[(0,d._)("div",dc,[(0,d._)("label",fc,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",gc,[(0,d.wy)((0,d._)("input",{id:"pnInput1",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enter90isn"),"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.searchTerm=t})},null,8,hc),[[d.nr,e.searchTerm]])])]),(0,d._)("div",mc,[e.uploadToDBReady?((0,d.wg)(),(0,d.iD)("button",{key:0,id:"delete",name:"delete",class:"col col-auto btn btn-lg btn-danger",value:e.$t("basicInfoLang.delete"),onClick:t[4]||(t[4]=function(){return e.deleteRow&&e.deleteRow.apply(e,arguments)})},vc,8,bc)):(0,d.kq)("",!0)])]),yc,e.isInvalid_DB?((0,d.wg)(),(0,d.iD)("span",wc,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0),(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!0,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[5]||(t[5]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"]),xc,(0,d._)("div",_c,[(0,d._)("div",Cc,[e.uploadToDBReady?((0,d.wg)(),(0,d.iD)("button",{key:0,type:"submit",name:"upload",class:"col col-auto fs-3 text-center btn btn-lg btn-info",onClick:t[6]||(t[6]=function(){return e.onSendToDBClick&&e.onSendToDBClick.apply(e,arguments)})},[Lc,(0,d.Uk)(" "+(0,d.zw)(e.$t("monthlyPRpageLang.upload1")),1)])):(0,d.kq)("",!0)])])])])],64)}],["__scopeId","data-v-62fd8e97"]]);var Dc={class:"card"},Fc={class:"card-header"},Uc={class:"row"},qc={class:"col col-auto m-0"},Gc=(0,d._)("i",{class:"bi bi-arrow-left-right"},null,-1),zc=(0,d._)("div",{class:"w-100",style:{height:"2rem"}},null,-1),Hc={class:"card-body"},Jc={class:"row justify-content-between"},Yc={class:"row col col-auto"},Qc={class:"col col-auto"},Xc={for:"pnInput",class:"col-form-label"},Zc={class:"col col-auto p-0 m-0"},Vc=["placeholder"],Kc={class:"col col-auto"},Wc=[(0,d._)("i",{class:"bi bi-trash3-fill fs-4"},null,-1)],eu=["value"],tu=[(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill fs-4"},null,-1)],nu=(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1),ou={key:0,class:"invalid-feedback d-block",role:"alert"};var au=n(9755);function ru(e){return ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ru(e)}function iu(){iu=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==ru(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function lu(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function su(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){lu(r,o,a,i,l,"next",e)}function l(e){lu(r,o,a,i,l,"throw",e)}i(void 0)}))}}const cu=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=(0,A.FN)(),t=document.getElementsByTagName("HTML")[0].getAttribute("lang");e.appContext.config.globalProperties.$lang.setLocale(t);var n=Ac(),o=n.mats,a=n.getMats_MPS,r=n.deleteMPS,i=ja(),l=(i.queryResult,i.validateISN,function(){var e=su(iu().mark((function e(){return iu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:return e.abrupt("return",new Promise((function(e,t){e("success")})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),s=(0,d.iH)(!1),c=(0,d.iH)(""),u=((0,d.iH)(),[]),p=function(){var t=su(iu().mark((function t(){var n,o,a,i,l;return iu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],o=[],0!=u.length){t.next=5;break}return notyf.open({type:"warning",message:e.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),t.abrupt("return");case 5:for(a=0;a<u.length;a++)n.push(u[a].料號90),o.push(u[a].料號);return t.next=8,h();case 8:return t.next=10,r(n,o);case 10:if("success"===t.sent){for(i=function(e){var t=g.findIndex((function(t){return parseInt(t.id)===parseInt(u[e].id)}));-1!=t&&g.splice(t,1)},l=0;l<u.length;l++)i(l);notyf.open({type:"success",message:e.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),document.querySelectorAll(".vtl-tbody-checkbox").forEach((function(e){return e.checked=!1})),document.querySelector(".vtl-thead-checkbox").checked&&document.querySelector(".vtl-thead-checkbox").click(),u=[]}else notyf.open({type:"error",message:e.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});au("body").loadingModal("hide"),au("body").loadingModal("destroy");case 14:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),f=(0,d.iH)(""),g=(0,d.qj)([]),h=function(){var e=su(iu().mark((function e(){return iu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return au("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,A.YP)(o,su(iu().mark((function e(){var t,n;return iu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:if(g.splice(0),""!=o.value){e.next=7;break}return au("body").loadingModal("hide"),au("body").loadingModal("destroy"),e.abrupt("return");case 7:for(t=JSON.parse(o.value),n=0;n<t.data.length;n++)t.data[n].id=n,g.push(t.data[n]);au("body").loadingModal("hide"),au("body").loadingModal("destroy"),m.isLoading=!1;case 12:case"end":return e.stop()}}),e)}))));var m=(0,d.qj)({isLoading:!0,columns:[{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.90isn"),field:"料號90",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="ninetyisn'+e.id+'" name="ninetyisn'+t+'" value="'+e.料號90+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%; height: 100%;">'+e.料號90+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),field:"料號",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="isn'+e.id+'" name="isn'+t+'" value="'+e.料號+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%; height: 100%;">'+e.料號+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.nowmps"),field:"本月MPS",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nowmps'+t+'" name="nowmps'+t+'" value="'+e.本月MPS+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.本月MPS).toLocaleString("en",{useGrouping:!0})+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.nowday"),field:"本月生產天數",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nowday'+t+'" name="nowday'+t+'" value="'+e.本月生產天數+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.本月生產天數)+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.nextmps"),field:"下月MPS",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nextmps'+t+'" name="nextmps'+t+'" value="'+e.下月MPS+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.下月MPS).toLocaleString("en",{useGrouping:!0})+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.nextday"),field:"下月生產天數",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nextday'+t+'" name="nextday'+t+'" value="'+e.下月生產天數+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.下月生產天數)+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.writetime"),field:"填寫時間",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="time'+t+'" name="time'+t+'" value="'+e.填寫時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.填寫時間+"</div>"}}],rows:(0,d.Fl)((function(){return g.filter((function(e){return e.料號90.toLowerCase().includes(f.value.toLowerCase())}))})),totalRecordCount:(0,d.Fl)((function(){return m.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:e.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+e.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+e.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+e.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:e.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:e.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:e.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{flip:(0,d.iH)(!1),isInvalid_DB:s,validation_err_msg:c,searchTerm:f,table:m,updateCheckedRows:function(e){console.log(e),u=e},rowClicked:function(e){},deleteRow:p,OutputExcelClick:function(){au("body").loadingModal({text:"Loading...",animation:"circle"});var t=new Date,n=String(t.getDate()).padStart(2,"0"),o=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();t=a+"_"+o+"_"+n;for(var r=Array(),i=0;i<g.length;i++){var l=new Object;l.料號90=g[i].料號90,l.料號=g[i].料號,l.本月MPS=g[i].本月MPS,l.本月生產天數=g[i].本月生產天數,l.下月MPS=g[i].下月MPS,l.下月生產天數=g[i].下月生產天數,l.填寫時間=g[i].填寫時間,r.push(l)}var s=ue.P6.json_to_sheet(r),c=ue.P6.book_new();ue.P6.book_append_sheet(c,s,e.appContext.config.globalProperties.$t("templateWords.monthly")),ue.NC(c,e.appContext.config.globalProperties.$t("templateWords.monthly")+"_"+t+".xlsx",{compression:!0}),au("body").loadingModal("hide"),au("body").loadingModal("destroy")},triggerSearchUpdate:l}}}),uu=(0,w.Z)(cu,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)("div",Dc,[(0,d._)("div",Fc,[(0,d._)("div",Uc,[(0,d._)("h3",qc,(0,d.zw)(e.$t("monthlyPRpageLang.search")),1),(0,d._)("button",{class:"col col-auto btn btn-light m-0 p-0 flip-btn",onClick:t[0]||(t[0]=function(t){return e.flip=!e.flip})},[Gc,(0,d.Uk)(" "+(0,d.zw)(e.$t("monthlyPRpageLang.importMonthlyData")),1)])])]),zc,(0,d._)("div",Hc,[(0,d._)("div",Jc,[(0,d._)("div",Yc,[(0,d._)("div",Qc,[(0,d._)("label",Xc,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",Zc,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enter90isn"),"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.searchTerm=t})},null,8,Vc),[[d.nr,e.searchTerm]])])]),(0,d._)("div",Kc,[(0,d._)("button",{id:"delete",name:"delete",class:"col col-auto btn btn-lg btn-danger",onClick:t[2]||(t[2]=function(){return e.deleteRow&&e.deleteRow.apply(e,arguments)})},Wc),(0,d.Uk)("   "),(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("monthlyPRpageLang.download"),onClick:t[3]||(t[3]=function(){return e.OutputExcelClick&&e.OutputExcelClick.apply(e,arguments)})},tu,8,eu)])]),nu,e.isInvalid_DB?((0,d.wg)(),(0,d.iD)("span",ou,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0),(0,d.Wm)(i,{id:"searchTable","is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!0,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onReturnCheckedRows:e.updateCheckedRows,onRowClicked:e.rowClicked},null,8,["messages","columns","rows","total","page-options","sortable","onReturnCheckedRows","onRowClicked"])])])}]]);var pu=n(9755);function du(e){return du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},du(e)}function fu(){fu=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==du(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function gu(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function hu(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){gu(r,o,a,i,l,"next",e)}function l(e){gu(r,o,a,i,l,"throw",e)}i(void 0)}))}}function mu(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return bu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bu(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw r}}}}function bu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}const vu=(0,d.aZ)({name:"App",components:{MonthlyPRImportTable:Bc,MonthlyPRSearchTable:uu},setup:function(){var e=(0,d.iH)(null),t=(0,d.iH)(null),n=(0,d.iH)(null),o=new MutationObserver((function(e){var t,n=mu(e);try{var o=function(){var e=t.value,n=e.target.getAttribute(e.attributeName);(0,d.Y3)((function(){r(n,e.oldValue)}))};for(n.s();!(t=n.n()).done;)o()}catch(e){n.e(e)}finally{n.f()}}));(0,A.Jd)(o.disconnect()),(0,A.bv)((function(){o.observe(n.value,{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]}),(0,A.YP)((function(){return e.value.flip}),(function(e){pu(".flip-card").toggleClass("transition")})),(0,A.YP)((function(){return t.value.flip}),(function(e){pu(".flip-card").toggleClass("transition")}))}));var a=function(){var e=hu(fu().mark((function e(){return fu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pu("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r=function(){var e=hu(fu().mark((function e(n){return fu().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:if(!n.split(" ").includes("transition")){e.next=6;break}return e.next=6,t.value.triggerSearchUpdate();case 6:pu("body").loadingModal("hide"),pu("body").loadingModal("destroy");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{myChild:e,myChild2:t,detectclasschange:n}}});var yu=n(384),wu={insert:"head",singleton:!1};bt()(yu.Z,wu);yu.Z.locals;const xu=(0,w.Z)(vu,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("MonthlyPRImportTable"),l=(0,d.up)("MonthlyPRSearchTable");return(0,d.wg)(),(0,d.iD)("div",Fs,[(0,d._)("div",Us,[(0,d._)("div",qs,[(0,d.Wm)(i,{ref:"myChild"},null,512)]),(0,d._)("div",Gs,[(0,d.Wm)(l,{ref:"myChild2"},null,512)])])],512)}],["__scopeId","data-v-8cf998e4"]]);var _u={class:"flip-card",ref:"detectclasschange"},Cu={class:"flip-card-inner row w-100"},Lu={class:"flip-card-front col col-12",id:"cardFront",style:{height:"auto !important"}},ku={class:"flip-card-back col col-12",id:"cardBack"};var Pu=function(e){return(0,d.dD)("data-v-2b865b76"),e=e(),(0,d.Cn)(),e},Su={class:"card"},Iu={class:"card-header"},Au={class:"row"},Eu={class:"col col-auto m-0"},$u=Pu((function(){return(0,d._)("i",{class:"bi bi-arrow-left-right"},null,-1)})),Ru={class:"card-body"},Ou={class:"row justify-content-center mb-3"},Tu={class:"col col-auto"},ju=["href"],Mu=Pu((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Nu={class:"col col-auto form-label"},Bu=Pu((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Du={class:"col col-auto"},Fu={key:0,class:"invalid-feedback d-block",role:"alert"},Uu=Pu((function(){return(0,d._)("div",{class:"w-100",style:{height:"2ch"}},null,-1)})),qu={class:"row justify-content-center"},Gu=Pu((function(){return(0,d._)("button",{id:"togglebtn",class:"btn btn-primary col col-auto",type:"button","data-bs-toggle":"collapse","data-bs-target":"#importedtable","aria-expanded":"false","aria-controls":"importedtable",style:{display:"none"}},null,-1)})),zu={class:"card collapse",id:"importedtable"},Hu={class:"card-body"},Ju={class:"row justify-content-between"},Yu={class:"row col col-auto"},Qu={class:"col col-auto"},Xu={for:"pnInput1",class:"col-form-label"},Zu={class:"col col-auto p-0 m-0"},Vu=["placeholder"],Ku={class:"col col-auto"},Wu=["value"],ep=[Pu((function(){return(0,d._)("i",{class:"bi bi-trash3-fill fs-4"},null,-1)}))],tp=Pu((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),np={key:0,class:"invalid-feedback d-block",role:"alert"},op={style:{"white-space":"pre-wrap"}},ap=Pu((function(){return(0,d._)("div",{class:"w-100",style:{height:"2ch"}},null,-1)})),rp={class:"row justify-content-center"},ip={class:"col col-auto"},lp=Pu((function(){return(0,d._)("i",{class:"bi bi-cloud-upload-fill"},null,-1)}));var sp=n(9755);function cp(e){return cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cp(e)}function up(){up=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==cp(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function pp(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function dp(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){pp(r,o,a,i,l,"next",e)}function l(e){pp(r,o,a,i,l,"throw",e)}i(void 0)}))}}const fp=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=(0,d.iH)(window.location.origin+"/download/ImportNotmonthExample.xlsx"),t=(0,A.FN)(),n=document.getElementsByTagName("HTML")[0].getAttribute("lang");t.appContext.config.globalProperties.$lang.setLocale(n);var o,a=Ac(),r=a.mats,i=a.uploadNonMonthlyToDB,l=ja(),s=l.queryResult,c=l.validateISN,u=(0,d.iH)(!1),p=(0,d.iH)(!1),f=(0,d.iH)(""),g=(0,d.iH)(!1),h=(0,d.iH)(),m=[],b=function(e){for(var t=e.slice().sort(),n=[],o=0;o<t.length-1;o++)t[o+1]==t[o]&&n.push(t[o]);return n},v=function(){var e=dp(up().mark((function e(){var n;return up().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.value=!1,r.value="",e.next=4,x();case 4:h.value?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==h.value.type||"application/vnd.ms-excel"==h.value.type||"application/vnd.ms-excel"==h.value.type||".csv"==h.value.type?((n=new FileReader).onload=function(){var e=dp(up().mark((function e(n){var a,r,i,l,s,p;return up().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.target.result,r=ue.ij(a,{type:"binary",WTF:!0}),i=r.SheetNames[0],l=r.Sheets[i],void 0!==(o=ue.P6.sheet_to_json(l,{header:1}))&&void 0!==o[0]&&void 0!==o[0][0]&&void 0!==o[0][1]&&void 0!==o[0][2]){e.next=10;break}u.value=!0,f.value=t.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors"),e.next=21;break;case 10:if("料號"===o[0][0].trim()&&o[0][1].trim().toLowerCase().includes("當月需求")){e.next=15;break}u.value=!0,f.value=t.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors"),e.next=21;break;case 15:for(s=Array(),p=1;p<o.length;p++)null!=o[p][0]&&o[p].length>2&&""!=o[p][0].trim()&&null!=o[p][0].trim()?s.push(o[p][0].trim()):(o.splice(p,1),p-=1),null!==o[p][3]&&void 0!==o[p][3]||(o[p][3]=o[p][1]+o[p][2]);return e.next=19,x();case 19:return e.next=21,c(s);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.readAsBinaryString(h.value)):(u.value=!0,f.value=t.appContext.config.globalProperties.$t("validation.mimetypes")):(u.value=!0,f.value=t.appContext.config.globalProperties.$t("validation.required")),h.value=null,document.getElementById("excel_input").value="",sp("body").loadingModal("hide"),sp("body").loadingModal("destroy");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=(0,d.iH)(""),w=(0,d.qj)([]),x=function(){var e=dp(up().mark((function e(){return up().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return sp("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=dp(up().mark((function e(){var n,o,a,r,l,s,c,u,d,h,m,v,y,_,C,L,k,P;return up().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:if(p.value=!1,n=0,o=!1,!(w.length<=0)){e.next=10;break}return notyf.open({type:"warning",message:t.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),sp("body").loadingModal("hide"),sp("body").loadingModal("destroy"),e.abrupt("return");case 10:for(a=0;a<w.length&&0==o;a++)""!==w[a].月請購&&null!==w[a].月請購&&"null"!==w[a].月請購.toLowerCase()||(o=!0,n=a);if(!o){e.next=18;break}return p.value=!0,f.value="Excel "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.row")+" "+w[n].excel_row_num+" ("+w[n].料號+") "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.noisn"),notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),sp("body").loadingModal("hide"),sp("body").loadingModal("destroy"),e.abrupt("return");case 18:for(r=Array(),l=0;l<w.length;l++)null!=w[l].料號&&""!=w[l].料號.trim()&&r.push(w[l].料號.toString().trim());if(!((s=b(r)).length>0)){e.next=28;break}return p.value=!0,f.value=t.appContext.config.globalProperties.$t("monthlyPRpageLang.repeated_isn")+" : "+s[0],notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),sp("body").loadingModal("hide"),sp("body").loadingModal("destroy"),e.abrupt("return");case 28:for(c=[],u=[],d=[],h=[],m=[],v=0;v<w.length;v++)c.push(w[v].料號),u.push(parseInt(w[v].當月需求)),d.push(parseInt(w[v].下月需求)),h.push(parseInt(w[v].請購數量)),m.push(w[v].說明);return y=Date.now(),e.next=37,i(c,u,d,h,m);case 37:if(_=e.sent,C=Date.now()-y,console.log("Total time taken : "+C+" milliseconds"),sp("body").loadingModal("hide"),sp("body").loadingModal("destroy"),"success"===_)g.value=!1,notyf.open({type:"success",message:t.appContext.config.globalProperties.$t("monthlyPRpageLang.total")+" "+w.length+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.record")+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});else{if(420==_.response.status){for(p.value=!0,L=JSON.parse(_.response.data.PR_ALREADY),k=1,f.value=t.appContext.config.globalProperties.$t("monthlyPRpageLang.nonmonthly_pr_already_sxb")+"\n",P=0;P<L.length;P++)4===k?(f.value=f.value+L[P].料號+"、\n",k=0):f.value=f.value+L[P].料號+"、",k++;f.value=f.value.slice(0,-1)}notyf.open({type:"error",message:t.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}})}case 43:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,A.YP)(s,dp(up().mark((function e(){var n,a,r,i;return up().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.value=t.appContext.config.globalProperties.$t("barcodeGenerator.temp_save_error")+" Excel "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.row"),e.next=3,x();case 3:if(""!=s.value){e.next=7;break}return sp("body").loadingModal("hide"),sp("body").loadingModal("destroy"),e.abrupt("return");case 7:n=JSON.parse(s.value),a={},r=1;case 10:if(!(r<o.length)){e.next=51;break}if(e.prev=11,a.料號=o[r][0].toString().trim(),null!=o[r][1]&&""!=o[r][1].toString().trim()){e.next=19;break}return u.value=!0,f.value=a.料號+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.nowneed")+" "+t.appContext.config.globalProperties.$t("validation.required"),sp("body").loadingModal("hide"),sp("body").loadingModal("destroy"),e.abrupt("return");case 19:if(a.當月需求=parseFloat(o[r][1].toString().replace(/,/g,"")),null!=o[r][2]&&""!=o[r][2].toString().trim()){e.next=26;break}return u.value=!0,f.value=a.料號+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.nextneed")+" "+t.appContext.config.globalProperties.$t("validation.required"),sp("body").loadingModal("hide"),sp("body").loadingModal("destroy"),e.abrupt("return");case 26:if(a.下月需求=parseFloat(o[r][2].toString().replace(/,/g,"")),null!=o[r][3]&&""!=o[r][3].toString().trim()){e.next=33;break}return u.value=!0,f.value=a.料號+" "+t.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount1")+" "+t.appContext.config.globalProperties.$t("validation.required"),sp("body").loadingModal("hide"),sp("body").loadingModal("destroy"),e.abrupt("return");case 33:a.請購數量=parseInt(o[r][3].toString().replace(/,/g,""),10),void 0===o[r][4]||null===o[r][4]?a.說明="":a.說明=o[r][4].toString().trim(),a.excel_row_num=r+1,0==w.length?a.id=0:a.id=parseInt(w[w.length-1].id)+1,-1!=(i=n.data.findIndex((function(e){return e.料號===a.料號})))?a=Object.assign(a,n.data[i]):a.月請購="",w.push(a),e.next=47;break;case 42:e.prev=42,e.t0=e.catch(11),console.log(e.t0),f.value=f.value+" "+r+"、",p.value=!0;case 47:a={};case 48:r++,e.next=10;break;case 51:f.value=f.value.slice(0,-1),sp("#importedtable").hasClass("show")||sp("#togglebtn").click(),g.value=!0,sp("body").loadingModal("hide"),sp("body").loadingModal("destroy"),C.isLoading=!1;case 57:case"end":return e.stop()}}),e,null,[[11,42]])})))),(0,A.YP)(w,(function(){document.getElementsByClassName("vtl-table")[0].scrollIntoView({behavior:"smooth"})}));var C=(0,d.qj)({isLoading:!0,columns:[{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return""===e.月請購||null===e.月請購||"null"===e.月請購.toLowerCase()?'<input type="hidden" id="isn'+e.excel_row_num+'" name="isn'+t+'" value="'+e.料號+'"><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>":'<input type="hidden" id="isn'+e.excel_row_num+'" name="isn'+t+'" value="'+e.料號+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,n){return""===e.月請購||null===e.月請購||"null"===e.月請購.toLowerCase()?'<input type="hidden" id="name'+n+'" name="name'+n+'" value="'+e.品名+'"><div class="CustomScrollbar text-nowrap text-danger" style="overflow-x: auto; width: 100%;">'+t.appContext.config.globalProperties.$t("inboundpageLang.row")+" "+e.excel_row_num+"</div>":'<input type="hidden" id="name'+n+'" name="name'+n+'" value="'+e.品名+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.nowneed"),field:"當月需求",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nowneed'+t+'" name="nowneed'+t+'" value="'+e.當月需求+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.當月需求).toLocaleString("en",{useGrouping:!0})+" <small>"+e.單位+"</small></div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.nextneed"),field:"下月需求",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nextneed'+e.id+'" name="nextneed'+t+'" value="'+e.下月需求+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.下月需求).toLocaleString("en",{useGrouping:!0})+" <small>"+e.單位+"</small></div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount1"),field:"請購數量",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="buyamount'+t+'" name="buyamount'+t+'" value="'+e.請購數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.請購數量).toLocaleString("en",{useGrouping:!0})+" <small>"+e.單位+"</small></div>"}},{label:t.appContext.config.globalProperties.$t("monthlyPRpageLang.description"),field:"說明",width:"10ch",sortable:!0,display:function(e,t){return null===e.說明&&(e.說明=""),'<input type="hidden" id="remark'+t+'" name="remark'+t+'" value="'+e.說明+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.說明+"</div>"}}],rows:(0,d.Fl)((function(){return w.filter((function(e){return e.料號.toLowerCase().includes(y.value.toLowerCase())||e.品名.includes(y.value)}))})),totalRecordCount:(0,d.Fl)((function(){return C.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:t.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+t.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+t.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+t.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:t.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:t.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:t.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{flip:(0,d.iH)(!1),exampleUrl:e,isInvalid:u,isInvalid_DB:p,validation_err_msg:f,uploadToDBReady:g,searchTerm:y,table:C,updateCheckedRows:function(e){m=e},rowUserInput:function(e,t){w[e.excel_row_num].單耗=document.getElementById("unitConsumption"+e.excel_row_num).value},onUploadClick:v,onInputChange:function(e){u.value=!1,w.splice(0),s.value="",h.value=e.target.files?e.target.files[0]:null,sp("#importedtable").hasClass("show")&&sp("#togglebtn").click()},onSendToDBClick:_,deleteRow:function(){for(var e=function(e){var t=w.findIndex((function(t){return parseInt(t.excel_row_num)===parseInt(m[e].excel_row_num)}));-1!=t&&w.splice(t,1)},t=0;t<m.length;t++)e(t);document.querySelectorAll(".vtl-tbody-checkbox").forEach((function(e){return e.checked=!1})),document.querySelector(".vtl-thead-checkbox").checked&&document.querySelector(".vtl-thead-checkbox").click(),m=[]}}}});var gp=n(7441),hp={insert:"head",singleton:!1};bt()(gp.Z,hp);gp.Z.locals;const mp=(0,w.Z)(fp,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",Su,[(0,d._)("div",Iu,[(0,d._)("div",Au,[(0,d._)("h3",Eu,(0,d.zw)(e.$t("monthlyPRpageLang.importNonMonthlyData")),1),(0,d._)("button",{class:"col col-auto btn btn-light m-0 p-0 flip-btn",onClick:t[0]||(t[0]=function(t){return e.flip=!e.flip})},[$u,(0,d.Uk)(" "+(0,d.zw)(e.$t("monthlyPRpageLang.search")),1)])])]),(0,d._)("div",Ru,[(0,d._)("div",Ou,[(0,d._)("div",Tu,[(0,d._)("a",{href:e.exampleUrl,download:""},(0,d.zw)(e.$t("monthlyPRpageLang.exampleExcel")),9,ju)]),Mu,(0,d._)("label",Nu,(0,d.zw)(e.$t("monthlyPRpageLang.plz_upload")),1),Bu,(0,d._)("div",Du,[(0,d._)("input",{class:(0,d.C_)(["form-control",{"is-invalid":e.isInvalid}]),id:"excel_input",type:"file",name:"select_file",onChange:t[1]||(t[1]=function(){return e.onInputChange&&e.onInputChange.apply(e,arguments)})},null,34),e.isInvalid?((0,d.wg)(),(0,d.iD)("span",Fu,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0)]),Uu,(0,d._)("div",qu,[(0,d._)("button",{type:"submit",name:"upload",class:"col col-auto btn btn-lg btn-primary",onClick:t[2]||(t[2]=function(){return e.onUploadClick&&e.onUploadClick.apply(e,arguments)})},(0,d.zw)(e.$t("monthlyPRpageLang.upload1")),1)])])])]),Gu,(0,d._)("div",zu,[(0,d._)("div",Hu,[(0,d._)("div",Ju,[(0,d._)("div",Yu,[(0,d._)("div",Qu,[(0,d._)("label",Xu,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+": ",1)]),(0,d._)("div",Zu,[(0,d.wy)((0,d._)("input",{id:"pnInput1",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.searchTerm=t})},null,8,Vu),[[d.nr,e.searchTerm]])])]),(0,d._)("div",Ku,[e.uploadToDBReady?((0,d.wg)(),(0,d.iD)("button",{key:0,id:"delete",name:"delete",class:"col col-auto btn btn-lg btn-danger",value:e.$t("basicInfoLang.delete"),onClick:t[4]||(t[4]=function(){return e.deleteRow&&e.deleteRow.apply(e,arguments)})},ep,8,Wu)):(0,d.kq)("",!0)])]),tp,e.isInvalid_DB?((0,d.wg)(),(0,d.iD)("span",np,[(0,d._)("strong",op,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0),(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!0,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[5]||(t[5]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"]),ap,(0,d._)("div",rp,[(0,d._)("div",ip,[e.uploadToDBReady?((0,d.wg)(),(0,d.iD)("button",{key:0,type:"submit",name:"upload",class:"col col-auto fs-3 text-center btn btn-lg btn-info",onClick:t[6]||(t[6]=function(){return e.onSendToDBClick&&e.onSendToDBClick.apply(e,arguments)})},[lp,(0,d.Uk)(" "+(0,d.zw)(e.$t("monthlyPRpageLang.upload1")),1)])):(0,d.kq)("",!0)])])])])],64)}],["__scopeId","data-v-2b865b76"]]);var bp={class:"card"},vp={class:"card-header"},yp={class:"row"},wp={class:"col col-auto m-0"},xp=(0,d._)("i",{class:"bi bi-arrow-left-right"},null,-1),_p={class:"card-body"},Cp={class:"row justify-content-between"},Lp={class:"row col col-auto"},kp={class:"col col-auto"},Pp={for:"pnInput",class:"col-form-label"},Sp={class:"col col-auto p-0 m-0"},Ip=["placeholder"],Ap={class:"col col-auto"},Ep=["value"],$p=[(0,d._)("i",{class:"bi bi-trash3-fill fs-4"},null,-1)],Rp=["value"],Op=[(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill fs-4"},null,-1)],Tp=(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1),jp={key:0,class:"invalid-feedback d-block",role:"alert"};var Mp=n(9755);function Np(e){return Np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Np(e)}function Bp(){Bp=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==Np(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Dp(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Fp(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Dp(r,o,a,i,l,"next",e)}function l(e){Dp(r,o,a,i,l,"throw",e)}i(void 0)}))}}const Up=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=(0,A.FN)(),t=document.getElementsByTagName("HTML")[0].getAttribute("lang");e.appContext.config.globalProperties.$lang.setLocale(t);var n=Ac(),o=n.mats,a=n.getMats_nonMonthly,r=n.deleteNonMPS,i=ja(),l=(i.queryResult,i.validateISN,function(){var e=Fp(Bp().mark((function e(){return Bp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:return e.abrupt("return",new Promise((function(e,t){e("success")})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),s=(0,d.iH)(!1),c=(0,d.iH)(""),u=((0,d.iH)(),[]),p=function(){var t=Fp(Bp().mark((function t(){var n,o,a,i;return Bp().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],0!=u.length){t.next=4;break}return notyf.open({type:"warning",message:e.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),t.abrupt("return");case 4:for(o=0;o<u.length;o++)n.push(u[o].料號);return t.next=7,h();case 7:return t.next=9,r(n);case 9:if("success"===t.sent){for(a=function(e){var t=g.findIndex((function(t){return parseInt(t.id)===parseInt(u[e].料號)}));-1!=t&&g.splice(t,1)},i=0;i<u.length;i++)a(i);notyf.open({type:"success",message:e.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),document.querySelectorAll(".vtl-tbody-checkbox").forEach((function(e){return e.checked=!1})),document.querySelector(".vtl-thead-checkbox").checked&&document.querySelector(".vtl-thead-checkbox").click(),u=[]}else notyf.open({type:"error",message:e.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});Mp("body").loadingModal("hide"),Mp("body").loadingModal("destroy");case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),f=(0,d.iH)(""),g=(0,d.qj)([]),h=function(){var e=Fp(Bp().mark((function e(){return Bp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Mp("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,A.YP)(o,Fp(Bp().mark((function e(){var t,n;return Bp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:if(g.splice(0),""!=o.value){e.next=7;break}return Mp("body").loadingModal("hide"),Mp("body").loadingModal("destroy"),e.abrupt("return");case 7:for(t=JSON.parse(o.value),n=0;n<t.data.length;n++)t.data[n].id=n,g.push(t.data[n]);Mp("body").loadingModal("hide"),Mp("body").loadingModal("destroy"),m.isLoading=!1;case 12:case"end":return e.stop()}}),e)}))));var m=(0,d.qj)({isLoading:!0,columns:[{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="isn'+e.id+'" name="isn'+e.id+'" value="'+e.料號+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.nowneed"),field:"當月需求",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nowneed'+t+'" name="nowneed'+t+'" value="'+e.當月需求+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.當月需求).toLocaleString("en",{useGrouping:!0})+" <small>"+e.單位+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.nextneed"),field:"下月需求",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nextneed'+e.id+'" name="nextneed'+t+'" value="'+e.下月需求+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.下月需求).toLocaleString("en",{useGrouping:!0})+" <small>"+e.單位+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount1"),field:"請購數量",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="buyamount'+t+'" name="buyamount'+t+'" value="'+e.請購數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.請購數量).toLocaleString("en",{useGrouping:!0})+" <small>"+e.單位+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.description"),field:"說明",width:"10ch",sortable:!0,display:function(e,t){return null===e.說明&&(e.說明=""),'<input type="hidden" id="remark'+t+'" name="remark'+t+'" value="'+e.說明+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.說明+"</div>"}}],rows:(0,d.Fl)((function(){return g.filter((function(e){return e.料號.toLowerCase().includes(f.value.toLowerCase())||e.品名.includes(f.value)}))})),totalRecordCount:(0,d.Fl)((function(){return m.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:e.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+e.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+e.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+e.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:e.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:e.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:e.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{flip:(0,d.iH)(!1),isInvalid_DB:s,validation_err_msg:c,searchTerm:f,table:m,updateCheckedRows:function(e){u=e},deleteRow:p,OutputExcelClick:function(){Mp("body").loadingModal({text:"Loading...",animation:"circle"});var t=new Date,n=String(t.getDate()).padStart(2,"0"),o=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();t=a+"_"+o+"_"+n;for(var r=Array(),i=0;i<g.length;i++){var l=new Object;l.料號=g[i].料號,l.請購數量=g[i].請購數量,l.說明=g[i].說明,r.push(l)}var s=ue.P6.json_to_sheet(r),c=ue.P6.book_new();ue.P6.book_append_sheet(c,s,e.appContext.config.globalProperties.$t("templateWords.nonmonthly")),ue.NC(c,e.appContext.config.globalProperties.$t("templateWords.nonmonthly")+"_"+t+".xlsx",{compression:!0}),Mp("body").loadingModal("hide"),Mp("body").loadingModal("destroy")},triggerSearchUpdate:l}}}),qp=(0,w.Z)(Up,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)("div",bp,[(0,d._)("div",vp,[(0,d._)("div",yp,[(0,d._)("h3",wp,(0,d.zw)(e.$t("monthlyPRpageLang.search")),1),(0,d._)("button",{class:"col col-auto btn btn-light m-0 p-0 flip-btn",onClick:t[0]||(t[0]=function(t){return e.flip=!e.flip})},[xp,(0,d.Uk)(" "+(0,d.zw)(e.$t("monthlyPRpageLang.importNonMonthlyData")),1)])])]),(0,d._)("div",_p,[(0,d._)("div",Cp,[(0,d._)("div",Lp,[(0,d._)("div",kp,[(0,d._)("label",Pp,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",Sp,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.searchTerm=t})},null,8,Ip),[[d.nr,e.searchTerm]])])]),(0,d._)("div",Ap,[(0,d._)("button",{id:"delete",name:"delete",class:"col col-auto btn btn-lg btn-danger",value:e.$t("basicInfoLang.delete"),onClick:t[2]||(t[2]=function(){return e.deleteRow&&e.deleteRow.apply(e,arguments)})},$p,8,Ep),(0,d.Uk)("   "),(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("monthlyPRpageLang.download"),onClick:t[3]||(t[3]=function(){return e.OutputExcelClick&&e.OutputExcelClick.apply(e,arguments)})},Op,8,Rp)])]),Tp,e.isInvalid_DB?((0,d.wg)(),(0,d.iD)("span",jp,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):(0,d.kq)("",!0),(0,d.Wm)(i,{id:"searchTable","is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!0,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[4]||(t[4]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])])])}]]);var Gp=n(9755);function zp(e){return zp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zp(e)}function Hp(){Hp=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==zp(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Jp(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Yp(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Jp(r,o,a,i,l,"next",e)}function l(e){Jp(r,o,a,i,l,"throw",e)}i(void 0)}))}}function Qp(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Xp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xp(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw r}}}}function Xp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}const Zp=(0,d.aZ)({name:"App",components:{NonMonthlyPRImportTable:mp,NonMonthlyPRSearchTable:qp},setup:function(){var e=(0,d.iH)(null),t=(0,d.iH)(null),n=(0,d.iH)(null),o=new MutationObserver((function(e){var t,n=Qp(e);try{var o=function(){var e=t.value,n=e.target.getAttribute(e.attributeName);(0,d.Y3)((function(){r(n,e.oldValue)}))};for(n.s();!(t=n.n()).done;)o()}catch(e){n.e(e)}finally{n.f()}}));(0,A.Jd)(o.disconnect()),(0,A.bv)((function(){o.observe(n.value,{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]}),(0,A.YP)((function(){return e.value.flip}),(function(e){Gp(".flip-card").toggleClass("transition")})),(0,A.YP)((function(){return t.value.flip}),(function(e){Gp(".flip-card").toggleClass("transition")}))}));var a=function(){var e=Yp(Hp().mark((function e(){return Hp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Gp("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r=function(){var e=Yp(Hp().mark((function e(n){return Hp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:if(!n.split(" ").includes("transition")){e.next=6;break}return e.next=6,t.value.triggerSearchUpdate();case 6:Gp("body").loadingModal("hide"),Gp("body").loadingModal("destroy");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{myChild:e,myChild2:t,detectclasschange:n}}});var Vp=n(8136),Kp={insert:"head",singleton:!1};bt()(Vp.Z,Kp);Vp.Z.locals;const Wp=(0,w.Z)(Zp,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("NonMonthlyPRImportTable"),l=(0,d.up)("NonMonthlyPRSearchTable");return(0,d.wg)(),(0,d.iD)("div",_u,[(0,d._)("div",Cu,[(0,d._)("div",Lu,[(0,d.Wm)(i,{ref:"myChild"},null,512)]),(0,d._)("div",ku,[(0,d.Wm)(l,{ref:"myChild2"},null,512)])])],512)}],["__scopeId","data-v-57b1c3ff"]]);var ed=function(e){return(0,d.dD)("data-v-1d12f6c1"),e=e(),(0,d.Cn)(),e},td={class:"card"},nd={class:"card-header"},od={class:"card-body"},ad={class:"row justify-content-between"},rd={class:"row col col-auto"},id={class:"col col-auto"},ld={for:"pnInput",class:"col-form-label"},sd={class:"col col-6 p-0 m-0"},cd=["placeholder"],ud={class:"col col-auto"},pd=[ed((function(){return(0,d._)("i",{class:"bi bi-trash3-fill fs-4"},null,-1)}))],dd=["value"],fd=[ed((function(){return(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill fs-4"},null,-1)}))],gd=ed((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),hd={class:"row justify-content-between"},md={key:0,class:"col col-auto text-danger m-0 p-0",role:"alert"},bd={key:1,class:"col col-auto text-danger m-0 p-0",role:"alert"},vd=[ed((function(){return(0,d._)("strong",null,null,-1)}))],yd={class:"col col-auto text-sm text-danger m-0 p-0"},wd={class:"row justify-content-center"},xd={class:"col col-auto"},_d={key:0,class:"col col-auto m-0 p-0"},Cd={type:"button",name:"upload","data-bs-toggle":"modal","data-bs-target":"#sendPRConfirmTable","aria-controls":"sendPRConfirmTable",class:"col col-auto fs-3 text-center btn btn-lg btn-info"},Ld=ed((function(){return(0,d._)("i",{class:"bi bi-envelope-check-fill"},null,-1)})),kd={key:1,class:"col col-auto m-0 p-0"},Pd=ed((function(){return(0,d._)("i",{class:"bi bi-envelope-check-fill"},null,-1)})),Sd={class:"modal fade",id:"sendPRConfirmTable",tabindex:"-1","aria-labelledby":"sendPRConfirmTable","aria-hidden":"true"},Id={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},Ad={class:"modal-content"},Ed={class:"modal-header justify-content-center"},$d={class:"col col-auto modal-title m-0 p-0 fs-4"},Rd=ed((function(){return(0,d._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)})),Od={class:"modal-body"},Td={class:"row justify-content-between"},jd={class:"row col col-auto"},Md={class:"col col-auto"},Nd={for:"pnInput",class:"col-form-label"},Bd={class:"col col-auto p-0 m-0"},Dd=["placeholder"],Fd=ed((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Ud={key:0,class:"modal-footer justify-content-between"},qd={type:"button",class:"btn btn-lg btn-danger",style:{"border-radius":"5px"}};var Gd=n(9755);function zd(e){return zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zd(e)}function Hd(){Hd=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==zd(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Jd(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Yd(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Jd(r,o,a,i,l,"next",e)}function l(e){Jd(r,o,a,i,l,"throw",e)}i(void 0)}))}}const Qd=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=(0,A.FN)(),t=document.getElementsByTagName("HTML")[0].getAttribute("lang");e.appContext.config.globalProperties.$lang.setLocale(t);var n=Ac(),o=n.mats,a=n.Currency,r=n.getMats_Buylist,i=n.getMats_nonMonthly,l=n.sendBuylistMail,s=n.submitBuylist,c=n.getCurrency,u=Xi(),p=u.mats_SXB,f=u.getMats;(0,A.wF)(c);var g=(0,d.iH)("USD"),h=(0,d.iH)(!0),m=(0,d.iH)(!1),b=(0,d.iH)(e.appContext.config.globalProperties.$t("validation.required")),v=[],y=(0,d.iH)(!1),w=(0,d.iH)(!1),x=(0,d.iH)(null),_=(0,d.iH)(null),C=((0,d.iH)(null),[]),L=[],k=[],P=(0,d.iH)(""),S=(0,d.iH)(""),I=(0,d.iH)(""),E=(0,d.iH)(!1),$=(0,d.qj)([]),R=(0,d.qj)([]),O=function(){var e=Yd(Hd().mark((function e(){return Hd().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Gd("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var t=Yd(Hd().mark((function t(){var n,o,a,r,i,l,s,c,u;return Hd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O();case 2:for(n=new Date,o=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0"),r=n.getFullYear(),n=r+"_"+a+"_"+o,i=Array(),l=0;l<$.length;l++)(s=new Object).料號=$[l].料號,s.品名=$[l].品名,s.規格=$[l].規格,s.單價=$[l].單價,s.幣別1=$[l].幣別,s.當月需求=parseFloat($[l].當月需求).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,","),s.下月需求=parseFloat($[l].下月需求).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,","),s.現有庫存=parseInt($[l].現有庫存).toLocaleString("en-US"),s.在途量=parseInt($[l].在途量).toLocaleString("en-US"),s.本次請購數量=parseInt($[l].本次請購數量).toLocaleString("en-US"),s.請購金額=parseFloat($[l].請購金額).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,","),s.幣別2=$[l].幣別,s.匯率=parseFloat($[l].匯率).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,","),s.MOQ=$[l].MOQ,i.push(s);c=ue.P6.json_to_sheet(i),ue.P6.sheet_add_aoa(c,[[e.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),e.appContext.config.globalProperties.$t("monthlyPRpageLang.pName"),e.appContext.config.globalProperties.$t("inboundpageLang.format"),e.appContext.config.globalProperties.$t("basicInfoLang.price"),e.appContext.config.globalProperties.$t("basicInfoLang.money"),e.appContext.config.globalProperties.$t("monthlyPRpageLang.nowneed"),e.appContext.config.globalProperties.$t("monthlyPRpageLang.nextneed"),e.appContext.config.globalProperties.$t("monthlyPRpageLang.nowstock"),e.appContext.config.globalProperties.$t("monthlyPRpageLang.transit"),e.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount"),e.appContext.config.globalProperties.$t("monthlyPRpageLang.buyprice"),e.appContext.config.globalProperties.$t("basicInfoLang.money"),e.appContext.config.globalProperties.$t("monthlyPRpageLang.buyprice")+"(USD)",e.appContext.config.globalProperties.$t("monthlyPRpageLang.moq")]],{origin:"A1"}),u=ue.P6.book_new(),ue.P6.book_append_sheet(u,c,e.appContext.config.globalProperties.$t("monthlyPRpageLang.PR")),ue.NC(u,e.appContext.config.globalProperties.$t("monthlyPRpageLang.PR")+"_"+n+".xlsx",{compression:!0}),Gd("body").loadingModal("hide"),Gd("body").loadingModal("destroy");case 16:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),j=function(){var t=Yd(Hd().mark((function t(){var n,o,a,r,i,u,p,d,f,g,h,v,w,x,_,P,S,I,A;return Hd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O();case 2:if(m.value=!1,0,n=!1,!($.length<=0)){t.next=8;break}return notyf.open({type:"warning",message:e.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),t.abrupt("return");case 8:for(o=[],a=[],r=[],i=[],u=[],p=[],d=[],f=[],g=[],h=[],v=[],w=[],x=[],(_=$).sort((function(e,t){return t.匯率-e.匯率})),P=0;P<_.length;P++)parseInt(_[P].本次請購數量)>0?(o.push(_[P].料號),a.push(_[P].品名),r.push(_[P].規格),i.push(_[P].單價),u.push(parseFloat(_[P].當月需求).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")),p.push(parseFloat(_[P].下月需求).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")),d.push(parseInt(_[P].現有庫存).toLocaleString("en-US")),f.push(parseInt(_[P].在途量).toLocaleString("en-US")),g.push(parseInt(_[P].本次請購數量).toLocaleString("en-US")),h.push(parseFloat(_[P].請購金額).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")),v.push(_[P].幣別),w.push(parseFloat(_[P].匯率).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")),x.push(_[P].MOQ)):n=!0;if(!(o.length<=0)){t.next=33;break}return m.value=!0,b.value=e.appContext.config.globalProperties.$t("monthlyPRpageLang.no_req_amount_to_submit"),notyf.open({type:"warning",message:e.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Gd("body").loadingModal("hide"),Gd("body").loadingModal("destroy"),t.abrupt("return");case 33:n&&(m.value=!0,b.value=e.appContext.config.globalProperties.$t("monthlyPRpageLang.some_data_has_no_amount"),notyf.open({type:"warning",message:e.appContext.config.globalProperties.$t("monthlyPRpageLang.some_data_has_no_amount"),duration:5e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}));case 34:return S=Date.now(),t.next=37,l(o,a,r,i,u,p,d,f,g,h,v,w,x);case 37:if(I=t.sent,A=Date.now()-S,console.log("Total time taken : "+A+" milliseconds"),Gd("body").loadingModal("hide"),Gd("body").loadingModal("destroy"),"success"!==I){t.next=49;break}return t.next=45,s(o,a,r,i,u,p,d,f,g,h,v,w,x,C,k,L);case 45:"success"===(I=t.sent)?(y.value=!1,notyf.open({type:"success",message:e.appContext.config.globalProperties.$t("monthlyPRpageLang.total")+" "+$.length+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.record")+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+e.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}})):notyf.open({type:"error",message:e.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),t.next=50;break;case 49:notyf.open({type:"error",message:e.appContext.config.globalProperties.$t("checkInvLang.sent_email_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}});case 50:return t.next=52,c();case 52:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,A.YP)(a,Yd(Hd().mark((function t(){var n,l,s,c,u,d,g,m,b,v,P;return Hd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O();case 2:return $.splice(0),"Not Found"===a.value&&(notyf.open({type:"error",message:e.appContext.config.globalProperties.$t("monthlyPRpageLang.exchangerate_notfound"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),Gd("body").loadingModal("hide"),Gd("body").loadingModal("destroy")),n=new Date,(l=new Date).setDate(n.getDate()-20),sessionStorage.clear(),sessionStorage.setItem("sxbisn",null),sessionStorage.setItem("sxbsend",null),sessionStorage.setItem("sxbbegin",JSON.stringify(l.toISOString().split("T")[0])),sessionStorage.setItem("sxbend",JSON.stringify(n.toISOString().split("T")[0])),t.next=14,f();case 14:if(C=[],L=[],k=[],h.value=!1,s=a.value.rates,!1!==h.value){t.next=38;break}return t.next=22,r();case 22:return x.value=JSON.parse(o.value).data,t.next=25,i();case 25:for(_.value=JSON.parse(o.value).data,c={},u=[],d=0;d<x.value.length;d++)c.料號=x.value[d].料號.toString().trim(),c.品名=x.value[d].品名.toString().trim(),c.單位=x.value[d].單位.toString().trim(),c.規格=x.value[d].規格.toString().trim(),c.單價=parseFloat(x.value[d].單價),c.當月需求=parseInt(x.value[d].本月MPS)*parseFloat(x.value[d].單耗)/1e3,c.下月需求=parseInt(x.value[d].下月MPS)*parseFloat(x.value[d].單耗)/1e3,null===x.value[d].total_stock?c.現有庫存=0:c.現有庫存=parseInt(x.value[d].total_stock),null===x.value[d].in_transit?c.在途量=0:c.在途量=Math.round(parseFloat(x.value[d].in_transit)),c.本次請購數量=Math.ceil(c.當月需求+c.下月需求),c.請購金額=parseFloat((c.本次請購數量*c.單價).toFixed(5)),c.幣別=x.value[d].幣別.toString().trim().toUpperCase(),"RMB"==c.幣別?c.匯率=parseFloat((c.請購金額*(s.USD/s.CNY)).toFixed(5)):c.匯率=parseFloat((c.請購金額*(s.USD/s[c.幣別])).toFixed(5)),c.MOQ=parseInt(x.value[d].MOQ.toString().trim()),c.id=d,u.push(c),L.push(c.料號),k.push(x.value[d].料號90),c={};for(g=0;g<_.value.length;g++)c.料號=_.value[g].料號.toString().trim(),c.品名=_.value[g].品名.toString().trim(),c.單位=_.value[g].單位.toString().trim(),c.規格=_.value[g].規格.toString().trim(),c.單價=parseFloat(_.value[g].單價),c.當月需求=parseFloat(_.value[g].當月需求),c.下月需求=parseFloat(_.value[g].下月需求),null===_.value[g].total_stock?c.現有庫存=0:c.現有庫存=parseInt(_.value[g].total_stock),null===_.value[g].in_transit?c.在途量=0:c.在途量=Math.round(parseFloat(_.value[g].in_transit)),c.本次請購數量=Math.ceil(c.當月需求+c.下月需求),c.請購金額=parseFloat((c.本次請購數量*c.單價).toFixed(5)),c.幣別=_.value[g].幣別.toString().trim().toUpperCase(),"RMB"==c.幣別?c.匯率=parseFloat((c.請購金額*(s.USD/s.CNY)).toFixed(5)):c.匯率=parseFloat((c.請購金額*(s.USD/s[c.幣別])).toFixed(5)),c.MOQ=parseInt(_.value[g].MOQ.toString().trim()),c.id=g+x.value.length,u.push(c),C.push(c.料號),c={};m=Object.values(u.reduce((function(e,t){return e[t.料號]||(e[t.料號]={id:t.id,料號:t.料號,品名:t.品名,規格:t.規格,單位:t.單位,單價:t.單價,當月需求:0,下月需求:0,現有庫存:t.現有庫存,在途量:t.在途量,本次請購數量:0,請購金額:0,幣別:t.幣別,匯率:0,MOQ:t.MOQ}),e[t.料號].當月需求+=t.當月需求,e[t.料號].下月需求+=t.下月需求,e}),{})),b=Object.values(m.reduce((function(e,t){return e[t.料號]||(e[t.料號]={id:t.id,料號:t.料號,品名:t.品名,單位:t.單位,規格:t.規格,單價:t.單價,當月需求:t.當月需求,下月需求:t.下月需求,現有庫存:t.現有庫存,在途量:t.在途量,本次請購數量:0,請購金額:0,幣別:t.幣別,匯率:0,MOQ:t.MOQ}),e[t.料號].本次請購數量=Math.ceil(t.當月需求+t.下月需求-t.現有庫存-t.在途量),e[t.料號].本次請購數量<0&&(e[t.料號].本次請購數量=0),e[t.料號].請購金額=parseFloat((e[t.料號].本次請購數量*t.單價).toFixed(5)),"RMB"==t.幣別?e[t.料號].匯率=parseFloat((e[t.料號].請購金額*(s.USD/s.CNY)).toFixed(5)):e[t.料號].匯率=parseFloat((e[t.料號].請購金額*(s.USD/s[t.幣別])).toFixed(5)),e}),{})),Object.assign($,b.map((function(e){return e}))),v=b.map((function(e){return e.料號})),P=JSON.parse(p.value).datas.map((function(e){return e.料號})),w.value=v.some((function(e){return P.includes(e)})),w.value&&(R.splice(0),Object.assign(R,JSON.parse(p.value).datas.flatMap((function(e){if("已退單"!==e.SRM單號){var t={};return t.料號=e.料號,t.品名=e.品名,t.單位=e.單位,t.規格=e.規格,t.單號=e.SXB單號,t.狀態=e.SRM單號,t.請購金額=parseFloat(e.請購金額).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,","),t.幣別=e.幣別.toString().trim().toUpperCase(),t.請購量=parseInt(e.本次請購數量),t.請購時間=e.請購時間,t.開單人員=e.開單人員,t.現有庫存=parseInt(e.現有庫存),t}return[]})))),R.length<=0&&(w.value=!1);case 38:$.length>0?y.value=!0:y.value=!1,Gd("body").loadingModal("hide"),Gd("body").loadingModal("destroy"),M.isLoading=!1;case 42:case"end":return t.stop()}}),t)}))));var M=(0,d.qj)({isLoading:!0,columns:[{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="isn'+e.id+'" name="isn'+t+'" value="'+e.料號+'"><div class="scrollableWithoutScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.pName"),field:"品名",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:e.appContext.config.globalProperties.$t("inboundpageLang.format"),field:"規格",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:e.appContext.config.globalProperties.$t("basicInfoLang.price"),field:"單價",width:"9ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="price'+t+'" name="price'+t+'" value="'+e.單價+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.單價+" <small>"+e.幣別+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.nowneed"),field:"當月需求",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nowneed'+t+'" name="nowneed'+t+'" value="'+e.當月需求+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.當月需求).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")+" <small>"+e.單位+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.nextneed"),field:"下月需求",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nextneed'+e.id+'" name="nextneed'+t+'" value="'+e.下月需求+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.下月需求).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")+" <small>"+e.單位+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.nowstock"),field:"現有庫存",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="nowstock'+e.id+'" name="nowstock'+t+'" value="'+e.現有庫存+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.現有庫存).toLocaleString("en-US")+" <small>"+e.單位+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.transit"),field:"在途量",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="transit'+t+'" name="transit'+t+'" value="'+e.在途量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.在途量).toLocaleString("en-US")+" <small>"+e.單位+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount"),field:"本次請購數量",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="buyamount'+e.id+'" name="buyamount'+t+'" value="'+e.本次請購數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.本次請購數量).toLocaleString("en-US")+" <small>"+e.單位+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.buyprice"),field:"請購金額",width:"11ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="buyprice'+e.id+'" name="buyprice'+t+'" value="'+e.請購金額+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.請購金額).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")+" <small>"+e.幣別+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.buyprice")+"(USD)",field:"匯率",width:"13ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="rate'+e.id+'" name="rate'+t+'" value="'+e.匯率+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseFloat(e.匯率).toFixed(2).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")+" <small>USD</small></div>"}},{label:e.appContext.config.globalProperties.$t("basicInfoLang.moq"),field:"MOQ",width:"8ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="moq'+e.id+'" name="moq'+t+'" value="'+e.MOQ+'"><div class="scrollableWithoutScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.MOQ+" <small>"+e.單位+"</small></div>"}}],rows:(0,d.Fl)((function(){return $.filter((function(e){return e.料號.toLowerCase().includes(P.value.toLowerCase())||e.品名.includes(P.value)}))})),totalRecordCount:(0,d.Fl)((function(){return M.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:e.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+e.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+e.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+e.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:e.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:e.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:e.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]}),N=(0,d.qj)({isLoading:!0,columns:[{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.buytime"),field:"請購時間",width:"13ch",sortable:!0,display:function(e,t){return'<div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.請購時間+"</div>"}},{label:e.appContext.config.globalProperties.$t("basicInfoLang.isn"),field:"料號",width:"14ch",sortable:!0,isKey:!0,display:function(e,t){return'<div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:e.appContext.config.globalProperties.$t("basicInfoLang.pName"),field:"品名",width:"13ch",sortable:!0,display:function(e,t){return'<div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount1"),field:"請購量",width:"12ch",sortable:!0,display:function(e,t){return'<div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+parseInt(e.請購量).toLocaleString("en-US")+" <small>"+e.單位+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.buyprice"),field:"請購金額",width:"11ch",sortable:!0,display:function(e,t){return'<div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.請購金額+" <small>"+e.幣別+"</small></div>"}},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.transit_reviser"),field:"開單人員",width:"10ch",sortable:!0,display:function(e,t){return null!==e.開單人員&&void 0!==e.開單人員||(e.開單人員="N/A"),'<div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.開單人員+"</div>"}}],rows:(0,d.Fl)((function(){return R.filter((function(e){return e.料號.toLowerCase().includes(S.value.toLowerCase())||e.品名.includes(S.value)}))})),totalRecordCount:(0,d.Fl)((function(){return N.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:e.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+e.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+e.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+e.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:e.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:e.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:e.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{selectedValue2:g,isInvalid:h,isInvalid_DB:m,validation_err_msg:b,uploadToDBReady:y,needConfirm:w,searchTerm:P,searchTerm2:S,table:M,table2:N,modalTitle:I,showFooter:E,updateCheckedRows:function(e){v=e},deleteRow:function(){if(0!=v.length){for(var t=function(e){var t=$.findIndex((function(t){return parseInt(t.id)===parseInt(v[e].id)}));-1!=t&&$.splice(t,1)},n=0;n<v.length;n++)t(n);document.querySelectorAll(".vtl-tbody-checkbox").forEach((function(e){return e.checked=!1})),document.querySelector(".vtl-thead-checkbox").checked&&document.querySelector(".vtl-thead-checkbox").click(),v=[]}else notyf.open({type:"warning",message:e.appContext.config.globalProperties.$t("basicInfoLang.nodata"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}})},OutputExcelClick:T,onSendClick:j}}});var Xd=n(2646),Zd={insert:"head",singleton:!1};bt()(Xd.Z,Zd);Xd.Z.locals;const Vd=(0,w.Z)(Qd,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",td,[(0,d._)("div",nd,[(0,d._)("h3",null,(0,d.zw)(e.$t("monthlyPRpageLang.PR")),1)]),(0,d._)("div",od,[(0,d._)("div",ad,[(0,d._)("div",rd,[(0,d._)("div",id,[(0,d._)("label",ld,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",sd,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,cd),[[d.nr,e.searchTerm]])])]),(0,d._)("div",ud,[(0,d._)("button",{id:"delete",name:"delete",class:"col col-auto btn btn-lg btn-danger",onClick:t[1]||(t[1]=function(){return e.deleteRow&&e.deleteRow.apply(e,arguments)})},pd),(0,d.Uk)("   "),(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("monthlyPRpageLang.download"),onClick:t[2]||(t[2]=function(){return e.OutputExcelClick&&e.OutputExcelClick.apply(e,arguments)})},fd,8,dd)])]),gd,(0,d._)("div",hd,[e.isInvalid_DB?((0,d.wg)(),(0,d.iD)("span",md,[(0,d._)("strong",null,(0,d.zw)(e.validation_err_msg),1)])):((0,d.wg)(),(0,d.iD)("span",bd,vd)),(0,d._)("span",yd,(0,d.zw)(e.$t("monthlyPRpageLang.shallow_delete")),1)]),(0,d.Wm)(i,{id:"searchTable","is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!0,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[3]||(t[3]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"]),(0,d._)("div",wd,[(0,d.wy)((0,d._)("div",xd,[e.needConfirm?((0,d.wg)(),(0,d.iD)("div",_d,[(0,d._)("button",Cd,[Ld,(0,d.Uk)(" "+(0,d.zw)(e.$t("monthlyPRpageLang.SendPRReview")),1)])])):((0,d.wg)(),(0,d.iD)("div",kd,[(0,d._)("button",{onClick:t[4]||(t[4]=function(){return e.onSendClick&&e.onSendClick.apply(e,arguments)}),type:"button",name:"upload",class:"col col-auto fs-3 text-center btn btn-lg btn-info"},[Pd,(0,d.Uk)(" "+(0,d.zw)(e.$t("monthlyPRpageLang.SendPRReview")),1)])]))],512),[[d.F8,e.uploadToDBReady]])])])]),(0,d._)("div",Sd,[(0,d._)("div",Id,[(0,d._)("div",Ad,[(0,d._)("div",Ed,[(0,d._)("h1",$d,(0,d.zw)(e.modalTitle),1),Rd]),(0,d._)("div",Od,[(0,d._)("div",Td,[(0,d._)("div",jd,[(0,d._)("div",Md,[(0,d._)("label",Nd,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",Bd,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.searchTerm2=t})},null,8,Dd),[[d.nr,e.searchTerm2]])])])]),Fd,(0,d.Wm)(i,{"is-static-mode":!0,isSlotMode:!0,hasCheckbox:!1,messages:e.table2.messages,columns:e.table2.columns,rows:e.table2.rows,total:e.table2.totalRecordCount,"page-options":e.table2.pageOptions,sortable:e.table2.sortable,"is-fixed-first-column":!1},null,8,["messages","columns","rows","total","page-options","sortable"])]),e.showFooter?((0,d.wg)(),(0,d.iD)("div",Ud,[(0,d._)("button",qd,(0,d.zw)(e.$t("monthlyPRpageLang.review_cancel")),1),(0,d._)("button",{onClick:t[6]||(t[6]=function(){return e.onSendClick&&e.onSendClick.apply(e,arguments)}),type:"button",class:"btn btn-lg btn-success",style:{"border-radius":"5px"}},(0,d.zw)(e.$t("monthlyPRpageLang.review_complete")),1)])):(0,d.kq)("",!0)])])])],64)}],["__scopeId","data-v-1d12f6c1"]]);var Kd={class:"row",style:{"text-align":"left"}},Wd={class:"col col-auto"},ef={for:"pnInput",class:"col-form-label"},tf={class:"col col-3 p-0 m-0"},nf=["placeholder"],of=function(e){return(0,d.dD)("data-v-4df1ae5a"),e=e(),(0,d.Cn)(),e}((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)}));function af(e){return af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},af(e)}function rf(){rf=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==af(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function lf(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function sf(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=((0,m.tv)(),function(){var n,o=(n=rf().mark((function n(){var o,a,r,i,l,s,c,u,p;return rf().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.value="",n.next=3,$().post("/getCurrentDB");case 3:return o=n.sent,a=sessionStorage.getItem("oboundclient"),r=sessionStorage.getItem("oboundisn"),i=sessionStorage.getItem("oboundbound"),l=sessionStorage.getItem("oboundcheck"),s=sessionStorage.getItem("oboundbegin"),c=sessionStorage.getItem("oboundend"),n.prev=10,n.next=13,$().post("/api/obound/inboundsearch",{DB:o.data,oboundbound:i,oboundclient:a,oboundisn:r,oboundcheck:l,oboundbegin:s,oboundend:c});case 13:u=n.sent,e.value=JSON.stringify(u.data),n.next=22;break;case 17:for(p in n.prev=17,n.t0=n.catch(10),console.log(n.t0),n.t0.response.data.errors)t.value+=n.t0.response.data.errors[p][0]+"  ";console.log(t.value);case 22:case"end":return n.stop()}}),n,null,[[10,17]])})),function(){var e=this,t=arguments;return new Promise((function(o,a){var r=n.apply(e,t);function i(e){lf(r,o,a,i,l,"next",e)}function l(e){lf(r,o,a,i,l,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}());return{mats:e,getMats:n}}var cf=n(9755);const uf=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=sf(),t=e.mats,n=e.getMats;(0,A.wF)(n);var o=(0,d.iH)(""),a=(0,A.FN)(),r=document.getElementsByTagName("HTML")[0].getAttribute("lang");a.appContext.config.globalProperties.$lang.setLocale(r);var i=(0,d.qj)([]);(0,A.YP)(t,(function(){console.log(JSON.parse(t.value));for(var e=JSON.parse(t.value),n=0;n<e.datas.length;n++)i.push(e.datas[n]);document.getElementById("QueryFlag").click(),l.isLoading=!1}));var l=(0,d.qj)({isLoading:!0,columns:[{label:a.appContext.config.globalProperties.$t("oboundpageLang.inlist"),field:"入庫單號",width:"14ch",sortable:!0,isKey:!0,display:function(e,t){return'<input type="hidden" id="inboundlist'+t+'" name="inboundlist'+t+'" value="'+e.入庫單號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.入庫單號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.pName"),field:"品名",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.format"),field:"規格",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.client"),field:"客戶別",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="client'+t+'" name="client'+t+'" value="'+e.客戶別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.客戶別+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.bound"),field:"庫別",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="bound'+t+'" name="bound'+t+'" value="'+e.庫別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.庫別+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.inboundnum"),field:"入庫數量",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="inboundnum'+t+'" name="inboundnum'+t+'" value="'+e.數量+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.數量+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.inpeople"),field:"入庫人員",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="inboundpeople'+t+'" name="inboundpeople'+t+'" value="'+e.入庫人員+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.入庫人員+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.inboundtime"),field:"入庫時間",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="inboundtime'+t+'" name="inboundtime'+t+'" value="'+e.時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.時間+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.mark"),field:"備註",width:"10ch",sortable:!0,display:function(e,t){return null===e.備註&&(e.備註=""),'<input type="hidden" id="remark'+t+'" name="remark'+t+'" value="'+e.備註+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.備註+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.inreason"),field:"入庫原因",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="inboundreason'+t+'" name="inboundreason'+t+'" value="'+e.入庫原因+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.入庫原因+"</div>"}}],rows:(0,d.Fl)((function(){return i.filter((function(e){return e.料號.toLowerCase().includes(o.value.toLowerCase())||e.品名.includes(o.value)}))})),totalRecordCount:(0,d.Fl)((function(){return l.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:a.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+a.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+a.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+a.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:a.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:a.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:a.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:o,table:l,updateCheckedRows:function(e){console.log(e);var t=cf(".vtl-paging-count-dropdown").val();e=parseInt(e);for(var n=0;n<t;n++)n!==e?cf("#checkbox"+n).prop("disabled",!0):cf("#checkbox"+n).prop("disabled",!1);isNaN(e)&&(console.log(1),cf(".vtl-tbody-checkbox").prop("disabled",!1))}}}});var pf=n(6547),df={insert:"head",singleton:!1};bt()(pf.Z,df);pf.Z.locals;const ff=(0,w.Z)(uf,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",Kd,[(0,d._)("div",Wd,[(0,d._)("label",ef,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",tf,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,nf),[[d.nr,e.searchTerm]])])]),of,(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!0,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[1]||(t[1]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])],64)}],["__scopeId","data-v-4df1ae5a"]]);var gf={class:"row",style:{"text-align":"left"}},hf={class:"col col-auto"},mf={for:"pnInput",class:"col-form-label"},bf={class:"col col-3 p-0 m-0"},vf=["placeholder"],yf=function(e){return(0,d.dD)("data-v-9b60d964"),e=e(),(0,d.Cn)(),e}((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)}));function wf(e){return wf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wf(e)}function xf(){xf=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==wf(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function _f(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Cf(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=((0,m.tv)(),function(){var n,o=(n=xf().mark((function n(){var o,a,r,i;return xf().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.value="",n.next=3,$().post("/getCurrentDB");case 3:return o=n.sent,a=sessionStorage.getItem("oboundisn"),n.prev=5,n.next=8,$().post("/api/obound/isnsearch",{DB:o.data,oboundisn:a});case 8:r=n.sent,e.value=JSON.stringify(r.data),n.next=17;break;case 12:for(i in n.prev=12,n.t0=n.catch(5),console.log(n.t0),n.t0.response.data.errors)t.value+=n.t0.response.data.errors[i][0]+"  ";console.log(t.value);case 17:case"end":return n.stop()}}),n,null,[[5,12]])})),function(){var e=this,t=arguments;return new Promise((function(o,a){var r=n.apply(e,t);function i(e){_f(r,o,a,i,l,"next",e)}function l(e){_f(r,o,a,i,l,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}());return{mats:e,getMats:n}}const Lf=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=Cf(),t=e.mats,n=e.getMats;(0,A.wF)(n);var o=(0,d.iH)(""),a=(0,A.FN)(),r=document.getElementsByTagName("HTML")[0].getAttribute("lang");a.appContext.config.globalProperties.$lang.setLocale(r);var i=(0,d.qj)([]);(0,A.YP)(t,(function(){console.log(JSON.parse(t.value));for(var e=JSON.parse(t.value),n=0;n<e.datas.length;n++)i.push(e.datas[n]);document.getElementById("QueryFlag").click(),l.isLoading=!1}));var l=(0,d.qj)({isLoading:!0,columns:[{label:a.appContext.config.globalProperties.$t("oboundpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.pName"),field:"品名",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.format"),field:"規格",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}}],rows:(0,d.Fl)((function(){return i.filter((function(e){return e.料號.toLowerCase().includes(o.value.toLowerCase())||e.品名.includes(o.value)}))})),totalRecordCount:(0,d.Fl)((function(){return l.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:a.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+a.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+a.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+a.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:a.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:a.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:a.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:o,table:l,updateCheckedRows:function(e){console.log(e)}}}});var kf=n(5691),Pf={insert:"head",singleton:!1};bt()(kf.Z,Pf);kf.Z.locals;const Sf=(0,w.Z)(Lf,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",gf,[(0,d._)("div",hf,[(0,d._)("label",mf,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",bf,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,vf),[[d.nr,e.searchTerm]])])]),yf,(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!1,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[1]||(t[1]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])],64)}],["__scopeId","data-v-9b60d964"]]);var If={class:"row",style:{"text-align":"left"}},Af={class:"col col-auto"},Ef={for:"pnInput",class:"col-form-label"},$f={class:"col col-3 p-0 m-0"},Rf=["placeholder"],Of=function(e){return(0,d.dD)("data-v-5a6cb164"),e=e(),(0,d.Cn)(),e}((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)}));function Tf(e){return Tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tf(e)}function jf(){jf=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==Tf(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Mf(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Nf(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=((0,m.tv)(),function(){var n,o=(n=jf().mark((function n(){var o,a,r,i,l,s,c,u,p;return jf().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.value="",n.next=3,$().post("/getCurrentDB");case 3:return o=n.sent,a=sessionStorage.getItem("oboundpickrecordclient"),r=sessionStorage.getItem("oboundpickrecordproduction"),i=sessionStorage.getItem("oboundpickrecordisn"),l=sessionStorage.getItem("oboundpickrecordcheck"),s=sessionStorage.getItem("oboundpickrecordbegin"),c=sessionStorage.getItem("oboundpickrecordend"),n.prev=10,n.next=13,$().post("/api/obound/picklistsearch",{DB:o.data,oboundpickrecordclient:a,oboundpickrecordproduction:r,oboundpickrecordisn:i,oboundpickrecordcheck:l,oboundpickrecordbegin:s,oboundpickrecordend:c});case 13:u=n.sent,e.value=JSON.stringify(u.data),n.next=22;break;case 17:for(p in n.prev=17,n.t0=n.catch(10),console.log(n.t0),n.t0.response.data.errors)t.value+=n.t0.response.data.errors[p][0]+"  ";console.log(t.value);case 22:case"end":return n.stop()}}),n,null,[[10,17]])})),function(){var e=this,t=arguments;return new Promise((function(o,a){var r=n.apply(e,t);function i(e){Mf(r,o,a,i,l,"next",e)}function l(e){Mf(r,o,a,i,l,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}());return{mats:e,getMats:n}}const Bf=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=Nf(),t=e.mats,n=e.getMats;(0,A.wF)(n);var o=(0,d.iH)(""),a=(0,A.FN)(),r=document.getElementsByTagName("HTML")[0].getAttribute("lang");a.appContext.config.globalProperties.$lang.setLocale(r);var i=(0,d.qj)([]);(0,A.YP)(t,(function(){console.log(JSON.parse(t.value));for(var e=JSON.parse(t.value),n=0;n<e.datas.length;n++)i.push(e.datas[n]);document.getElementById("QueryFlag").click(),l.isLoading=!1}));var l=(0,d.qj)({isLoading:!0,columns:[{label:a.appContext.config.globalProperties.$t("oboundpageLang.client"),field:"客戶別",width:"12ch",sortable:!0,isKey:!0,display:function(e,t){return'<input type="hidden" id="client'+t+'" name="client'+t+'" value="'+e.客戶別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.客戶別+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.machine"),field:"機種",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="machine'+t+'" name="machine'+t+'" value="'+e.機種+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.機種+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.process"),field:"製程",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="production'+t+'" name="production'+t+'" value="'+e.製程+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.製程+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.usereason"),field:"領用原因",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="usereason'+t+'" name="usereason'+t+'" value="'+e.領用原因+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.領用原因+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.line"),field:"線別",width:"9ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="line'+t+'" name="line'+t+'" value="'+e.線別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.線別+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.format"),field:"規格",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.pickamount"),field:"預領數量",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="pickamount'+t+'" name="pickamount'+t+'" value="'+e.預領數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.預領數量+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.realpickamount"),field:"實際領用數量",width:"22ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="realpickamount'+t+'" name="realpickamount'+t+'" value="'+e.實際領用數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.實際領用數量+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.mark"),field:"備註",width:"10ch",sortable:!0,display:function(e,t){return null===e.備註&&(e.備註=""),'<input type="hidden" id="remark'+t+'" name="remark'+t+'" value="'+e.備註+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.備註+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.diffreason"),field:"實領差異原因",width:"25ch",sortable:!0,display:function(e,t){return null===e.實領差異原因&&(e.實領差異原因=""),'<input type="hidden" id="diffreason'+t+'" name="diffreason'+t+'" value="'+e.實領差異原因+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.實領差異原因+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.bound"),field:"庫別",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="bound'+t+'" name="bound'+t+'" value="'+e.庫別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.庫別+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.pickpeople"),field:"領料人員",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="pickpeople'+t+'" name="pickpeople'+t+'" value="'+e.領料人員+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.領料人員+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.pickpeoplenum"),field:"領料人員工號",width:"17ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="pickpeoplenum'+t+'" name="pickpeoplenum'+t+'" value="'+e.領料人員工號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.領料人員工號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.sendpeople"),field:"發料人員",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="sendpeople'+t+'" name="sendpeople'+t+'" value="'+e.發料人員+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.發料人員+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.sendpeoplenum"),field:"發料人員工號",width:"17ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="sendpeoplenum'+t+'" name="sendpeoplenum'+t+'" value="'+e.發料人員工號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.發料人員工號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.picklistnum"),field:"領料單號",width:"17ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="picklist'+t+'" name="picklist'+t+'" value="'+e.領料單號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.領料單號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.opentime"),field:"開單時間",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="opentime'+t+'" name="opentime'+t+'" value="'+e.開單時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.開單時間+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.outboundtime"),field:"出庫時間",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="outboundtime'+t+'" name="outboundtime'+t+'" value="'+e.出庫時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.出庫時間+"</div>"}}],rows:(0,d.Fl)((function(){return i.filter((function(e){return e.料號.toLowerCase().includes(o.value.toLowerCase())||e.品名.includes(o.value)}))})),totalRecordCount:(0,d.Fl)((function(){return l.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:a.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+a.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+a.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+a.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:a.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:a.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:a.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:o,table:l,updateCheckedRows:function(e){console.log(e)}}}});var Df=n(9770),Ff={insert:"head",singleton:!1};bt()(Df.Z,Ff);Df.Z.locals;const Uf=(0,w.Z)(Bf,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",If,[(0,d._)("div",Af,[(0,d._)("label",Ef,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",$f,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,Rf),[[d.nr,e.searchTerm]])])]),Of,(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!1,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[1]||(t[1]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])],64)}],["__scopeId","data-v-5a6cb164"]]);var qf={class:"row",style:{"text-align":"left"}},Gf={class:"col col-auto"},zf={for:"pnInput",class:"col-form-label"},Hf={class:"col col-3 p-0 m-0"},Jf=["placeholder"],Yf=function(e){return(0,d.dD)("data-v-f13f1bc2"),e=e(),(0,d.Cn)(),e}((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)}));function Qf(e){return Qf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qf(e)}function Xf(){Xf=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==Qf(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Zf(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function Vf(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=((0,m.tv)(),function(){var n,o=(n=Xf().mark((function n(){var o,a,r,i,l,s,c,u,p;return Xf().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.value="",n.next=3,$().post("/getCurrentDB");case 3:return o=n.sent,a=sessionStorage.getItem("oboundbackrecordclient"),r=sessionStorage.getItem("oboundbackrecordproduction"),i=sessionStorage.getItem("oboundbackrecordisn"),l=sessionStorage.getItem("oboundbackrecordcheck"),s=sessionStorage.getItem("oboundbackrecordbegin"),c=sessionStorage.getItem("oboundbackrecordend"),n.prev=10,n.next=13,$().post("/api/obound/backlistsearch",{DB:o.data,oboundbackrecordclient:a,oboundbackrecordproduction:r,oboundbackrecordisn:i,oboundbackrecordcheck:l,oboundbackrecordbegin:s,oboundbackrecordend:c});case 13:u=n.sent,e.value=JSON.stringify(u.data),n.next=22;break;case 17:for(p in n.prev=17,n.t0=n.catch(10),console.log(n.t0),n.t0.response.data.errors)t.value+=n.t0.response.data.errors[p][0]+"  ";console.log(t.value);case 22:case"end":return n.stop()}}),n,null,[[10,17]])})),function(){var e=this,t=arguments;return new Promise((function(o,a){var r=n.apply(e,t);function i(e){Zf(r,o,a,i,l,"next",e)}function l(e){Zf(r,o,a,i,l,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}());return{mats:e,getMats:n}}const Kf=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=Vf(),t=e.mats,n=e.getMats;(0,A.wF)(n);var o=(0,d.iH)(""),a=(0,A.FN)(),r=document.getElementsByTagName("HTML")[0].getAttribute("lang");a.appContext.config.globalProperties.$lang.setLocale(r);var i=(0,d.qj)([]);(0,A.YP)(t,(function(){console.log(JSON.parse(t.value));for(var e=JSON.parse(t.value),n=0;n<e.datas.length;n++)i.push(e.datas[n]);document.getElementById("QueryFlag").click(),l.isLoading=!1}));var l=(0,d.qj)({isLoading:!0,columns:[{label:a.appContext.config.globalProperties.$t("oboundpageLang.client"),field:"客戶別",width:"12ch",sortable:!0,isKey:!0,display:function(e,t){return'<input type="hidden" id="client'+t+'" name="client'+t+'" value="'+e.客戶別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.客戶別+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.machine"),field:"機種",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="machine'+t+'" name="machine'+t+'" value="'+e.機種+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.機種+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.process"),field:"製程",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="production'+t+'" name="production'+t+'" value="'+e.製程+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.製程+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.backreason"),field:"退回原因",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="backreason'+t+'" name="backreason'+t+'" value="'+e.退回原因+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.退回原因+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.line"),field:"線別",width:"9ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="line'+t+'" name="line'+t+'" value="'+e.線別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.線別+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.isn"),field:"料號",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="number'+t+'" name="number'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="name'+t+'" name="name'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.format"),field:"規格",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.backamount"),field:"預退數量",width:"15ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="backamount'+t+'" name="backamount'+t+'" value="'+e.預退數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.預退數量+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.realbackamount"),field:"實際退回數量",width:"22ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="realbackamount'+t+'" name="realbackamount'+t+'" value="'+e.實際退回數量+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.實際退回數量+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.mark"),field:"備註",width:"10ch",sortable:!0,display:function(e,t){return null===e.備註&&(e.備註=""),'<input type="hidden" id="remark'+t+'" name="remark'+t+'" value="'+e.備註+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.備註+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.backdiffreason"),field:"實退差異原因",width:"25ch",sortable:!0,display:function(e,t){return null===e.實退差異原因&&(e.實退差異原因=""),'<input type="hidden" id="backdiffreason'+t+'" name="backdiffreason'+t+'" value="'+e.實退差異原因+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.實退差異原因+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.bound"),field:"庫別",width:"10ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="bound'+t+'" name="bound'+t+'" value="'+e.庫別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.庫別+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.receivepeople"),field:"收料人員",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="receivepeople'+t+'" name="receivepeople'+t+'" value="'+e.收料人員+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.收料人員+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.receivepeoplenum"),field:"收料人員工號",width:"17ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="receivepeoplenum'+t+'" name="receivepeoplenum'+t+'" value="'+e.收料人員工號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.收料人員工號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.backpeople"),field:"退料人員",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="backpeople'+t+'" name="backpeople'+t+'" value="'+e.退料人員+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.退料人員+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.backpeoplenum"),field:"退料人員工號",width:"17ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="backpeoplenum'+t+'" name="backpeoplenum'+t+'" value="'+e.退料人員工號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.退料人員工號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.backlistnum"),field:"退料單號",width:"17ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="backlist'+t+'" name="backlist'+t+'" value="'+e.退料單號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.退料單號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.opentime"),field:"開單時間",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="opentime'+t+'" name="opentime'+t+'" value="'+e.開單時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.開單時間+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.inboundtime"),field:"入庫時間",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="inboundtime'+t+'" name="inboundtime'+t+'" value="'+e.入庫時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.入庫時間+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.status"),field:"功能狀況",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="status'+t+'" name="status'+t+'" value="'+e.功能狀況+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.功能狀況+"</div>"}}],rows:(0,d.Fl)((function(){return i.filter((function(e){return e.料號.toLowerCase().includes(o.value.toLowerCase())||e.品名.includes(o.value)}))})),totalRecordCount:(0,d.Fl)((function(){return l.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:a.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+a.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+a.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+a.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:a.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:a.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:a.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:o,table:l,updateCheckedRows:function(e){console.log(e)}}}});var Wf=n(1383),eg={insert:"head",singleton:!1};bt()(Wf.Z,eg);Wf.Z.locals;const tg=(0,w.Z)(Kf,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",qf,[(0,d._)("div",Gf,[(0,d._)("label",zf,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",Hf,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,Jf),[[d.nr,e.searchTerm]])])]),Yf,(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!1,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[1]||(t[1]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])],64)}],["__scopeId","data-v-f13f1bc2"]]);var ng={class:"row",style:{"text-align":"left"}},og={class:"col col-auto"},ag={for:"pnInput",class:"col-form-label"},rg={class:"col col-3 p-0 m-0"},ig=["placeholder"],lg=function(e){return(0,d.dD)("data-v-9060e7aa"),e=e(),(0,d.Cn)(),e}((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)}));function sg(e){return sg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sg(e)}function cg(){cg=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==sg(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function ug(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function pg(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=((0,m.tv)(),function(){var n,o=(n=cg().mark((function n(){var o,a,r,i,l,s,c;return cg().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.value="",n.next=3,$().post("/getCurrentDB");case 3:return o=n.sent,a=sessionStorage.getItem("oboundstockclient"),r=sessionStorage.getItem("oboundstockisn"),i=sessionStorage.getItem("oboundstockbound"),l=sessionStorage.getItem("oboundstocknogood"),n.prev=8,n.next=11,$().post("/api/obound/searchstock",{DB:o.data,oboundclient:a,oboundisn:r,oboundbound:i,oboundnogood:l});case 11:s=n.sent,e.value=JSON.stringify(s.data),n.next=20;break;case 15:for(c in n.prev=15,n.t0=n.catch(8),console.log(n.t0),n.t0.response.data.errors)t.value+=n.t0.response.data.errors[c][0]+"  ";console.log(t.value);case 20:case"end":return n.stop()}}),n,null,[[8,15]])})),function(){var e=this,t=arguments;return new Promise((function(o,a){var r=n.apply(e,t);function i(e){ug(r,o,a,i,l,"next",e)}function l(e){ug(r,o,a,i,l,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}());return{mats:e,getMats:n}}const dg=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=pg(),t=e.mats,n=e.getMats;(0,A.wF)(n);var o=(0,d.iH)(""),a=(0,A.FN)(),r=document.getElementsByTagName("HTML")[0].getAttribute("lang");a.appContext.config.globalProperties.$lang.setLocale(r);var i=(0,d.qj)([]);(0,A.YP)(t,(function(){console.log(JSON.parse(t.value));for(var e=JSON.parse(t.value),n=0;n<e.datas.length;n++)i.push(e.datas[n]);document.getElementById("QueryFlag").click(),l.isLoading=!1}));var l=(0,d.qj)({isLoading:!0,columns:[{label:a.appContext.config.globalProperties.$t("oboundpageLang.isn"),field:"料號",width:"14ch",sortable:!0,isKey:!0,display:function(e,t){return'<input type="hidden" id="isn'+t+'" name="isn'+t+'" value="'+e.料號+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.料號+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.nowstock"),field:"現有庫存",width:"12ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="stock'+t+'" name="stock'+t+'" value="'+e.現有庫存+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.現有庫存+" <small>"+e.單位+"</small></div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.client"),field:"客戶別",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="client'+t+'" name="client'+t+'" value="'+e.客戶別+'"><div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.客戶別+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.bound"),field:"庫別",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="bound'+t+'" name="bound'+t+'" value="'+e.庫別+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.庫別+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.updatetime"),field:"最後更新時間",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="updatetime'+t+'" name="updatetime'+t+'" value="'+e.最後更新時間+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.最後更新時間+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="pName'+t+'" name="pName'+t+'" value="'+e.品名+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:a.appContext.config.globalProperties.$t("oboundpageLang.format"),field:"規格",width:"14ch",sortable:!0,display:function(e,t){return'<input type="hidden" id="format'+t+'" name="format'+t+'" value="'+e.規格+'"><div class="text-nowrap CustomScrollbar" style="overflow-x: auto; width: 100%;">'+e.規格+"</div>"}}],rows:(0,d.Fl)((function(){return i.filter((function(e){return e.料號.toLowerCase().includes(o.value.toLowerCase())||e.品名.includes(o.value)}))})),totalRecordCount:(0,d.Fl)((function(){return l.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:a.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+a.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+a.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+a.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:a.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:a.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:a.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{searchTerm:o,table:l,updateCheckedRows:function(e){console.log(e)}}}});var fg=n(3186),gg={insert:"head",singleton:!1};bt()(fg.Z,gg);fg.Z.locals;const hg=(0,w.Z)(dg,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",ng,[(0,d._)("div",og,[(0,d._)("label",ag,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",rg,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,ig),[[d.nr,e.searchTerm]])])]),lg,(0,d.Wm)(i,{"is-fixed-first-column":!0,"is-static-mode":!0,hasCheckbox:!1,isLoading:e.table.isLoading,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[1]||(t[1]=function(t){return e.table.isLoading=!1}),onReturnCheckedRows:e.updateCheckedRows},null,8,["isLoading","messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])],64)}],["__scopeId","data-v-9060e7aa"]]);function mg(e){return mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mg(e)}function bg(){bg=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==mg(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function vg(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function yg(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=((0,m.tv)(),function(){var n,o=(n=bg().mark((function n(){var o,a;return bg().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.value="",$().interceptors.request.use((function(e){return e}),(function(e){return console.log(e),Promise.reject(e)})),n.prev=2,n.t0=$(),n.next=6,$().post("/getCurrentDB");case 6:return n.t1=n.sent,n.t2={DB:n.t1},n.next=10,n.t0.post.call(n.t0,"/api/news",n.t2);case 10:o=n.sent,e.value=JSON.stringify(o.data),n.next=19;break;case 14:for(a in n.prev=14,n.t3=n.catch(2),console.log(n.t3),n.t3.response.data.errors)t.value+=n.t3.response.data.errors[a][0]+"  ";console.log(t.value);case 19:case"end":return n.stop()}}),n,null,[[2,14]])})),function(){var e=this,t=arguments;return new Promise((function(o,a){var r=n.apply(e,t);function i(e){vg(r,o,a,i,l,"next",e)}function l(e){vg(r,o,a,i,l,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}());return{news:e,getNews:n}}const wg=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=yg(),t=e.news,n=e.getNews;(0,A.wF)(n);var o=(0,A.FN)(),a=document.getElementsByTagName("HTML")[0].getAttribute("lang");o.appContext.config.globalProperties.$lang.setLocale(a);var r=(0,d.qj)([]);(0,A.YP)(t,(function(){for(var e=JSON.parse(t.value),n=0;n<e.datas.length;n++)r.push(e.datas[n]);document.getElementById("QueryFlag").click(),i.isLoading=!1}));var i=(0,d.qj)({isLoading:!0,columns:[{label:o.appContext.config.globalProperties.$t("templateWords.cat"),field:"cat",width:"8ch",sortable:!0,display:function(e,t){return"urgent"===e.level?'<span id="'+e.id+'" class="col col-auto text-danger-emphasis">'+e.category+"</span>":"important"===e.level?'<span id="'+e.id+'" class="col col-auto text-warning-emphasis">'+e.category+"</span>":'<span id="'+e.id+'" class="col col-auto">'+e.category+"</span>"}},{label:o.appContext.config.globalProperties.$t("templateWords.title"),field:"title",width:"13ch",sortable:!0,display:function(e,t){return"urgent"===e.level?'<span class="col col-auto text-danger-emphasis">'+e.title+"</span>":"important"===e.level?'<span class="col col-auto text-warning-emphasis">'+e.title+"</span>":'<span class="col col-auto">'+e.title+"</span>"}},{label:o.appContext.config.globalProperties.$t("templateWords.dateOfNotice"),field:"date",width:"8ch",sortable:!0,display:function(e,t){return"urgent"===e.level?'<span class="col col-auto text-danger-emphasis">'+e.updated_at+"</span>":"important"===e.level?'<span class="col col-auto text-warning-emphasis">'+e.updated_at+"</span>":'<span class="col col-auto">'+e.updated_at+"</span>"}}],rows:[],totalRecordCount:(0,d.Fl)((function(){return i.rows.length})),sortable:{order:"date",sort:"desc"},messages:{pagingInfo:o.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+o.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+o.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+o.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:o.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:o.appContext.config.globalProperties.$t("basicInfoLang.go_to_page")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{table:i,rowClicked:function(e){console.log("Row clicked ! on "+e)}}}}),xg=(0,w.Z)(wg,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.j4)(i,{"is-fixed-first-column":!0,isStaticMode:!0,isSlotMode:!0,hasCheckbox:!1,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[0]||(t[0]=function(t){return e.table.isLoading=!1}),onRowClicked:e.rowClicked},null,8,["messages","columns","rows","total","page-options","sortable","onRowClicked"])}]]);var _g={class:"card w-100"},Cg={class:"card w-100"};var Lg=function(e){return(0,d.dD)("data-v-5858c480"),e=e(),(0,d.Cn)(),e},kg={class:"card-header row align-items-center"},Pg={class:"col col-auto align-middle m-0 p-0"},Sg={class:"card-body"},Ig={class:"row justify-content-between"},Ag={class:"row col col-auto"},Eg={class:"col col-auto"},$g={for:"pnInput",class:"col-form-label"},Rg={class:"col col-auto p-0 m-0"},Og=["placeholder"],Tg={class:"col col-auto"},jg=["value"],Mg=[Lg((function(){return(0,d._)("i",{class:"bi bi-file-earmark-arrow-down-fill fs-4"},null,-1)}))],Ng=Lg((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Bg={class:"CustomScrollbar text-nowrap",style:{"overflow-x":"auto",width:"100%"}},Dg={class:"col col-auto align-items-center m-0 p-0"},Fg={class:"m-0 p-0",style:{width:"12ch"}},Ug={class:"col col-auto align-items-center m-0 p-0"},qg={class:"m-0 p-0",style:{width:"12ch"}},Gg={class:"col col-auto align-items-center m-0 p-0"},zg={class:"m-0 p-0",style:{width:"12ch"}},Hg={class:"CustomScrollbar text-nowrap",style:{"overflow-x":"auto",width:"100%"}};var Jg=new Date,Yg=(0,d.iH)(Jg.getFullYear()),Qg=(0,d.iH)(Jg.getMonth()),Xg=(0,d.qj)([]),Zg=(0,d.iH)([0,0,0,0,0,0,0,0,0,0,0,0]),Vg=(0,d.iH)([0,0,0,0,0,0,0,0,0,0,0,0]),Kg=(0,d.iH)(""),Wg=(0,d.qj)([]),eh=(0,d.qj)({isLoading:!0,columns:[{label:Lang.get("monthlyPRpageLang.isn"),field:"料號",width:"14ch",sortable:!0},{label:Lang.get("monthlyPRpageLang.pName"),field:"品名",width:"14ch",sortable:!0,display:function(e,t){return'<div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.品名+"</div>"}},{label:Lang.get("monthlyPRpageLang.buyamount1"),field:"請購數量",width:"12ch",sortable:!0},{label:Lang.get("outboundpageLang.realpickamount"),field:"實際領用數量",width:"10ch",sortable:!0},{label:Lang.get("callpageLang.req_vs_real"),field:"需求與領用差異量",width:"13ch",sortable:!0},{label:Lang.get("callpageLang.req_vs_real_percent"),field:"需求與領用差異",width:"13ch",sortable:!0}],rows:(0,d.Fl)((function(){return Wg.filter((function(e){return null!=e.料號&&(e.料號.toLowerCase().includes(Kg.value.toLowerCase())||e.品名.includes(Kg.value))}))})),totalRecordCount:(0,d.Fl)((function(){return eh.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:Lang.get("basicInfoLang.now_showing")+" {0} ~ {1} "+Lang.get("basicInfoLang.record")+", "+Lang.get("basicInfoLang.total")+" {2} "+Lang.get("basicInfoLang.record"),pageSizeChangeLabel:Lang.get("basicInfoLang.records_per_page"),gotoPageLabel:Lang.get("basicInfoLang.go_to_page"),noDataAvailable:Lang.get("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});function th(e){return th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},th(e)}function nh(){nh=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==th(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function oh(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function ah(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=((0,m.tv)(),function(){var n,o=(n=nh().mark((function n(){var o,a,r,i=arguments;return nh().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=i.length>0&&void 0!==i[0]?i[0]:(new Date).getFullYear(),t.value="",n.next=4,$().post("/getCurrentDB");case 4:return a=n.sent,n.prev=5,n.next=8,$().post("/api/call/getYearlyDiff",{DB:a.data,Year:o});case 8:return r=n.sent,e.value=JSON.stringify(r.data),n.abrupt("return",new Promise((function(e,t){e("success")})));case 13:return n.prev=13,n.t0=n.catch(5),console.log(n.t0),n.abrupt("return",n.t0);case 17:case"end":return n.stop()}}),n,null,[[5,13]])})),function(){var e=this,t=arguments;return new Promise((function(o,a){var r=n.apply(e,t);function i(e){oh(r,o,a,i,l,"next",e)}function l(e){oh(r,o,a,i,l,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}());return{mats:e,getMats:n}}var rh=n(9755);function ih(e){return ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ih(e)}function lh(e){return function(e){if(Array.isArray(e))return sh(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return sh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sh(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function ch(){ch=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==ih(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function uh(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function ph(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){uh(r,o,a,i,l,"next",e)}function l(e){uh(r,o,a,i,l,"throw",e)}i(void 0)}))}}const dh=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=(0,A.FN)(),t=document.getElementsByTagName("HTML")[0].getAttribute("lang");e.appContext.config.globalProperties.$lang.setLocale(t);var n=ah(),o=n.mats,a=n.getMats,r=Ac(),i=r.Currency,l=r.getCurrency;(0,A.wF)(ph(ch().mark((function e(){return ch().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:return e.next=4,a();case 4:case"end":return e.stop()}}),e)}))));var s=(0,d.iH)(e.appContext.config.globalProperties.$t("monthlyPRpageLang.months").split("_")),c=(0,d.iH)(s.value[Qg.value]),u=function(){var e=ph(ch().mark((function e(){return ch().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return rh("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var t=ph(ch().mark((function t(){var n,o,a,r,i,l,s,c,p;return ch().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u();case 2:for(n=new Date,o=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0"),r=n.getFullYear(),n=r+"_"+a+"_"+o,i=Array(),l=0;l<Wg.length;l++)(s=new Object).料號=Wg[l].料號,s.品名=Wg[l].品名,s.請購數量=Wg[l].請購數量,s.實際領用數量=Wg[l].實際領用數量,s.單位=Wg[l].單位,s.需求與領用差異量=Wg[l].需求與領用差異量,s.需求與領用差異=Wg[l].需求與領用差異+"%",i.push(s);c=ue.P6.json_to_sheet(i),p=ue.P6.book_new(),ue.P6.book_append_sheet(p,c,"PR vs Acq "+Yg.value+"_"+(Qg.value+1)),ue.NC(p,e.appContext.config.globalProperties.$t("callpageLang.req_vs_real_percent")+".xlsx",{compression:!0}),rh("body").loadingModal("hide"),rh("body").loadingModal("destroy");case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),f=function(){var e=ph(ch().mark((function e(t,n){var o,a,r,i,l,s,c,u,p,d,f,g,m,b,v,y,w,x,_,C,L;return ch().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=-99,a=function(e){for(var n=h.inbound[t],a=1;a<3;a++){var r=t-a;if(-1==r){if(h.buylist_lastyear[11].find((function(t){return t.料號===n[e].料號}))){r>o&&(o=r);break}}else if(-2==r){if(h.buylist_lastyear[10].find((function(t){return t.料號===n[e].料號}))){r>o&&(o=r);break}}else{if(h.buylist[r].find((function(t){return t.料號===n[e].料號}))){r>o&&(o=r);break}}}},r=0;r<h.inbound[t].length;r++)a(r);for(i=function(e){var a={},r=h.inbound[t];if(a.料號=r[e].料號,a.品名=r[e].品名,-99==o)a.請購數量=0;else if(-1==o){var i=h.buylist_lastyear[11].find((function(e){return e.料號===a.料號}));i?(a.請購數量=parseFloat(i.本次請購數量),Number.isNaN(parseFloat(i.本次請購數量))&&(a.請購數量=0)):a.請購數量=0}else if(-2==o){var l=h.buylist_lastyear[10].find((function(e){return e.料號===a.料號}));l?(a.請購數量=parseFloat(l.本次請購數量),Number.isNaN(parseFloat(l.本次請購數量))&&(a.請購數量=0)):a.請購數量=0}else{var s=h.buylist[o].find((function(e){return e.料號===a.料號}));s?(a.請購數量=parseFloat(s.本次請購數量),Number.isNaN(parseFloat(s.本次請購數量))&&(a.請購數量=0)):a.請購數量=0}a.單位=r[e].單位,a.實際領用數量=parseInt(r[e].入庫數量),a.需求與領用差異量=a.請購數量-a.實際領用數量,a.需求與領用差異=100*(a.請購數量-a.實際領用數量)/((a.請購數量+a.實際領用數量)/2),Number.isNaN(a.需求與領用差異)&&(a.需求與領用差異=0),a.單價=parseFloat(r[e].單價),a.幣別=r[e].幣別,n.push(a)},l=0;l<h.inbound[t].length;l++)i(l);if(-99==o)if(-1==(s=t-1))for(c=0;c<h.buylist_lastyear[11].length;c++)u=h.buylist_lastyear[11],(p={}).料號=u[c].料號,p.品名=u[c].品名,p.請購數量=parseFloat(u[c].本次請購數量),Number.isNaN(parseFloat(u[c].本次請購數量))&&(p.請購數量=0),p.單位=u[c].單位,p.實際領用數量=0,p.需求與領用差異量=p.請購數量-p.實際領用數量,p.需求與領用差異=100*(p.請購數量-p.實際領用數量)/((p.請購數量+p.實際領用數量)/2),Number.isNaN(p.需求與領用差異)&&(p.需求與領用差異=0),p.單價=parseFloat(u[c].單價),p.幣別=u[c].幣別,n.push(p);else if(-2==s)for(d=0;d<h.buylist_lastyear[10].length;d++)f=h.buylist_lastyear[10],(g={}).料號=f[d].料號,g.品名=f[d].品名,g.請購數量=parseFloat(f[d].本次請購數量),Number.isNaN(parseFloat(f[d].本次請購數量))&&(g.請購數量=0),g.單位=f[d].單位,g.實際領用數量=0,g.需求與領用差異量=g.請購數量-g.實際領用數量,g.需求與領用差異=100*(g.請購數量-g.實際領用數量)/((g.請購數量+g.實際領用數量)/2),Number.isNaN(g.需求與領用差異)&&(g.需求與領用差異=0),g.單價=parseFloat(f[d].單價),g.幣別=f[d].幣別,n.push(g);else for(m=0;m<h.buylist[s].length;m++)b=h.buylist[s],(v={}).料號=b[m].料號,v.品名=b[m].品名,v.請購數量=parseFloat(b[m].本次請購數量),Number.isNaN(parseFloat(b[m].本次請購數量))&&(v.請購數量=0),v.單位=b[m].單位,v.實際領用數量=0,v.需求與領用差異量=v.請購數量-v.實際領用數量,v.需求與領用差異=100*(v.請購數量-v.實際領用數量)/((v.請購數量+v.實際領用數量)/2),Number.isNaN(v.需求與領用差異)&&(v.需求與領用差異=0),v.單價=parseFloat(b[m].單價),v.幣別=b[m].幣別,n.push(v);else if(-1==o)for(y=function(e){var t=h.buylist_lastyear[11];if(void 0===n.find((function(n){return n.料號===t[e].料號}))){var o={};o.料號=t[e].料號,o.品名=t[e].品名,o.請購數量=parseFloat(t[e].本次請購數量),Number.isNaN(parseFloat(t[e].本次請購數量))&&(o.請購數量=0),o.單位=t[e].單位,o.實際領用數量=0,o.需求與領用差異量=o.請購數量-o.實際領用數量,o.需求與領用差異=100*(o.請購數量-o.實際領用數量)/((o.請購數量+o.實際領用數量)/2),Number.isNaN(o.需求與領用差異)&&(o.需求與領用差異=0),o.單價=parseFloat(t[e].單價),o.幣別=t[e].幣別,n.push(o)}},w=0;w<h.buylist_lastyear[11].length;w++)y(w);else if(-2==o)for(x=function(e){var t=h.buylist_lastyear[10];if(void 0===n.find((function(n){return n.料號===t[e].料號}))){var o={};o.料號=t[e].料號,o.品名=t[e].品名,o.請購數量=parseFloat(t[e].本次請購數量),Number.isNaN(parseFloat(t[e].本次請購數量))&&(o.請購數量=0),o.單位=t[e].單位,o.實際領用數量=0,o.需求與領用差異量=o.請購數量-o.實際領用數量,o.需求與領用差異=100*(o.請購數量-o.實際領用數量)/((o.請購數量+o.實際領用數量)/2),Number.isNaN(o.需求與領用差異)&&(o.需求與領用差異=0),o.單價=parseFloat(t[e].單價),o.幣別=t[e].幣別,n.push(o)}},_=0;_<h.buylist_lastyear[10].length;_++)x(_);else for(C=function(e){var t=h.buylist[o];if(void 0===n.find((function(n){return n.料號===t[e].料號}))){var a={};a.料號=t[e].料號,a.品名=t[e].品名,a.請購數量=parseFloat(t[e].本次請購數量),Number.isNaN(parseFloat(t[e].本次請購數量))&&(a.請購數量=0),a.單位=t[e].單位,a.實際領用數量=0,a.需求與領用差異量=a.請購數量-a.實際領用數量,a.需求與領用差異=100*(a.請購數量-a.實際領用數量)/((a.請購數量+a.實際領用數量)/2),Number.isNaN(a.需求與領用差異)&&(a.需求與領用差異=0),a.單價=parseFloat(t[e].單價),a.幣別=t[e].幣別,n.push(a)}},L=0;L<h.buylist[o].length;L++)C(L);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=ph(ch().mark((function e(){var t,n,o,a,r,l,s,c,u;return ch().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=[],o=[],a=i.value.rates,r=0;case 5:if(!(r<12)){e.next=18;break}return o.splice(0),e.next=9,f(r,o);case 9:for(l=0,s=0,c=function(e){o[e].料號&&(Xg.length>0?null!=Xg.find((function(t){return t.料號==o[e].料號}))&&("RMB"==o[e].幣別?(Number.isNaN(parseFloat((parseFloat(o[e].請購數量)*parseFloat(o[e].單價)*(a.USD/a.CNY)).toFixed(5)))||(l+=parseFloat((parseFloat(o[e].請購數量)*parseFloat(o[e].單價)*(a.USD/a.CNY)).toFixed(5))),Number.isNaN(parseFloat((parseFloat(o[e].實際領用數量)*parseFloat(o[e].單價)*(a.USD/a.CNY)).toFixed(5)))||(s+=parseFloat((parseFloat(o[e].實際領用數量)*parseFloat(o[e].單價)*(a.USD/a.CNY)).toFixed(5)))):(Number.isNaN(parseFloat((parseFloat(o[e].請購數量)*parseFloat(o[e].單價)*(a.USD/a[o[e].幣別])).toFixed(5)))||(l+=parseFloat((parseFloat(o[e].請購數量)*parseFloat(o[e].單價)*(a.USD/a[o[e].幣別])).toFixed(5))),Number.isNaN(parseFloat((parseFloat(o[e].實際領用數量)*parseFloat(o[e].單價)*(a.USD/a[o[e].幣別])).toFixed(5)))||(s+=parseFloat((parseFloat(o[e].實際領用數量)*parseFloat(o[e].單價)*(a.USD/a[o[e].幣別])).toFixed(5))))):"RMB"==o[e].幣別?(Number.isNaN(parseFloat((parseFloat(o[e].請購數量)*parseFloat(o[e].單價)*(a.USD/a.CNY)).toFixed(5)))||(l+=parseFloat((parseFloat(o[e].請購數量)*parseFloat(o[e].單價)*(a.USD/a.CNY)).toFixed(5))),Number.isNaN(parseFloat((parseFloat(o[e].實際領用數量)*parseFloat(o[e].單價)*(a.USD/a.CNY)).toFixed(5)))||(s+=parseFloat((parseFloat(o[e].實際領用數量)*parseFloat(o[e].單價)*(a.USD/a.CNY)).toFixed(5)))):(Number.isNaN(parseFloat((parseFloat(o[e].請購數量)*parseFloat(o[e].單價)*(a.USD/a[o[e].幣別])).toFixed(5)))||(l+=parseFloat((parseFloat(o[e].請購數量)*parseFloat(o[e].單價)*(a.USD/a[o[e].幣別])).toFixed(5))),Number.isNaN(parseFloat((parseFloat(o[e].實際領用數量)*parseFloat(o[e].單價)*(a.USD/a[o[e].幣別])).toFixed(5)))||(s+=parseFloat((parseFloat(o[e].實際領用數量)*parseFloat(o[e].單價)*(a.USD/a[o[e].幣別])).toFixed(5)))))},u=0;u<o.length;u++)c(u);t.push(l),n.push(s);case 15:r++,e.next=5;break;case 18:Zg.value=t,Vg.value=n;case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,A.YP)(Xg,ph(ch().mark((function e(){return ch().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:case"end":return e.stop()}}),e)})))),(0,A.YP)(Yg,ph(ch().mark((function e(){return ch().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(4==Yg.value.toString().length&&parseInt(Yg.value)>=1996)){e.next=8;break}return e.next=3,u();case 3:return Wg.splice(0),e.next=6,a(Yg.value);case 6:rh("body").loadingModal("hide"),rh("body").loadingModal("destroy");case 8:case"end":return e.stop()}}),e)})))),(0,A.YP)(Qg,ph(ch().mark((function e(){return ch().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:return Wg.splice(0),document.querySelectorAll(".vtl-tbody-checkbox").forEach((function(e){return e.checked=!1})),document.querySelector(".vtl-thead-checkbox").checked&&document.querySelector(".vtl-thead-checkbox").click(),Xg.splice(0),c.value=s.value[Qg.value],e.next=9,f(Qg.value,Wg);case 9:rh("body").loadingModal("hide"),rh("body").loadingModal("destroy");case 11:case"end":return e.stop()}}),e)}))));var h={buylist_lastyear:[],buylist:[],inbound:[]};(0,A.YP)(o,ph(ch().mark((function e(){var t,n,a,r,i,l,s;return ch().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:if(h={buylist_lastyear:[],buylist:[],inbound:[]},Wg.splice(0),""!=o.value){e.next=8;break}return rh("body").loadingModal("hide"),rh("body").loadingModal("destroy"),e.abrupt("return");case 8:for(t=JSON.parse(o.value),n=function(e){var n=t.buylist_lastyear.filter((function(t){return new Date(t.請購時間.replace(" ","T")).getMonth()==e})),o=Object.values(n.reduce((function(e,t){var n=e[t.料號];return n?(n.本次請購數量+=parseFloat(t.本次請購數量),n.匯率+=parseFloat(t.匯率)):(t.匯率=parseFloat(t.匯率),t.本次請購數量=parseFloat(t.本次請購數量),e[t.料號]=t),e}),{}));h.buylist_lastyear[e]=o},a=0;a<12;a++)n(a);for(r=function(e){var n=t.buylist.filter((function(t){return new Date(t.請購時間.replace(" ","T")).getMonth()==e})),o=Object.values(n.reduce((function(e,t){var n=e[t.料號];return n?(n.匯率=parseFloat(n.匯率)+parseFloat(t.匯率),n.本次請購數量=parseFloat(n.本次請購數量)+parseFloat(t.本次請購數量)):(t.匯率=parseFloat(t.匯率),t.本次請購數量=parseFloat(t.本次請購數量),e[t.料號]=t),e}),{}));h.buylist[e]=o},i=0;i<12;i++)r(i);for(l=function(e){var n=t.inbound.filter((function(t){return new Date(t.入庫時間.replace(" ","T")).getMonth()==e})),o=Object.values(n.reduce((function(e,t){var n=e[t.料號];return n?n.入庫數量=parseInt(n.入庫數量)+parseInt(t.入庫數量):(t.入庫數量=parseInt(t.入庫數量),e[t.料號]=t),e}),{}));h.inbound[e]=o},s=0;s<12;s++)l(s);return console.log(h),e.next=18,f(Qg.value,Wg);case 18:return e.next=20,g();case 20:rh("body").loadingModal("hide"),rh("body").loadingModal("destroy"),eh.isLoading=!1;case 23:case"end":return e.stop()}}),e)}))));return{table:eh,searchTerm:Kg,updateCheckedRows:function(e){Xg.length=0,Xg.push.apply(Xg,lh(e))},OutputExcelClick:p,yearTag:Yg,monthStr:c}}});var fh=n(4180),gh={insert:"head",singleton:!1};bt()(fh.Z,gh);fh.Z.locals;const hh=(0,w.Z)(dh,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",kg,[(0,d._)("h3",Pg,(0,d.zw)(e.yearTag+"-"+e.monthStr+" "+e.$t("callpageLang.diffalert")),1)]),(0,d._)("div",Sg,[(0,d._)("div",Ig,[(0,d._)("div",Ag,[(0,d._)("div",Eg,[(0,d._)("label",$g,(0,d.zw)(e.$t("basicInfoLang.quicksearch"))+" :",1)]),(0,d._)("div",Rg,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("monthlyPRpageLang.enterisn_or_descr"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,Og),[[d.nr,e.searchTerm]])])]),(0,d._)("div",Tg,[(0,d._)("button",{id:"download",name:"download",class:"col col-auto btn btn-lg btn-success",value:e.$t("monthlyPRpageLang.download"),onClick:t[1]||(t[1]=function(t){return e.OutputExcelClick("All")})},Mg,8,jg)])]),Ng,(0,d.Wm)(i,{id:"searchTable","is-fixed-first-column":!0,hasCheckbox:!0,isStaticMode:!0,isSlotMode:!0,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onReturnCheckedRows:e.updateCheckedRows},{料號:(0,d.w5)((function(e){var t=e.row;e.key;return[(0,d._)("div",Bg,(0,d.zw)(t.料號),1)]})),請購數量:(0,d.w5)((function(e){var t=e.row;e.key;return[(0,d._)("div",Dg,[(0,d._)("span",Fg,[(0,d.Uk)((0,d.zw)(parseInt(t.請購數量).toLocaleString("en",{useGrouping:!0}))+" ",1),(0,d._)("small",null,(0,d.zw)(t.單位),1)])])]})),實際領用數量:(0,d.w5)((function(e){var t=e.row;e.key;return[(0,d._)("div",Ug,[(0,d._)("span",qg,[(0,d.Uk)((0,d.zw)(parseInt(t.實際領用數量).toLocaleString("en",{useGrouping:!0}))+" ",1),(0,d._)("small",null,(0,d.zw)(t.單位),1)])])]})),需求與領用差異量:(0,d.w5)((function(e){var t=e.row;e.key;return[(0,d._)("div",Gg,[(0,d._)("span",zg,[(0,d.Uk)((0,d.zw)(parseInt(t.需求與領用差異量).toLocaleString("en",{useGrouping:!0}))+" ",1),(0,d._)("small",null,(0,d.zw)(t.單位),1)])])]})),需求與領用差異:(0,d.w5)((function(e){var t=e.row;e.key;return[(0,d._)("div",Hg,(0,d.zw)(t.需求與領用差異)+"% ",1)]})),_:1},8,["messages","columns","rows","total","page-options","sortable","onReturnCheckedRows"])])],64)}],["__scopeId","data-v-5858c480"]]);var mh={class:"card-header row align-items-center"},bh={class:"col col-2"},vh={class:"col col-auto align-middle m-0 p-0"},yh={class:"card-body"};var wh=n(5750),xh=n(2005);function _h(e){return _h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_h(e)}function Ch(){Ch=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==_h(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function Lh(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function kh(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){Lh(r,o,a,i,l,"next",e)}function l(e){Lh(r,o,a,i,l,"throw",e)}i(void 0)}))}}wh.kL.register(wh.uw,wh.f$,wh.ZL,wh.jn,wh.od,wh.Gu,wh.Dx,wh.u,wh.De);const Ph={name:"App",components:{Line:xh.x1},setup:function(){var e=(0,A.FN)(),t=document.getElementsByTagName("HTML")[0].getAttribute("lang");e.appContext.config.globalProperties.$lang.setLocale(t);var n=(0,d.iH)(null),o=new Date,a=o.getMonth(),r=o.getFullYear(),i=(0,d.iH)(e.appContext.config.globalProperties.$t("monthlyPRpageLang.months").split("_"));i.value.splice(a+1,12),(0,A.YP)(Yg,kh(Ch().mark((function t(){var n;return Ch().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:parseInt(Yg.value)==r?((n=e.appContext.config.globalProperties.$t("monthlyPRpageLang.months").split("_")).splice(a+1,12),i.value=n):i.value=e.appContext.config.globalProperties.$t("monthlyPRpageLang.months").split("_");case 1:case"end":return t.stop()}}),t)}))));var l=(0,d.Fl)((function(){return{labels:i.value,datasets:[{label:e.appContext.config.globalProperties.$t("outboundpageLang.realpickamount")+"(USD)",borderColor:"rgb(9, 116, 230)",backgroundColor:"rgba(9, 116, 230, 0.5)",pointStyle:"rect",data:Vg.value},{label:e.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount1")+"(USD)",borderColor:"rgb(245, 44, 44)",backgroundColor:"rgba(245, 44, 44, 0.5)",pointStyle:"rect",fill:"-1",data:Zg.value}]}}));return{chartRef:n,onClick:function(e){var t=n.value.chart;t&&function(e){if(e.length){var t=e[0],n=(t.datasetIndex,t.index);Qg.value=n}}((0,xh.cX)(t,e))},chartData:l,options:{interaction:{mode:"index",intersect:!1},responsive:!0,maintainAspectRatio:!1,hoverRadius:10},yearTag:Yg}}};var Sh=n(1274),Ih={insert:"head",singleton:!1};bt()(Sh.Z,Ih);Sh.Z.locals;const Ah=(0,w.Z)(Ph,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("Line");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",mh,[(0,d._)("div",bh,[(0,d.wy)((0,d._)("input",{id:"yearInput",class:"text-center m-0 p-0 form-control form-control-lg",type:"number",min:"1996","onUpdate:modelValue":t[0]||(t[0]=function(e){return o.yearTag=e})},null,512),[[d.nr,o.yearTag]])]),(0,d._)("h3",vh,(0,d.zw)(e.$t("callpageLang.diffalert")),1)]),(0,d._)("div",yh,[(0,d.Wm)(i,{ref:"chartRef",data:o.chartData,options:o.options,onClick:o.onClick},null,8,["data","options","onClick"])])],64)}],["__scopeId","data-v-2d256245"]]),Eh=(0,d.aZ)({name:"App",components:{DemandRecieveDiffTable:hh,ChartJSLine:Ah},setup:function(){var e=(0,A.FN)(),t=document.getElementsByTagName("HTML")[0].getAttribute("lang");e.appContext.config.globalProperties.$lang.setLocale(t);(0,d.iH)("");return{}}}),$h=(0,w.Z)(Eh,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("ChartJSLine"),l=(0,d.up)("DemandRecieveDiffTable");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",_g,[(0,d.Wm)(i)]),(0,d._)("div",Cg,[(0,d.Wm)(l)])],64)}]]);var Rh=function(e){return(0,d.dD)("data-v-25769560"),e=e(),(0,d.Cn)(),e},Oh={class:"card-header align-items-center"},Th={class:"col col-auto align-middle"},jh={class:"card-body"},Mh={class:"row justify-content-between"},Nh={class:"col col-auto"},Bh=["placeholder"],Dh=Rh((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)})),Fh={key:0,class:"m-0 p-0"},Uh=["id","onChange"],qh=["value","selected"],Gh={key:1,class:"m-0 p-0"},zh=["id","onChange","disabled"],Hh=["value","selected"],Jh={key:2},Yh=["value","onClick"],Qh={class:"modal fade",id:"siteListPicker","aria-hidden":"true","aria-labelledby":"siteListPicker",tabindex:"-1"},Xh={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},Zh={class:"modal-content"},Vh={class:"modal-header"},Kh={class:"modal-title"},Wh=Rh((function(){return(0,d._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)})),em={class:"modal-body CustomScrollbar"},tm={class:"row justify-content-center"},nm={class:"form-check form-switch col-9"},om=["id","value"],am=["for"],rm={class:"modal-footer"},im=Rh((function(){return(0,d._)("button",{type:"button",id:"DeleteUser",class:"btn btn-danger","data-bs-target":"#AreYouSureModal","data-bs-toggle":"modal"},"Delete This User",-1)})),lm={class:"modal fade",id:"AreYouSureModal","aria-hidden":"true","aria-labelledby":"AreYouSureModal",tabindex:"-1"},sm={class:"modal-dialog modal-dialog-centered"},cm={class:"modal-content"},um={class:"modal-body row justify-content-center"},pm=Rh((function(){return(0,d._)("span",{class:"col col-auto"},"Are You Sure ?",-1)})),dm=Rh((function(){return(0,d._)("div",{class:"w-100",style:{height:"1ch"}},null,-1)}));function fm(e){return fm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fm(e)}function gm(){gm=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==fm(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function hm(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function mm(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){hm(r,o,a,i,l,"next",e)}function l(e){hm(r,o,a,i,l,"throw",e)}i(void 0)}))}}var bm=n(9755);function vm(e){return vm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vm(e)}function ym(){ym=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var r=t&&t.prototype instanceof d?t:d,i=Object.create(r.prototype),l=new k(a||[]);return o(i,"_invoke",{value:x(e,n,l)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function d(){}function f(){}function g(){}var h={};s(h,r,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(P([])));b&&b!==t&&n.call(b,r)&&(h=b);var v=g.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(o,r,i,l){var s=u(e[o],e,r);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==vm(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(p).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(s.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){a(e,n,t,o)}))}return r=r?r.then(o,o):o()}})}function x(e,t,n){var o="suspendedStart";return function(a,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw r;return S()}for(n.method=a,n.arg=r;;){var i=n.delegate;if(i){var l=_(i,n);if(l){if(l===p)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=u(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}function _(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=u(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=g,o(v,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=s(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,o,a,r){void 0===r&&(r=Promise);var i=new w(c(t,n,o,a),r);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(v),s(v,l,"Generator"),s(v,r,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return i.type="throw",i.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var l=n.call(r,"catchLoc"),s=n.call(r,"finallyLoc");if(l&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function wm(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function xm(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){wm(r,o,a,i,l,"next",e)}function l(e){wm(r,o,a,i,l,"throw",e)}i(void 0)}))}}const _m=(0,d.aZ)({name:"App",components:{TableLite:wt},setup:function(){var e=function(){var e=(0,d.iH)(""),t=(0,d.iH)(""),n=(0,d.iH)(""),o=(0,d.iH)(""),a=(0,d.qj)([]),r=((0,m.tv)(),function(){var e=mm(gm().mark((function e(){var n;return gm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$().post("/getCurrentUser");case 2:n=e.sent,t.value=n.data;case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),i=function(){var e=mm(gm().mark((function e(){var t;return gm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$().post("/getDBList");case 2:t=e.sent,Object.assign(a,t.data.data),a.shift();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var t=mm(gm().mark((function t(){var o,a,r;return gm().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.value="",t.next=3,$().post("/getCurrentDB");case 3:return o=t.sent,t.next=6,$().post("/getCurrentUser");case 6:return a=t.sent,t.prev=7,t.next=10,$().post("/api/member/getUsers",{DB:o.data,CurrentUser:a});case 10:return r=t.sent,e.value=JSON.stringify(r.data),t.abrupt("return",new Promise((function(e,t){e("success")})));case 15:return t.prev=15,t.t0=t.catch(7),console.log(t.t0),t.abrupt("return",t.t0);case 19:case"end":return t.stop()}}),t,null,[[7,15]])})));return function(){return t.apply(this,arguments)}}(),s=function(){var e=mm(gm().mark((function e(){var t,a;return gm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return t=e.sent,e.prev=4,e.next=7,$().post("/api/member/getStaffs",{DB:t.data});case 7:return a=e.sent,o.value=JSON.stringify(a.data),e.abrupt("return",new Promise((function(e,t){e("success")})));case 12:return e.prev=12,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(){return e.apply(this,arguments)}}(),c=function(){var e=mm(gm().mark((function e(t,o){var a;return gm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return a=e.sent,e.prev=4,e.next=7,$().post("/api/member/usernamechange",{DB:a.data,username:t,priority:o});case 7:return e.sent,e.abrupt("return",new Promise((function(e,t){e("success")})));case 11:return e.prev=11,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=mm(gm().mark((function e(t,o){var a;return gm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return a=e.sent,e.prev=4,e.next=7,$().post("/api/member/update_available_dblist",{DB:a.data,username:t,list:o});case 7:return e.sent,e.abrupt("return",new Promise((function(e,t){e("success")})));case 11:return e.prev=11,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t,n){return e.apply(this,arguments)}}(),p=function(){var e=mm(gm().mark((function e(t){var o;return gm().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value="",e.next=3,$().post("/getCurrentDB");case 3:return o=e.sent,e.prev=4,e.next=7,$().post("/api/member/username_del",{DB:o.data,username:t});case 7:return e.sent,e.abrupt("return",new Promise((function(e,t){e("success")})));case 11:return e.prev=11,e.t0=e.catch(4),console.log(e.t0),e.abrupt("return",e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}();return{users:e,staffs:o,current_user:t,db_list:a,getUsers:l,getStaffs:s,getCurrentUser:r,getDBList:i,setPriority:c,setDBList:u,delUser:p}}(),t=e.users,n=e.getUsers,o=(e.staffs,e.getStaffs),a=e.current_user,r=e.getCurrentUser,i=e.db_list,l=e.getDBList,s=e.setPriority,c=e.setDBList,u=e.delUser;(0,A.wF)(xm(ym().mark((function e(){return ym().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:return e.next=4,r();case 4:return e.next=6,o();case 6:return e.next=8,n();case 8:case"end":return e.stop()}}),e)}))));var p=function(){var e=xm(ym().mark((function e(){return ym().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return bm("body").loadingModal({text:"Loading...",animation:"circle"}),e.abrupt("return",new Promise((function(e,t){e()})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=(0,d.iH)(""),g=(0,A.FN)(),h=document.getElementsByTagName("HTML")[0].getAttribute("lang");g.appContext.config.globalProperties.$lang.setLocale(h);var b=(0,d.qj)([]),v=(0,d.iH)(""),y=(0,d.iH)([]);function w(){return(w=xm(ym().mark((function e(t,n){return ym().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:return e.next=4,s(t,n);case 4:"success"===e.sent?notyf.open({type:"success",message:g.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+g.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}):notyf.open({type:"error",message:g.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),bm("body").loadingModal("hide"),bm("body").loadingModal("destroy");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=xm(ym().mark((function e(){var t,o;return ym().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="",o=v.value.split("(")[0],y.value.forEach((function(e){t=t+"_"+e})),y.value.length>0&&(t=t.slice(1)),e.next=6,p();case 6:return e.next=8,c(o,t);case 8:return"success"===e.sent?notyf.open({type:"success",message:g.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+g.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}):notyf.open({type:"error",message:g.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),bm("body").loadingModal("hide"),bm("body").loadingModal("destroy"),e.next=14,n();case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=xm(ym().mark((function e(){var t;return ym().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.value.split("(")[0],e.next=3,p();case 3:return e.next=5,u(t);case 5:return"success"===e.sent?notyf.open({type:"success",message:g.appContext.config.globalProperties.$t("monthlyPRpageLang.change")+" "+g.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}):notyf.open({type:"error",message:g.appContext.config.globalProperties.$t("checkInvLang.update_failed"),duration:3e3,ripple:!0,dismissible:!0,position:{x:"right",y:"bottom"}}),bm("body").loadingModal("hide"),bm("body").loadingModal("destroy"),e.next=11,n();case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,A.YP)(a,xm(ym().mark((function e(){return ym().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.value.priority>0&&C.columns.splice(5,2);case 1:case"end":return e.stop()}}),e)})))),(0,A.YP)(t,xm(ym().mark((function e(){var n,o,r;return ym().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b.splice(0),e.next=3,p();case 3:if(n=JSON.parse(t.value),a.value.priority>0)for(o=0;o<n.datas.length;o++)0!=n.datas[o].priority&&(n.datas[o].current_user_priority=a.value.priority,b.push(n.datas[o]));else for(r=0;r<n.datas.length;r++)n.datas[r].current_user_priority=a.value.priority,b.push(n.datas[r]);bm("body").loadingModal("hide"),bm("body").loadingModal("destroy"),C.isLoading=!1;case 8:case"end":return e.stop()}}),e)}))));var C=(0,d.qj)({isLoading:!0,columns:[{label:g.appContext.config.globalProperties.$t("loginPageLang.username"),field:"username",width:"10ch",sortable:!0,display:function(e,t){return'<div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.username+"</div>"}},{label:g.appContext.config.globalProperties.$t("loginPageLang.priority"),field:"priority",width:"10ch",sortable:!0},{label:g.appContext.config.globalProperties.$t("loginPageLang.name"),field:"姓名",width:"12ch",sortable:!0,display:function(e,t){return'<div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.姓名+"</div>"}},{label:g.appContext.config.globalProperties.$t("loginPageLang.dep"),field:"部門",width:"13ch",sortable:!0,display:function(e,t){return'<div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.部門+"</div>"}},{label:g.appContext.config.globalProperties.$t("loginPageLang.mail"),field:"email",width:"12ch",sortable:!0,display:function(e,t){return null===e.email||"null"==e.email?'<div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">N/A</div>':'<div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.email+"</div>"}},{label:g.appContext.config.globalProperties.$t("loginPageLang.database_list"),field:"available_dblist",width:"10ch",sortable:!1},{label:g.appContext.config.globalProperties.$t("loginPageLang.latest_login_time"),field:"last_login_time",width:"10ch",sortable:!0,display:function(e,t){return'<div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">'+e.last_login_time+"</div>"}}],rows:(0,d.Fl)((function(){return b.filter((function(e){return e.username.toLowerCase().includes(f.value.toLowerCase())||e.姓名.includes(f.value)}))})),totalRecordCount:(0,d.Fl)((function(){return C.rows.length})),sortable:{order:"id",sort:"asc"},messages:{pagingInfo:g.appContext.config.globalProperties.$t("basicInfoLang.now_showing")+" {0} ~ {1} "+g.appContext.config.globalProperties.$t("basicInfoLang.record")+", "+g.appContext.config.globalProperties.$t("basicInfoLang.total")+" {2} "+g.appContext.config.globalProperties.$t("basicInfoLang.record"),pageSizeChangeLabel:g.appContext.config.globalProperties.$t("basicInfoLang.records_per_page"),gotoPageLabel:g.appContext.config.globalProperties.$t("basicInfoLang.go_to_page"),noDataAvailable:g.appContext.config.globalProperties.$t("basicInfoLang.search_with_no_data_returned")},pageOptions:[{value:10,text:10},{value:20,text:20},{value:40,text:40},{value:100,text:100}]});return{db_list:i,searchTerm:f,table:C,clickedUser:v,InfoBtClicked:function(e,t,n){v.value=e+"("+t+")",y.value=n.split("_")},current_user:a,priorityChange:function(e,t){return w.apply(this,arguments)},checkedDBs:y,submitNewDBList:function(){return x.apply(this,arguments)},DeleteUser:function(){return _.apply(this,arguments)}}}});var Cm=n(4475),Lm={insert:"head",singleton:!1};bt()(Cm.Z,Lm);Cm.Z.locals;const km=(0,w.Z)(_m,[["render",function(e,t,n,o,a,r){var i=(0,d.up)("table-lite");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",Oh,[(0,d._)("h3",Th,(0,d.zw)(e.$t("templateWords.UserInfo")),1)]),(0,d._)("div",jh,[(0,d._)("div",Mh,[(0,d._)("div",Nh,[(0,d.wy)((0,d._)("input",{id:"pnInput",class:"text-center form-control form-control-lg",placeholder:e.$t("loginPageLang.username_search"),"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchTerm=t})},null,8,Bh),[[d.nr,e.searchTerm]])])]),Dh,(0,d.Wm)(i,{id:"searchTable","is-fixed-first-column":!0,isStaticMode:!0,isSlotMode:!0,hasCheckbox:!1,messages:e.table.messages,columns:e.table.columns,rows:e.table.rows,total:e.table.totalRecordCount,"page-options":e.table.pageOptions,sortable:e.table.sortable,onIsFinished:t[1]||(t[1]=function(t){return e.table.isLoading=!1})},{priority:(0,d.w5)((function(t){var n=t.row;t.key;return[0==n.current_user_priority?((0,d.wg)(),(0,d.iD)("div",Fh,[(0,d._)("select",{class:"form-select text-center m-0 p-0",id:n.username,style:{width:"8ch"},onChange:function(t){return e.priorityChange(n.username,t.target.value)}},[((0,d.wg)(),(0,d.iD)(d.HY,null,(0,d.Ko)([0,1,2,3,4],(function(e){return(0,d._)("option",{value:e,selected:n.priority==e},(0,d.zw)(e),9,qh)})),64))],40,Uh)])):1==n.current_user_priority?((0,d.wg)(),(0,d.iD)("div",Gh,[(0,d._)("select",{class:"form-select text-center m-0 p-0",id:n.username,style:{width:"8ch"},onChange:function(t){return e.priorityChange(n.username,t.target.value)},disabled:n.priority<=n.current_user_priority},[((0,d.wg)(),(0,d.iD)(d.HY,null,(0,d.Ko)([1,2,3,4],(function(e){return(0,d._)("option",{value:e,selected:n.priority==e},(0,d.zw)(e),9,Hh)})),64))],40,zh)])):((0,d.wg)(),(0,d.iD)("div",Jh,(0,d.zw)(n.priority),1))]})),available_dblist:(0,d.w5)((function(t){var n=t.row;t.key;return[(0,d._)("button",{value:n.available_dblist,type:"button",style:{"border-radius":"20px"},class:"btn btn-outline-info dbInfo btn-sm m-0 px-3 py-0","data-bs-toggle":"modal","data-bs-target":"#siteListPicker",onClick:function(t){return e.InfoBtClicked(n.username,n.姓名,n.available_dblist)}},"Info",8,Yh)]})),_:1},8,["messages","columns","rows","total","page-options","sortable"])]),(0,d._)("div",Qh,[(0,d._)("div",Xh,[(0,d._)("div",Zh,[(0,d._)("div",Vh,[(0,d._)("h3",Kh,"Available Databases for "+(0,d.zw)(e.clickedUser),1),Wh]),(0,d._)("div",em,[(0,d._)("div",tm,[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.db_list,(function(n){return(0,d.wg)(),(0,d.iD)("div",nm,[(0,d.wy)((0,d._)("input",{class:"form-check-input dbCheckbox",type:"checkbox",role:"switch",id:"".concat(n.replace("Consumables management","").trim()),value:"".concat(n.replace("Consumables management","").trim()),"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.checkedDBs=t})},null,8,om),[[d.e8,e.checkedDBs]]),(0,d._)("label",{class:"form-check-label",for:"".concat(n.replace("Consumables management","").trim())},(0,d.zw)(n),9,am)])})),256))])]),(0,d._)("div",rm,[im,(0,d._)("button",{type:"button",id:"ListConfirm",class:"btn btn-success",onClick:t[3]||(t[3]=function(t){return e.submitNewDBList()})}," Save Changes ")])])])]),(0,d._)("div",lm,[(0,d._)("div",sm,[(0,d._)("div",cm,[(0,d._)("div",um,[pm,dm,(0,d._)("button",{id:"ImSure",class:"col col-auto btn btn-outline-danger","data-bs-dismiss":"modal",onClick:t[4]||(t[4]=function(t){return e.DeleteUser()})},"YES")])])])])],64)}],["__scopeId","data-v-25769560"]]);n.g.$=n.g.jQuery=n(9755),n(7333),window.Vue=n(3868).default,window.Notyf=o.Iq;var Pm=(0,d.ri)({components:{"vue-bread-crumb":T,"mats-info-table":Tt,"mats-info-upload-table":yn,"inbound-search-table":zn,"inbound-stock-table":po,"inbound-month-table":Io,"inbound-stock-upload-table":Ya,"outbound-pickrecord-table":lr,"outbound-backrecord-table":xr,"transit-search-table":ci,"sxb-search-table":al,"unit-consumption-upload-table":ns,"unit-consumption-search-table":Ds,"monthly-pr-table":xu,"non-monthly-pr-table":Wp,"combined-monthly-search-table":Vd,"obound-insearch-table":ff,"obound-isnsearch-table":Sf,"obound-pickrecord-table":Uf,"obound-backrecord-table":tg,"obound-stock-table":hg,"news-table":xg,"demand-recieve-diff-page":$h,"user-table":km}});Pm.use(f.Z,{messages:h()}),Pm.use(M),Pm.mount("#mountingPoint")},7333:(e,t,n)=>{n(9755),n(9755);window._=n(6486);try{window.Popper=n(8981).Z,n(9755),n(8877)}catch(e){}window.axios=n(9669),window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"},8571:()=>{window.theme={primary:"#3B7DDD",secondary:"#6c757d",success:"#1cbb8c",info:"#17a2b8",warning:"#fcb92c",danger:"#dc3545",white:"#fff","gray-100":"#f8f9fa","gray-200":"#e9ecef","gray-300":"#dee2e6","gray-400":"#ced4da","gray-500":"#adb5bd","gray-600":"#6c757d","gray-700":"#495057","gray-800":"#343a40","gray-900":"#212529",black:"#000"}},3624:e=>{e.exports={"en.auth":{failed:"Login data does not match",throttle:"Too many login attempts. Please try again in seconds."},"en.barcodeGenerator":{Delete_Notice:"Deleting here only means the barcode will not be printed.",Temporary_Storage_Zone:"Temporary Storage Zone",barcode_gening:"Barcode Generate",batch_upload:"Batch Generate",enter_isn:"Enter a PN.",enter_loc:"Enter a Loc.",enter_pName:"Enter a Descr.",exampleExcel:"Example Download",gen:"Generate",isn:"PN",isn_gen_barcode:"Generate PN Barcode",leaving_page_alert:"Leaving the page will clean up all inputs, are you sure?",loc:"Location",loc_gen_barcode:"Generate Loc. Barcode",nothing_to_print:"Nothing to print",pName:"Description",page_name:"Barcode",plz_upload:"Upload an Excel File",print:"Print",print_amount:"Print Qty",search:"Search",search_isn:"Search PN ",search_loc:"Search Location ",spec:"Specification",temp_save_error:"Error :",temp_save_success:"Successfully Saved",upload_save_success:"Successfully Uploaded"},"en.basicInfoLang":{add:"Add",addtodatabase:"Add to Database",basicInfo:"Basic Info.",belong:"Attr.",change:"Update",check:"Check",client:"Client",consume:"Unit Cons.",data:"data",delete:"Delete",differ_by_client:"Vary by clients",download:"Download Excel",enterbelong:"Please select the attribution of consumables",enterformat:"Please Enter Spec.",enterisn:"Please Enter PN",enterlt:"Please Enter LT",entermoney:"Please Select Currency",entermoq:"Please Enter MOQ",entermpq:"Please Enter MPQ",enterpName:"Please Enter Descr.",enterprice:"Please Enter Unit Price",entersafe:"Please Enter Safety Stock",entersenddep:"Please select issuing department",enterunit:"Please enter Unit",enteryorn:"Please Select Yes/No",equiproom:"Equipment Spare parts room",exampleExcel:"Example Download",factory:"Factory",format:"Spec.",go_to_page:"Go to Page : ",gradea:"Grade-A",ieroom:"IE Spare parts room",inreason:"Reason of Inbound",isn:"PN",isnlength:"PN length is not 12",isnrepeat:"Duplicate PN",line:"Line",loc:"Location",lt:"LT",machine:"Model",matsInfo:"Material Info.",matsdata:"Material Data",matssearch:"PN Search",meroom:"ME Spare parts room",money:"Currency",month:"Monthly PR",moq:"MOQ",mpq:"MPQ",new:"New",newMats:"Add Material",newbasicInfo:"New Basic Info.",no:"No",nocheck:"Please check the items to be submitted",nodata:"Nothing to submit",now_showing:"Showing",obound:"Vendor Stock",pName:"Descr.",page_name:"Basic Info.",plz_upload:"Upload an Excel File",price:"Unit-Price",process:"Process",quicksearch:"Search By",record:"reocords",records_per_page:"Row count : ",repeat:"The data has been stored in the database, please confirm.",return:"Return",returnreason:"Reasons of Return",room:"Spare parts room",row:"in row",safe:"Safety Stock",safeerror:"Safety stock of non monthly purchase requisition is required",search_with_no_data_returned:"No Data Found",searchisn:"Search all directly, or enter the part number to search at the beginning",searchisn1:"Enter multiple item numbers for query, separated by newlines(Enter-key)",senddep:"Issue Dep.",stand:"Station",submit:"Submit",success:"Success",total:"Total",unit:"Unit",upload:"Batch Upload",upload1:"Upload",uploaderror:"Not a format for upload of basic information",usedep:"Receiving Dep.",usereason:"Reason of Req.",yellowrepeat:"Yellow background means that the data already exist in the database",yes:"Yes"},"en.bupagelang":{amounterr:"Transfer Qty < stock or <=0",amounterr1:"Acq Qty Exceeds Stock",begindate:"starting date",bu:"BU Consumable Mgmt.",buyrecord:"Recent order record",buytime:"Recent order time",changeok:"Updated successfully",check:"Check",checkreceive:"Confirm whether to receive",checktrans:"Confirm whether to dial out",client:"Clients",days:"Inactive Days",dbadd:"Transfer list add",dblist:"Transfer list number",delete:"Delete",download:"Download",enddate:"ending date",enteramount:"Please Enter Qty",enterclient:"Please select client",enterfactory:"Please select factory",enterisn:"Please enter the PN",enterloc:"Please select Location",enteroutlist:"Please select an outgoing order",enteroutpeople:"Please select dialed people",enterpicklist:"Please select received list",enterreceivepeople:"Please select received people",factory:"Factorys",factorychange:"Factory transfer",format:"Spec.",inboundtime:"inbound time",inventoryerr:"Inventory changes, please rearrange",isn:"PN",isnlength:"PN length is not 12",jobnum:"Job number",loc:"Locations",name:"Name",nocheck:"Please check the item to be deleted / updated",nocheck1:"Please tick the items you want to submit",noisn:"PN does not exist",nooutpeople:"The ID of the dialed people does not exist, please go to User Management-Maintenance of New Person Information",nopickpeople:"The ID of the picker does not exist, please go to User Management-Maintenance of New Person Information",notequal:"not equal",nowstock:"NowStock",opentime:"open list time",outboundtime:"outbound time",outdetail:"Dialed detail",outfactory:"Dialed factory",outlist:"Transfer List <br/> &nbsp;&nbsp;&nbsp; (outbound)",outpeople:"dialed people",outtime:"Dialed time",pName:"Descr.",page_name:"BU Consumable Mgmt.",picklist:"Transfer List <br/> &nbsp;&nbsp;&nbsp; (inbound)",preamount:"Expected Qty",realamount:"Acq Qty",realpickamount:"Acq Qty",receiveamount:"Received Qty",receivedetail:"Received detail",receivefac:"receive factory",receivepeople:"receive people",receivetime:"Received time",remark:"Remarks",return:"return",row:"in Row",search:"Search",searchdetail:"Transfer Detail Search",searchlist:"Transfer List Search",searchoutlist:"Search dialed list",searchpicklist:"Search received list",senddep:"Issuing department",sluggish:"Passive stock",status:"status",stock:"Stock",submit:"Submit",success:"Success",timepart:"Time Period",tranamount:"Transfer Qty",transamount:"Dialed Qty",transpeople:"Transfer people",unit:"Unit"},"en.callpageLang":{callsys:"Alarm System",change:"Update",client:"Client",dayalert:"Passive Day Alert",days:"Inactive Days",diffalert:"PR. vs. Acquired",entersenddep:"Please select issuing department",format:"Spec.",ismonth:"Monthly purchase consumables",isn:"PN",loc:"Location",mark:"Remarks",month:"Monthly purchase",nostock:"There is no stock at present",notmonth:"Non-monthly purchase consumables",nowstock:"Available Stock",pName:"Descr.",page_name:"Alarm System",req_vs_real:"PR vs. Acq Qty",req_vs_real_percent:"PR vs. Acq %",return:"Return",safe:"Safety Stock",safealert:"Safety Stock Alert",saveremark:"Save Remark",senddep:"Issuing department",stock:"Total Stock",success:"Success"},"en.checkInvLang":{all:"All",check:"Stocktake",check_not_right_amount:"Excess/Short",check_result:"Result of Stocktaking",checked:"Stocktaked",checking_result:"Result",client:"Client",continue_check:"Proceed",create_new_table:"Create New Sheet",create_table_fail:"Process Failed",create_table_success:"New Sheet Created !",created_by:"Created By",created_time:"Created Time",edit:"Edit",exact:"Exact",excess:"Excess",existed_tables:"There are existed sheets",has:"Has",has_exist_sheet_confirm:"Existing sheets found, do you still want to create a new sheet?",input_isn_barcode:"Scan In PN Barcode",input_loc_barcode:"Scan In Loc. Barcode",inventory:"Inventory",isn:"PN",loc:"Location",loc_short:"Loc.",no_results_found:"No Results Found !",no_such_isn:"No Such PN",no_such_loc:"No Such Location",no_table_found:"No table Found",not_checked:"Not Stocktaked",page_name:"Stock-taking",plz_create:"No recent sheets found, please create a new one.",product_name:"Name",search:"Search",search_by:"Search by",sent_email_failed:"E-Mail Failed.",serial_number:"Serial No.",shortage:"Shortage",sort_by:"Sort by",stock:"Stock",submit:"Submit",this:"This",time_range:"Time Range",unchecked:"not yet stocktaked !",unknown:"N/A",update_failed:"Update Failed.",update_success:"Update Success!",updated_at:"Updated At",updated_by:"Updated By",value_not_changed:"The inventory result has not changed. Are you sure to send it?"},"en.fileUploadErrors":{Content_errors:"There are errors within the file.",Exceeded_filesize_limit:"Exceeded Filesize Limit",Failed_to_move_uploaded_file:"Failed to Move Uploaded File",Invalid_file_format:"Unsupported File Extension",Invalid_parameters:"Invalid Parameters",No_file_sent:"No File Sent",Unknown_errors:"Unknown Errors"},"en.httpErrors":{error_569_msg:"Login Failed",error_569_title:"Login Failed"},"en.inboundpageLang":{add:"Add",addclient:"Add(By client)",addtodatabase:"Add to Inventory",amount:"Qty",begindate:"Begin date",change:"Update",check:"Check",client:"Clients",coming:"Coming from",days:"Inactive Days",delete:"Delete",download:"Download",enddate:"End date",enteramount:"Please Enter Qty",enterclient:"Please select the client",enterinlist:"Please enter the Inbound list No.",enterinpeople:"Please select the inbound people",enterinreason:"Please select a reason",enterisn:"Please enter the PN",enterloc:"Please select Location",entersenddep:"Please select the Issuing department",exampleExcel:"Example Download",format:"Spec.",gradea:"GradeA Material",inboundnum:"Inbound Qty",inboundtime:"Inbound time",inlist:"Inbound list no.",inpeople:"Inbound People",inputinreason:"Please input a reason",inreason:"Reason",isn:"PN",isnlength:"PN length is not 12",lessstock:"Current inventory is less than the inbound qty, cannot delete some of the inbound records.",loc:"Location",locationchange:"Location Transfer",locchangeerr:"Transfer qty cannot exceed the available inventory, cannot submit the transfer.",mark:"Remarks",money:"Currency",month:"Mothly PR",monthuse:"Monthly Use",new:"New",newloc:"Send to Loc.",no_basic:"PN data not exist",no_basic_are_highlighted:"PN in red indicates that the material info. is not maintained",nocheck:"Please tick the items you want to delete/update",noclient:"Client does not exist",nogood:"Defectives",noinpeople:"The ID does not exist, please go to User Mgmt. -> Modify Staff Info.",noisn:"PN does not exist",noloc:"Location does not exist",notransit:"Picking list cannot be opened because the in transit quantity is 0",nowstock:"Stock",oldloc:"Stock Loc.",other:"other",pName:"Descr.",page_name:"Inbound",plz_upload:"Upload an Excel File",price:"Unit price",record:"Records",repeated_isn_90_pair:"Repeated PN & 90PN Pairs",repeated_isn_loc_pair:"Repeated PN & Loc. Pairs",return:"return",rfidinpeople:"Please click here to tap ID card",row:"On Row",safe:"Safety Stock",search:"Search",searchstock:"Stock Search",senddep:"Issuing department",stock:"Stock",stockmonth:"In-Use Months",stockupload:"Stock Upload",submit:"Submit",success:"Success",timepart:"Time period",to:"to",total:"Total",transfer:"transfer",transferamount:"Transfer Qty",transit:"Qty in Transit",transiterror:"The receipt quantity cannot be greater than the in transit quantity",unit:"Unit",updatetime:"Updated On",upload:"Batch Upload",upload1:"Upload"},"en.loginPageLang":{addtodatabase:"AddtoDatabase",adduser:"Add User",againlogin:"Please log in again",change:"Update",changeMail:"Change Email",changePass:"Change Password",change_site_permission_reset:"Your permission will be reset.<br/>Contact the site manager for more permissions.",check:"Check",current_permission:"Current Permission",data:"Data",database_list:"Databases",delete:"Delete",dep:"Department",email:"Company Email",enter_email:"Enter Email Account",enterdep:"Please Enter the Department",enteremail:"Please enter company email",enterjobsearch:"Please enter your ID",enterlogin:"Please enter the login account",entername:"Please enter your name",enternewpass:"Enter New Password",enteroldpass:"Enter Old Password",enterpassword:"Enter New Password Again",enterpriority:"Please Select the Permission",errorpassword:"The old password was incorrect",errorpassword2:"The password does not match",exampleExcel:"Example format download",functionality:"Functionality",home:"Home",joblength:"The length of the ID is not 9",jobnumber:"ID",jobrepeat:"ID repeat",jobsearch:"ID search",latest_login_time:"Latest Login",login_btn:"Login",loginsearch:"Login account search",mail:"Email",name:"Name",new:"New",newSSO_msg:"This OA account has not logged in before.<br/>Please complete the form for initial settings.",new_email:"New Email",newpass:"New Password",no_email:"None",nocheck:"Please tick the items you want to submit",old_email:"Old Email",oldpass:"Old Password",page_name:"User Mgmt.",password:"Password",password_placeholder:"Enter your password",permission_details:"Permission Details",permission_notice:"Your permission might be restricted at first (lv 4).<br/>Contact your manager for more permissions.",pinf:"Personnel Info.",plz_upload:"Please upload an Excel file",pre_page:"Prev.",priority:"Permission",profile_pic:"Profile Pic",record:"Record",return:"return",row:"On Row",search:"Search",selectprofile_pic:"Please select Profile Pic",settings:"Settings",signup:"Sign Up",site:"Site",site_error:"Please select your site.",site_placeholder:"Choose your site",submit:"Submit",success:"Success",surepassword:"Confirm Password",total:"Total",upload:"Batch upload",upload1:"Upload",user:"User",username:"ID",username_placeholder:"Enter your username",username_search:"Search by ID/Name",usernamerepeat:"The account is repeated, please enter again.",welcome:"Welcome",welcome_msg:"Sign in to your account to continue",yellowrepeat:"Yellow background means that the data already exist in the database"},"en.monthlyPRpageLang":{"90isn":"90PN","90isnlength":"90PN length incorrect",PR:"Export All PR Data",SXB_search:"PR Record",SendPRReview:"Apply",UpdateUnitPrice:"Update Unit Price",add:"Add",addtodatabase:"Add to Database",allclient:"ALL Client",applydate:"Date",buyamount:"Req Qty INST",buyamount1:"Req Qty",buyper:"％ of Demand",buyprice:"Req Amt",buytime:"Req Time",change:"Updated",check:"Check",clickmail:"Click Here",client:"Clients",confirmemail:"Confirm Email",confirmpeople:"Confirm People",consume:"Unit Cons.",consumemail:"Hi, Please Click this link to confrim Consume data.",control:"Control items",data:"Data",delete:"Delete",description:"Descr.",download:"Download",email:"Email",emailsender:"Email Sender",enter90isn:"Search 90PN",enteramount:"Qty",enterclient:"Select a Client",entercontrol:"Select Control Items",enterdesc:"Descr.",enterisn:"PN",enterisn_90pn_or_descr:"PN/90PN/Descr.",enterisn_or_descr:"PN/Descr.",entermachine:"Select a Model",entermoney:"Select a CUR",enterprocess:"Select a Process",entersenddep:"Select a Issuing Dept.",entersrm:"SRM No.",entersxb:"No.",errormonth:"For monthly purchase requisition consumables, control LN and description must be filled in.",exampleExcel:"Example Download",exchangerate_notfound:"EXR Not Found",export:"Export",export1:"Export inquiry price style",exportspan:"Only the records with Buying Qty > 0 will be exported",format:"Spec.",generatePR:"Generate PR",importMonthlyData:"Import Monthly PR Data",importNonMonthlyData:"Import Non-Monthly PR Data",info:"Info.",isn:"PN",isnConsumeAdd:"Unit Consumption (Add)",isnConsumeUpdate:"Unit Consumption (Search & Update)",isnlength:"PN length is not 12",loadconsume:"Load Rejected Records",loadsuccess:"Loaded Successfully",lt:"LT",machine:"Models",markconsume:"If checked, the consumption engineer had confirmed it.<br/>\n                    If not, it means the record was rejected.",markstand:"If checked, the station manpower engineer had confirmed it.<br/>\n                    If not, it means the record was rejected.",money:"Currency",month:"Mothly PR",months:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec",moq:"MOQ",mpq:"MPQ",needper:"％ of Req",needprice:"Demand Amt",new:"New",nextchange:"Daily change frequency PROX",nextclass:"Number PROX of class",nextday:"Prod. Days PROX",nextdayneed:"Daily Demand PROX",nextline:"Number PROX of line",nextmps:"MPS PROX",nextneed:"Demand PROX",nextpeople:"Number PROX of stand",nextuse:"Daily Demand per Person PROX",no_req_amount_to_submit:"All Buying Qty is 0, nothing to submit",nocheck:"Tick the items you want to submit",noclient:"Client does not exist",nodata:"Nothing to submit",noemail:"Signatory",noisn:"PN does not exist",noload:"No Data Were Loaded",nomachine:"Model does not exist",nonmonthly_pr_already_sxb:"The following materials have been filed for approval：",nopeople:"Signatory's Staff ID",noproduction:"Process does not exist",notmonth:"Non-monthly PR",nounitconsumption:"Unit Cons. does not exist or not yet approved",nowchange:"Daily change frequency INST",nowclass:"Number of shifts INST",nowday:"Prod. Days INST",nowdayneed:"Daily Demand INST",nowline:"Number of lines opened INST",nowmps:"MPS INST",nowneed:"Demand INST",nowpeople:"Number of stations INST",nowrite:"Not yet filled in the field",nowstock:"Stock",nowuse:"Daily Demand per Person INST",on_the_way_search:"On-Order Qty",pName:"Descr.",page_name:"Monthly PR",please_utilize:"Please Utilize",plz_upload:"Upload an Excel File",plz_write:"Please fill in the field",price:"Unit Price",process:"Processes",rate:"Exachange Rate",realneed:"Actual Demand",reason:"Enter a Reason",record:"Record",remark:"Remarks",repeat:"The data has been stored in the database, please check.",repeated_isn:"Repeated PN",return:"return",review_cancel:"Reject",review_complete:"Approve",review_pending:"Pending",row:"On Row",safe:"Safety Stock",search:"Search",senddep:"Issuing Dept.",shallow_delete:"To delete completely, please go to Import (Non)Monthly PR.",some_data_has_no_amount:"Only the records with Buying Qty > 0 will be submitted",srm:"SRM number",srmspan:"Only fill in the tick column",stand:"Station Manpower",standAdd:"Station Manpower (Add)",standUpdate:"Station Manpower (Search & Update)",standmail:"Hi, Please Click this link to confrim Stand data.",status:"Status",submit:"Submit",submitspan:"Only the columns filled with SRM and Buying Qty > 0 will be submitted or exported",success:"Successfully",surepeople:"Signatory's Staff ID",surepeopleemail:"Signatory's Email",sxbamount:"SXB Qty",sxbamounterr:"The qty of SXB cannot exceed buying qty",timepart:"Time period",to_update_unit_price:"to Update Unit Price.",total:"Total",transit:"In-Transit",transit_reviser:"Reviser",unit:"Unit",upload:"Batch Upload",upload1:"Upload",uploadtime:"Upload Time",writesrm:"Write SRM number",writetime:"Updated At",yellowrepeat:"Yellow background means that the data already exist in the database"},"en.oboundpageLang":{add:"Add",addtodatabase:"Add to database",amount:"Qty",amountzero:"The qty of storage cannot be less than or equal to 0",back:"Return Material",backamount:"Pre-return Qty",backdiffreason:"Reason for actual returned diff.",backlist:"Material Return Sheet",backlistnum:"Return List #",backpeople:"Rejecter",backpeoplenum:"Rejecter's ID",backreason:"Return Reason",backrecord:"Material Return Record",begindate:"starting date",bound:"Library",client:"Clients",data:"data",delete:"delete",deletebacklist:"Delete return list",deletepicklist:"Delete pickup list",diffreason:"Reason of Diff",download:"Download",enddate:"ending date",enteramount:"Please Enter Qty",enterbacklist:"Please select returning list",enterbackpeople:"Please select return people",enterbackreason:"Please select return reason",enterbound:"Please select the library",enterclient:"Please select client",enterdiffreason:"Please input the reason",enterformat:"Please enter the Specification",enterinpeople:"Please select the inbound people",enterinreason:"Please select a reason",enterisn:"Please enter the PN",enterline:"Please select line",entermachine:"Please select model",enterpName:"Please enter the Description",enterpicklist:"Please select pickup list",enterpickpeople:"Please Select Picker",enterprocess:"Please select process",enterreceivepeople:"Please select receivier",entersendpeople:"Please Select Dispatcher",enterstatus:"Please select the status",enterusereason:"Please select usereason",exampleExcel:"Example Download",format:"Spec.",good:"Good product",inbound:"Inbound",inboundnum:"Inbound Amt",inboundsearch:"Inbound Search",inboundtime:"Inbound time",inlist:"Inbound list number",inpeople:"Inbound People",inputbackpeople:"Please input Rejecter ID",inputbackreason:"Please enter return reason",inputinreason:"Please enter a reason",inputpickpeople:"Please input Picker ID",inputreceivepeople:"Please input Receiver ID",inputsendpeople:"Please input Dispatcher ID",inputusereason:"Please enter usereason",inreason:"Reason",isn:"PN",isnlength:"PN length is not 12",isnrepeat:"Duplicate Part Number",lessstock1:"The current inventory is less than the receipt quantity. This receipt cannot be deleted.",line:"Lines",machine:"Models",mark:"Remarks",matsInfo:"Material Info.(Search)",matsdata:"Material Data",new:"New",newMats:"Add Material",nobackpeople:"The ID of the return people does not exist, please go to User Management-Maintenance -> Person Information",nobound:"Library does not exist",nocheck:"Please tick the items you want to delete/update",noclient:"Client does not exist",nogood:"rejects",noinpeople:"The ID of the inbound people does not exist, please go to User Management-Maintenance -> Person Information",noisn:"PN does not exist",nopickpeople:"The ID of the picker does not exist, please go to User Management-Maintenance -> Person Information",noreceivepeople:"The ID of the Receiver does not exist, please go to User Management-Maintenance -> Person Information",nosendpeople:"The ID of the sender does not exist, please go to User Management-Maintenance -> Person Information",nostock:"The Client & PN do not have stock can not bill material requisition",nowbound:"current library",nowstock:"Available Stock",oisn:"Vendor Stock PN",opentime:"Open list time",other:"other",outbackok:"Outbound completed Backlist number",outboundtime:"outbound time",outpickok:"Outbound completed Picklist number",pName:"Descr.",page_name:"Vendor Stock",pick:"Pick Material",pickamount:"Quantity to be Collected",picklist:"Pick Material List",picklistnum:"Pickup list number",pickpeople:"Picker",pickpeoplenum:"Picker's ID",pickrecord:"Pick Material Record",plz_upload:"Upload an Excel File",process:"Processes",realbackamount:"Actual Returned Qty",realpickamount:"Acq Qty",receivepeople:"Receiver",receivepeoplenum:"Receiver's ID",record:"Record",return:"return",rfidinpeople:"Click here and tap the Inbound Staff's ID card",row:"On Row",search:"Search",searchbacklist:"Search return list",searchpicklist:"Search pickup list",searchstock:"Stock Search",senddep:"Issuing department",sendpeople:"Material issuing personnel",sendpeoplenum:"Material issuing personnel ID",status:"Status",stockless:"The inventory is less than the actual requisition quantity thus cannot outbound",stockupload:"Stock Upload",submit:"Submit",success:"Success",timepart:"Time period",total:"Total",unit:"Unit",updatetime:"Updated On",upload:"Batch Upload",upload1:"Upload",usereason:"Reason",yellowrepeat:"Yellow background means that the data already exist in the database"},"en.outboundpageLang":{add:"Add",back:"Return Material",backamount:"Pre-return Qty",backdiffreason:"Reason of Actual Returned Diff",backlist:"Material Return Sheet",backlistnum:"Return List #",backpeople:"Rejecter",backpeoplenum:"Rejecter's ID",backreason:"Return Reasons",backrecord:"Material Return Record",begindate:"starting date",client:"Clients",delete:"delete",deletebacklist:"Delete return list",deletepicklist:"Delete pickup list",diffreason:"Reason of Diff",download:"Download",enddate:"ending date",enteramount:"Please Enter Qty",enterbacklist:"Please select returning list",enterbackpeople:"Please select return personnel",enterbackreason:"Please select return reason",enterclient:"Please select client",enterdiffreason:"Please input the reason",enterisn:"Please enter the PN",enterline:"Please select line",enterloc:"Please select Location",entermachine:"Please select model",enterpicklist:"Please select pickup list",enterpickpeople:"Please Select Picker",enterprocess:"Please select process",enterreceivepeople:"Please select receivier",entersenddep:"Please select the issuing department",entersendpeople:"Please Select Dispatcher",enterstatus:"Please select the status",enterusereason:"Please select usereason",format:"Spec.",good:"good product",inboundtime:"Inbound Time",inputbackpeople:"Please input Rejecter ID",inputbackreason:"Please enter return reason",inputpickpeople:"Please input Picker ID",inputreceivepeople:"Please input Receiver ID",inputsendpeople:"Please input Dispatcher ID",inputusereason:"Please enter usereason",isn:"PN",isnlength:"PN length is not 12",line:"Lines",loc:"Location",machine:"Machines",mark:"Remarks",nobackpeople:"The ID of the return person does not exist, please go to User Management-Maintenance -> Person Information",nogood:"rejects",noisn:"PN does not exist",nopickpeople:"The ID of the picker does not exist, please go to User Management-Maintenance -> Person Information",noreceivepeople:"The ID of the Receiver does not exist, please go to User Management-Maintenance -> Person Information",nosendpeople:"The ID of the sender does not exist, please go to User Management-Maintenance -> Person Information",nostock:"Said Isn pair does not have any stock, cannot bill material requisition",nostock1:"Said PN & Location pair do not have any stock, cannot be outbounded",nowloc:"current storage location",nowstock:"Available stock",opentime:"Opened Time",other:"other",outbackok:"Outbound completed, Backlist number",outboundtime:"Outbound Time",outpickok:"Outbound completed, Picklist number",pName:"Descr.",page_name:"Outbound",pick:"Pick Material",pickamount:"Prefetch Qty",picklist:"Pick Material List",picklistnum:"Pickup #",pickpeople:"Picker",pickpeoplenum:"Picker's ID",pickrecord:"Pick Material Record",process:"Processes",realbackamount:"Actual Returned Qty",realpickamount:"Acq Qty",realpickzero:"Acquired Qty is 0",receivepeople:"Receiver",receivepeoplenum:"Receiver's ID",record:"record",return:"return",rfidinputbackpeople:"Click here and tap the Rejecter's ID card",rfidinputpickpeople:"Click here and tap the Picker's ID card",rfidinputreceivepeople:"Click here and tap the Receiver's ID card",rfidinputsendpeople:"Click here and tap the Dispatcher's ID card",row:"On Row",search:"Search",searchbacklist:"Search return list",searchpicklist:"Search pickup list",senddep:"Issuing department",sendpeople:"Dispatcher",sendpeoplenum:"Dispatcher ID",status:"Status",stockless:"The inventory is less than the actual requisition quantity thus cannot be outbounded",submit:"Submit",success:"Success",timepart:"Time period",total:"Total",unit:"Unit",usereason:"Reason"},"en.pagination":{next:"Next &raquo;",previous:"&laquo; Previous"},"en.passwords":{reset:"Your password has been reset!",sent:"We have emailed your password reset link!",throttled:"Please wait before retrying.",token:"This password reset token is invalid.",user:"We can't find a user with that email address."},"en.templateWords":{News:"Bulletin",PInfo:"Modify Staff Info.",UserInfo:"Modify User Info.",addNewCat:"Add New Category",addNews:"Add Bulletin",all:"All",all_history_records:"All Past Records",apply:"Apply",barcode_gen:"Barcodes",barcode_generator:"Barcode Generator",basicInfo:"Basic Info.",bu:"BU C.M.",callsys:"Alarm System",cancel:"Cancel",cat:"Category",changePass:"Change Password",checkIvent:"Stock-taking",checkIvent_create_new_table:"Create New Sheet",chrome:"Chrome",clear_cache:"When Website Behaves Unexpectedly, Please Refer to The Following Docs.",content:"Content",custom_range:"Custom Range",dashboard:"Menubar",dateOfNotice:"Date",dep:"Department Site",east:"PSH EIP",edge:"Edge",editNews:"Edit Bulletin",first_thing_first:"If it seems like there's someting missing, try pressing Shift + Ctrl + R on your keyboard first.",importMonthlyData:"Import Monthly <br/> &nbsp;&nbsp;&nbsp; PR Data",importNonMonthlyData:"Import Non-Monthly <br/> &nbsp;&nbsp;&nbsp; PR Data",important:"Important",inbound:"Inbound",isnBarcode:"Find PN. Barcode",isnConsumeAdd:"Unit Consumption <br/> &nbsp;&nbsp;&nbsp; (Add)",isnConsumeUpdate:"Unit Consumption <br/> &nbsp;&nbsp;&nbsp; (Search & Update)",language:"Language",level:"Level",locBarcode:"Find Loc. Barcode",logout_btn:"Log Out",middle:"PSZ EIP",monthly:"Monthly PR",newPInfo:"Add Staff Info.",newUser:"Add User",nonmonthly:"Non-Monthly PR",normal:"Normal",nowuser:"Logged-In User :",obound:"Vendor Stock",on_the_way_search:"On-Order Qty",outbound:"Outbound",past_three_months:"Past 3 Months",project:"Project Site",site:"Site",standAdd:"Station Manpower <br/> &nbsp;&nbsp;&nbsp; (Add)",standUpdate:"Station Manpower <br/> &nbsp;&nbsp;&nbsp; (Search & Update)",taipei:"Taipei EIP",title:"Title",today:"Today",urgent:"Urgent",userManage:"User Mgmt.",websiteName:"Consumable Mgmt.",west:"PCQ EIP"},"en.validation":{accepted:"The :attribute must be accepted.",active_url:"The :attribute is not a valid URL.",after:"The :attribute must be a date after :date.",after_or_equal:"The :attribute must be a date after or equal to :date.",alpha:"The :attribute must only contain letters.",alpha_dash:"The :attribute must only contain letters, numbers, dashes and underscores.",alpha_num:"The :attribute must only contain letters and numbers.",array:"The :attribute must be an array.",attributes:{password:"password",username:"username"},before:"The :attribute must be a date before :date.",before_or_equal:"The :attribute must be a date before or equal to :date.",between:{array:"The :attribute must have between :min and :max items.",file:"The :attribute must be between :min and :max kilobytes.",numeric:"The :attribute must be between :min and :max.",string:"The :attribute must be between :min and :max characters."},boolean:"The :attribute field must be true or false.",confirmed:"The :attribute confirmation does not match.",custom:{"attribute-name":{"rule-name":"custom-message"}},date:"The :attribute is not a valid date.",date_equals:"The :attribute must be a date equal to :date.",date_format:"The :attribute does not match the format :format.",different:"The :attribute and :other must be different.",digits:"The :attribute must be :digits digits.",digits_between:"The :attribute must be between :min and :max digits.",dimensions:"The :attribute has invalid image dimensions.",distinct:"The :attribute field has a duplicate value.",email:"The :attribute must be a valid email address.",ends_with:"The :attribute must end with one of the following: :values.",exists:"The selected :attribute is invalid.",file:"The :attribute must be a file.",filled:"The :attribute field must have a value.",gt:{array:"The :attribute must have more than :value items.",file:"The :attribute must be greater than :value kilobytes.",numeric:"The :attribute must be greater than :value.",string:"The :attribute must be greater than :value characters."},gte:{array:"The :attribute must have :value items or more.",file:"The :attribute must be greater than or equal :value kilobytes.",numeric:"The :attribute must be greater than or equal :value.",string:"The :attribute must be greater than or equal :value characters."},image:"The :attribute must be an image.",in:"The selected :attribute is invalid.",in_array:"The :attribute field does not exist in :other.",integer:"The :attribute must be an integer.",ip:"The :attribute must be a valid IP address.",ipv4:"The :attribute must be a valid IPv4 address.",ipv6:"The :attribute must be a valid IPv6 address.",json:"The :attribute must be a valid JSON string.",lt:{array:"The :attribute must have less than :value items.",file:"The :attribute must be less than :value kilobytes.",numeric:"The :attribute must be less than :value.",string:"The :attribute must be less than :value characters."},lte:{array:"The :attribute must not have more than :value items.",file:"The :attribute must be less than or equal :value kilobytes.",numeric:"The :attribute must be less than or equal :value.",string:"The :attribute must be less than or equal :value characters."},max:{array:"The :attribute must not have more than :max items.",file:"The :attribute must not be greater than :max kilobytes.",numeric:"The :attribute must not be greater than :max.",string:"The :attribute must not be greater than :max characters."},mimes:"The :attribute must be a file of type: :values.",mimetypes:"Must be a file of type: xls or xlsx.",min:{array:"The :attribute must have at least :min items.",file:"The :attribute must be at least :min kilobytes.",numeric:"The :attribute must be at least :min.",string:"The :attribute must be at least :min characters."},multiple_of:"The :attribute must be a multiple of :value.",not_in:"The selected :attribute is invalid.",not_regex:"The :attribute format is invalid.",numeric:"The :attribute must be a number.",password:"The password is incorrect.",present:"The :attribute field must be present.",prohibited:"The :attribute field is prohibited.",prohibited_if:"The :attribute field is prohibited when :other is :value.",prohibited_unless:"The :attribute field is prohibited unless :other is in :values.",regex:"format incorrect.",required:"required",required_if:"The :attribute field is required when :other is :value.",required_unless:"The :attribute field is required unless :other is in :values.",required_with:"The :attribute field is required when :values is present.",required_with_all:"The :attribute field is required when :values are present.",required_without:"The :attribute field is required when :values is not present.",required_without_all:"The :attribute field is required when none of :values are present.",same:"The :attribute and :other must match.",size:{array:"The :attribute must contain :size items.",file:"The :attribute must be :size kilobytes.",numeric:"The :attribute must be :size.",string:"The :attribute must be :size characters."},starts_with:"The :attribute must start with one of the following: :values.",string:"The :attribute must be a string.",timezone:"The :attribute must be a valid zone.",unique:"The :attribute has already been taken.",uploaded:"The :attribute failed to upload.",url:"The :attribute format is invalid.",uuid:"The :attribute must be a valid UUID."},"en.welcomePageLang":{header:"Consumables Management",login_btn:"Log in",menu:"Menu"},"zh-CN.auth":{failed:"登入资料不符合",throttle:"尝试登入太多次，请 :seconds 秒后再尝试"},"zh-CN.barcodeGenerator":{Delete_Notice:"此处之删除仅表示其条码不会被列印",Temporary_Storage_Zone:"暂存区",barcode_gening:"条码生成",batch_upload:"批量产生",enter_isn:"请输入料号",enter_loc:"请输入储位",enter_pName:"请输入品名",exampleExcel:"示例格式下载",gen:"产生",isn:"料号",isn_gen_barcode:"产生料号条码",leaving_page_alert:"离开页面将会清所有暂存资料，确认离开？",loc:"储位",loc_gen_barcode:"产生储位条码",nothing_to_print:"没有条码",pName:"品名",page_name:"条码",plz_upload:"请上传Excel档",print:"列印",print_amount:"列印数量",search:"查询",search_isn:"料号查询 ",search_loc:"储位查询 ",spec:"规格",temp_save_error:"错误 :",temp_save_success:"暂存成功",upload_save_success:"上传成功"},"zh-CN.basicInfoLang":{add:"添加",addtodatabase:"新增至资料库",basicInfo:"基础信息",belong:"耗材归属",change:"更新",check:"勾选",client:"客户别",consume:"单耗",data:"资料",delete:"删除",differ_by_client:"因客户而不同",download:"下载",enterbelong:"请选择耗材归属",enterformat:"请输入规格",enterisn:"请输入料号",enterlt:"请输入LT",entermoney:"请选择币别",entermoq:"请输入MOQ",entermpq:"请输入MPQ",enterpName:"请输入品名",enterprice:"请输入单价",entersafe:"请输入安全库存",entersenddep:"请选择发料部门",enterunit:"请输入单位",enteryorn:"请选择是/否",equiproom:"设备备品室",exampleExcel:"格式下载",factory:"厂别",format:"规格",go_to_page:"现在页数 : ",gradea:"A级资材",ieroom:"IE备品室",inreason:"入库原因",isn:"料号",isnlength:"料号长度不为12",isnrepeat:"料号重复",line:"线别",loc:"储位",lt:"LT",machine:"机种",matsInfo:"料件信息",matsdata:"料件资料",matssearch:"料号查询",meroom:"ME备品室",money:"币别",month:"月请购",moq:"MOQ",mpq:"MPQ",new:"新增",newMats:"新增料件",newbasicInfo:"新增基础信息",no:"否",nocheck:"请勾选欲提交项目",nodata:"无资料提交",now_showing:"现在显示",obound:"O库(借贷库)",pName:"品名",page_name:"基础资料",plz_upload:"请上传Excel档",price:"单价",process:"制程",quicksearch:"快速查询",record:"笔",records_per_page:"每页笔数 : ",repeat:"资料已存放在资料库内，请检查。 ",return:"返回",returnreason:"退回原因",room:"备品室",row:"在行",safe:"安全库存",safeerror:"非月请购之安全库存为必填项目",search_with_no_data_returned:"查无资料",searchisn:"直接搜索全部，或输入料号开头搜索",searchisn1:"输入多笔料号查询，使用换行隔开",senddep:"发料部门",stand:"站位",submit:"提交",success:"成功",total:"共",unit:"单位",upload:"批量上传",upload1:"上传",uploaderror:"不是基础信息批量上传的格式",usedep:"领用部门",usereason:"领用原因",yellowrepeat:"黄底标表示资料库已存放在资料库内",yes:"是"},"zh-CN.bupagelang":{amounterr:"拨出数量小于库存/拨出数量<=0",amounterr1:"实际拨出数量>现有库存",begindate:"起始日期",bu:"BU耗材管理",buyrecord:"近期请购纪录",buytime:"近期请购时间",changeok:"已顺利更新",check:"勾选",checkreceive:"确认是否接收",checktrans:"确认是否拨出",client:"客户别",days:"呆滞天数",dbadd:"调拨单新增",dblist:"调拨单号",delete:"删除",download:"下载",enddate:"结束日期",enteramount:"请输入数量",enterclient:"请选择客户别",enterfactory:"请选择厂区",enterisn:"请输入料号",enterloc:"请选择储位",enteroutlist:"请选择拨出单",enteroutpeople:"请选择拨出人",enterpicklist:"请选择接收单",enterreceivepeople:"请选择接收人",factory:"厂区",factorychange:"厂区库存调拨",format:"规格",inboundtime:"入库时间",inventoryerr:"库存有异动，请重新整理",isn:"料号",isnlength:"料号长度不为12",jobnum:"工号",loc:"储位",name:"姓名",nocheck:"请勾选欲删除/更新项目",nocheck1:"请勾选欲提交项目",noisn:"料号不存在,请先维护此料件信息",nooutpeople:"拨出人员之工号不存在，请先到用户管理-新增人员讯息维护",nopickpeople:"接收人员之工号不存在，请先到用户管理-新增人员讯息维护",notequal:"不等于",nowstock:"现有库存",opentime:"开单时间",outboundtime:"出库时间",outdetail:"拨出明细",outfactory:"拨出厂区",outlist:"调拨_拨出单",outpeople:"拨出人",outtime:"拨出时间",pName:"品名",page_name:"BU耗材管理",picklist:"调拨_接收单",preamount:"预计拨出数量",realamount:"实际拨出数量",realpickamount:"实际接收数量",receiveamount:"接收数量",receivedetail:"接收明细",receivefac:"接收厂区",receivepeople:"接收人",receivetime:"接收时间",remark:"备注",return:"返回",row:"在行",search:"查询",searchdetail:"调拨明细查询",searchlist:"调拨单查询",searchoutlist:"搜寻拨出单",searchpicklist:"搜寻接收单",senddep:"发料部门",sluggish:"呆滞库存",status:"状态",stock:"库存",submit:"提交",success:"成功",timepart:"时间段",tranamount:"调拨数量",transamount:"拨出数量",transpeople:"拨出人",unit:"单位"},"zh-CN.callpageLang":{callsys:"报警系统",change:"更新",client:"客户别",dayalert:"呆滞天数警报",days:"呆滞天数",diffalert:"需求vs领用差异",entersenddep:"请选择发料部门",format:"规格",ismonth:"月请购耗材",isn:"料号",loc:"储位",mark:"备注",month:"月请购",nostock:"目前无任何库存",notmonth:"非月请购耗材",nowstock:"现有库存",pName:"品名",page_name:"报警系统",req_vs_real:"需求与领用差异量",req_vs_real_percent:"需求与领用差异",return:"返回",safe:"安全库存",safealert:"安全库存警报",saveremark:"保存备注",senddep:"发料部门",stock:"总库存",success:"成功"},"zh-CN.checkInvLang":{all:"全部",check:"盘点",check_not_right_amount:"盘盈亏",check_result:"盘点结果",checked:"已盘点",checking_result:"结果",client:"客户",continue_check:"续盘",create_new_table:"建立新盘点表",create_table_fail:"建立失败",create_table_success:"新盘点表建立成功 !",created_by:"建立者",created_time:"建立时间",edit:"修改",exact:"盘正确",excess:"盘盈",existed_tables:"已有近期盘点表",has:"还有",has_exist_sheet_confirm:"已有近期盘点表，请确认是否仍须建立新盘点表？",input_isn_barcode:"输入 料号条码",input_loc_barcode:"输入 储位条码",inventory:"盘点",isn:"料号",loc:"储位",loc_short:"储位",no_results_found:"查无资料 !",no_such_isn:"查无此料号",no_such_loc:"查无此储位",no_table_found:"无近期盘点表",not_checked:"未盘点",page_name:"盘点管理",plz_create:"无近期盘点表，请建立新盘点表",product_name:"品名",search:"搜寻",search_by:"搜寻",sent_email_failed:"寄信失败",serial_number:"单号",shortage:"盘亏",sort_by:"筛选",stock:"库存",submit:"送出",this:"此",time_range:"时间",unchecked:"个未盘",unknown:"N/A",update_failed:"更新失败",update_success:"更新成功",updated_at:"盘点时间",updated_by:"盘点人",value_not_changed:"盘点结果未改变，确定送出？"},"zh-CN.fileUploadErrors":{Content_errors:"档案内容有错误",Exceeded_filesize_limit:"超过档案大小限制",Failed_to_move_uploaded_file:"无法移动档案至伺服器资料夹",Invalid_file_format:"请上传.xlsx或.xls档",Invalid_parameters:"参数错误",No_file_sent:"没有档案",Unknown_errors:"未知错误"},"zh-CN.httpErrors":{error_569_msg:"Login Failed",error_569_title:"Login Failed"},"zh-CN.inboundpageLang":{add:"添加",addclient:"添加(By 客户别)",addtodatabase:"加入库存",amount:"数量",begindate:"起始日期",change:"更新",check:"勾选",client:"客户别",coming:"即将从",days:"呆滞天数",delete:"删除",download:"下载",enddate:"结束日期",enteramount:"请输入数量",enterclient:"请选择客户别",enterinlist:"请输入入库单号",enterinpeople:"请选择入库人员",enterinreason:"请选择入库原因",enterisn:"请输入料号",enterloc:"请选择储位",entersenddep:"请选择发料部门",exampleExcel:"格式下载",format:"规格",gradea:"A级资材",inboundnum:"入库数量",inboundtime:"入库时间",inlist:"入库单号",inpeople:"入库人员",inputinreason:"请输入入库原因",inreason:"入库原因",isn:"料号",isnlength:"料号长度不为12",lessstock:"有库存小于入库数量，无法删除一些入库单。",loc:"储位",locationchange:"储位调拨",locchangeerr:"调拨数量不可大于现有库存，无法提交此笔储位调拨。",mark:"备注",money:"币别",month:"月请购",monthuse:"月使用量",new:"新增",newloc:"送至储位",no_basic:"料号资料不存在",no_basic_are_highlighted:"红字料号表示其料件讯息未维护",nocheck:"请勾选欲删除/更新项目",noclient:"客户不存在",nogood:"不良品",noinpeople:"入库人员之工号不存在，请先到用户管理-人员讯息维护",noisn:"料号不存在",noloc:"储位不存在",notransit:"在途量为0，无法开领料单",nowstock:"现有库存",oldloc:"库存储位",other:"其他",pName:"品名",page_name:"入库",plz_upload:"请上传Excel档",price:"单价",record:"笔",repeated_isn_90_pair:"有重复的料号＋90料号",repeated_isn_loc_pair:"有重复的料号＋储位",return:"返回",rfidinpeople:"请点这里感应入库人员识别证",row:"在行",safe:"安全库存",search:"查询",searchstock:"库存查询",senddep:"发料部门",stock:"库存",stockmonth:"库存使用月数",stockupload:"库存上传",submit:"提交",success:"成功",timepart:"时间段",to:"到",total:"共",transfer:"调拨",transferamount:"调拨数量",transit:"在途量",transiterror:"入库数量不可大于在途量",unit:"单位",updatetime:"最后更新时间",upload:"批量上传",upload1:"上传"},"zh-CN.loginPageLang":{addtodatabase:"新增至资料库",adduser:"新增用户",againlogin:"请重新登入",change:"更新",changeMail:"修改信箱",changePass:"修改密码",change_site_permission_reset:"切换厂区将重置权限<br/>若有需要请联络该厂主管或系统管理员提升权限",check:"勾选",current_permission:"当前权限",data:"资料",database_list:"可登入资料库",delete:"删除",dep:"部门",email:"公司信箱",enter_email:"请输入信箱帐号",enterdep:"请输入部门",enteremail:"请输入公司信箱",enterjobsearch:"请输入工号",enterlogin:"请输入登入帐号",entername:"请输入姓名",enternewpass:"请输入新密码",enteroldpass:"请输入旧密码",enterpassword:"请再次输入密码",enterpriority:"请选择权限",errorpassword:"旧密码输入错误",errorpassword2:"密码并不相符",exampleExcel:"格式下载",functionality:"功能",home:"首页",joblength:"工号长度不为9",jobnumber:"工号",jobrepeat:"工号重复",jobsearch:"工号查询",latest_login_time:"最后登入",login_btn:"登入",loginsearch:"登入帐号查询",mail:"信箱",name:"姓名",new:"新增",newSSO_msg:"此公司帐号从未登入过耗材管理系统<br/>请先填写以下内容完成初始设定",new_email:"新信箱",newpass:"新密码",no_email:"无",nocheck:"请勾选欲提交项目",old_email:"旧信箱",oldpass:"旧密码",page_name:"用户管理",password:"密码",password_placeholder:"请输入密码",permission_details:"权限说明",permission_notice:"初始权限设为最低(4)<br/>若有需要请联络主管或系统管理员提升权限",pinf:"人员信息",plz_upload:"请上传Excel档",pre_page:"返回",priority:"权限",profile_pic:"头像",record:"笔",return:"返回",row:"在行",search:"查询",selectprofile_pic:"请选择头像",settings:"设定",signup:"注册",site:"厂区",site_error:"请选择厂区",site_placeholder:"请选择厂区",submit:"提交",success:"成功",surepassword:"确认密码",total:"共",upload:"批量上传",upload1:"上传",user:"用户",username:"帐号",username_placeholder:"请输入帐号",username_search:"搜寻帐号/姓名",usernamerepeat:"帐号重复，请重新输入。",welcome:"欢迎",welcome_msg:"请登入帐户以继续使用功能",yellowrepeat:"黄底标表示资料库已存放在资料库内"},"zh-CN.monthlyPRpageLang":{"90isn":"90料号","90isnlength":"90料号长度不为12",PR:"汇出所有请购明细",SXB_search:"请购单纪录",SendPRReview:"送签",UpdateUnitPrice:"上传最新单价",add:"添加",addtodatabase:"新增至资料库",allclient:"所有客户",applydate:"申请日期",buyamount:"本次请购数量",buyamount1:"请购数量",buyper:"请购占比",buyprice:"总价",buytime:"请购时间",change:"更新",check:"勾选",clickmail:"点选此网址",client:"客户别",consume:"单耗",consumemail:"您好，请点击此链接画押单耗",control:"管控项次",data:"资料",delete:"删除",description:"说明",download:"下载",email:"画押信箱",emailsender:"发信者",enter90isn:"请输入90料号",enteramount:"请输入数量",enterclient:"请选择客户别",entercontrol:"请选择管控项次",enterdesc:"请输入说明",enterisn:"料号",enterisn_90pn_or_descr:"料号/90料号/品名",enterisn_or_descr:"料号/品名",entermachine:"请选择机种",entermoney:"请选择币别",enterprocess:"请选择制程",entersenddep:"请选择发料部门",entersrm:"SRM单号",entersxb:"请输入单号",errormonth:"为月请购耗材，需选填管控项次以及填入说明。 ",exampleExcel:"格式下载",exchangerate_notfound:"汇率查询错误",export:"汇出",export1:"汇出询价格式",exportspan:"仅会汇出本次请购数量 > 0 资料",format:"规格",generatePR:"产生请购单",importMonthlyData:"汇入月请购资料",importNonMonthlyData:"汇入非月请购资料",info:"详细资讯",isn:"料号",isnConsumeAdd:"料号单耗(新增)",isnConsumeUpdate:"料号单耗(查询与修改)",isnlength:"料号长度不为12",loadconsume:"载入待重画",loadsuccess:"载入成功",lt:"LT",machine:"机种",markconsume:"勾选表示此单耗工程师已确认，未勾选表示须重新开单",markstand:"勾选表示此站位工程师已确认，未勾选表示须重新开单",money:"币别",month:"月请购",months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月",moq:"MOQ",mpq:"MPQ",needper:"需求占比",needprice:"需求金额",new:"新增",nextchange:"下月每日更换频率",nextclass:"下月开班数",nextday:"下月生产天数",nextdayneed:"下月每日需求",nextline:"下月开线数",nextmps:"下月MPS",nextneed:"下月需求",nextpeople:"下月站位人数",nextuse:"下月每人每日需求量",no_req_amount_to_submit:"所有请购数量皆为0，无资料提交",nocheck:"请勾选欲提交项目",noclient:"客户别不存在",nodata:"无资料提交",noemail:"确认人员",noisn:"料号不存在",noload:"无资料载入",nomachine:"机种不存在",nonmonthly_pr_already_sxb:"以下料号已经送出请购单签核中：",nopeople:"确认人员工號",noproduction:"制程不存在",notmonth:"非月请购",nounitconsumption:"单耗不存在或未画押",nowchange:"当月每日更换频率",nowclass:"当月开班数",nowday:"当月生产天数",nowdayneed:"当月每日需求",nowline:"当月开线数",nowmps:"当月MPS",nowneed:"当月需求",nowpeople:"当月站位人数",nowrite:"尚未填写",nowstock:"现有库存",nowuse:"当月每人每日需求量",on_the_way_search:"在途数量",pName:"品名",page_name:"月请购",please_utilize:"请透过",plz_upload:"请上传Excel档",plz_write:"请填写",price:"单价",process:"制程",rate:"汇率",realneed:"实际需求",reason:"请填写原因",record:"笔",remark:"备注",repeat:"资料已存放在资料库内，请检查。 ",repeated_isn:"有重复的料号",return:"返回",review_cancel:"退单",review_complete:"签核完成",review_pending:"待签核",row:"在行",safe:"安全库存",search:"查询",senddep:"发料部门",shallow_delete:"此处删除仅代表不会送签，完全删除请至 汇入(非)月请购",some_data_has_no_amount:"部分请购数量为0，只会提交有请购数量的料号",srm:"SRM单号",srmspan:"仅会至打勾的那一行",stand:"站位",standAdd:"站位人力(新增)",standUpdate:"站位人力(查询与修改)",standmail:"您好，请点击此链接画押站位",status:"状态",submit:"提交",submitspan:"仅会提交或汇出有填写SRM单号以及本次请购数量>0那一行",success:"成功",surepeople:"确认人员工号",surepeopleemail:"确认人员信箱",sxbamount:"SXB数量",sxbamounterr:"SXB数量不得大于本次请购数量",timepart:"时间段",to_update_unit_price:"更新单价",total:"共",transit:"在途量",transit_reviser:"修改人",unit:"单位",upload:"上传",upload1:"上传",uploadtime:"上传时间",writesrm:"填写SRM单号",writetime:"填写时间",yellowrepeat:"黄底标表示资料库已存放在资料库内"},"zh-CN.oboundpageLang":{add:"添加",addtodatabase:"新增至资料库",amount:"数量",amountzero:"入库数量不可小于等于零",back:"退料",backamount:"预退数量",backdiffreason:"实退差异原因",backlist:"退料单",backlistnum:"退料单号",backpeople:"退料人员",backpeoplenum:"退料人员工号",backreason:"退回原因",backrecord:"退料记录表",begindate:"起始日期",bound:"库别",client:"客户别",data:"资料",delete:"删除",deletebacklist:"删除退料单",deletepicklist:"删除领料单",diffreason:"实领差异原因",download:"下载",enddate:"结束日期",enteramount:"请输入数量",enterbacklist:"请选择退料单",enterbackpeople:"请选择退料人员",enterbackreason:"请选择退回原因",enterbound:"请选择库别",enterclient:"请选择客户别",enterdiffreason:"请输入差异原因",enterformat:"请输入规格",enterinpeople:"请选择入库人员",enterinreason:"请选择入库原因",enterisn:"请输入料号",enterline:"请选择线别",entermachine:"请选择机种",enterpName:"请输入品名",enterpicklist:"请选择领料单",enterpickpeople:"请选择领料人员",enterprocess:"请选择制程",enterreceivepeople:"请选择收料人员",entersendpeople:"请选择发料人员",enterstatus:"请选择功能状况",enterusereason:"请选择领用原因",exampleExcel:"格式下载",format:"规格",good:"良品",inbound:"入库",inboundnum:"入库数量",inboundsearch:"入库查询",inboundtime:"入库时间",inlist:"入库单号",inpeople:"入库人员",inputbackpeople:"请输入退料人员工号",inputbackreason:"请输入退回原因",inputinreason:"请输入入库原因",inputpickpeople:"请输入领料人员工号",inputreceivepeople:"请输入收料人员工号",inputsendpeople:"请输入发料人员工号",inputusereason:"请输入领用原因",inreason:"入库原因",isn:"料号",isnlength:"料号长度不为12",isnrepeat:"料号重复",lessstock1:"目前库存小于入库数量，无法删除此笔入库。",line:"线别",machine:"机种",mark:"备注",matsInfo:"料件信息(查询)",matsdata:"料件资料",new:"新增",newMats:"新增料件",nobackpeople:"退料人员之工号不存在，请先到用户管理-人员讯息维护",nobound:"库别不存在",nocheck:"请勾选欲删除/更新项目",noclient:"客户不存在",nogood:"不良品",noinpeople:"入库人员之工号不存在，请先到用户管理-人员讯息维护",noisn:"料号不存在",nopickpeople:"领料人员之工号不存在，请先到用户管理-人员讯息维护",noreceivepeople:"收料人员之工号不存在，请先到用户管理-人员讯息维护",nosendpeople:"发料人员之工号不存在，请先到用户管理-人员讯息维护",nostock:"该客户&料号没有库存，无法开领料单。",nowbound:"目前库别",nowstock:"现有库存",oisn:"O库料号",opentime:"开单时间",other:"其他",outbackok:"出库完成，退料单号",outboundtime:"出库时间",outpickok:"出库完成，领料单号",pName:"品名",page_name:"O库",pick:"领料",pickamount:"预领数量",picklist:"领料单",picklistnum:"领料单号",pickpeople:"领料人员",pickpeoplenum:"领料人员工号",pickrecord:"领料记录表",plz_upload:"请上传Excel档",process:"制程",realbackamount:"实际退回数量",realpickamount:"实际领用数量",receivepeople:"收料人员",receivepeoplenum:"收料人员工号",record:"笔",return:"返回",rfidinpeople:"请点这里感应入库人员识别证",row:"在行",search:"查询",searchbacklist:"搜寻退料单",searchpicklist:"搜寻领料单",searchstock:"库存查询",senddep:"发料部门",sendpeople:"发料人员",sendpeoplenum:"发料人员工号",status:"功能状况",stockless:"库存小于实际领用数量，无法出库。",stockupload:"库存上传",submit:"提交",success:"成功",timepart:"时间段",total:"共",unit:"单位",updatetime:"最后更新时间",upload:"批量上传",upload1:"上传",usereason:"领用原因",yellowrepeat:"黄底标表示资料库已存放在资料库内"},"zh-CN.outboundpageLang":{add:"添加",back:"退料",backamount:"预退数量",backdiffreason:"实退差异原因",backlist:"退料单",backlistnum:"退料单号",backpeople:"退料人员",backpeoplenum:"退料人员工号",backreason:"退回原因",backrecord:"退料记录表",begindate:"起始日期",client:"客户别",delete:"删除",deletebacklist:"删除退料单",deletepicklist:"删除领料单",diffreason:"实领差异原因",download:"下载",enddate:"结束日期",enteramount:"请输入数量",enterbacklist:"请选择退料单",enterbackpeople:"请选择退料人员",enterbackreason:"请选择退回原因",enterclient:"请选择客户别",enterdiffreason:"请输入差异原因",enterisn:"请输入料号",enterline:"请选择线别",enterloc:"请选择储位",entermachine:"请选择机种",enterpicklist:"请选择领料单",enterpickpeople:"请选择领料人员",enterprocess:"请选择制程",enterreceivepeople:"请选择收料人员",entersenddep:"请选择发料部门",entersendpeople:"请选择发料人员",enterstatus:"请选择功能状况",enterusereason:"请选择领用原因",format:"规格",good:"良品",inboundtime:"入库时间",inputbackpeople:"请输入退料人员工号",inputbackreason:"请输入退回原因",inputpickpeople:"请输入领料人员工号",inputreceivepeople:"请输入收料人员工号",inputsendpeople:"请输入发料人员工号",inputusereason:"请输入领用原因",isn:"料号",isnlength:"料号长度不为12",line:"线别",loc:"储位",machine:"机种",mark:"备注",nobackpeople:"退料人员之工号不存在，请先到用户管理-人员讯息维护",nogood:"不良品",noisn:"料号不存在",nopickpeople:"领料人员之工号不存在，请先到用户管理-人员讯息维护",noreceivepeople:"收料人员之工号不存在，请先到用户管理-人员讯息维护",nosendpeople:"发料人员之工号不存在，请先到用户管理-人员讯息维护",nostock:"该料号没有库存，无法开领料单。 ",nostock1:"该料号&储位没有库存，无法出库。 ",nowloc:"目前储位",nowstock:"现有库存",opentime:"开单时间",other:"其他",outbackok:"出库完成，退料单号",outboundtime:"出库时间",outpickok:"出库完成，领料单号",pName:"品名",page_name:"出库",pick:"领料",pickamount:"预领数量",picklist:"领料单",picklistnum:"领料单号",pickpeople:"领料人员",pickpeoplenum:"领料人员工号",pickrecord:"领料记录表",process:"制程",realbackamount:"实际退回数量",realpickamount:"实际领用数量",realpickzero:"实际领用数量为0",receivepeople:"收料人员",receivepeoplenum:"收料人员工号",record:"笔",return:"返回",rfidinputbackpeople:"请点这里感应退料人员识别证",rfidinputpickpeople:"请点这里感应领料人员识别证",rfidinputreceivepeople:"请点这里感应收料人员识别证",rfidinputsendpeople:"请点这里感应发料人员识别证",row:"在行",search:"查询",searchbacklist:"搜寻退料单",searchpicklist:"搜寻领料单",senddep:"发料部门",sendpeople:"发料人员",sendpeoplenum:"发料人员工号",status:"功能状况",stockless:"库存小于实际领用数量，无法出库。 ",submit:"提交",success:"成功",timepart:"时间段",total:"共",unit:"单位",usereason:"领用原因"},"zh-CN.templateWords":{News:"公告",PInfo:"人员讯息维护",UserInfo:"用户讯息(查询/修改)",addNewCat:"新增类别",addNews:"新增公告",all:"所有厂别",all_history_records:"所有纪录",apply:"确定",barcode_gen:"条码",barcode_generator:"条码产生器",basicInfo:"基础资料",bu:"BU耗材管理",callsys:"报警系统",cancel:"取消",cat:"类别",changePass:"修改密码",checkIvent:"盘点管理",chrome:"Chrome",clear_cache:"网站功能或显示异常时，请先依照以下文件清理浏览器快取",content:"内容",custom_range:"自订",dashboard:"功能表",dateOfNotice:"日期",dep:"部门网站",east:"华东EIP",edge:"Edge",editNews:"编辑公告",first_thing_first:"若画面显示缺漏，请先按下键盘 Shift + Ctrl + R",importMonthlyData:"汇入月请购资料",importNonMonthlyData:"汇入非月请购资料",important:"重要",inbound:"入库",isnBarcode:"料号条码查询",isnConsumeAdd:"料号单耗(新增)",isnConsumeUpdate:"料号单耗(查询与修改)",language:"语言/Language",level:"层级",locBarcode:"储位条码查询",logout_btn:"登出",middle:"华中EIP",monthly:"月请购",newPInfo:"新增人员讯息",newUser:"新增用户",nonmonthly:"非月请购",normal:"一般",nowuser:"现在登入的用户是 :",obound:"O库",on_the_way_search:"在途数量",outbound:"出库",past_three_months:"过去3个月内",project:"专案网站",site:"厂别",standAdd:"站位人力(新增)",standUpdate:"站位人力(查询与修改)",taipei:"台北企总EIP",title:"标题",today:"今日",urgent:"紧急",userManage:"用户管理",websiteName:"耗材管理系统",west:"华西EIP"},"zh-CN.validation":{accepted:"The :attribute must be accepted.",active_url:"The :attribute is not a valid URL.",after:"The :attribute must be a date after :date.",after_or_equal:"The :attribute must be a date after or equal to :date.",alpha:"The :attribute must only contain letters.",alpha_dash:"The :attribute must only contain letters, numbers, dashes and underscores.",alpha_num:"The :attribute must only contain letters and numbers.",array:"The :attribute must be an array.",attributes:{password:"密码",username:"帐号"},before:"The :attribute must be a date before :date.",before_or_equal:"The :attribute must be a date before or equal to :date.",between:{array:"The :attribute must have between :min and :max items.",file:"The :attribute must be between :min and :max kilobytes.",numeric:"The :attribute must be between :min and :max.",string:"The :attribute must be between :min and :max characters."},boolean:"The :attribute field must be true or false.",confirmed:"The :attribute confirmation does not match.",custom:{"attribute-name":{"rule-name":"custom-message"}},date:"The :attribute is not a valid date.",date_equals:"The :attribute must be a date equal to :date.",date_format:"The :attribute does not match the format :format.",different:"The :attribute and :other must be different.",digits:"The :attribute must be :digits digits.",digits_between:"The :attribute must be between :min and :max digits.",dimensions:"The :attribute has invalid image dimensions.",distinct:"The :attribute field has a duplicate value.",email:"The :attribute must be a valid email address.",ends_with:"The :attribute must end with one of the following: :values.",exists:"The selected :attribute is invalid.",file:"The :attribute must be a file.",filled:"The :attribute field must have a value.",gt:{array:"The :attribute must have more than :value items.",file:"The :attribute must be greater than :value kilobytes.",numeric:"The :attribute must be greater than :value.",string:"The :attribute must be greater than :value characters."},gte:{array:"The :attribute must have :value items or more.",file:"The :attribute must be greater than or equal :value kilobytes.",numeric:"The :attribute must be greater than or equal :value.",string:"The :attribute must be greater than or equal :value characters."},image:"The :attribute must be an image.",in:"The selected :attribute is invalid.",in_array:"The :attribute field does not exist in :other.",integer:"The :attribute must be an integer.",ip:"The :attribute must be a valid IP address.",ipv4:"The :attribute must be a valid IPv4 address.",ipv6:"The :attribute must be a valid IPv6 address.",json:"The :attribute must be a valid JSON string.",lt:{array:"The :attribute must have less than :value items.",file:"The :attribute must be less than :value kilobytes.",numeric:"The :attribute must be less than :value.",string:"The :attribute must be less than :value characters."},lte:{array:"The :attribute must not have more than :value items.",file:"The :attribute must be less than or equal :value kilobytes.",numeric:"The :attribute must be less than or equal :value.",string:"The :attribute must be less than or equal :value characters."},max:{array:"The :attribute must not have more than :max items.",file:"The :attribute must not be greater than :max kilobytes.",numeric:"The :attribute must not be greater than :max.",string:"The :attribute must not be greater than :max characters."},mimes:"档案格式错误，需为 :values 档",mimetypes:"档案格式错误，需为 xls 或 xlsx 档",min:{array:"The :attribute must have at least :min items.",file:"The :attribute must be at least :min kilobytes.",numeric:"The :attribute must be at least :min.",string:"The :attribute must be at least :min characters."},multiple_of:"The :attribute must be a multiple of :value.",not_in:"The selected :attribute is invalid.",not_regex:"The :attribute format is invalid.",numeric:"The :attribute must be a number.",password:"The password is incorrect.",present:"The :attribute field must be present.",prohibited:"The :attribute field is prohibited.",prohibited_if:"The :attribute field is prohibited when :other is :value.",prohibited_unless:"The :attribute field is prohibited unless :other is in :values.",regex:"格式不正确",required:"栏位未填写",required_if:"The :attribute field is required when :other is :value.",required_unless:"The :attribute field is required unless :other is in :values.",required_with:"The :attribute field is required when :values is present.",required_with_all:"The :attribute field is required when :values are present.",required_without:"The :attribute field is required when :values is not present.",required_without_all:"The :attribute field is required when none of :values are present.",same:"The :attribute and :other must match.",size:{array:"The :attribute must contain :size items.",file:"The :attribute must be :size kilobytes.",numeric:"The :attribute must be :size.",string:"The :attribute must be :size characters."},starts_with:"The :attribute must start with one of the following: :values.",string:"The :attribute must be a string.",timezone:"The :attribute must be a valid zone.",unique:"The :attribute has already been taken.",uploaded:"The :attribute failed to upload.",url:"The :attribute format is invalid.",uuid:"The :attribute must be a valid UUID."},"zh-CN.welcomePageLang":{header:"耗材管理",login_btn:"登入",menu:"主目录"},"zh-TW.auth":{failed:"登入資料不符合",throttle:"嘗試登入太多次，請 :seconds 秒後再嘗試"},"zh-TW.barcodeGenerator":{Delete_Notice:"此處之刪除僅表示其條碼不會被列印",Temporary_Storage_Zone:"暫存區",barcode_gening:"條碼生成",batch_upload:"批量生產",enter_isn:"請輸入料號",enter_loc:"請輸入儲位",enter_pName:"請輸入品名",exampleExcel:"範例格式下載",gen:"生成",isn:"料號",isn_gen_barcode:"產生料號條碼",leaving_page_alert:"離開頁面將會清所有暫存資料，確認離開？",loc:"儲位",loc_gen_barcode:"產生儲位條碼",nothing_to_print:"沒有條碼",pName:"品名",page_name:"條碼",plz_upload:"請上傳Excel檔",print:"列印",print_amount:"列印數量",search:"查詢",search_isn:"料號查詢 ",search_loc:"儲位查詢 ",spec:"規格",temp_save_error:"錯誤 :",temp_save_success:"暫存成功",upload_save_success:"上傳成功"},"zh-TW.basicInfoLang":{add:"添加",addtodatabase:"新增至資料庫",basicInfo:"基礎信息",change:"更新",check:"勾選",client:"客戶別",consume:"單耗",data:"資料",delete:"刪除",differ_by_client:"因客戶而不同",download:"下載",enterformat:"請輸入規格",enterisn:"請輸入料號",enterlt:"請輸入LT",entermoney:"請選擇幣別",entermoq:"請輸入MOQ",entermpq:"請輸入MPQ",enterpName:"請輸入品名",enterprice:"請輸入單價",entersafe:"請輸入安全庫存",entersenddep:"請選擇發料部門",enterunit:"請輸入單位",enteryorn:"請選擇是/否",equiproom:"設備備品室",exampleExcel:"範例格式下載",factory:"廠別",format:"規格",go_to_page:"現在頁數 : ",gradea:"A級資材",ieroom:"IE備品室",inreason:"入庫原因",isn:"料號",isnlength:"料號長度不為12",isnrepeat:"料號重複",line:"線別",loc:"儲位",lt:"LT",machine:"機種",matsInfo:"料件信息",matsdata:"料件資料",matssearch:"料號查詢",meroom:"ME備品室",money:"幣別",month:"月請購",moq:"MOQ",mpq:"MPQ",new:"新增",newMats:"新增料件",newbasicInfo:"新增基礎信息",no:"否",nocheck:"請勾選欲提交項目",nodata:"無資料提交",now_showing:"現在顯示",obound:"O庫(借貸庫)",pName:"品名",page_name:"基礎資料",plz_upload:"請上傳Excel檔",price:"單價",process:"製程",quicksearch:"快速查詢",record:"筆",records_per_page:"每頁筆數 : ",repeat:"資料已存放在資料庫內，請檢查。",return:"返回",returnreason:"退回原因",room:"備品室",row:"在列",safe:"安全庫存",safeerror:"非月請購之安全庫存為必填項目",search_with_no_data_returned:"查無資料",searchisn:"直接搜尋全部，或輸入料號開頭搜尋",searchisn1:"輸入多筆料號查詢，使用換行隔開",senddep:"發料部門",stand:"站位",submit:"提交",success:"成功",total:"共",unit:"單位",upload:"批量上傳",upload1:"上傳",uploaderror:"不是基礎信息批量上傳的格式",usedep:"領用部門",usereason:"領用原因",yellowrepeat:"黃底標表示資料庫已存放在資料庫內",yes:"是"},"zh-TW.bupagelang":{amounterr:"撥出數量小於庫存/撥出數量<=0",amounterr1:"實際撥出數量>現有庫存",begindate:"起始日期",bu:"BU耗材管理",buyrecord:"近期請購紀錄",buytime:"近期請購時間",changeok:"已順利更新",check:"勾選",checkreceive:"確認是否接收",checktrans:"確認是否撥出",client:"客戶別",days:"呆滯天數",dbadd:"調撥單新增",dblist:"調撥單號",delete:"刪除",download:"下載",enddate:"結束日期",enteramount:"請輸入數量",enterclient:"請選擇客戶別",enterfactory:"請選擇廠區",enterisn:"請輸入料號",enterloc:"請選擇儲位",enteroutlist:"請選擇撥出單",enteroutpeople:"請選擇撥出人",enterpicklist:"請選擇接收單",enterreceivepeople:"請選擇接收人",factory:"廠區",factorychange:"廠區庫存調撥",format:"規格",inboundtime:"入庫時間",inventoryerr:"庫存有異動，請重新整理",isn:"料號",isnlength:"料號長度不為12",jobnum:"工號",loc:"儲位",name:"姓名",nocheck:"請勾選欲刪除/更新項目",nocheck1:"請勾選欲提交項目",noisn:"料號不存在,請先維護此料件信息",nooutpeople:"撥出人員之工號不存在，請先到用戶管理-新增人員信息維護",nopickpeople:"接收人員之工號不存在，請先到用戶管理-新增人員信息維護",notequal:"不等於",nowstock:"現有庫存",opentime:"開單時間",outboundtime:"出庫時間",outdetail:"撥出明細",outfactory:"撥出廠區",outlist:"調撥_撥出單",outpeople:"撥出人",outtime:"撥出時間",pName:"品名",page_name:"BU耗材管理",picklist:"調撥_接收單",preamount:"預計撥出數量",realamount:"實際撥出數量",realpickamount:"實際接收數量",receiveamount:"接收數量",receivedetail:"接收明細",receivefac:"接收廠區",receivepeople:"接收人",receivetime:"接收時間",remark:"備註",return:"返回",row:"在列",search:"查詢",searchdetail:"調撥明細查詢",searchlist:"調撥單查詢",searchoutlist:"搜尋撥出單",searchpicklist:"搜尋接收單",senddep:"發料部門",sluggish:"呆滯庫存",status:"狀態",stock:"庫存",submit:"提交",success:"成功",timepart:"時間段",tranamount:"調撥數量",transamount:"撥出數量",transpeople:"撥出人",unit:"單位"},"zh-TW.callpageLang":{callsys:"報警系統",change:"更新",client:"客戶別",dayalert:"呆滯天數警報",days:"呆滯天數",diffalert:"需求vs領用差異",entersenddep:"請選擇發料部門",format:"規格",ismonth:"月請購耗材",isn:"料號",loc:"儲位",mark:"備註",month:"月請購",nostock:"目前無任何庫存",notmonth:"非月請購耗材",nowstock:"現有庫存",pName:"品名",page_name:"報警系統",req_vs_real:"需求&領用差異量",req_vs_real_percent:"需求&領用差異",return:"返回",safe:"安全庫存",safealert:"安全庫存警報",saveremark:"保存備註",senddep:"發料部門",stock:"總庫存",success:"成功"},"zh-TW.checkInvLang":{all:"全部",check:"盤點",check_not_right_amount:"盤盈虧",check_result:"盤點結果",checked:"已盤點",checking_result:"結果",client:"客戶",continue_check:"續盤",create_new_table:"建立新盤點表",create_table_fail:"建立失敗",create_table_success:"新盤點表建立成功 !",created_by:"建立者",created_time:"建立時間",edit:"修改",exact:"盤正確",excess:"盤盈",existed_tables:"已有近期盤點表",has:"還有",has_exist_sheet_confirm:"已有近期盤點表，請確認是否仍須建立新盤點表？",input_isn_barcode:"輸入 料號條碼",input_loc_barcode:"輸入 儲位條碼",inventory:"盤點",isn:"料號",loc:"儲位",loc_short:"儲位",no_results_found:"查無資料 !",no_such_isn:"查無此料號",no_such_loc:"查無此儲位",no_table_found:"無近期盤點表",not_checked:"未盤點",page_name:"盤點管理",plz_create:"無近期盤點表，請建立新盤點表",product_name:"品名",search:"搜尋",search_by:"搜尋",sent_email_failed:"寄信失敗",serial_number:"單號",shortage:"盤虧",sort_by:"篩選",stock:"庫存",submit:"送出",this:"此",time_range:"時間",unchecked:"筆未盤",unknown:"N/A",update_failed:"更新失敗",update_success:"更新成功",updated_at:"盤點時間",updated_by:"盤點人",value_not_changed:"盤點結果未改變，確定送出？"},"zh-TW.fileUploadErrors":{Content_errors:"檔案內容有錯誤",Exceeded_filesize_limit:"超過檔案大小限制",Failed_to_move_uploaded_file:"無法移動檔案至伺服器資料夾",Invalid_file_format:"請上傳.xlsx或.xls檔",Invalid_parameters:"參數錯誤",No_file_sent:"沒有檔案",Unknown_errors:"未知錯誤"},"zh-TW.httpErrors":{error_569_msg:"Login Failed",error_569_title:"Login Failed"},"zh-TW.inboundpageLang":{add:"添加",addclient:"添加(By 客戶別)",addtodatabase:"加入庫存",amount:"數量",begindate:"起始日期",change:"更新",check:"勾選",client:"客戶別",coming:"即將從",days:"呆滯天數",delete:"刪除",download:"下載",enddate:"結束日期",enteramount:"請輸入數量",enterclient:"請選擇客戶別",enterinlist:"請輸入入庫單號",enterinpeople:"請選擇入庫人員",enterinreason:"請選擇入庫原因",enterisn:"請輸入料號",enterloc:"請選擇儲位",entersenddep:"請選擇發料部門",exampleExcel:"範例格式下載",format:"規格",gradea:"A級資材",inboundnum:"入庫數量",inboundtime:"入庫時間",inlist:"入庫單號",inpeople:"入庫人員",inputinreason:"請輸入入庫原因",inreason:"入庫原因",isn:"料號",isnlength:"料號長度不為12",lessstock:"有庫存小於入庫數量，無法刪除部分入庫單。",loc:"儲位",locationchange:"儲位調撥",locchangeerr:"調撥數量不可大於現有庫存，無法提交此筆儲位調撥。",mark:"備註",money:"幣別",month:"月請購",monthuse:"月使用量",new:"新增",newloc:"送至儲位",no_basic:"料號資料不存在",no_basic_are_highlighted:"紅字料號表示其料件訊息未維護",nocheck:"請勾選欲刪除/更新項目",noclient:"客戶不存在",nogood:"不良品",noinpeople:"入庫人員之工號不存在，請先到用戶管理-人員信息維護",noisn:"料號不存在",noloc:"儲位不存在",notransit:"在途量為0，無法開領料單",nowstock:"現有庫存",oldloc:"庫存儲位",other:"其他",pName:"品名",page_name:"入庫",plz_upload:"請上傳Excel檔",price:"單價",record:"筆",repeated_isn_90_pair:"有重複的料號＋90料號",repeated_isn_loc_pair:"有重複的料號＋儲位",return:"返回",rfidinpeople:"請點這裡感應入庫人員識別證",row:"在列",safe:"安全庫存",search:"查詢",searchstock:"庫存查詢",senddep:"發料部門",stock:"庫存",stockmonth:"庫存使用月數",stockupload:"庫存上傳",submit:"提交",success:"成功",timepart:"時間段",to:"到",total:"共",transfer:"調撥",transferamount:"調撥數量",transit:"在途量",transiterror:"入庫數量不可大於在途量",unit:"單位",updatetime:"最後更新時間",upload:"批量上傳",upload1:"上傳"},"zh-TW.loginPageLang":{addtodatabase:"新增至資料庫",adduser:"新增用戶",againlogin:"請重新登入",change:"更新",changeMail:"修改信箱",changePass:"修改密碼",change_site_permission_reset:"切換廠區將重置權限<br/>若有需要請聯絡該廠主管或系統管理員提升權限",check:"勾選",current_permission:"目前權限",data:"資料",database_list:"可登入資料庫",delete:"刪除",dep:"部門",email:"公司信箱",enter_email:"請輸入信箱帳號",enterdep:"請輸入部門",enteremail:"請輸入公司信箱",enterjobsearch:"請輸入工號",enterlogin:"請輸入登入帳號",entername:"請輸入姓名",enternewpass:"請輸入新密碼",enteroldpass:"請輸入舊密碼",enterpassword:"請再次輸入密碼",enterpriority:"請選擇權限",errorpassword:"舊密碼輸入錯誤",errorpassword2:"密碼並不相符",exampleExcel:"範例格式下載",functionality:"功能",home:"首頁",joblength:"工號長度不為9",jobnumber:"工號",jobrepeat:"工號重複",jobsearch:"工號查詢",latest_login_time:"最後登入",login_btn:"登入",loginsearch:"登入帳號查詢",mail:"信箱",name:"姓名",new:"新增",newSSO_msg:"此公司帳號從未登入過耗材管理系統<br/>請先填寫以下內容完成初始設定",new_email:"新信箱",newpass:"新密碼",no_email:"無",nocheck:"請勾選欲提交項目",old_email:"舊信箱",oldpass:"舊密碼",page_name:"用戶管理",password:"密碼",password_placeholder:"請輸入密碼",permission_details:"權限說明",permission_notice:"初始權限設為最低(4)<br/>若有需要請聯絡主管或系統管理員提升權限",pinf:"人員信息",plz_upload:"請上傳Excel檔",pre_page:"返回",priority:"權限",profile_pic:"頭像",record:"筆",return:"返回",row:"在列",search:"查詢",selectprofile_pic:"請選擇頭像",settings:"設定",signup:"註冊",site:"廠區",site_error:"請選擇廠區",site_placeholder:"請選擇廠區",submit:"提交",success:"成功",surepassword:"確認密碼",total:"共",upload:"上傳",upload1:"上傳",user:"用戶",username:"帳號",username_placeholder:"請輸入帳號",username_search:"搜尋帳號/姓名",usernamerepeat:"帳號重複，請重新輸入。",welcome:"歡迎",welcome_msg:"請登入帳戶以繼續使用功能",yellowrepeat:"黃底標表示資料庫已存放在資料庫內"},"zh-TW.monthlyPRpageLang":{"90isn":"90料號","90isnlength":"90料號長度不為12",PR:"匯出所有請購明細",SXB_search:"請購單紀錄",SendPRReview:"送簽",UpdateUnitPrice:"上傳最新單價",add:"添加",addtodatabase:"新增至資料庫",allclient:"所有客戶",applydate:"申請日期",buyamount:"本次請購數量",buyamount1:"請購數量",buyper:"請購占比",buyprice:"總價",buytime:"請購時間",change:"更新",check:"勾選",clickmail:"點選此網址",client:"客戶別",consume:"單耗",consumemail:"您好，請點擊此鏈接畫押單耗",control:"管控項次",data:"資料",delete:"刪除",description:"說明",download:"下載",email:"畫押信箱",emailsender:"發信者",enter90isn:"請輸入90料號",enteramount:"請輸入數量",enterclient:"請選擇客戶別",entercontrol:"請選擇管控項次",enterdesc:"請輸入說明",enterisn:"料號",enterisn_90pn_or_descr:"料號/90料號/品名",enterisn_or_descr:"料號/品名",entermachine:"請選擇機種",entermoney:"請選擇幣別",enterprocess:"請選擇製程",entersenddep:"請選擇發料部門",entersrm:"SRM單號",entersxb:"請輸入單號",errormonth:"為月請購耗材，需選填管控項次以及填入說明。",exampleExcel:"範例格式下載",exchangerate_notfound:"匯率查詢錯誤",export:"匯出",export1:"匯出詢價格式",exportspan:"僅會匯出本次請購數量 > 0 資料",format:"規格",generatePR:"產生請購單",importMonthlyData:"匯入月請購資料",importNonMonthlyData:"匯入非月請購資料",info:"詳細資訊",isn:"料號",isnConsumeAdd:"料號單耗(新增)",isnConsumeUpdate:"料號單耗(查詢與修改)",isnlength:"料號長度不為12",loadconsume:"載入待重畫",loadsuccess:"載入成功",lt:"LT",machine:"機種",markconsume:"打勾表示此單耗工程師已確認，未勾選表示須重新開單",markstand:"打勾表示此站位工程師已確認，未勾選表示須重新開單",money:"幣別",month:"月請購",months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月",moq:"MOQ",mpq:"MPQ",needper:"需求占比",needprice:"需求金額",new:"新增",nextchange:"下月每日更換頻率",nextclass:"下月開班數",nextday:"下月生產天數",nextdayneed:"下月每日需求",nextline:"下月開線數",nextmps:"下月MPS",nextneed:"下月需求",nextpeople:"下月站位人數",nextuse:"下月每人每日需求量",no_req_amount_to_submit:"所有請購數量皆為0，無資料提交",nocheck:"請勾選欲提交項目",noclient:"客戶別不存在",nodata:"無資料提交",noemail:"確認人員",noisn:"料號不存在",noload:"無資料載入",nomachine:"機種不存在",nonmonthly_pr_already_sxb:"以下料號已經送出請購單簽核中：",nopeople:"確認人員工號",noproduction:"製程不存在",notmonth:"非月請購",nounitconsumption:"單耗不存在或未畫押",nowchange:"當月每日更換頻率",nowclass:"當月開班數",nowday:"當月生產天數",nowdayneed:"當月每日需求",nowline:"當月開線數",nowmps:"當月MPS",nowneed:"當月需求",nowpeople:"當月站位人數",nowrite:"尚未填寫",nowstock:"現有庫存",nowuse:"當月每人每日需求量",on_the_way_search:"在途數量",pName:"品名",page_name:"月請購",please_utilize:"請透過",plz_upload:"請上傳Excel檔",plz_write:"請填寫",price:"單價",process:"製程",rate:"匯率",realneed:"實際需求",reason:"請填寫原因",record:"筆",remark:"備註",repeat:"資料已存放在資料庫內，請檢查。",repeated_isn:"有重複的料號",return:"返回",review_cancel:"退單",review_complete:"簽核完成",review_pending:"待簽核",row:"在列",safe:"安全庫存",search:"查詢",senddep:"發料部門",shallow_delete:"此處刪除僅代表不會送簽，完全刪除請至 匯入(非)月請購",some_data_has_no_amount:"部分請購數量為0，只會提交有請購數量的料號",srm:"SRM單號",srmspan:"僅會填寫至打勾的那一列",stand:"站位",standAdd:"站位人力(新增)",standUpdate:"站位人力(查詢與修改)",standmail:"您好，請點擊此鏈接畫押站位",status:"狀態",submit:"提交",submitspan:"僅會提交或匯出有填寫SRM單號以及本次請購數量>0那一列",success:"成功",surepeople:"確認人員工號",surepeopleemail:"確認人員信箱",sxbamount:"SXB數量",sxbamounterr:"SXB數量不得大於本次請購數量",timepart:"時間段",to_update_unit_price:"更新單價",total:"共",transit:"在途量",transit_reviser:"修改人",unit:"單位",upload:"上傳",upload1:"上傳",uploadtime:"上傳時間",writesrm:"填寫SRM單號",writetime:"填寫時間",yellowrepeat:"黃底標表示資料庫已存放在資料庫內"},"zh-TW.oboundpageLang":{add:"添加",addtodatabase:"新增至資料庫",amount:"數量",amountzero:"入庫數量不可小於等於零",back:"退料",backamount:"預退數量",backdiffreason:"實退差異原因",backlist:"退料單",backlistnum:"退料單號",backpeople:"退料人員",backpeoplenum:"退料人員工號",backreason:"退回原因",backrecord:"退料記錄表",begindate:"起始日期",bound:"庫別",client:"客戶別",data:"資料",delete:"刪除",deletebacklist:"刪除退料單",deletepicklist:"刪除領料單",diffreason:"實領差異原因",download:"下載",enddate:"結束日期",enteramount:"請輸入數量",enterbacklist:"請選擇退料單",enterbackpeople:"請選擇退料人員",enterbackreason:"請選擇退回原因",enterbound:"請選擇庫別",enterclient:"請選擇客戶別",enterdiffreason:"請輸入差異原因",enterformat:"請輸入規格",enterinpeople:"請選擇入庫人員",enterinreason:"請選擇入庫原因",enterisn:"請輸入料號",enterline:"請選擇線別",entermachine:"請選擇機種",enterpName:"請輸入品名",enterpicklist:"請選擇領料單",enterpickpeople:"請選擇領料人員",enterprocess:"請選擇製程",enterreceivepeople:"請選擇收料人員",entersendpeople:"請選擇發料人員",enterstatus:"請選擇功能狀況",enterusereason:"請選擇領用原因",exampleExcel:"範例格式下載",format:"規格",good:"良品",inbound:"入庫",inboundnum:"入庫數量",inboundsearch:"入庫查詢",inboundtime:"入庫時間",inlist:"入庫單號",inpeople:"入庫人員",inputbackpeople:"請輸入退料人員工號",inputbackreason:"請輸入退回原因",inputinreason:"請輸入入庫原因",inputpickpeople:"請輸入領料人員工號",inputreceivepeople:"請輸入收料人員工號",inputsendpeople:"請輸入發料人員工號",inputusereason:"請輸入領用原因",inreason:"入庫原因",isn:"料號",isnlength:"料號長度不為12",isnrepeat:"料號重複",lessstock1:"目前庫存小於入庫數量，無法刪除此筆入庫。",line:"線別",machine:"機種",mark:"備註",matsInfo:"料件信息(查詢)",matsdata:"料件資料",new:"新增",newMats:"新增料件",nobackpeople:"退料人員之工號不存在，請先到用戶管理-人員信息維護",nobound:"庫別不存在",nocheck:"請勾選欲刪除/更新項目",noclient:"客戶不存在",nogood:"不良品",noinpeople:"入庫人員之工號不存在，請先到用戶管理-人員信息維護",noisn:"料號不存在",nopickpeople:"領料人員之工號不存在，請先到用戶管理-人員信息維護",noreceivepeople:"收料人員之工號不存在，請先到用戶管理-人員信息維護",nosendpeople:"發料人員之工號不存在，請先到用戶管理-人員信息維護",nostock:"該客戶&料號沒有庫存，無法開領料單。",nowbound:"目前庫別",nowstock:"現有庫存",oisn:"O庫料號",opentime:"開單時間",other:"其他",outbackok:"出庫完成，退料單號",outboundtime:"出庫時間",outpickok:"出庫完成，領料單號",pName:"品名",page_name:"O庫",pick:"領料",pickamount:"預領數量",picklist:"領料單",picklistnum:"領料單號",pickpeople:"領料人員",pickpeoplenum:"領料人員工號",pickrecord:"領料記錄表",plz_upload:"請上傳Excel檔",process:"製程",realbackamount:"實際退回數量",realpickamount:"實際領用數量",receivepeople:"收料人員",receivepeoplenum:"收料人員工號",record:"筆",return:"返回",rfidinpeople:"請點這裡感應入庫人員識別證",row:"在列",search:"查詢",searchbacklist:"搜尋退料單",searchpicklist:"搜尋領料單",searchstock:"庫存查詢",senddep:"發料部門",sendpeople:"發料人員",sendpeoplenum:"發料人員工號",status:"功能狀況",stockless:"庫存小於實際領用數量，無法出庫。",stockupload:"庫存上傳",submit:"提交",success:"成功",timepart:"時間段",total:"共",unit:"單位",updatetime:"最後更新時間",upload:"批量上傳",upload1:"上傳",usereason:"領用原因",yellowrepeat:"黃底標表示資料庫已存放在資料庫內"},"zh-TW.outboundpageLang":{add:"添加",back:"退料",backamount:"預退數量",backdiffreason:"實退差異原因",backlist:"退料單",backlistnum:"退料單號",backpeople:"退料人員",backpeoplenum:"退料人員工號",backreason:"退回原因",backrecord:"退料記錄表",begindate:"起始日期",client:"客戶別",delete:"刪除",deletebacklist:"刪除退料單",deletepicklist:"刪除領料單",diffreason:"實領差異原因",download:"下載",enddate:"結束日期",enteramount:"請輸入數量",enterbacklist:"請選擇退料單",enterbackpeople:"請選擇退料人員",enterbackreason:"請選擇退回原因",enterclient:"請選擇客戶別",enterdiffreason:"請輸入差異原因",enterisn:"請輸入料號",enterline:"請選擇線別",enterloc:"請選擇儲位",entermachine:"請選擇機種",enterpicklist:"請選擇領料單",enterpickpeople:"請選擇領料人員",enterprocess:"請選擇製程",enterreceivepeople:"請選擇收料人員",entersenddep:"請選擇發料部門",entersendpeople:"請選擇發料人員",enterstatus:"請選擇功能狀況",enterusereason:"請選擇領用原因",format:"規格",good:"良品",inboundtime:"入庫時間",inputbackpeople:"請輸入退料人員工號",inputbackreason:"請輸入退回原因",inputpickpeople:"請輸入領料人員工號",inputreceivepeople:"請輸入收料人員工號",inputsendpeople:"請輸入發料人員工號",inputusereason:"請輸入領用原因",isn:"料號",isnlength:"料號長度不為12",line:"線別",loc:"儲位",machine:"機種",mark:"備註",nobackpeople:"退料人員之工號不存在，請先到用戶管理-人員信息維護",nogood:"不良品",noisn:"料號不存在",nopickpeople:"領料人員之工號不存在，請先到用戶管理-人員信息維護",noreceivepeople:"收料人員之工號不存在，請先到用戶管理-人員信息維護",nosendpeople:"發料人員之工號不存在，請先到用戶管理-人員信息維護",nostock:"該料號沒有庫存，無法開領料單。",nostock1:"該料號&儲位沒有庫存，無法出庫。",nowloc:"目前儲位",nowstock:"現有庫存",opentime:"開單時間",other:"其他",outbackok:"出庫完成，退料單號",outboundtime:"出庫時間",outpickok:"出庫完成，領料單號",pName:"品名",page_name:"出庫",pick:"領料",pickamount:"預領數量",picklist:"領料單",picklistnum:"領料單號",pickpeople:"領料人員",pickpeoplenum:"領料人員工號",pickrecord:"領料記錄表",process:"製程",realbackamount:"實際退回數量",realpickamount:"實際領用數量",realpickzero:"實際領用數量為0",receivepeople:"收料人員",receivepeoplenum:"收料人員工號",record:"筆",return:"返回",rfidinputbackpeople:"請點這裡感應退料人員識別證",rfidinputpickpeople:"請點這裡感應領料人員識別證",rfidinputreceivepeople:"請點這裡感應收料人員識別證",rfidinputsendpeople:"請點這裡感應發料人員識別證",row:"在列",search:"查詢",searchbacklist:"搜尋退料單",searchpicklist:"搜尋領料單",senddep:"發料部門",sendpeople:"發料人員",sendpeoplenum:"發料人員工號",status:"功能狀況",stockless:"庫存小於實際領用數量，無法出庫。",submit:"提交",success:"成功",timepart:"時間段",total:"共",unit:"單位",usereason:"領用原因"},"zh-TW.templateWords":{News:"公告",PInfo:"人員信息維護",UserInfo:"用戶訊息(查詢/修改)",addNewCat:"新增類別",addNews:"新增公告",all:"所有廠別",all_history_records:"所有紀錄",apply:"確定",barcode_gen:"條碼",barcode_generator:"條碼產生器",basicInfo:"基礎資料",bu:"BU耗材管理",callsys:"報警系統",cancel:"取消",cat:"類別",changePass:"修改密碼",checkIvent:"盤點管理",checkIvent_create_new_table:"Create New Sheet",chrome:"Chrome",clear_cache:"網站功能或顯示異常時，請先依照以下文件清理瀏覽器快取",content:"內容",custom_range:"自訂",dashboard:"功能表",dateOfNotice:"日期",dep:"部門網站",east:"華東EIP",edge:"Edge",editNews:"編輯公告",first_thing_first:"若畫面顯示缺漏，請先按下鍵盤 Shift + Ctrl + R",importMonthlyData:"匯入月請購資料",importNonMonthlyData:"匯入非月請購資料",important:"重要",inbound:"入庫",isnBarcode:"料號條碼查詢",isnConsumeAdd:"料號單耗(新增)",isnConsumeUpdate:"料號單耗(查詢與修改)",language:"語言/Language",level:"層級",locBarcode:"儲位條碼查詢",logout_btn:"登出",middle:"華中EIP",monthly:"月請購",newUser:"新增用戶",nonmonthly:"非月請購",normal:"一般",nowuser:"現在登入的用戶是 :",obound:"O庫",on_the_way_search:"在途數量",outbound:"出庫",past_three_months:"過去3個月內",project:"專案網站",site:"廠別",standAdd:"站位人力(新增)",standUpdate:"站位人力(查詢與修改)",taipei:"台北企總EIP",title:"標題",today:"今日",urgent:"緊急",userManage:"用戶管理",websiteName:"耗材管理系統",west:"華西EIP"},"zh-TW.validation":{accepted:"The :attribute must be accepted.",active_url:"The :attribute is not a valid URL.",after:"The :attribute must be a date after :date.",after_or_equal:"The :attribute must be a date after or equal to :date.",alpha:"The :attribute must only contain letters.",alpha_dash:"The :attribute must only contain letters, numbers, dashes and underscores.",alpha_num:"The :attribute must only contain letters and numbers.",array:"The :attribute must be an array.",attributes:{password:"密碼",username:"帳號"},before:"The :attribute must be a date before :date.",before_or_equal:"The :attribute must be a date before or equal to :date.",between:{array:"The :attribute must have between :min and :max items.",file:"The :attribute must be between :min and :max kilobytes.",numeric:"The :attribute must be between :min and :max.",string:"The :attribute must be between :min and :max characters."},boolean:"The :attribute field must be true or false.",confirmed:"The :attribute confirmation does not match.",custom:{"attribute-name":{"rule-name":"custom-message"}},date:"The :attribute is not a valid date.",date_equals:"The :attribute must be a date equal to :date.",date_format:"The :attribute does not match the format :format.",different:"The :attribute and :other must be different.",digits:"The :attribute must be :digits digits.",digits_between:"The :attribute must be between :min and :max digits.",dimensions:"The :attribute has invalid image dimensions.",distinct:"The :attribute field has a duplicate value.",email:"The :attribute must be a valid email address.",ends_with:"The :attribute must end with one of the following: :values.",exists:"The selected :attribute is invalid.",file:"The :attribute must be a file.",filled:"The :attribute field must have a value.",gt:{array:"The :attribute must have more than :value items.",file:"The :attribute must be greater than :value kilobytes.",numeric:"The :attribute must be greater than :value.",string:"The :attribute must be greater than :value characters."},gte:{array:"The :attribute must have :value items or more.",file:"The :attribute must be greater than or equal :value kilobytes.",numeric:"The :attribute must be greater than or equal :value.",string:"The :attribute must be greater than or equal :value characters."},image:"The :attribute must be an image.",in:"The selected :attribute is invalid.",in_array:"The :attribute field does not exist in :other.",integer:"The :attribute must be an integer.",ip:"The :attribute must be a valid IP address.",ipv4:"The :attribute must be a valid IPv4 address.",ipv6:"The :attribute must be a valid IPv6 address.",json:"The :attribute must be a valid JSON string.",lt:{array:"The :attribute must have less than :value items.",file:"The :attribute must be less than :value kilobytes.",numeric:"The :attribute must be less than :value.",string:"The :attribute must be less than :value characters."},lte:{array:"The :attribute must not have more than :value items.",file:"The :attribute must be less than or equal :value kilobytes.",numeric:"The :attribute must be less than or equal :value.",string:"The :attribute must be less than or equal :value characters."},max:{array:"The :attribute must not have more than :max items.",file:"The :attribute must not be greater than :max kilobytes.",numeric:"The :attribute must not be greater than :max.",string:"The :attribute must not be greater than :max characters."},mimes:"檔案格式錯誤，需為 :values 檔",mimetypes:"檔案格式錯誤，需為 xls 或 xlsx 檔",min:{array:"The :attribute must have at least :min items.",file:"The :attribute must be at least :min kilobytes.",numeric:"The :attribute must be at least :min.",string:"The :attribute must be at least :min characters."},multiple_of:"The :attribute must be a multiple of :value.",not_in:"The selected :attribute is invalid.",not_regex:"The :attribute format is invalid.",numeric:"The :attribute must be a number.",password:"The password is incorrect.",present:"The :attribute field must be present.",prohibited:"The :attribute field is prohibited.",prohibited_if:"The :attribute field is prohibited when :other is :value.",prohibited_unless:"The :attribute field is prohibited unless :other is in :values.",regex:"格式不正確",required:"欄位未填寫",required_if:"The :attribute field is required when :other is :value.",required_unless:"The :attribute field is required unless :other is in :values.",required_with:"The :attribute field is required when :values is present.",required_with_all:"The :attribute field is required when :values are present.",required_without:"The :attribute field is required when :values is not present.",required_without_all:"The :attribute field is required when none of :values are present.",same:"The :attribute and :other must match.",size:{array:"The :attribute must contain :size items.",file:"The :attribute must be :size kilobytes.",numeric:"The :attribute must be :size.",string:"The :attribute must be :size characters."},starts_with:"The :attribute must start with one of the following: :values.",string:"The :attribute must be a string.",timezone:"The :attribute must be a valid zone.",unique:"The :attribute has already been taken.",uploaded:"The :attribute failed to upload.",url:"The :attribute format is invalid.",uuid:"The :attribute must be a valid UUID."},"zh-TW.welcomePageLang":{header:"耗材管理",login_btn:"登入",menu:"主目錄"}}},1274:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"input[data-v-2d256245]::-webkit-inner-spin-button,input[data-v-2d256245]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number][data-v-2d256245]{-moz-appearance:textfield}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/ChartJSLine.vue"],names:[],mappings:"AAyKA,oGAEI,uBAAwB,CACxB,QACJ,CAGA,oCACI,yBACJ",sourcesContent:['<template>\n    <div class="card-header row align-items-center">\n        <div class="col col-2">\n            <input id="yearInput" class="text-center m-0 p-0 form-control form-control-lg" type="number" min="1996"\n                v-model="yearTag" />\n        </div>\n        <h3 class="col col-auto align-middle m-0 p-0">\n            {{ $t("callpageLang.diffalert") }}\n        </h3>\n    </div>\n    <div class="card-body">\n        <Line ref="chartRef" :data="chartData" :options="options" @click="onClick" />\n    </div>\n</template>\n\n<script>\nimport { yearTag, monthTag, checkedRows, data, table, datasetBuyUSD, datasetRealUSD } from \'../../composables/DiffTableStore.js\';\nimport * as XLSX from \'xlsx\';\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport {\n    Chart as ChartJS,\n    Title,\n    Tooltip,\n    Legend,\n    BarElement,\n    CategoryScale,\n    LinearScale,\n    InteractionItem,\n    LineElement,\n    PointElement,\n    Filler\n} from \'chart.js\';\nimport {\n    Chart,\n    Line,\n    getDatasetAtEvent,\n    getElementAtEvent,\n    getElementsAtEvent\n} from \'vue-chartjs\';\n\nChartJS.register(CategoryScale, LinearScale, BarElement, LineElement, PointElement, Filler, Title, Tooltip, Legend);\n\nexport default {\n    name: \'App\',\n    components: { Line },\n    setup() {\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const datasetAtEvent = (dataset) => {\n            if (!dataset.length) return\n\n            const datasetIndex = dataset[0].datasetIndex\n\n            console.log(\'dataset\', chartData.value.datasets[datasetIndex].label)\n        } // datasetAtEvent\n\n        const elementAtEvent = (element) => {\n            if (!element.length) return\n\n            const { datasetIndex, index } = element[0]\n\n            // console.log(\n            //     \'element\',\n            //     datasetIndex,\n            //     index,\n            //     chartData.value.labels[index],\n            //     chartData.value.datasets[datasetIndex].data[index]\n            // );\n\n            monthTag.value = index;\n        } // elementAtEvent\n\n        const elementsAtEvent = (elements) => {\n            if (!elements.length) return\n\n            console.log(\'elements\', elements)\n        } // elementsAtEvent\n\n        const chartRef = ref(null);\n\n        const onClick = (event) => {\n            const {\n                value: { chart }\n            } = chartRef\n\n            if (!chart) {\n                return\n            } // if\n\n            // datasetAtEvent(getDatasetAtEvent(chart, event));\n            elementAtEvent(getElementAtEvent(chart, event));\n            // elementsAtEvent(getElementsAtEvent(chart, event));\n        } // onClick\n\n        const date = new Date();\n        const currentMonth = date.getMonth();\n        const currentYear = date.getFullYear();\n        const monthList = ref(app.appContext.config.globalProperties.$t("monthlyPRpageLang.months").split(\'_\'));\n        monthList.value.splice(currentMonth + 1, 12);\n        watch(yearTag, async () => {\n            if (parseInt(yearTag.value) == currentYear) {\n                let tempRef = app.appContext.config.globalProperties.$t("monthlyPRpageLang.months").split(\'_\');\n                tempRef.splice(currentMonth + 1, 12);\n                monthList.value = tempRef;\n            } else {\n                monthList.value = app.appContext.config.globalProperties.$t("monthlyPRpageLang.months").split(\'_\');\n            } // if else\n        }); // watch for data change\n\n        const chartData = computed(() => ({\n            labels: monthList.value,\n            datasets: [\n                {\n                    label: app.appContext.config.globalProperties.$t("outboundpageLang.realpickamount") + "(USD)",\n                    borderColor: \'rgb(9, 116, 230)\',\n                    backgroundColor: \'rgba(9, 116, 230, 0.5)\',\n                    pointStyle: \'rect\',\n                    data: datasetRealUSD.value,\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount1") + "(USD)",\n                    borderColor: \'rgb(245, 44, 44)\',\n                    backgroundColor: \'rgba(245, 44, 44, 0.5)\',\n                    pointStyle: \'rect\',\n                    fill: \'-1\',\n                    data: datasetBuyUSD.value,\n                },\n                // {\n                //     type: \'bar\',\n                //     label: \'Bar\',\n                //     backgroundColor: \'#ff9991\',\n                //     data: [10, 20, 30, 40, 90, 100, 50, 1, 40, 90, 100, 5]\n                // },\n            ],\n        }));\n        const options = {\n            interaction: {\n                mode: \'index\',\n                intersect: false,\n            },\n            responsive: true,\n            maintainAspectRatio: false,\n            // radius: 10,\n            hoverRadius: 10,\n        };\n\n        return {\n            chartRef,\n            onClick,\n            chartData,\n            options,\n            yearTag\n        }\n    }\n}\n<\/script>\n<style scoped>\n/* Chrome, Safari, Edge, Opera */\ninput::-webkit-outer-spin-button,\ninput::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n}\n\n/* Firefox */\ninput[type=number] {\n    -moz-appearance: textfield;\n}\n</style>'],sourceRoot:""}]);const l=i},2646:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-1d12f6c1] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/CombinedMonthlyPRSearchTable.vue"],names:[],mappings:"AA6tCA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="card">\n        <div class="card-header ">\n            <h3>{{ $t("monthlyPRpageLang.PR") }}</h3>\n        </div>\n        <div class="card-body">\n            <div class="row justify-content-between">\n                <div class="row col col-auto">\n                    <div class="col col-auto">\n                        <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n                    </div>\n                    <div class="col col-6 p-0 m-0">\n                        <input id="pnInput" class="text-center form-control form-control-lg"\n                            v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n                    </div>\n                </div>\n                <div class="col col-auto">\n                    <button id="delete" name="delete" class="col col-auto btn btn-lg btn-danger" @click="deleteRow">\n                        <i class="bi bi-trash3-fill fs-4"></i>\n                    </button>\n                    &nbsp;\n                    <button id="download" name="download" class="col col-auto btn btn-lg btn-success"\n                        :value="$t(\'monthlyPRpageLang.download\')" @click="OutputExcelClick">\n                        <i class="bi bi-file-earmark-arrow-down-fill fs-4"></i>\n                    </button>\n                </div>\n            </div>\n            <div class="w-100" style="height: 1ch"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n            <div class="row justify-content-between">\n                <span v-if="isInvalid_DB" class="col col-auto text-danger m-0 p-0" role="alert">\n                    <strong>{{ validation_err_msg }}</strong>\n                </span>\n                <span v-else class="col col-auto text-danger m-0 p-0" role="alert">\n                    <strong></strong>\n                </span>\n                <span class="col col-auto text-sm text-danger m-0 p-0">{{ $t(\'monthlyPRpageLang.shallow_delete\')\n                    }}</span>\n            </div>\n            <table-lite id="searchTable" :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="true"\n                :isLoading="table.isLoading" :messages="table.messages" :columns="table.columns" :rows="table.rows"\n                :total="table.totalRecordCount" :page-options="table.pageOptions" :sortable="table.sortable"\n                @is-finished="table.isLoading = false" @return-checked-rows="updateCheckedRows"></table-lite>\n\n            <div class="row justify-content-center">\n                <div v-show="uploadToDBReady" class="col col-auto">\n                    <div v-if="needConfirm" class="col col-auto m-0 p-0">\n                        <button type="button" name="upload" data-bs-toggle="modal" data-bs-target="#sendPRConfirmTable"\n                            aria-controls="sendPRConfirmTable"\n                            class="col col-auto fs-3 text-center btn btn-lg btn-info">\n                            <i class="bi bi-envelope-check-fill"></i>\n                            {{ $t(\'monthlyPRpageLang.SendPRReview\') }}\n                        </button>\n                    </div>\n                    <div v-else class="col col-auto m-0 p-0">\n                        <button @click="onSendClick" type="button" name="upload"\n                            class="col col-auto fs-3 text-center btn btn-lg btn-info">\n                            <i class="bi bi-envelope-check-fill"></i>\n                            {{ $t(\'monthlyPRpageLang.SendPRReview\') }}\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="modal fade" id="sendPRConfirmTable" tabindex="-1" aria-labelledby="sendPRConfirmTable"\n        aria-hidden="true">\n        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">\n            <div class="modal-content">\n                <div class="modal-header justify-content-center">\n                    <h1 class="col col-auto modal-title m-0 p-0 fs-4">\n                        {{ modalTitle }}\n                    </h1>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n                    <div class="row justify-content-between">\n                        <div class="row col col-auto">\n                            <div class="col col-auto">\n                                <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }}\n                                    :</label>\n                            </div>\n                            <div class="col col-auto p-0 m-0">\n                                <input id="pnInput" class="text-center form-control form-control-lg"\n                                    v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')"\n                                    v-model="searchTerm2" />\n                            </div>\n                        </div>\n                    </div>\n                    <div class="w-100" style="height: 1ch"></div>\n                    \x3c!-- </div>breaks cols to a new line--\x3e\n                    <table-lite :is-static-mode="true" :isSlotMode="true" :hasCheckbox="false"\n                        :messages="table2.messages" :columns="table2.columns" :rows="table2.rows"\n                        :total="table2.totalRecordCount" :page-options="table2.pageOptions" :sortable="table2.sortable"\n                        :is-fixed-first-column="false">\n                    </table-lite>\n                </div>\n                <div v-if="showFooter" class="modal-footer justify-content-between">\n                    <button type="button" class="btn btn-lg btn-danger" style="border-radius: 5px;">\n                        {{ $t(\'monthlyPRpageLang.review_cancel\') }}\n                    </button>\n                    <button @click="onSendClick" type="button" class="btn btn-lg btn-success"\n                        style="border-radius: 5px;">\n                        {{ $t(\'monthlyPRpageLang.review_complete\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useMonthlyPRSearch from "../../composables/MonthlyPRSearch.ts";\nimport useSxbSearch from "../../composables/SxbSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const { mats, Currency, getMats_Buylist, getMats_nonMonthly, sendBuylistMail, submitBuylist, getCurrency } = useMonthlyPRSearch(); // axios get the mats data\n        const { mats_SXB, getMats } = useSxbSearch(); // axios get the mats data\n\n        onBeforeMount(getCurrency);\n\n        const selectedValue2 = ref(\'USD\');\n        let isInvalid = ref(true); // validation\n\n        let isInvalid_DB = ref(false); // add to DB validation\n        let validation_err_msg = ref(app.appContext.config.globalProperties.$t("validation.required"));\n        let checkedRows = [];\n        let uploadToDBReady = ref(false); // validation\n        let needConfirm = ref(false); // try to prevent redundant PR on the same PN\n\n        const MPSData = ref(null);\n        const nonMPSData = ref(null);\n        const combinedData = ref(null);\n        let nonMPS_PN_Array = [];\n        let MPS_PN_Array = [];\n        let MPS_90PN_Array = [];\n\n        const searchTerm = ref(""); // Search text\n        const searchTerm2 = ref(""); // Search text for modal table\n        const modalTitle = ref("");\n        let showFooter = ref(false);\n\n\n        // pour the data in\n        const data = reactive([]);\n        const data2 = reactive([]);\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const deleteRow = () => {\n            if (checkedRows.length == 0) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                return;\n            } // if\n\n            for (let i = 0; i < checkedRows.length; i++) {\n                let indexOfObject = data.findIndex(object => {\n                    return parseInt(object.id) === parseInt(checkedRows[i].id);\n                });\n\n                if (indexOfObject != -1) {\n                    data.splice(indexOfObject, 1);\n                } // if\n            } // for\n\n            document.querySelectorAll(\'.vtl-tbody-checkbox\').forEach(el => el.checked = false);\n            if (document.querySelector(".vtl-thead-checkbox").checked) {\n                document.querySelector(".vtl-thead-checkbox").click();\n            } // if\n            checkedRows = [];\n\n        } // deleteRowv\n\n        const OutputExcelClick = async () => {\n            await triggerModal();\n\n            // get today\'s date for filename\n            let today = new Date();\n            let dd = String(today.getDate()).padStart(2, \'0\');\n            let mm = String(today.getMonth() + 1).padStart(2, \'0\'); //January is 0!\n            let yyyy = today.getFullYear();\n            today = yyyy + "_" + mm + \'_\' + dd;\n\n            let rows = Array();\n\n            for (let i = 0; i < data.length; i++) {\n                let tempObj = new Object;\n                tempObj.料號 = data[i].料號;\n                tempObj.品名 = data[i].品名;\n                tempObj.規格 = data[i].規格;\n                tempObj.單價 = data[i].單價;\n                tempObj.幣別1 = data[i].幣別;\n                tempObj.當月需求 = parseFloat(data[i].當月需求).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",");\n                tempObj.下月需求 = parseFloat(data[i].下月需求).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",");\n                tempObj.現有庫存 = parseInt(data[i].現有庫存).toLocaleString("en-US");\n                tempObj.在途量 = parseInt(data[i].在途量).toLocaleString("en-US");\n                tempObj.本次請購數量 = parseInt(data[i].本次請購數量).toLocaleString("en-US");\n                tempObj.請購金額 = parseFloat(data[i].請購金額).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",");\n                tempObj.幣別2 = data[i].幣別;\n                tempObj.匯率 = parseFloat(data[i].匯率).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",");\n                tempObj.MOQ = data[i].MOQ;\n                rows.push(tempObj);\n            } // for\n\n            const worksheet = XLSX.utils.json_to_sheet(rows);\n\n            // change header name\n            XLSX.utils.sheet_add_aoa(worksheet,\n                [[\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.isn"),\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.pName"),\n                    app.appContext.config.globalProperties.$t("inboundpageLang.format"),\n                    app.appContext.config.globalProperties.$t("basicInfoLang.price"),\n                    app.appContext.config.globalProperties.$t("basicInfoLang.money"),\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.nowneed"),\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.nextneed"),\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.nowstock"),\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.transit"),\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount"),\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.buyprice"),\n                    app.appContext.config.globalProperties.$t("basicInfoLang.money"),\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.buyprice") + "(USD)",\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.moq"),\n                ]],\n                { origin: "A1" });\n\n            const workbook = XLSX.utils.book_new();\n            XLSX.utils.book_append_sheet(workbook, worksheet, app.appContext.config.globalProperties.$t("monthlyPRpageLang.PR"));\n            XLSX.writeFile(workbook,\n                app.appContext.config.globalProperties.$t(\n                    "monthlyPRpageLang.PR"\n                ) + "_" + today + ".xlsx", { compression: true });\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // OutputExcelClick\n\n        const onSendClick = async () => {\n            await triggerModal();\n\n            isInvalid_DB.value = false;\n            let rowsCount = 0;\n            let hasError = false;\n\n            if (data.length <= 0) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // actually updating database now\n            let number = [];\n            let pName = [];\n            let spec = [];\n            let unit_price = [];\n            let nowNeed = [];\n            let nextNeed = [];\n            let stock = [];\n            let in_transit = [];\n            let req_amount = [];\n            let total_price_default_currency = [];\n            let total_price_default_currency_name = [];\n            let total_price_other_currency = [];\n            let moq = [];\n\n            let tempData = data;\n            tempData.sort((a, b) => b.匯率 - a.匯率);\n            // console.log(tempData); // test\n            for (let i = 0; i < tempData.length; i++) {\n                if (parseInt(tempData[i].本次請購數量) > 0) { // send only the one that has value\n                    number.push(tempData[i].料號);\n                    pName.push(tempData[i].品名);\n                    spec.push(tempData[i].規格);\n                    unit_price.push(tempData[i].單價);\n                    nowNeed.push(parseFloat(tempData[i].當月需求).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ","));\n                    nextNeed.push(parseFloat(tempData[i].下月需求).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ","));\n                    stock.push(parseInt(tempData[i].現有庫存).toLocaleString("en-US"));\n                    in_transit.push(parseInt(tempData[i].在途量).toLocaleString("en-US"));\n                    req_amount.push(parseInt(tempData[i].本次請購數量).toLocaleString("en-US"));\n                    total_price_default_currency.push(parseFloat(tempData[i].請購金額).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ","));\n                    total_price_default_currency_name.push(tempData[i].幣別);\n                    total_price_other_currency.push(parseFloat(tempData[i].匯率).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ","));\n                    moq.push(tempData[i].MOQ);\n                } // if\n                else {\n                    hasError = true;\n                } // else\n            } // for\n\n            if (number.length <= 0) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value = app.appContext.config.globalProperties.$t("monthlyPRpageLang.no_req_amount_to_submit");\n\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n            else if (hasError) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value = app.appContext.config.globalProperties.$t("monthlyPRpageLang.some_data_has_no_amount");\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.some_data_has_no_amount"),\n                    duration: 5000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else if\n\n            // console.log(total_price_other_currency); // test\n            // return;\n            let start = Date.now();\n            let result = await sendBuylistMail(\n                number, pName, spec, unit_price,\n                nowNeed, nextNeed, stock, in_transit, req_amount,\n                total_price_default_currency, total_price_default_currency_name, total_price_other_currency, moq\n            );\n\n            let timeTaken = Date.now() - start;\n            console.log("Total time taken : " + timeTaken + " milliseconds");\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n\n            // ------- quick test --------\n            // result = await submitBuylist(\n            //     number, pName, spec, unit_price,\n            //     nowNeed, nextNeed, stock, in_transit, req_amount,\n            //     total_price_default_currency, total_price_default_currency_name,\n            //     total_price_other_currency, moq, nonMPS_PN_Array, MPS_90PN_Array, MPS_PN_Array\n            // );\n            // result = "failed";\n            // ------- ---- --------\n\n            if (result === "success") {\n                result = await submitBuylist(\n                    number, pName, spec, unit_price,\n                    nowNeed, nextNeed, stock, in_transit, req_amount,\n                    total_price_default_currency, total_price_default_currency_name,\n                    total_price_other_currency, moq, nonMPS_PN_Array, MPS_90PN_Array, MPS_PN_Array\n                );\n\n                if (result === "success") {\n                    uploadToDBReady.value = false;\n                    notyf.open({\n                        type: "success",\n                        message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.total") + " " + data.length + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.record") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                        duration: 3000, //miliseconds, use 0 for infinite duration\n                        ripple: true,\n                        dismissible: true,\n                        position: {\n                            x: "right",\n                            y: "bottom",\n                        },\n                    });\n                } // if\n                else {\n                    notyf.open({\n                        type: "error",\n                        message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                        duration: 3000, //miliseconds, use 0 for infinite duration\n                        ripple: true,\n                        dismissible: true,\n                        position: {\n                            x: "right",\n                            y: "bottom",\n                        },\n                    });\n                } // else\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.sent_email_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n\n            await getCurrency();\n        } // onSendClick\n\n        watch(Currency, async () => {\n            await triggerModal();\n            data.splice(0);\n            if (Currency.value === "Not Found") {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.exchangerate_notfound"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n            } // if\n\n            let today = new Date();\n            let twentyDaysAgo = new Date();\n            twentyDaysAgo.setDate(today.getDate() - 20);\n            sessionStorage.clear();\n            sessionStorage.setItem("sxbisn", null);\n            sessionStorage.setItem("sxbsend", null);\n            sessionStorage.setItem("sxbbegin", JSON.stringify(twentyDaysAgo.toISOString().split(\'T\')[0]));\n            sessionStorage.setItem("sxbend", JSON.stringify(today.toISOString().split(\'T\')[0]));\n            await getMats();\n\n            nonMPS_PN_Array = [];\n            MPS_PN_Array = [];\n            MPS_90PN_Array = [];\n            isInvalid.value = false;\n            let exchange_table = Currency.value.rates;\n\n            // if all is good, proceed on generating the CombinedPRTable\n            if (isInvalid.value === false) {\n                await getMats_Buylist();\n                MPSData.value = JSON.parse(mats.value).data;\n                await getMats_nonMonthly();\n                nonMPSData.value = JSON.parse(mats.value).data;\n\n                // console.log(MPSData.value); // test\n                // console.log(nonMPSData.value); // test\n\n                let singleEntry = {};\n                let tempAll = [];\n                for (let i = 0; i < MPSData.value.length; i++) {\n                    singleEntry.料號 = MPSData.value[i].料號.toString().trim();\n                    singleEntry.品名 = MPSData.value[i].品名.toString().trim();\n                    singleEntry.單位 = MPSData.value[i].單位.toString().trim();\n                    singleEntry.規格 = MPSData.value[i].規格.toString().trim();\n                    singleEntry.單價 = parseFloat(MPSData.value[i].單價);\n                    singleEntry.當月需求 = parseInt(MPSData.value[i].本月MPS) * parseFloat(MPSData.value[i].單耗) / 1000;\n                    singleEntry.下月需求 = parseInt(MPSData.value[i].下月MPS) * parseFloat(MPSData.value[i].單耗) / 1000;\n                    if (MPSData.value[i].total_stock === null) {\n                        singleEntry.現有庫存 = 0;\n                    } else {\n                        singleEntry.現有庫存 = parseInt(MPSData.value[i].total_stock);\n                    } // if else\n\n                    if (MPSData.value[i].in_transit === null) {\n                        singleEntry.在途量 = 0;\n                    } else {\n                        singleEntry.在途量 = Math.round(parseFloat(MPSData.value[i].in_transit));\n                    } // if else\n\n                    // Don\'t care, will be calculated below\n                    singleEntry.本次請購數量 = Math.ceil(singleEntry.當月需求 + singleEntry.下月需求);\n\n                    singleEntry.請購金額 = parseFloat((singleEntry.本次請購數量 * singleEntry.單價).toFixed(5));\n                    singleEntry.幣別 = MPSData.value[i].幣別.toString().trim().toUpperCase();\n                    if (singleEntry.幣別 == "RMB") {\n                        singleEntry.匯率 = parseFloat((singleEntry.請購金額 * (exchange_table[\'USD\'] / exchange_table[\'CNY\'])).toFixed(5));\n                    } // if\n                    else {\n                        singleEntry.匯率 = parseFloat((singleEntry.請購金額 * (exchange_table[\'USD\'] / exchange_table[singleEntry.幣別])).toFixed(5));\n                    } // else\n                    singleEntry.MOQ = parseInt(MPSData.value[i].MOQ.toString().trim());\n                    singleEntry.id = i;\n                    tempAll.push(singleEntry);\n                    MPS_PN_Array.push(singleEntry.料號);\n                    MPS_90PN_Array.push(MPSData.value[i].料號90);\n                    // data.push(singleEntry); // test\n                    // console.log(singleEntry); // test\n                    singleEntry = {};\n                } // for\n\n                for (let i = 0; i < nonMPSData.value.length; i++) {\n                    singleEntry.料號 = nonMPSData.value[i].料號.toString().trim();\n                    singleEntry.品名 = nonMPSData.value[i].品名.toString().trim();\n                    singleEntry.單位 = nonMPSData.value[i].單位.toString().trim();\n                    singleEntry.規格 = nonMPSData.value[i].規格.toString().trim();\n                    singleEntry.單價 = parseFloat(nonMPSData.value[i].單價);\n                    singleEntry.當月需求 = parseFloat(nonMPSData.value[i].當月需求);\n                    singleEntry.下月需求 = parseFloat(nonMPSData.value[i].下月需求);\n                    if (nonMPSData.value[i].total_stock === null) {\n                        singleEntry.現有庫存 = 0;\n                    } else {\n                        singleEntry.現有庫存 = parseInt(nonMPSData.value[i].total_stock);\n                    } // if else\n\n                    if (nonMPSData.value[i].in_transit === null) {\n                        singleEntry.在途量 = 0;\n                    } else {\n                        singleEntry.在途量 = Math.round(parseFloat(nonMPSData.value[i].in_transit));\n                    } // if else\n\n                    // Don\'t care, will be calculated below\n                    singleEntry.本次請購數量 = Math.ceil(singleEntry.當月需求 + singleEntry.下月需求);\n\n                    singleEntry.請購金額 = parseFloat((singleEntry.本次請購數量 * singleEntry.單價).toFixed(5));\n                    singleEntry.幣別 = nonMPSData.value[i].幣別.toString().trim().toUpperCase();\n                    if (singleEntry.幣別 == "RMB") {\n                        singleEntry.匯率 = parseFloat((singleEntry.請購金額 * (exchange_table[\'USD\'] / exchange_table[\'CNY\'])).toFixed(5));\n                    } // if\n                    else {\n                        singleEntry.匯率 = parseFloat((singleEntry.請購金額 * (exchange_table[\'USD\'] / exchange_table[singleEntry.幣別])).toFixed(5));\n                    } // else\n                    singleEntry.MOQ = parseInt(nonMPSData.value[i].MOQ.toString().trim());\n\n                    singleEntry.id = i + MPSData.value.length;\n\n                    tempAll.push(singleEntry);\n                    nonMPS_PN_Array.push(singleEntry.料號);\n                    singleEntry = {};\n                } // for\n\n                // console.log(tempAll); // test\n\n                // sum by 料號\n                let sum_result = Object.values(tempAll.reduce((accumulator, currentValue) => {\n                    if (!accumulator[currentValue.料號]) { // if the current 料號 is fisrt met, then we create a index for it\n                        accumulator[currentValue.料號] =\n                        {\n                            id: currentValue.id,\n                            料號: currentValue.料號,\n                            品名: currentValue.品名,\n                            規格: currentValue.規格,\n                            單位: currentValue.單位,\n                            單價: currentValue.單價,\n                            當月需求: 0,\n                            下月需求: 0,\n                            現有庫存: currentValue.現有庫存,\n                            在途量: currentValue.在途量,\n                            本次請購數量: 0,\n                            請購金額: 0,\n                            幣別: currentValue.幣別,\n                            匯率: 0,\n                            MOQ: currentValue.MOQ\n                        };\n                    } // if\n\n                    // sum the value by index\n                    accumulator[currentValue.料號].當月需求 += currentValue.當月需求;\n                    accumulator[currentValue.料號].下月需求 += currentValue.下月需求;\n                    return accumulator;\n                }, {}));\n\n                // console.log(sum_result); // test\n\n                // Calculate result rows\n                let final_result = Object.values(sum_result.reduce((accumulator, currentValue) => {\n                    if (!accumulator[currentValue.料號]) { // if the current 料號 is fisrt met, then we create a index for it\n                        accumulator[currentValue.料號] =\n                        {\n                            id: currentValue.id,\n                            料號: currentValue.料號,\n                            品名: currentValue.品名,\n                            單位: currentValue.單位,\n                            規格: currentValue.規格,\n                            單價: currentValue.單價,\n                            當月需求: currentValue.當月需求,\n                            下月需求: currentValue.下月需求,\n                            現有庫存: currentValue.現有庫存,\n                            在途量: currentValue.在途量,\n                            本次請購數量: 0,\n                            請購金額: 0,\n                            幣別: currentValue.幣別,\n                            匯率: 0,\n                            MOQ: currentValue.MOQ\n                        };\n                    } // if\n\n                    // calculate the value by index\n                    accumulator[currentValue.料號].本次請購數量 = Math.ceil(currentValue.當月需求 + currentValue.下月需求 - currentValue.現有庫存 - currentValue.在途量);\n                    if (accumulator[currentValue.料號].本次請購數量 < 0) {\n                        accumulator[currentValue.料號].本次請購數量 = 0;\n                    } // if\n                    accumulator[currentValue.料號].請購金額 = parseFloat((accumulator[currentValue.料號].本次請購數量 * currentValue.單價).toFixed(5));\n                    if (currentValue.幣別 == "RMB") {\n                        accumulator[currentValue.料號].匯率 = parseFloat((accumulator[currentValue.料號].請購金額 * (exchange_table[\'USD\'] / exchange_table[\'CNY\'])).toFixed(5));\n                    } // if\n                    else {\n                        accumulator[currentValue.料號].匯率 = parseFloat((accumulator[currentValue.料號].請購金額 * (exchange_table[\'USD\'] / exchange_table[currentValue.幣別])).toFixed(5));\n                    } // else\n                    // console.log(accumulator); // test\n                    return accumulator;\n                }, {}));\n\n                // console.log(final_result); // test\n\n                // push to table\n                Object.assign(data, final_result.map(obj => obj));\n\n                let allPN = final_result.map(obj => obj.料號);\n                let SXB_PN = JSON.parse(mats_SXB.value).datas.map(obj => obj.料號);\n                // console.log(JSON.parse(mats_SXB.value).datas); // test\n                needConfirm.value = allPN.some(r => SXB_PN.includes(r));\n                if (needConfirm.value) {\n                    data2.splice(0);\n                    Object.assign(data2, JSON.parse(mats_SXB.value).datas.flatMap((obj) => {\n                        if (obj.SRM單號 !== "已退單") {\n                            let singleEntry = {};\n                            singleEntry.料號 = obj.料號;\n                            singleEntry.品名 = obj.品名;\n                            singleEntry.單位 = obj.單位;\n                            singleEntry.規格 = obj.規格;\n                            singleEntry.單號 = obj.SXB單號;\n                            singleEntry.狀態 = obj.SRM單號;\n                            singleEntry.請購金額 = parseFloat(obj.請購金額).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",");\n                            singleEntry.幣別 = obj.幣別.toString().trim().toUpperCase();\n                            singleEntry.請購量 = parseInt(obj.本次請購數量);\n                            singleEntry.請購時間 = obj.請購時間;\n                            singleEntry.開單人員 = obj.開單人員;\n                            singleEntry.現有庫存 = parseInt(obj.現有庫存);\n                            return singleEntry;\n                        } // if\n                        else {\n                            return [];\n                        } // else\n                    }));\n                } // if\n\n                if(data2.length <= 0) {\n                    needConfirm.value = false;\n                } // if\n\n            } // if\n\n            if (data.length > 0) {\n                uploadToDBReady.value = true;\n            } // if\n            else {\n                uploadToDBReady.value = false;\n            } // else\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="isn\' +\n                            row.id +\n                            \'" name="isn\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="scrollableWithoutScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.format"\n                    ),\n                    field: "規格",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="format\' +\n                            i +\n                            \'" name="format\' +\n                            i +\n                            \'" value="\' +\n                            row.規格 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.規格 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.price"\n                    ),\n                    field: "單價",\n                    width: "9ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="price\' +\n                            i +\n                            \'" name="price\' +\n                            i +\n                            \'" value="\' +\n                            row.單價 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.單價 + " <small>" + row.幣別 + "</small>" +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.nowneed"\n                    ),\n                    field: "當月需求",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="nowneed\' +\n                            i +\n                            \'" name="nowneed\' +\n                            i +\n                            \'" value="\' +\n                            row.當月需求 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.當月需求).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",") +\n                            " <small>" + row.單位 + "</small>" + "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.nextneed"\n                    ),\n                    field: "下月需求",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="nextneed\' +\n                            row.id +\n                            \'" name="nextneed\' +\n                            i +\n                            \'" value="\' +\n                            row.下月需求 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.下月需求).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",") +\n                            " <small>" + row.單位 + "</small>" + "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.nowstock"\n                    ),\n                    field: "現有庫存",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="nowstock\' +\n                            row.id +\n                            \'" name="nowstock\' +\n                            i +\n                            \'" value="\' +\n                            row.現有庫存 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseInt(row.現有庫存).toLocaleString("en-US") +\n                            " <small>" + row.單位 + "</small>" + "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.transit"\n                    ),\n                    field: "在途量",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="transit\' +\n                            i +\n                            \'" name="transit\' +\n                            i +\n                            \'" value="\' +\n                            row.在途量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseInt(row.在途量).toLocaleString("en-US") +\n                            " <small>" + row.單位 + "</small>" + "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buyamount"\n                    ),\n                    field: "本次請購數量",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="buyamount\' +\n                            row.id +\n                            \'" name="buyamount\' +\n                            i +\n                            \'" value="\' +\n                            row.本次請購數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseInt(row.本次請購數量).toLocaleString("en-US") +\n                            " <small>" + row.單位 + "</small>" + "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buyprice"\n                    ),\n                    field: "請購金額",\n                    width: "11ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="buyprice\' +\n                            row.id +\n                            \'" name="buyprice\' +\n                            i +\n                            \'" value="\' +\n                            row.請購金額 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.請購金額).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",") +\n                            " <small>" + row.幣別 + "</small>" +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buyprice"\n                    ) + "(USD)",\n                    field: "匯率",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="rate\' +\n                            row.id +\n                            \'" name="rate\' +\n                            i +\n                            \'" value="\' +\n                            row.匯率 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.匯率).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",") +\n                            " " + "<small>USD</small>" +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.moq"\n                    ),\n                    field: "MOQ",\n                    width: "8ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="moq\' +\n                            row.id +\n                            \'" name="moq\' +\n                            i +\n                            \'" value="\' +\n                            row.MOQ +\n                            \'">\' +\n                            \'<div class="scrollableWithoutScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.MOQ + " <small>" + row.單位 + "</small>" +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const table2 = reactive({\n            isLoading: true,\n            columns: [\n            {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buytime"\n                    ),\n                    field: "請購時間",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        let returnStr = "";\n                        // console.log(row); // test\n                        returnStr =\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.請購時間 +\n                            "</div>";\n                        \n                        return returnStr;\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    isKey: true,\n                    display: function (row, i) {\n                        // console.log(row);\n                        return (\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.pName"\n                    ),\n                    field: "品名",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buyamount1"\n                    ),\n                    field: "請購量",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseInt(row.請購量).toLocaleString("en-US") +\n                            " <small>" + row.單位 + "</small>" +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buyprice"\n                    ),\n                    field: "請購金額",\n                    width: "11ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.請購金額 + " <small>" + row.幣別 + "</small>" +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.transit_reviser"\n                    ),\n                    field: "開單人員",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.開單人員 === null || row.開單人員 === undefined) row.開單人員 = "N/A";\n                        return (\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.開單人員 +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data2.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm2.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm2.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table2.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            // console.log(rowsKey); // test\n            checkedRows = rowsKey;\n        };\n\n        return {\n            selectedValue2,\n            isInvalid,\n            isInvalid_DB,\n            validation_err_msg,\n            uploadToDBReady,\n            needConfirm,\n            searchTerm,\n            searchTerm2,\n            table,\n            table2,\n            modalTitle,\n            showFooter,\n            updateCheckedRows,\n            deleteRow,\n            OutputExcelClick,\n            onSendClick,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>\n'],sourceRoot:""}]);const l=i},4180:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-5858c480] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/DemandRecieveDiffTable.vue"],names:[],mappings:"AAsnBA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="card-header row align-items-center">\n        <h3 class="col col-auto align-middle m-0 p-0">\n            {{ yearTag + "-" + monthStr + " " + $t("callpageLang.diffalert") }}\n        </h3>\n    </div>\n    <div class="card-body">\n        <div class="row justify-content-between">\n            <div class="row col col-auto">\n                <div class="col col-auto">\n                    <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n                </div>\n                <div class="col col-auto p-0 m-0">\n                    <input id="pnInput" class="text-center form-control form-control-lg"\n                        v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n                </div>\n            </div>\n            <div class="col col-auto">\n                <button id="download" name="download" class="col col-auto btn btn-lg btn-success"\n                    :value="$t(\'monthlyPRpageLang.download\')" @click="OutputExcelClick(\'All\')">\n                    <i class="bi bi-file-earmark-arrow-down-fill fs-4"></i>\n                </button>\n            </div>\n        </div>\n        <div class="w-100" style="height: 1ch"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n        <table-lite id="searchTable" :is-fixed-first-column="true" :hasCheckbox="true" :isStaticMode="true"\n            :isSlotMode="true" :messages="table.messages" :columns="table.columns" :rows="table.rows"\n            :total="table.totalRecordCount" :page-options="table.pageOptions" :sortable="table.sortable"\n            @return-checked-rows="updateCheckedRows">\n            <template v-slot:料號="{ row, key }">\n                <div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">\n                    {{ row.料號 }}\n                </div>\n            </template>\n            <template v-slot:請購數量="{ row, key }">\n                <div class="col col-auto align-items-center m-0 p-0">\n                    <span class="m-0 p-0" style="width: 12ch;">\n                        {{ parseInt(row.請購數量).toLocaleString(\'en\', { useGrouping: true }) }}\n                        <small>{{ row.單位 }}</small>\n                    </span>\n                </div>\n            </template>\n            <template v-slot:實際領用數量="{ row, key }">\n                <div class="col col-auto align-items-center m-0 p-0">\n                    <span class="m-0 p-0" style="width: 12ch;">\n                        {{ parseInt(row.實際領用數量).toLocaleString(\'en\', { useGrouping: true }) }}\n                        <small>{{ row.單位 }}</small>\n                    </span>\n                </div>\n            </template>\n            <template v-slot:需求與領用差異量="{ row, key }">\n                <div class="col col-auto align-items-center m-0 p-0">\n                    <span class="m-0 p-0" style="width: 12ch;">\n                        {{ parseInt(row.需求與領用差異量).toLocaleString(\'en\', { useGrouping: true }) }}\n                        <small>{{ row.單位 }}</small>\n                    </span>\n                </div>\n            </template>\n            <template v-slot:需求與領用差異="{ row, key }">\n                <div class="CustomScrollbar text-nowrap" style="overflow-x: auto; width: 100%;">\n                    {{ row.需求與領用差異 }}%\n                </div>\n            </template>\n        </table-lite>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed, defineModel } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport { yearTag, monthTag, checkedRows, searchTerm, data, table, datasetBuyUSD, datasetRealUSD } from \'../../composables/DiffTableStore.js\';\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useDiffSearch from "../../composables/DiffSearch.ts";\nimport useMonthlyPRSearch from "../../composables/MonthlyPRSearch.ts";\nimport useCommonlyUsedFunctions from "../../composables/CommonlyUsedFunctions.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const { mats, getMats } = useDiffSearch(); // axios get the mats data\n        const { Currency, getCurrency } = useMonthlyPRSearch(); // axios get the currency\n\n\n        onBeforeMount(async () => {\n            await getCurrency();\n            await getMats();\n        });\n\n        const monthList = ref(app.appContext.config.globalProperties.$t("monthlyPRpageLang.months").split(\'_\'));\n        const monthStr = ref(monthList.value[monthTag.value]);\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const OutputExcelClick = async () => {\n            await triggerModal();\n\n            // get today\'s date for filename\n            let today = new Date();\n            let dd = String(today.getDate()).padStart(2, \'0\');\n            let mm = String(today.getMonth() + 1).padStart(2, \'0\'); //January is 0\n            let yyyy = today.getFullYear();\n            today = yyyy + "_" + mm + \'_\' + dd;\n\n            let rows = Array();\n            for (let i = 0; i < data.length; i++) {\n                let tempObj = new Object;\n                tempObj.料號 = data[i].料號;\n                tempObj.品名 = data[i].品名;\n                tempObj.請購數量 = data[i].請購數量;\n                tempObj.實際領用數量 = data[i].實際領用數量;\n                tempObj.單位 = data[i].單位;\n                tempObj.需求與領用差異量 = data[i].需求與領用差異量;\n                tempObj.需求與領用差異 = data[i].需求與領用差異 + "%";\n\n                rows.push(tempObj);\n            } // for\n\n            const worksheet = XLSX.utils.json_to_sheet(rows);\n            const workbook = XLSX.utils.book_new();\n            XLSX.utils.book_append_sheet(workbook, worksheet, "PR vs Acq " + yearTag.value + "_" + (monthTag.value + 1));\n            XLSX.writeFile(workbook,\n                app.appContext.config.globalProperties.$t(\n                    "callpageLang.req_vs_real_percent"\n                ) + ".xlsx", { compression: true });\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // OutputExcelClick\n\n        const SortCurrentMonthTable = async (inputMonth, resultArray) => {\n            // 無法確定此廠這個月的入庫是來自固定前一個月的請購or固定提前(早兩個月)的請購\n            // 回頭一個月一個月找時 若有料號match 表示整批的請購月份也是現在的月份\n            // 將找到matching請購月份紀錄下來 loop完inbound list後\n            // 會在loop buylist時只取用此請購月份的資料 (作為有請購但沒有(尚未?)入庫的料)\n            let matchingBuylistMonth = -99;\n            // console.log(all_data_sorted); // test\n            // find the matching buylist month\n            for (let i = 0; i < all_data_sorted.inbound[inputMonth].length; i++) {\n                let tempArry = all_data_sorted.inbound[inputMonth];\n                for (let j = 1; j < 3; j++) {\n                    let prevBuylistMonth = inputMonth - j;\n                    if (prevBuylistMonth == -1) { // 去年12月請購\n                        let obj = all_data_sorted.buylist_lastyear[11].find(o => o.料號 === tempArry[i].料號);\n                        // console.log(obj); // test\n                        if (obj) {\n                            if (prevBuylistMonth > matchingBuylistMonth) {\n                                matchingBuylistMonth = prevBuylistMonth;\n                            } // if\n                            break;\n                        } // if\n                    } else if (prevBuylistMonth == -2) { // 去年11月請購\n                        let obj = all_data_sorted.buylist_lastyear[10].find(o => o.料號 === tempArry[i].料號);\n                        // console.log(obj); // test\n                        if (obj) {\n                            if (prevBuylistMonth > matchingBuylistMonth) {\n                                matchingBuylistMonth = prevBuylistMonth;\n                            } // if\n                            break;\n                        } // if\n                    } else { // 今年內請購\n                        let obj = all_data_sorted.buylist[prevBuylistMonth].find(o => o.料號 === tempArry[i].料號);\n                        if (obj) {\n                            if (prevBuylistMonth > matchingBuylistMonth) {\n                                matchingBuylistMonth = prevBuylistMonth;\n                            } // if\n                            break;\n                        } // if\n                    } // if else\n                } // for\n            } // for\n\n            // loop thru inbound list and push to table\n            for (let i = 0; i < all_data_sorted.inbound[inputMonth].length; i++) {\n                let singleEntry = {};\n                let tempArry = all_data_sorted.inbound[inputMonth];\n                singleEntry.料號 = tempArry[i].料號;\n                singleEntry.品名 = tempArry[i].品名;\n\n                if (matchingBuylistMonth == -99) { // if the whole batch is newly inbound without any buy records\n                    singleEntry.請購數量 = 0;\n                } else if (matchingBuylistMonth == -1) { // if the batch\'s buy record is from last year Dec\n                    let obj = all_data_sorted.buylist_lastyear[11].find(o => o.料號 === singleEntry.料號);\n                    // console.log(obj); // test\n                    if (obj) {\n                        singleEntry.請購數量 = parseFloat(obj.本次請購數量);\n                        if (Number.isNaN(parseFloat(obj.本次請購數量))) {\n                            singleEntry.請購數量 = 0;\n                        } // if\n                    } // if\n                    else { // 新入料\n                        singleEntry.請購數量 = 0;\n                    } // else\n                } else if (matchingBuylistMonth == -2) { // if the batch\'s buy record is from last year Nov\n                    let obj = all_data_sorted.buylist_lastyear[10].find(o => o.料號 === singleEntry.料號);\n                    if (obj) {\n                        singleEntry.請購數量 = parseFloat(obj.本次請購數量);\n                        if (Number.isNaN(parseFloat(obj.本次請購數量))) {\n                            singleEntry.請購數量 = 0;\n                        } // if\n                    } // if\n                    else { // 新入料\n                        singleEntry.請購數量 = 0;\n                    } // else\n                } else { // if the batch\'s buy record is within this year\n                    let obj = all_data_sorted.buylist[matchingBuylistMonth].find(o => o.料號 === singleEntry.料號);\n                    if (obj) {\n                        singleEntry.請購數量 = parseFloat(obj.本次請購數量);\n                        if (Number.isNaN(parseFloat(obj.本次請購數量))) {\n                            singleEntry.請購數量 = 0;\n                        } // if\n                    } // if\n                    else { // 新入料\n                        singleEntry.請購數量 = 0;\n                    } // else\n                } // if else\n\n                singleEntry.單位 = tempArry[i].單位;\n                singleEntry.實際領用數量 = parseInt(tempArry[i].入庫數量);\n                singleEntry.需求與領用差異量 = singleEntry.請購數量 - singleEntry.實際領用數量;\n                singleEntry.需求與領用差異 = 100 * (singleEntry.請購數量 - singleEntry.實際領用數量) / ((singleEntry.請購數量 + singleEntry.實際領用數量) / 2);\n                if (Number.isNaN(singleEntry.需求與領用差異)) {\n                    singleEntry.需求與領用差異 = 0;\n                } // if\n                singleEntry.單價 = parseFloat(tempArry[i].單價);\n                singleEntry.幣別 = tempArry[i].幣別;\n\n                resultArray.push(singleEntry);\n            } // for\n\n            // fish out entries that are within buylist but not within inbound\n            if (matchingBuylistMonth == -99) {\n                // if the whole batch are all newly inbound without any corresponding buy records \n                // OR if there\'s no inbound records\n                // 目前作法：直接抓上個月的請購資料\n                let prevBuylistMonth = inputMonth - 1;\n                if (prevBuylistMonth == -1) { // 去年12月請購\n                    for (let i = 0; i < all_data_sorted.buylist_lastyear[11].length; i++) {\n                        let tempMonthRecord = all_data_sorted.buylist_lastyear[11];\n                        let singleEntry = {};\n                        singleEntry.料號 = tempMonthRecord[i].料號;\n                        singleEntry.品名 = tempMonthRecord[i].品名;\n                        singleEntry.請購數量 = parseFloat(tempMonthRecord[i].本次請購數量);\n                        if (Number.isNaN(parseFloat(tempMonthRecord[i].本次請購數量))) {\n                            singleEntry.請購數量 = 0;\n                        } // if\n                        singleEntry.單位 = tempMonthRecord[i].單位;\n                        singleEntry.實際領用數量 = 0;\n                        singleEntry.需求與領用差異量 = singleEntry.請購數量 - singleEntry.實際領用數量;\n                        singleEntry.需求與領用差異 = 100 * (singleEntry.請購數量 - singleEntry.實際領用數量) / ((singleEntry.請購數量 + singleEntry.實際領用數量) / 2);\n                        if (Number.isNaN(singleEntry.需求與領用差異)) {\n                            singleEntry.需求與領用差異 = 0;\n                        } // if\n                        singleEntry.單價 = parseFloat(tempMonthRecord[i].單價);\n                        singleEntry.幣別 = tempMonthRecord[i].幣別;\n\n                        resultArray.push(singleEntry);\n                    } // for\n                } else if (prevBuylistMonth == -2) { // 去年11月請購\n                    for (let i = 0; i < all_data_sorted.buylist_lastyear[10].length; i++) {\n                        let tempMonthRecord = all_data_sorted.buylist_lastyear[10];\n                        let singleEntry = {};\n                        singleEntry.料號 = tempMonthRecord[i].料號;\n                        singleEntry.品名 = tempMonthRecord[i].品名;\n                        singleEntry.請購數量 = parseFloat(tempMonthRecord[i].本次請購數量);\n                        if (Number.isNaN(parseFloat(tempMonthRecord[i].本次請購數量))) {\n                            singleEntry.請購數量 = 0;\n                        } // if\n                        singleEntry.單位 = tempMonthRecord[i].單位;\n                        singleEntry.實際領用數量 = 0;\n                        singleEntry.需求與領用差異量 = singleEntry.請購數量 - singleEntry.實際領用數量;\n                        singleEntry.需求與領用差異 = 100 * (singleEntry.請購數量 - singleEntry.實際領用數量) / ((singleEntry.請購數量 + singleEntry.實際領用數量) / 2);\n                        if (Number.isNaN(singleEntry.需求與領用差異)) {\n                            singleEntry.需求與領用差異 = 0;\n                        } // if\n                        singleEntry.單價 = parseFloat(tempMonthRecord[i].單價);\n                        singleEntry.幣別 = tempMonthRecord[i].幣別;\n\n                        resultArray.push(singleEntry);\n                    } // for\n                } else { // 今年內請購\n                    for (let i = 0; i < all_data_sorted.buylist[prevBuylistMonth].length; i++) {\n                        let tempMonthRecord = all_data_sorted.buylist[prevBuylistMonth];\n                        let singleEntry = {};\n                        singleEntry.料號 = tempMonthRecord[i].料號;\n                        singleEntry.品名 = tempMonthRecord[i].品名;\n                        singleEntry.請購數量 = parseFloat(tempMonthRecord[i].本次請購數量);\n                        if (Number.isNaN(parseFloat(tempMonthRecord[i].本次請購數量))) {\n                            singleEntry.請購數量 = 0;\n                        } // if\n                        singleEntry.單位 = tempMonthRecord[i].單位;\n                        singleEntry.實際領用數量 = 0;\n                        singleEntry.需求與領用差異量 = singleEntry.請購數量 - singleEntry.實際領用數量;\n                        singleEntry.需求與領用差異 = 100 * (singleEntry.請購數量 - singleEntry.實際領用數量) / ((singleEntry.請購數量 + singleEntry.實際領用數量) / 2);\n                        if (Number.isNaN(singleEntry.需求與領用差異)) {\n                            singleEntry.需求與領用差異 = 0;\n                        } // if\n                        singleEntry.單價 = parseFloat(tempMonthRecord[i].單價);\n                        singleEntry.幣別 = tempMonthRecord[i].幣別;\n\n                        resultArray.push(singleEntry);\n                    } // for\n                } // if else\n            } else if (matchingBuylistMonth == -1) { // if the batch\'s buy record is from last year Dec\n                for (let i = 0; i < all_data_sorted.buylist_lastyear[11].length; i++) {\n                    let tempMonthRecord = all_data_sorted.buylist_lastyear[11];\n                    let obj = resultArray.find(o => o.料號 === tempMonthRecord[i].料號);\n                    if (obj === undefined) {\n                        let singleEntry = {};\n                        singleEntry.料號 = tempMonthRecord[i].料號;\n                        singleEntry.品名 = tempMonthRecord[i].品名;\n                        singleEntry.請購數量 = parseFloat(tempMonthRecord[i].本次請購數量);\n                        if (Number.isNaN(parseFloat(tempMonthRecord[i].本次請購數量))) {\n                            singleEntry.請購數量 = 0;\n                        } // if\n                        singleEntry.單位 = tempMonthRecord[i].單位;\n                        singleEntry.實際領用數量 = 0;\n                        singleEntry.需求與領用差異量 = singleEntry.請購數量 - singleEntry.實際領用數量;\n                        singleEntry.需求與領用差異 = 100 * (singleEntry.請購數量 - singleEntry.實際領用數量) / ((singleEntry.請購數量 + singleEntry.實際領用數量) / 2);\n                        if (Number.isNaN(singleEntry.需求與領用差異)) {\n                            singleEntry.需求與領用差異 = 0;\n                        } // if\n                        singleEntry.單價 = parseFloat(tempMonthRecord[i].單價);\n                        singleEntry.幣別 = tempMonthRecord[i].幣別;\n\n                        resultArray.push(singleEntry);\n                    } // if\n                } // for\n            } else if (matchingBuylistMonth == -2) { // if the batch\'s buy record is from last year Nov\n                for (let i = 0; i < all_data_sorted.buylist_lastyear[10].length; i++) {\n                    let tempMonthRecord = all_data_sorted.buylist_lastyear[10];\n                    let obj = resultArray.find(o => o.料號 === tempMonthRecord[i].料號);\n                    if (obj === undefined) {\n                        let singleEntry = {};\n                        singleEntry.料號 = tempMonthRecord[i].料號;\n                        singleEntry.品名 = tempMonthRecord[i].品名;\n                        singleEntry.請購數量 = parseFloat(tempMonthRecord[i].本次請購數量);\n                        if (Number.isNaN(parseFloat(tempMonthRecord[i].本次請購數量))) {\n                            singleEntry.請購數量 = 0;\n                        } // if\n                        singleEntry.單位 = tempMonthRecord[i].單位;\n                        singleEntry.實際領用數量 = 0;\n                        singleEntry.需求與領用差異量 = singleEntry.請購數量 - singleEntry.實際領用數量;\n                        singleEntry.需求與領用差異 = 100 * (singleEntry.請購數量 - singleEntry.實際領用數量) / ((singleEntry.請購數量 + singleEntry.實際領用數量) / 2);\n                        if (Number.isNaN(singleEntry.需求與領用差異)) {\n                            singleEntry.需求與領用差異 = 0;\n                        } // if\n                        singleEntry.單價 = parseFloat(tempMonthRecord[i].單價);\n                        singleEntry.幣別 = tempMonthRecord[i].幣別;\n\n                        resultArray.push(singleEntry);\n                    } // if\n                } // for\n            } else { // if the batch\'s buy record is within this year\n                for (let i = 0; i < all_data_sorted.buylist[matchingBuylistMonth].length; i++) {\n                    let tempMonthRecord = all_data_sorted.buylist[matchingBuylistMonth];\n                    let obj = resultArray.find(o => o.料號 === tempMonthRecord[i].料號);\n                    if (obj === undefined) {\n                        let singleEntry = {};\n                        singleEntry.料號 = tempMonthRecord[i].料號;\n                        singleEntry.品名 = tempMonthRecord[i].品名;\n                        singleEntry.請購數量 = parseFloat(tempMonthRecord[i].本次請購數量);\n                        if (Number.isNaN(parseFloat(tempMonthRecord[i].本次請購數量))) {\n                            singleEntry.請購數量 = 0;\n                        } // if\n                        singleEntry.單位 = tempMonthRecord[i].單位;\n                        singleEntry.實際領用數量 = 0;\n                        singleEntry.需求與領用差異量 = singleEntry.請購數量 - singleEntry.實際領用數量;\n                        singleEntry.需求與領用差異 = 100 * (singleEntry.請購數量 - singleEntry.實際領用數量) / ((singleEntry.請購數量 + singleEntry.實際領用數量) / 2);\n                        if (Number.isNaN(singleEntry.需求與領用差異)) {\n                            singleEntry.需求與領用差異 = 0;\n                        } // if\n                        singleEntry.單價 = parseFloat(tempMonthRecord[i].單價);\n                        singleEntry.幣別 = tempMonthRecord[i].幣別;\n\n                        resultArray.push(singleEntry);\n                    } // if\n                } // for\n            } // if else\n        }; // SortCurrentMonthTable\n\n        const CalChartDatasets = async () => {\n            let tempBuyUSD = [];\n            let tempRealUSD = [];\n\n            let monthlyTemp = [];\n            let exchange_table = Currency.value.rates;\n            for (let i = 0; i < 12; i++) { // loop thru whole year\n                monthlyTemp.splice(0); // clean up old records\n                await SortCurrentMonthTable(i, monthlyTemp); // get the sorted data by month\n                let currentMonthBuyTotalPrice = 0;\n                let currentMonthRealTotalPrice = 0;\n                // console.log(monthlyTemp); // test\n                for (let j = 0; j < monthlyTemp.length; j++) {\n                    if (monthlyTemp[j].料號) { // for safety measure\n                        if (checkedRows.length > 0) {\n                            if (checkedRows.find(o => o.料號 == monthlyTemp[j].料號) != undefined) {\n                                if (monthlyTemp[j].幣別 == "RMB") {\n                                    if (!Number.isNaN(parseFloat((parseFloat(monthlyTemp[j].請購數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[\'CNY\'])).toFixed(5)))) {\n                                        currentMonthBuyTotalPrice += parseFloat((parseFloat(monthlyTemp[j].請購數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[\'CNY\'])).toFixed(5));\n                                    } // if\n\n                                    if (!Number.isNaN(parseFloat((parseFloat(monthlyTemp[j].實際領用數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[\'CNY\'])).toFixed(5)))) {\n                                        currentMonthRealTotalPrice += parseFloat((parseFloat(monthlyTemp[j].實際領用數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[\'CNY\'])).toFixed(5));\n                                    } // if\n                                } // if\n                                else {\n                                    if (!Number.isNaN(parseFloat((parseFloat(monthlyTemp[j].請購數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[monthlyTemp[j].幣別])).toFixed(5)))) {\n                                        currentMonthBuyTotalPrice += parseFloat((parseFloat(monthlyTemp[j].請購數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[monthlyTemp[j].幣別])).toFixed(5));\n                                    } // if\n                                    if (!Number.isNaN(parseFloat((parseFloat(monthlyTemp[j].實際領用數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[monthlyTemp[j].幣別])).toFixed(5)))) {\n                                        currentMonthRealTotalPrice += parseFloat((parseFloat(monthlyTemp[j].實際領用數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[monthlyTemp[j].幣別])).toFixed(5));\n                                    } // if\n                                } // else\n                            } // if\n                        } // if\n                        else {\n                            if (monthlyTemp[j].幣別 == "RMB") {\n                                if (!Number.isNaN(parseFloat((parseFloat(monthlyTemp[j].請購數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[\'CNY\'])).toFixed(5)))) {\n                                    currentMonthBuyTotalPrice += parseFloat((parseFloat(monthlyTemp[j].請購數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[\'CNY\'])).toFixed(5));\n                                } // if\n\n                                if (!Number.isNaN(parseFloat((parseFloat(monthlyTemp[j].實際領用數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[\'CNY\'])).toFixed(5)))) {\n                                    currentMonthRealTotalPrice += parseFloat((parseFloat(monthlyTemp[j].實際領用數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[\'CNY\'])).toFixed(5));\n                                } // if\n                            } // if\n                            else {\n                                if (!Number.isNaN(parseFloat((parseFloat(monthlyTemp[j].請購數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[monthlyTemp[j].幣別])).toFixed(5)))) {\n                                    currentMonthBuyTotalPrice += parseFloat((parseFloat(monthlyTemp[j].請購數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[monthlyTemp[j].幣別])).toFixed(5));\n                                } // if\n                                if (!Number.isNaN(parseFloat((parseFloat(monthlyTemp[j].實際領用數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[monthlyTemp[j].幣別])).toFixed(5)))) {\n                                    currentMonthRealTotalPrice += parseFloat((parseFloat(monthlyTemp[j].實際領用數量) * parseFloat(monthlyTemp[j].單價) * (exchange_table[\'USD\'] / exchange_table[monthlyTemp[j].幣別])).toFixed(5));\n                                } // if\n                            } // else\n                        } // else\n\n                    } // if\n                } // for\n\n                tempBuyUSD.push(currentMonthBuyTotalPrice);\n                tempRealUSD.push(currentMonthRealTotalPrice);\n            } // for\n\n            // console.log(tempRealUSD); // test\n            // console.log(tempBuyUSD); // test\n            datasetBuyUSD.value = tempBuyUSD;\n            datasetRealUSD.value = tempRealUSD;\n        }; // CalChartDatasets\n\n        watch(checkedRows, async () => {\n            await CalChartDatasets();\n        }); // watch checked rows\n\n        watch(yearTag, async () => {\n            if (yearTag.value.toString().length == 4 && parseInt(yearTag.value) >= 1996) {\n                await triggerModal();\n\n                data.splice(0); // clean up old records\n\n                await getMats(yearTag.value);\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n            } // if\n        }); // watch year change\n\n        watch(monthTag, async () => {\n            // Jan is 0 in monthTag\n            await triggerModal();\n\n            data.splice(0); // clean up possible old records\n\n            // uncheck all checkboxes\n            document.querySelectorAll(\'.vtl-tbody-checkbox\').forEach(el => el.checked = false);\n\n            if (document.querySelector(".vtl-thead-checkbox").checked) {\n                document.querySelector(".vtl-thead-checkbox").click();\n            } // if\n            checkedRows.splice(0);\n\n            monthStr.value = monthList.value[monthTag.value];\n            await SortCurrentMonthTable(monthTag.value, data);\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        }); // watch month change\n\n        var all_data_sorted = {\n            buylist_lastyear: [],\n            buylist: [],\n            inbound: []\n        };\n        watch(mats, async () => {\n            await triggerModal();\n            all_data_sorted = {\n                buylist_lastyear: [],\n                buylist: [],\n                inbound: []\n            }; // clean up possible old records\n            data.splice(0); // clean up possible old records\n            if (mats.value == "") {\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            let allRowsObj = JSON.parse(mats.value);\n\n            // sort the last year\'s last few months\' buylist\n            for (let i = 0; i < 12; i++) {\n                let newArray = allRowsObj.buylist_lastyear.filter(function (el) {\n                    let sql_Date_To_JS_Date = new Date(el.請購時間.replace(\' \', \'T\'))\n                    return sql_Date_To_JS_Date.getMonth() == i;\n                });\n\n                // sum the entries with the same 料號                \n                let sum_result = Object.values(newArray.reduce((acc, curr) => {\n                    let item = acc[curr.料號];\n                    if (item) { // 匯率 其實是美金金額 不是真的匯率\n                        item.本次請購數量 += parseFloat(curr.本次請購數量);\n                        item.匯率 += parseFloat(curr.匯率);\n                    } else {\n                        curr.匯率 = parseFloat(curr.匯率);\n                        curr.本次請購數量 = parseFloat(curr.本次請購數量);\n                        acc[curr.料號] = curr;\n                    } // if else\n\n                    return acc;\n                }, {}));\n\n                all_data_sorted.buylist_lastyear[i] = sum_result;\n            } // for\n\n            // sort the yearly buylist\n            for (let i = 0; i < 12; i++) {\n                let newArray = allRowsObj.buylist.filter(function (el) {\n                    let sql_Date_To_JS_Date = new Date(el.請購時間.replace(\' \', \'T\'))\n                    return sql_Date_To_JS_Date.getMonth() == i;\n                });\n\n                // sum the entries with the same 料號\n                let sum_result = Object.values(newArray.reduce((acc, curr) => {\n                    let item = acc[curr.料號];\n\n                    if (item) {\n                        item.匯率 = parseFloat(item.匯率) + parseFloat(curr.匯率);\n                        item.本次請購數量 = parseFloat(item.本次請購數量) + parseFloat(curr.本次請購數量);\n                    } else {\n                        curr.匯率 = parseFloat(curr.匯率);\n                        curr.本次請購數量 = parseFloat(curr.本次請購數量);\n                        acc[curr.料號] = curr;\n                    } // if else\n\n                    return acc;\n                }, {}));\n\n                all_data_sorted.buylist[i] = sum_result;\n            } // for\n\n            // sort the yearly inbound\n            for (let i = 0; i < 12; i++) {\n                let newArray = allRowsObj.inbound.filter(function (el) {\n                    let sql_Date_To_JS_Date = new Date(el.入庫時間.replace(\' \', \'T\'))\n                    return sql_Date_To_JS_Date.getMonth() == i;\n                });\n\n                // sum the entries with the same 料號\n                let sum_result = Object.values(newArray.reduce((acc, curr) => {\n                    let item = acc[curr.料號];\n\n                    if (item) {\n                        item.入庫數量 = parseInt(item.入庫數量) + parseInt(curr.入庫數量);\n                    } else {\n                        curr.入庫數量 = parseInt(curr.入庫數量);\n                        acc[curr.料號] = curr;\n                    } // if else\n\n                    return acc;\n                }, {}));\n\n                all_data_sorted.inbound[i] = sum_result;\n            } // for\n\n            console.log(all_data_sorted); // test\n            await SortCurrentMonthTable(monthTag.value, data);\n            await CalChartDatasets();\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        const updateCheckedRows = (rowsKey) => {\n            checkedRows.length = 0;\n            checkedRows.push(...rowsKey);\n            // console.log(checkedRows); // test\n        };\n\n        return {\n            table,\n            searchTerm,\n            updateCheckedRows,\n            OutputExcelClick,\n            yearTag,\n            monthStr\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},4823:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-79e2d760] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/InboundMonthTable.vue"],names:[],mappings:"AA6YA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="row justify-content-between">\n        <div class="row col col-auto">\n            <div class="col col-auto">\n                <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n            </div>\n            <div class="col col-6 p-0 m-0">\n                <input id="pnInput" class="text-center form-control form-control-lg"\n                    v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n            </div>\n        </div>\n        <div class="col col-auto">\n            <button id="download" name="download" class="col col-auto btn btn-lg btn-success"\n                :value="$t(\'inboundpageLang.download\')" @click="OutputExcelClick">\n                <i class="bi bi-file-earmark-arrow-down-fill"></i>\n            </button>\n        </div>\n    </div>\n    <div class="w-100" style="height: 1ch"></div>\n    \x3c!-- </div>breaks cols to a new line--\x3e\n    <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="false" :isLoading="table.isLoading"\n        :messages="table.messages" :columns="table.columns" :rows="table.rows" :total="table.totalRecordCount"\n        :page-options="table.pageOptions" :sortable="table.sortable" @is-finished="table.isLoading = false"\n        @return-checked-rows="updateCheckedRows"></table-lite>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport TableLite from "./TableLite.vue";\nimport * as XLSX from \'xlsx\';\nimport useInboundStockSearch from "../../composables/InboundStockSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n\n    setup() {\n        const { mats, getMats } = useInboundStockSearch(); // axios get the mats data\n        onBeforeMount(getMats);\n\n        const searchTerm = ref(""); // Search text\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const OutputExcelClick = () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            // get today\'s date for filename\n            let today = new Date();\n            let dd = String(today.getDate()).padStart(2, \'0\');\n            let mm = String(today.getMonth() + 1).padStart(2, \'0\'); //January is 0!\n            let yyyy = today.getFullYear();\n            today = yyyy + "_" + mm + \'_\' + dd;\n\n            let rows = Array();\n            for (let i = 0; i < data.length; i++) {\n                let tempObj = new Object;\n                tempObj.料號 = data[i].料號;\n                tempObj.品名 = data[i].品名;\n                tempObj.規格 = data[i].規格;\n                tempObj.現有庫存 = data[i].現有庫存;\n                tempObj.單位 = data[i].單位;\n                tempObj.月使用量 = data[i].月使用量;\n                tempObj.庫存使用月數 = data[i].庫存使用月數;\n                tempObj.單價 = data[i].單價;\n                tempObj.幣別 = data[i].幣別;\n                tempObj.月請購 = data[i].月請購;\n                rows.push(tempObj);\n            } // for\n\n            const worksheet = XLSX.utils.json_to_sheet(rows);\n            const workbook = XLSX.utils.book_new();\n            XLSX.utils.book_append_sheet(workbook, worksheet, app.appContext.config.globalProperties.$t("inboundpageLang.stockmonth"));\n            XLSX.writeFile(workbook,\n                app.appContext.config.globalProperties.$t(\n                    "inboundpageLang.stockmonth"\n                ) + "_" + today + ".xlsx", { compression: true });\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // OutputExcelClick\n\n        // pour the data in\n        const data = reactive([]);\n        // const senders = reactive([]); // access the value by senders[0], senders[1] ...\n        watch(mats, () => {\n            console.log(JSON.parse(mats.value)); // test\n            let allRowsObj = JSON.parse(mats.value);\n            //console.log(allRowsObj.datas.length);\n            for (let i = 0; i < allRowsObj.datas.length; i++) {\n                data.push(allRowsObj.datas[i]);\n            } // for\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="isn\' +\n                            i +\n                            \'" name="isn\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.format"\n                    ),\n                    field: "規格",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="format\' +\n                            i +\n                            \'" name="format\' +\n                            i +\n                            \'" value="\' +\n                            row.規格 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.規格 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.nowstock"\n                    ),\n                    field: "現有庫存",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="stock\' +\n                            i +\n                            \'" name="stock\' +\n                            i +\n                            \'" value="\' +\n                            row.現有庫存 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.現有庫存 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.monthuse"\n                    ),\n                    field: "月使用量",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="monthuse\' +\n                            i +\n                            \'" name="monthuse\' +\n                            i +\n                            \'" value="\' +\n                            row.月使用量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.月使用量 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.stockmonth"\n                    ),\n                    field: "庫存使用月數",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="monthstock\' +\n                            i +\n                            \'" name="monthstock\' +\n                            i +\n                            \'" value="\' +\n                            row.庫存使用月數 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.庫存使用月數 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.price"\n                    ),\n                    field: "單價",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="price\' +\n                            i +\n                            \'" name="price\' +\n                            i +\n                            \'" value="\' +\n                            row.單價 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.單價 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.money"\n                    ),\n                    field: "幣別",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="money\' +\n                            i +\n                            \'" name="money\' +\n                            i +\n                            \'" value="\' +\n                            row.幣別 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.幣別 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.month"\n                    ),\n                    field: "月請購",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="month\' +\n                            i +\n                            \'" name="month\' +\n                            i +\n                            \'" value="\' +\n                            row.月請購 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.月請購 +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            console.log(rowsKey);\n        };\n\n        return {\n            searchTerm,\n            table,\n            updateCheckedRows,\n            OutputExcelClick,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>\n'],sourceRoot:""}]);const l=i},4896:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-9c9c5594] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/InboundSearchTable.vue"],names:[],mappings:"AAqgBA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="row justify-content-between">\n        <div class="row col col-auto">\n            <div class="col col-auto">\n                <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n            </div>\n            <div class="col col-6 p-0 m-0">\n                <input id="pnInput" class="text-center form-control form-control-lg"\n                    v-bind:placeholder="$t(\'basicInfoLang.enterisn\')" v-model="searchTerm" />\n            </div>\n        </div>\n        <div class="col col-auto">\n            <button type="submit" id="delete" name="delete" class="col col-auto btn btn-lg btn-danger"\n                @click="DeleteRowsClick">\n                <i class="bi bi-trash3-fill fs-4"></i>\n            </button>\n            &nbsp;\n            <button id="download" name="download" class="col col-auto btn btn-lg btn-success"\n                :value="$t(\'inboundpageLang.download\')" @click="OutputExcelClick">\n                <i class="bi bi-file-earmark-arrow-down-fill fs-4"></i>\n            </button>\n        </div>\n    </div>\n    <div class="w-100" style="height: 1ch"></div> \x3c!-- </div>breaks cols to a new line--\x3e\n    <span class="invalid-feedback d-block" role="alert">\n        <strong>{{ $t("inboundpageLang.no_basic_are_highlighted") }}</strong>\n    </span>\n    <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="true" :isLoading="table.isLoading"\n        :messages="table.messages" :columns="table.columns" :rows="table.rows" :total="table.totalRecordCount"\n        :page-options="table.pageOptions" :sortable="table.sortable" @is-finished="table.isLoading = false"\n        @return-checked-rows="updateCheckedRows"></table-lite>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport TableLite from "./TableLite.vue";\nimport * as XLSX from \'xlsx\';\nimport useInboundListSearch from "../../composables/InboundListSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        const { mats, getMats, deleteRows } = useInboundListSearch(); // axios get the mats data\n\n        onBeforeMount(getMats);\n\n        const searchTerm = ref(""); // Search text\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        let checkedRows = [];\n        const DeleteRowsClick = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            let rows_to_be_deleted = {\n                list: [],\n                isn: [],\n                amount: [],\n                position: [],\n                inpeople: [],\n                inreason: [],\n                intime: []\n            };\n\n            if (checkedRows !== undefined && checkedRows.length > 0) {\n                // console.log(checkedRows[0]); // test\n                checkedRows.forEach(row => {\n                    rows_to_be_deleted.list.push(row.入庫單號);\n                    rows_to_be_deleted.isn.push(row.料號);\n                    rows_to_be_deleted.amount.push(row.入庫數量);\n                    rows_to_be_deleted.position.push(row.儲位);\n                    rows_to_be_deleted.inpeople.push(row.入庫人員);\n                    rows_to_be_deleted.inreason.push(row.入庫原因);\n                    rows_to_be_deleted.intime.push(row.入庫時間);\n                });\n\n                let result = await deleteRows(rows_to_be_deleted);\n                if (result === "success") {\n                    notyf.open({\n                        type: "success",\n                        message: app.appContext.config.globalProperties.$t("inboundpageLang.change") + " " + app.appContext.config.globalProperties.$t("inboundpageLang.success"),\n                        duration: 3000, //miliseconds, use 0 for infinite duration\n                        ripple: true,\n                        dismissible: true,\n                        position: {\n                            x: "right",\n                            y: "bottom",\n                        },\n                    });\n\n                    rows_to_be_deleted.intime.forEach(element => {\n\n                        let indexOfObject = checkedRows.findIndex(object => {\n                            return object.入庫時間 === element.replace(\'inboundtime\', \'\');\n                        });\n                        if (indexOfObject != -1) {\n                            data.splice(indexOfObject, 1);\n                        } // if\n                    });\n\n                    document.getElementsByClassName("vtl-tbody-checkbox").forEach(element => {\n                        if (element.checked) {\n                            element.click();\n                        } // if\n                    });\n\n                    checkedRows = [];\n                } // if\n                else {\n                    //庫存小於入庫數量\n                    console.log(result.response.data); // test\n                    if (result.response.status === 420) {\n                        let mess =\n                            app.appContext.config.globalProperties.$t("inboundpageLang.lessstock");\n\n                        notyf.open({\n                            type: "warning",\n                            message: mess,\n                            duration: 3000, //miliseconds, use 0 for infinite duration\n                            ripple: true,\n                            dismissible: true,\n                            position: {\n                                x: "right",\n                                y: "bottom",\n                            },\n                        });\n\n                        // console.log(result.response.data.success_list); // test\n                        result.response.data.success_list.forEach(element => {\n                            let indexOfObject = data.findIndex(object => {\n                                return parseInt(object.id) === parseInt(element[3].replace(\'inboundtime\', \'\'));\n                            });\n\n                            if (indexOfObject != -1) {\n                                data.splice(indexOfObject, 1);\n                            } // if\n                        });\n                    } // if \n                    else if (result.response.status === 421) {\n                        var mess = result.response.data.message;\n                        alert(mess);\n                    } // else if\n                } // else\n            } // if\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // DeleteRowsClick\n\n        const OutputExcelClick = () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            // get today\'s date for filename\n            let today = new Date();\n            let dd = String(today.getDate()).padStart(2, \'0\');\n            let mm = String(today.getMonth() + 1).padStart(2, \'0\'); //January is 0!\n            let yyyy = today.getFullYear();\n            today = yyyy + "_" + mm + \'_\' + dd;\n\n            let rows = Array();\n            for (let i = 0; i < data.length; i++) {\n                let tempObj = new Object;\n                tempObj.入庫單號 = data[i].入庫單號;\n                tempObj.料號 = data[i].料號;\n                tempObj.入庫數量 = data[i].入庫數量;\n                tempObj.儲位 = data[i].儲位;\n                tempObj.入庫人員 = data[i].入庫人員;\n                tempObj.入庫原因 = data[i].入庫原因;\n                tempObj.入庫時間 = data[i].入庫時間;\n                tempObj.備註 = data[i].備註;\n                rows.push(tempObj);\n            } // for\n\n            const worksheet = XLSX.utils.json_to_sheet(rows);\n            const workbook = XLSX.utils.book_new();\n            XLSX.utils.book_append_sheet(workbook, worksheet, app.appContext.config.globalProperties.$t("inboundpageLang.inlist"));\n            XLSX.writeFile(workbook,\n                app.appContext.config.globalProperties.$t(\n                    "inboundpageLang.inlist"\n                ) + "_" + today + ".xlsx", { compression: true });\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // OutputExcelClick\n\n        // pour the data in\n        const data = reactive([]);\n\n        watch(mats, () => {\n            let allRowsObj = JSON.parse(mats.value);\n            // console.log(allRowsObj.datas); // test\n            for (let i = 0; i < allRowsObj.datas.length; i++) {\n                allRowsObj.datas[i].id = i;\n                data.push(allRowsObj.datas[i]);\n            } // for\n\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.inlist"\n                    ),\n                    field: "入庫單號",\n                    width: "14ch",\n                    sortable: true,\n                    iskey: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="inboundlist\' +\n                            i +\n                            \'" name="inboundlist\' +\n                            i +\n                            \'" value="\' +\n                            row.入庫單號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.入庫單號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.單位 === null) {\n                            return (\n                                \'<input type="hidden" id="number\' +\n                                i +\n                                \'" name="number\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="text-danger text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } else {\n                            return (\n                                \'<input type="hidden" id="number\' +\n                                i +\n                                \'" name="number\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.inboundnum"\n                    ),\n                    field: "入庫數量",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.單位 === null) {\n                            return (\n                                \'<input type="hidden" id="inboundnum\' +\n                                i +\n                                \'" name="inboundnum\' +\n                                i +\n                                \'" value="\' +\n                                row.入庫數量 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.入庫數量 + \' <small class="text-danger">\' +\n                                app.appContext.config.globalProperties.$t("inboundpageLang.no_basic") + "</small>" +\n                                "</div>"\n                            );\n                        } else {\n                            return (\n                                \'<input type="hidden" id="inboundnum\' +\n                                i +\n                                \'" name="inboundnum\' +\n                                i +\n                                \'" value="\' +\n                                row.入庫數量 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.入庫數量 + " <small>" + row.單位 + "</small>" +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.loc"\n                    ),\n                    field: "儲位",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="position\' +\n                            i +\n                            \'" name="position\' +\n                            i +\n                            \'" value="\' +\n                            row.儲位 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.儲位 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.inpeople"\n                    ),\n                    field: "入庫人員",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="inboundpeople\' +\n                            i +\n                            \'" name="inboundpeople\' +\n                            i +\n                            \'" value="\' +\n                            row.入庫人員 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.入庫人員 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.inreason"\n                    ),\n                    field: "入庫原因",\n                    width: "15ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="inboundreason\' +\n                            i +\n                            \'" name="inboundreason\' +\n                            i +\n                            \'" value="\' +\n                            row.入庫原因 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.入庫原因 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.inboundtime"\n                    ),\n                    field: "入庫時間",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="inboundtime\' +\n                            row.id +\n                            \'" name="inboundtime\' +\n                            i +\n                            \'" value="\' +\n                            row.入庫時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.入庫時間 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.mark"\n                    ),\n                    field: "備註",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.備註 === null) row.備註 = "";\n                        return (\n                            \'<input type="hidden" id="remark\' +\n                            i +\n                            \'" name="remark\' +\n                            i +\n                            \'" value="\' +\n                            row.備註 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.備註 +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase())\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            console.log(rowsKey); // test\n            checkedRows = rowsKey;\n        };\n\n        return {\n            searchTerm,\n            table,\n            updateCheckedRows,\n            DeleteRowsClick,\n            OutputExcelClick\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},3479:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-b0a09f1e] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/InboundStockTable.vue"],names:[],mappings:"AAsaA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="row justify-content-between">\n        <div class="row col col-auto">\n            <div class="col col-auto">\n                <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n            </div>\n            <div class="col col-6 p-0 m-0">\n                <input id="pnInput" class="text-center form-control form-control-lg"\n                    v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n            </div>\n        </div>\n        <div class="col col-auto">\n            <button id="download" name="download" class="col col-auto btn btn-lg btn-success"\n                :value="$t(\'inboundpageLang.download\')" @click="OutputExcelClick">\n                <i class="bi bi-file-earmark-arrow-down-fill"></i>\n            </button>\n        </div>\n    </div>\n    <div class="w-100" style="height: 1ch"></div>\n    \x3c!-- </div>breaks cols to a new line--\x3e\n    <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="false" :isLoading="table.isLoading"\n        :messages="table.messages" :columns="table.columns" :rows="table.rows" :total="table.totalRecordCount"\n        :page-options="table.pageOptions" :sortable="table.sortable" @is-finished="table.isLoading = false"\n        @return-checked-rows="updateCheckedRows"></table-lite>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport TableLite from "./TableLite.vue";\nimport * as XLSX from \'xlsx\';\nimport useInboundStockSearch from "../../composables/InboundStockSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n\n    setup() {\n        const { mats, getMats } = useInboundStockSearch(); // axios get the mats data\n        onBeforeMount(getMats);\n\n        const searchTerm = ref(""); // Search text\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const OutputExcelClick = () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            // get today\'s date for filename\n            let today = new Date();\n            let dd = String(today.getDate()).padStart(2, \'0\');\n            let mm = String(today.getMonth() + 1).padStart(2, \'0\'); //January is 0!\n            let yyyy = today.getFullYear();\n            today = yyyy + "_" + mm + \'_\' + dd;\n\n            let rows = Array();\n            for (let i = 0; i < data.length; i++) {\n                let tempObj = new Object;\n                tempObj.料號 = data[i].料號;\n                tempObj.品名 = data[i].品名;\n                tempObj.規格 = data[i].規格;\n                tempObj.現有庫存 = data[i].現有庫存;\n                tempObj.單位 = data[i].單位;\n                tempObj.儲位 = data[i].儲位;\n                tempObj.月請購 = data[i].月請購;\n                tempObj.安全庫存 = data[i].安全庫存;\n                tempObj.單價 = data[i].單價;\n                tempObj.幣別 = data[i].幣別;\n                tempObj.呆滯天數 = data[i].呆滯天數;\n                rows.push(tempObj);\n            } // for\n\n            const worksheet = XLSX.utils.json_to_sheet(rows);\n            const workbook = XLSX.utils.book_new();\n            XLSX.utils.book_append_sheet(workbook, worksheet, app.appContext.config.globalProperties.$t("inboundpageLang.stock"));\n            XLSX.writeFile(workbook,\n                app.appContext.config.globalProperties.$t(\n                    "inboundpageLang.stock"\n                ) + "_" + today + ".xlsx", { compression: true });\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // OutputExcelClick\n\n        // pour the data in\n        const data = reactive([]);\n        // const senders = reactive([]); // access the value by senders[0], senders[1] ...\n        watch(mats, () => {\n            // console.log(JSON.parse(mats.value)); // test\n            let allRowsObj = JSON.parse(mats.value);\n            //console.log(allRowsObj.datas.length);\n            for (let i = 0; i < allRowsObj.datas.length; i++) {\n                data.push(allRowsObj.datas[i]);\n            } // for\n            // console.log(data); // test\n\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="isn\' +\n                            i +\n                            \'" name="isn\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.format"\n                    ),\n                    field: "規格",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="format\' +\n                            i +\n                            \'" name="format\' +\n                            i +\n                            \'" value="\' +\n                            row.規格 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.規格 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.stock"\n                    ),\n                    field: "庫存",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="stock\' +\n                            i +\n                            \'" name="stock\' +\n                            i +\n                            \'" value="\' +\n                            row.現有庫存 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.現有庫存 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.loc"\n                    ),\n                    field: "儲位",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="loc\' +\n                            i +\n                            \'" name="loc\' +\n                            i +\n                            \'" value="\' +\n                            row.儲位 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.儲位 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.month"\n                    ),\n                    field: "月請購",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="month\' +\n                            i +\n                            \'" name="month\' +\n                            i +\n                            \'" value="\' +\n                            row.月請購 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.月請購 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.safe"\n                    ),\n                    field: "安全庫存",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="safe\' +\n                            i +\n                            \'" name="safe\' +\n                            i +\n                            \'" value="\' +\n                            row.安全庫存 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.安全庫存 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.price"\n                    ),\n                    field: "單價",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="price\' +\n                            i +\n                            \'" name="price\' +\n                            i +\n                            \'" value="\' +\n                            row.單價 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.單價 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.money"\n                    ),\n                    field: "幣別",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="money\' +\n                            i +\n                            \'" name="money\' +\n                            i +\n                            \'" value="\' +\n                            row.幣別 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.幣別 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.days"\n                    ),\n                    field: "呆滯天數",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="days\' +\n                            i +\n                            \'" name="days\' +\n                            i +\n                            \'" value="\' +\n                            row.呆滯天數 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.呆滯天數 +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            console.log(rowsKey);\n        };\n\n        return {\n            searchTerm,\n            table,\n            updateCheckedRows,\n            OutputExcelClick,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},1167:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-a28d14da] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/InboundStockUploadTable.vue"],names:[],mappings:"AAwzCA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="card">\n        <div class="card-header">\n            <h3>{{ $t("inboundpageLang.upload") }}</h3>\n        </div>\n        <div class="card-body">\n            <div class="row justify-content-center mb-3">\n                <div class="col col-auto">\n                    <a :href="exampleUrl" download>\n                        {{ $t(\'inboundpageLang.exampleExcel\') }}\n                    </a>\n                </div>\n\n                <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <label class="col col-auto form-label">{{ $t(\'inboundpageLang.plz_upload\') }}</label>\n                <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="col col-auto">\n                    <input class="form-control" :class="{ \'is-invalid\': isInvalid }" id="excel_input" type="file"\n                        name="select_file" @change="onInputChange" />\n                    <span v-if="isInvalid" class="invalid-feedback d-block" role="alert">\n                        <strong>{{ validation_err_msg }}</strong>\n                    </span>\n                </div>\n                <div class="w-100" style="height: 2ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="row justify-content-center">\n                    <button type="submit" name="upload" class="col col-auto btn btn-lg btn-primary"\n                        @click="onUploadClick">\n                        {{ $t(\'inboundpageLang.upload1\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <button id="togglebtn" class="btn btn-primary col col-auto" type="button" data-bs-toggle="collapse"\n        data-bs-target="#importedtable" aria-expanded="false" aria-controls="importedtable" style="display: none;">\n    </button>\n\n    <div class="card collapse" id="importedtable">\n        <div class="card-body">\n            <div class="row justify-content-between">\n                <div class="row col col-auto">\n                    <div class="col col-auto">\n                        <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n                    </div>\n                    <div class="col col-6 p-0 m-0">\n                        <input id="pnInput" class="text-center form-control form-control-lg"\n                            v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n                    </div>\n                </div>\n                <div class="col col-auto">\n                    <button id="delete" name="delete" class="col col-auto btn btn-lg btn-danger" @click="deleteRow">\n                        <i class="bi bi-trash3-fill fs-4"></i>\n                    </button>\n                </div>\n            </div>\n            <div class="w-100" style="height: 1ch"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n            <span v-if="isInvalid_DB" class="invalid-feedback d-block" role="alert">\n                <strong>{{ validation_err_msg }}</strong>\n            </span>\n            <table-lite :is-fixed-first-column="true" :is-static-mode="true" :isSlotMode="true" :hasCheckbox="true"\n                :isLoading="table.isLoading" :messages="table.messages" :columns="table.columns" :rows="table.rows"\n                :total="table.totalRecordCount" :page-options="table.pageOptions" :sortable="table.sortable"\n                @is-finished="table.isLoading = false" @return-checked-rows="updateCheckedRows">\n                <template v-slot:原儲位="{ row, key }">\n                    <div class="col col-auto align-items-center m-0 p-0">\n                        <button @click="openLocDetails(row.料號)" type="button" data-bs-toggle="modal"\n                            data-bs-target="#detailTable" class="btn btn-outline-info my-0 px-1 py-0"\n                            style="border-radius: 20px;" :id="\'oldloc\' + row.id" :name="\'oldloc\' + key">Info</button>\n                    </div>\n                </template>\n            </table-lite>\n            <div class="w-100" style="height: 1ch;"></div> \x3c!-- breaks cols to a new line--\x3e\n            <div class="row justify-content-center">\n                <div class="col col-auto">\n                    <button v-if="uploadToDBReady" type="submit" name="upload"\n                        class="col col-auto fs-3 text-center btn btn-lg btn-info" @click="onSendToDBClick">\n                        <i class="bi bi-inboxes-fill"></i>\n                        {{ $t(\'templateWords.inbound\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="modal fade" id="detailTable" tabindex="-1" aria-labelledby="detailTable" aria-hidden="true">\n        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">\n            <div class="modal-content">\n                <div class="modal-header justify-content-center">\n                    <h1 class="col col-auto modal-title m-0 p-0 fs-4">\n                        {{ modalTitle }}\n                    </h1>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n                    <div class="row justify-content-between">\n                        <div class="row col col-auto">\n                            <div class="col col-auto">\n                                <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }}\n                                    :</label>\n                            </div>\n                            <div class="col col-auto p-0 m-0">\n                                <input id="pnInput" class="text-center form-control form-control-lg"\n                                    v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')"\n                                    v-model="searchTerm2" />\n                            </div>\n                        </div>\n                        <div class="col col-auto">\n                            <button id="download" name="download" class="col col-auto btn btn-lg btn-success"\n                                :value="$t(\'monthlyPRpageLang.download\')" @click="OutputExcelClick(modalTitle)">\n                                <i class="bi bi-file-earmark-arrow-down-fill fs-4"></i>\n                            </button>\n                        </div>\n                    </div>\n                    <div class="w-100" style="height: 1ch"></div>\n                    \x3c!-- </div>breaks cols to a new line--\x3e\n                    <table-lite :is-static-mode="true" :isSlotMode="true" :hasCheckbox="false"\n                        :messages="table2.messages" :columns="table2.columns" :rows="table2.rows"\n                        :total="table2.totalRecordCount" :page-options="table2.pageOptions" :sortable="table2.sortable"\n                        :is-fixed-first-column="false" @row-clicked="rowClicked">\n                    </table-lite>\n                </div>\n                <div v-if="showFooter" class="modal-footer justify-content-between">\n                    <button @click="sxb_reject" type="button" class="btn btn-lg btn-danger" style="border-radius: 5px;">\n                        {{ $t(\'monthlyPRpageLang.review_cancel\') }}\n                    </button>\n                    <button @click="sxb_approve" type="button" class="btn btn-lg btn-success"\n                        style="border-radius: 5px;">\n                        {{ $t(\'monthlyPRpageLang.review_complete\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useInboundStockSearch from "../../composables/InboundStockSearch.ts";\nimport useTransitSearch from "../../composables/TransitSearch.ts";\nimport useCommonlyUsedFunctions from "../../composables/CommonlyUsedFunctions.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        let exampleUrl = ref(window.location.origin + \'/download/StockExample.xlsx\');\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const { mats, uploadToDB, getExistingStock } = useInboundStockSearch();\n        const { mats_inTransit, getTransit } = useTransitSearch(); // axios get the mats data\n        const { queryResult, locations, validateISN, getLocs } = useCommonlyUsedFunctions();\n\n        onBeforeMount(async () => {\n            await getTransit();\n            await getLocs();\n        });\n\n        let isInvalid = ref(false); // validation\n        let isInvalid_DB = ref(false); // add to DB validation\n        let validation_err_msg = ref("");\n        let uploadToDBReady = ref(false); // validation\n        let checkedRows = [];\n        const file = ref();\n        let input_data;\n        let sumInboundQuantity = {};\n\n        const findDuplicates = (arr) => {\n            let sorted_arr = arr.slice().sort(); // You can define the comparing function here. \n            // JS by default uses a crappy string compare.\n            // (we use slice to clone the array so the original array won\'t be modified)\n            let results = [];\n            for (let i = 0; i < sorted_arr.length - 1; i++) {\n                if (sorted_arr[i + 1] == sorted_arr[i]) {\n                    results.push(sorted_arr[i]);\n                } // if\n            } // for\n            return results;\n        } // findDuplicates\n\n        // Helper function to deal with Objects\n        const deepCopyObject = (obj) => {\n            let tempObj = {};\n            for (let [key, value] of Object.entries(obj)) {\n                if (Array.isArray(value)) {\n                    tempObj[key] = deepCopy(value);\n                } // if\n                else {\n                    if (typeof value === \'object\') {\n                        tempObj[key] = deepCopyObject(value);\n                    } // if\n                    else {\n                        tempObj[key] = value\n                    } // else\n                } // else\n            } // for\n            return tempObj;\n        } // deepCopyObject\n\n        const deepCopy = (arr) => {\n            let copy = [];\n            arr.forEach(elem => {\n                if (Array.isArray(elem)) {\n                    copy.push(deepCopy(elem))\n                } else {\n                    if (typeof elem === \'object\') {\n                        copy.push(deepCopyObject(elem))\n                    } else {\n                        copy.push(elem)\n                    }\n                }\n            })\n            return copy;\n        } // deepCopy\n\n        const onUploadClick = async () => {\n            isInvalid_DB.value = false;\n            mats.value = "";\n            await triggerModal();\n            if (file.value) {\n                // console.log(file.value); // test\n                if (file.value.type == "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || file.value.type == "application/vnd.ms-excel" || file.value.type == "application/vnd.ms-excel" || file.value.type == ".csv") {\n                    const reader = new FileReader();\n                    reader.onload = async (e) => {\n                        /* Parse data */\n                        const bstr = e.target.result;\n                        const wb = XLSX.read(bstr, { type: \'binary\' });\n                        /* Get first worksheet */\n                        const wsname = wb.SheetNames[0];\n                        const ws = wb.Sheets[wsname];\n                        /* Convert array of arrays */\n                        input_data = XLSX.utils.sheet_to_json(ws, { header: 1 });\n                        // console.log(input_data); // data[row#][col#]  test\n                        if (input_data === undefined || input_data[0] === undefined || input_data[0][0] === undefined || input_data[0][1] === undefined || input_data[0][2] === undefined || input_data[0][3] === undefined) {\n                            isInvalid.value = true;\n                            validation_err_msg.value = app.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors");\n                        } // if\n                        else {\n                            let tempArr = Array();\n                            for (let i = 1; i < input_data.length; i++) {\n                                if (input_data[i][0] != undefined && input_data[i].length > 2 && input_data[i][0].toString().trim() != "" && input_data[i][0].toString().trim() != null) {\n                                    tempArr.push(input_data[i][0].toString().trim());\n                                } // if\n                                else {\n                                    input_data.splice(i, 1); // remove the empty row\n                                    i = i - 1;\n                                } // else\n                            } // for\n\n                            await triggerModal();\n                            await validateISN(tempArr);\n                        } // else\n                    };\n\n                    reader.readAsBinaryString(file.value);\n                } // if\n                else {\n                    isInvalid.value = true;\n                    validation_err_msg.value = app.appContext.config.globalProperties.$t("validation.mimetypes");\n                } // else\n            } // if\n            else {\n                isInvalid.value = true;\n                validation_err_msg.value = app.appContext.config.globalProperties.$t("validation.required");\n            } // else\n\n            file.value = null;\n            document.getElementById(\'excel_input\').value = "";\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // onUploadClick\n\n        const onInputChange = (event) => {\n            isInvalid.value = false;\n            data.splice(0); // cleanup data from previous upload\n            queryResult.value = "";\n            file.value = event.target.files ? event.target.files[0] : null;\n            if ($("#importedtable").hasClass("show")) {\n                $("#togglebtn").click();\n            } // if\n        } // onInputChange\n\n        const searchTerm = ref(""); // Search text\n        const searchTerm2 = ref(""); // Search text for modal table\n        const modalTitle = ref("");\n        let showFooter = ref(false);\n\n        // pour the data in\n        const data = reactive([]);\n        const data2 = reactive([]);\n        // const senders = reactive([]); // access the value by senders[0], senders[1] ...\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const openLocDetails = (SXB) => {\n            // console.log("clicked!"); // test\n            modalTitle.value = SXB;\n            data2.splice(0);\n            for (let i = 0; i < AllRecords.length; i++) {\n                if (AllRecords[i].SXB單號 === SXB) {\n                    data2.push(AllRecords[i]);\n                } // if\n            } // for\n\n            if (data2[0].狀態 === \'未簽核\') {\n                showFooter.value = true;\n            } // if\n            else {\n                showFooter.value = false;\n            } // else\n        } // openLocDetails\n\n        const deleteRow = () => {\n            if (checkedRows.length == 0) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                return;\n            } // if\n\n            for (let i = 0; i < checkedRows.length; i++) {\n                let indexOfObject = data.findIndex(object => {\n                    return parseInt(object.id) === parseInt(checkedRows[i].id);\n                });\n\n                if (indexOfObject != -1) {\n                    data.splice(indexOfObject, 1);\n                } // if\n            } // for\n\n            document.querySelectorAll(\'.vtl-tbody-checkbox\').forEach(el => el.checked = false);\n            if (document.querySelector(".vtl-thead-checkbox").checked) {\n                document.querySelector(".vtl-thead-checkbox").click();\n            } // if\n            checkedRows = [];\n\n        } // deleteRow\n\n        const onSendToDBClick = async () => {\n            await triggerModal();\n            isInvalid_DB.value = false;\n            let rowsCount = [];\n            let hasError = false;\n            // console.log(data.length); //test\n            if (data.length <= 0) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // validate if all the isn exist\n            for (let j = 0; j < data.length; j++) {\n                if (data[j].月請購 === "" || data[j].月請購 === null || data[j].月請購.toLowerCase() === "null") {\n                    hasError = true;\n                    rowsCount.push(j);\n                } // if\n            } // for\n\n            if (hasError) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    "Excel " +\n                    app.appContext.config.globalProperties.$t("inboundpageLang.row") +\n                    " " + rowsCount.map(row => row + 1).join(", ") + " " +\n                    "(" + rowsCount.map(row => data[row].料號).join(", ") + ") " +\n                    app.appContext.config.globalProperties.$t("inboundpageLang.noisn");\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // validate if all the loc exist\n            rowsCount = [];\n            for (let j = 0; j < data.length; j++) {\n                if (!locsArray.includes(data[j].新儲位)) {\n                    hasError = true;\n                    rowsCount.push(j);\n                } // if\n            } // for\n\n            if (hasError) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    "Excel " +\n                    app.appContext.config.globalProperties.$t("inboundpageLang.row") +\n                    " " + rowsCount.map(row => row + 1).join(", ") + " " +\n                    "(" + rowsCount.map(row => data[row].新儲位).join(", ") + ") " +\n                    app.appContext.config.globalProperties.$t("inboundpageLang.noloc");\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // validate if there\'s duplicate values in excel\n            let duplicatedArray = Array();\n            for (let i = 0; i < data.length; i++) {\n                if (data[i].料號 != null && data[i].料號.trim() != "") {\n                    duplicatedArray.push(data[i].料號.toString().trim() + "_" + data[i].新儲位.toString().trim());\n                } // if\n            } // for\n\n            let findDuplicatesResult = findDuplicates(duplicatedArray);\n            // console.log(findDuplicatesResult); // test\n            if (findDuplicatesResult.length > 0) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    app.appContext.config.globalProperties.$t("inboundpageLang.repeated_isn_loc_pair") +\n                    " : " + findDuplicatesResult.map(entry => entry.split("_")[0] +\n                        " (" + entry.split("_")[1] + ")").join(", ");\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n            // ----------------------------------------------\n            // check if inbound quantity greater than the intransit quantity\n            rowsCount = [];\n            for (let i = 0; i < data.length; i++) {\n                const 料號 = data[i].料號;\n                const 在途量 = parseInt(data[i].在途量);\n                if (sumInboundQuantity[料號] > 在途量) {\n                    hasError = true;\n                    rowsCount.push(i);\n                } // if\n            } // for\n\n            if (hasError) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    "Excel " +\n                    app.appContext.config.globalProperties.$t("inboundpageLang.row") +\n                    " " + rowsCount.map(row => row + 1).join(", ") + " " +\n                    "(" + rowsCount.map(row => data[row].料號).join(", ") + ") " +\n                    app.appContext.config.globalProperties.$t("inboundpageLang.inboundnum") + " > " + app.appContext.config.globalProperties.$t("inboundpageLang.transit");\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // get existing stock for sum up\n            let tempArr_isn = Array();\n            let tempArr_loc = Array();\n            for (let i = 1; i < input_data.length; i++) {\n                if (input_data[i][0].trim() != "" && input_data[i][0].trim() != null) {\n                    tempArr_isn.push(input_data[i][0].trim());\n                    tempArr_loc.push(input_data[i][2].trim());\n                } // if\n            } // for\n\n            let start = Date.now();\n            let newStock = deepCopy(input_data);\n            let newInTransit;\n            let result = await getExistingStock(tempArr_isn, tempArr_loc); // get the existing stock\n            if (result === "success") {\n                for (let i = 1; i < newStock.length; i++) {\n                    tempArr_isn.push();\n                    tempArr_loc.push(newStock[i][2].trim());\n                    let foundObj = JSON.parse(mats.value).data.find(\n                        (o) => {\n                            return (o.料號 === newStock[i][0].trim() && o.儲位 === input_data[i][2].trim());\n                        });\n\n                    if (foundObj !== undefined) {\n                        newStock[i][1] = parseInt(newStock[i][1]) + parseInt(foundObj.現有庫存);\n                    } // if\n                } // for\n\n                // convert InTransit to a two-dimensional array and deduct the sumInboundQuantity from it\n                newInTransit = JSON.parse(mats_inTransit.value).data.flatMap((obj) => {\n                    let value = parseInt(obj.請購數量) - sumInboundQuantity[obj.料號];\n                    value = value < 0 ? 0 : value;\n                    if (tempArr_isn.includes(obj.料號)) {\n                        return [[obj.料號, value]];\n                    } else {\n                        return [];\n                    } // if else\n                });\n            } // if\n            else {\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                console.log("Failed to get existing stock");\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                return;\n            } // else\n            let timeTaken = Date.now() - start;\n            console.log("Total time taken : " + timeTaken + " milliseconds");\n            // console.log(newStock); // test\n            // console.log(input_data); // test\n            // console.log(newInTransit); // test\n\n            // actually updating database now\n            start = Date.now();\n            result = await uploadToDB(newStock, input_data, newInTransit);\n            timeTaken = Date.now() - start;\n            console.log("Total time taken : " + timeTaken + " milliseconds");\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n\n            if (result === "success") {\n                uploadToDBReady.value = false;\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("inboundpageLang.change") + " " + app.appContext.config.globalProperties.$t("inboundpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                data.splice(0); // clean up the data\n                queryResult.value = "";\n                await getTransit();\n                await getLocs();\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n        } // onSendToDBClick\n\n        let locsArray = Array();\n        watch(queryResult, async () => {\n            await triggerModal();\n            if (queryResult.value == "") {\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            let allRowsObj = JSON.parse(queryResult.value);\n            // console.log(allRowsObj.data.length);\n            let allRowsObj2 = JSON.parse(mats_inTransit.value);\n            // console.log(allRowsObj2.data); // test\n            let sumOfExistingStock;\n            let singleEntry = {};\n\n            // get existing stock for sum up\n            let tempArr_isn = Array();\n            for (let i = 1; i < input_data.length; i++) {\n                if (input_data[i][0].trim() != "" && input_data[i][0].trim() != null) {\n                    tempArr_isn.push(input_data[i][0].trim());\n                } // if\n            } // for\n            let result = await getExistingStock(tempArr_isn, []); // get the existing stock\n            if (result === "success") {\n                let tempArr = JSON.parse(mats.value).data;\n                // sum the entries with the same 料號                \n                sumOfExistingStock = Object.values(tempArr.reduce((acc, curr) => {\n                    let item = acc[curr.料號];\n                    if (item) {\n                        item.現有庫存 += parseInt(curr.現有庫存);\n                    } else {\n                        curr.現有庫存 = parseInt(curr.現有庫存);\n                        acc[curr.料號] = curr;\n                    } // if else\n\n                    return acc;\n                }, {}));\n            } // if\n            else {\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                console.log("Failed to get existing stock");\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                return;\n            } // else\n\n            for (let i = 1; i < input_data.length; i++) {\n                singleEntry.料號 = input_data[i][0].toString().trim();\n                tempArr_isn.push(singleEntry.料號);\n                singleEntry.入庫量 = Math.abs(parseInt(\n                    input_data[i][1]\n                ));\n\n                // Check if singleEntry.料號 is found in mats_inTransit\n                let foundInAllRowsObj2 = allRowsObj2.data.find(obj => obj.料號 === singleEntry.料號);\n                if (foundInAllRowsObj2) {\n                    singleEntry.在途量 = parseFloat(foundInAllRowsObj2.請購數量);\n                } else {\n                    singleEntry.在途量 = 0;\n                } // if else\n\n                // Check existing stock\n                foundInAllRowsObj2 = sumOfExistingStock.find(obj => obj.料號 === singleEntry.料號);\n                if (foundInAllRowsObj2) {\n                    singleEntry.現有庫存 = parseFloat(foundInAllRowsObj2.現有庫存);\n                } else {\n                    singleEntry.原儲位 = "N/A";\n                    singleEntry.現有庫存 = 0;\n                } // if else\n\n                singleEntry.新儲位 = input_data[i][2].toString().trim();\n                singleEntry.入庫原因 = input_data[i][3].toString().trim();\n                singleEntry.excel_row_num = i + 1;\n\n                if (data.length == 0) {\n                    singleEntry.id = 0;\n                } else {\n                    singleEntry.id = parseInt(data[data.length - 1].id) + 1;\n                } // if else\n\n                let indexOfObject = allRowsObj.data.findIndex(object => {\n                    return (object.料號 === singleEntry.料號);\n                });\n\n                if (indexOfObject != -1) { // if an existing record is found\n                    singleEntry = Object.assign(singleEntry, allRowsObj.data[indexOfObject]);\n                } // if\n                else {\n                    singleEntry.月請購 = "";\n                } // else\n\n                data.push(singleEntry);\n                singleEntry = {};\n            } // for\n\n            sumInboundQuantity = {};\n            sumInboundQuantity = data.reduce((acc, item) => {\n                const 料號 = item.料號;\n                const 入庫量 = parseInt(item.入庫量);\n                if (acc[料號]) {\n                    acc[料號] += 入庫量;\n                } else {\n                    acc[料號] = 入庫量;\n                } // if else\n                return acc;\n            }, {});\n\n            JSON.parse(locations.value).data.forEach(element => {\n                locsArray.push(element.儲存位置);\n            });\n\n            if (!$("#importedtable").hasClass("show")) {\n                $("#togglebtn").click();\n            } // if\n\n            uploadToDBReady.value = true;\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        watch(data, () => {\n            document.getElementsByClassName("vtl-table")[0].scrollIntoView({ behavior: "smooth" });\n        });\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購 === "" || row.月請購 === null || row.月請購.toLowerCase() === "null") { // if isn not exist in consumptive_material table\n                            return (\n                                \'<input type="hidden" id="number\' +\n                                i +\n                                \'" name="number\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="text-nowrap text-danger CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } else { // isn exist in database\n                            return (\n                                \'<input type="hidden" id="number\' +\n                                i +\n                                \'" name="number\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購 === "" || row.月請購 === null || row.月請購.toLowerCase() === "null") { // if isn not exist in consumptive_material table\n                            return (\n                                \'<input type="hidden" id="name\' +\n                                i +\n                                \'" name="name\' +\n                                i +\n                                \'" value="\' +\n                                row.品名 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("inboundpageLang.noisn") +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<input type="hidden" id="name\' +\n                                i +\n                                \'" name="name\' +\n                                i +\n                                \'" value="\' +\n                                row.品名 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.品名 +\n                                "</div>"\n                            );\n                        } // else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.format"\n                    ),\n                    field: "規格",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購 === "" || row.月請購 === null || row.月請購.toLowerCase() === "null") { // if isn not exist in consumptive_material table\n                            return (\n                                \'<input type="hidden" id="format\' +\n                                i +\n                                \'" name="format\' +\n                                i +\n                                \'" value="\' +\n                                row.規格 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("inboundpageLang.noisn") +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<input type="hidden" id="format\' +\n                                i +\n                                \'" name="format\' +\n                                i +\n                                \'" value="\' +\n                                row.規格 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.規格 +\n                                "</div>"\n                            );\n                        } // else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.stock"\n                    ),\n                    field: "庫存",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="stock\' +\n                            i +\n                            \'" name="stock\' +\n                            i +\n                            \'" value="\' +\n                            row.現有庫存 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.現有庫存 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.transit"\n                    ),\n                    field: "在途量",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="intransit\' +\n                            i +\n                            \'" name="intransit\' +\n                            i +\n                            \'" value="\' +\n                            row.在途量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.在途量 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.inboundnum"\n                    ),\n                    field: "入庫量",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (sumInboundQuantity[row.料號] > row.在途量) {\n                            return (\n                                \'<input type="hidden" id="inbound\' +\n                                i +\n                                \'" name="inbound\' +\n                                i +\n                                \'" value="\' +\n                                row.入庫量 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.入庫量 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                                "</div>"\n                            );\n                        } else {\n                            return (\n                                \'<input type="hidden" id="inbound\' +\n                                i +\n                                \'" name="inbound\' +\n                                i +\n                                \'" value="\' +\n                                row.入庫量 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.入庫量 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.inreason"\n                    ),\n                    field: "入庫原因",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="oldloc\' +\n                            i +\n                            \'" name="oldloc\' +\n                            i +\n                            \'" value="\' +\n                            row.入庫原因 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.入庫原因 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.oldloc"\n                    ),\n                    field: "原儲位",\n                    width: "10ch",\n                    sortable: false,\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.newloc"\n                    ),\n                    field: "新儲位",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (locsArray.includes(row.新儲位)) {\n                            return (\n                                \'<input type="hidden" id="newloc\' +\n                                i +\n                                \'" name="newloc\' +\n                                i +\n                                \'" value="\' +\n                                row.新儲位 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.新儲位 +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<input type="hidden" id="newloc\' +\n                                i +\n                                \'" name="newloc\' +\n                                i +\n                                \'" value="\' +\n                                row.新儲位 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.新儲位 + " (" + app.appContext.config.globalProperties.$t("inboundpageLang.noloc") +\n                                ")</div>"\n                            );\n                        } // else\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const table2 = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    isKey: true,\n                    display: function (row, i) {\n                        // console.log(row);\n                        return (\n                            \'<input type="hidden" id="number\' +\n                            row.id +\n                            \'" name="number\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.pName"\n                    ),\n                    field: "品名",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.moq"\n                    ),\n                    field: "MOQ",\n                    width: "8ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="moq\' +\n                            row.id +\n                            \'" name="moq\' +\n                            i +\n                            \'" value="\' +\n                            row.MOQ +\n                            \'">\' +\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.MOQ + " <small>" + row.單位 + "</small>" +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buyamount"\n                    ),\n                    field: "本次請購數量",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="buyamount\' +\n                            row.id +\n                            \'" name="buyamount\' +\n                            i +\n                            \'" value="\' +\n                            row.本次請購數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseInt(row.本次請購數量).toLocaleString("en-US") +\n                            " <small>" + row.單位 + "</small>" + "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buyprice"\n                    ),\n                    field: "請購金額",\n                    width: "11ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="buyprice\' +\n                            row.id +\n                            \'" name="buyprice\' +\n                            i +\n                            \'" value="\' +\n                            row.請購金額 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.請購金額).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",") +\n                            " <small>" + row.幣別 + "</small>" +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data2.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm2.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm2.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table2.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            // console.log(rowsKey); // test\n            checkedRows = rowsKey;\n        };\n\n        return {\n            exampleUrl,\n            isInvalid,\n            isInvalid_DB,\n            validation_err_msg,\n            uploadToDBReady,\n            searchTerm,\n            searchTerm2,\n            table,\n            table2,\n            modalTitle,\n            openLocDetails,\n            showFooter,\n            updateCheckedRows,\n            onUploadClick,\n            onInputChange,\n            onSendToDBClick,\n            updateCheckedRows,\n            deleteRow,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},2399:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-79889ab7] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/MatsInfoTable.vue"],names:[],mappings:"AA2zBA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="row justify-content-between">\n        <div class="row col col-auto">\n            <div class="col col-auto">\n                <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n            </div>\n            <div class="col col-6 p-0 m-0">\n                <input id="pnInput" class="text-center form-control form-control-lg"\n                    v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n            </div>\n        </div>\n        <div class="col col-auto">\n            <button type="submit" id="delete" name="delete" class="col col-auto btn btn-lg btn-danger"\n                @click="deleteRow">\n                <i class="bi bi-trash3-fill fs-4"></i>\n            </button>\n            &nbsp;\n            <button id="download" name="download" class="col col-auto btn btn-lg btn-success" @click="OutputExcelClick">\n                <i class="bi bi-file-earmark-arrow-down-fill fs-4"></i>\n            </button>\n        </div>\n    </div>\n    <div class="w-100" style="height: 1ch"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n    <span v-if="isInvalid_DB" class="invalid-feedback d-block" role="alert">\n        <strong>{{ validation_err_msg }}</strong>\n    </span>\n    <table-lite id="searchTable" :is-fixed-first-column="true" :isStaticMode="true" :isSlotMode="true"\n        :hasCheckbox="true" :messages="table.messages" :columns="table.columns" :rows="table.rows"\n        :total="table.totalRecordCount" :page-options="table.pageOptions" :sortable="table.sortable"\n        @do-search="doSearch" @is-finished="table.isLoading = false" @return-checked-rows="updateCheckedRows"\n        @row-input="rowUserInput">\n        <template v-slot:月請購="{ row, key }">\n            <div v-if="row.月請購 === \'是\'">\n                <select @change="(event) => { (row.月請購 = event.target.value); rowUserInput(row, key); }"\n                    style="width: 7ch;" class="col col-auto form-select form-select-lg ps-2 p-0 m-0"\n                    :id="\'month\' + row.id" :name="\'month\' + key">\n                    <option value="是" selected>{{ $t("basicInfoLang.yes") }}</option>\n                    <option value="否">{{ $t("basicInfoLang.no") }}</option>\n                </select>\n            </div>\n            <div v-else>\n                <select @change="(event) => { (row.月請購 = event.target.value); rowUserInput(row, key); }"\n                    style="width: 7ch;" class="col col-auto form-select form-select-lg ps-2 p-0 m-0"\n                    :id="\'month\' + row.id" :name="\'month\' + key">\n                    <option value="是">{{ $t("basicInfoLang.yes") }}</option>\n                    <option value="否" selected>{{ $t("basicInfoLang.no") }}</option>\n                </select>\n            </div>\n        </template>\n\n        <template v-slot:安全庫存="{ row, key }">\n            <div v-if="row.月請購 === \'否\'">\n                <input @change="rowUserInput(row, key)" :class="{ \'is-invalid\': (row.安全庫存 === null) }"\n                    class="form-control text-center p-0 m-0" style="width: 8ch;" type="number" :id="\'safe\' + row.id"\n                    :name="\'safe\' + key" :value="row.安全庫存" />\n            </div>\n            <div v-else>{{ $t("basicInfoLang.differ_by_client") }}</div>\n        </template>\n    </table-lite>\n    <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n    <div class="row justify-content-center">\n        <div class="col col-auto">\n            <button type="submit" id="change" name="change" class="col col-auto fs-3 text-center btn btn-lg btn-info"\n                @click="onSendToDBClick">\n                <i class="bi bi-cloud-upload-fill"></i>\n                {{ $t(\'basicInfoLang.change\') }}\n            </button>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useConsumptiveMaterials from "../../composables/ConsumptiveMaterials.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        const { mats, queryResult, getMats, deletePN, uploadToDB } = useConsumptiveMaterials(); // axios get the mats data\n\n        let isInvalid_DB = ref(false); // add to DB validation\n        let validation_err_msg = ref("");\n\n        onBeforeMount(getMats);\n\n        const searchTerm = ref(""); // Search text\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        // pour the data in\n        const data = reactive([]);\n        const senders = reactive([]); // access the value by senders[0], senders[1] ...\n        let checkedRows = [];\n\n        const findDuplicates = (arr) => {\n            let sorted_arr = arr.slice().sort(); // You can define the comparing function here. \n            // JS by default uses a crappy string compare.\n            // (we use slice to clone the array so the original array won\'t be modified)\n            let results = [];\n            for (let i = 0; i < sorted_arr.length - 1; i++) {\n                if (sorted_arr[i + 1] == sorted_arr[i]) {\n                    results.push(sorted_arr[i]);\n                } // if\n            } // for\n            return results;\n        } // findDuplicates\n\n        const deleteRow = async () => {\n            let isn = [];\n\n            if (checkedRows.length == 0) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                return;\n            } // if\n\n            for (let i = 0; i < checkedRows.length; i++) {\n                isn.push(checkedRows[i].料號);\n            } // for\n\n            // console.log(isn); // test\n            await triggerModal();\n            let result = await deletePN(isn);\n            if (result === "success") {\n                for (let i = 0; i < checkedRows.length; i++) {\n                    let indexOfObject = data.findIndex(object => {\n                        return parseInt(object.id) === parseInt(checkedRows[i].id);\n                    });\n\n                    if (indexOfObject != -1) {\n                        data.splice(indexOfObject, 1);\n                    } // if\n                } // for\n\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                document.querySelectorAll(\'.vtl-tbody-checkbox\').forEach(el => el.checked = false);\n\n                if (document.querySelector(".vtl-thead-checkbox").checked) {\n                    document.querySelector(".vtl-thead-checkbox").click();\n                } // if\n                checkedRows = [];\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // deleteRow\n\n        const OutputExcelClick = async () => {\n            await triggerModal();\n\n            // get today\'s date for filename\n            let today = new Date();\n            let dd = String(today.getDate()).padStart(2, \'0\');\n            let mm = String(today.getMonth() + 1).padStart(2, \'0\'); //January is 0!\n            let yyyy = today.getFullYear();\n            today = yyyy + "_" + mm + \'_\' + dd;\n\n            let rows = Array();\n\n            for (let i = 0; i < data.length; i++) {\n                let tempObj = new Object;\n                tempObj.料號 = data[i].料號;\n                tempObj.品名 = data[i].品名;\n                tempObj.規格 = data[i].規格;\n                tempObj.單價 = parseFloat(data[i].單價.toString());\n                tempObj.幣別 = data[i].幣別;\n                tempObj.單位 = data[i].單位;\n                tempObj.MPQ = parseInt(data[i].MPQ.toString());\n                tempObj.MOQ = parseInt(data[i].MOQ.toString());\n                tempObj.LT = parseInt(data[i].LT.toString());\n                tempObj.月請購 = data[i].月請購;\n                tempObj.A級資材 = data[i].A級資材;\n                tempObj.發料部門 = data[i].發料部門;\n                tempObj.安全庫存 = data[i].安全庫存;\n                rows.push(tempObj);\n            } // for\n\n            const worksheet = XLSX.utils.json_to_sheet(rows);\n            const workbook = XLSX.utils.book_new();\n            XLSX.utils.book_append_sheet(workbook, worksheet, app.appContext.config.globalProperties.$t("basicInfoLang.matssearch"));\n            XLSX.writeFile(workbook,\n                app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.matssearch"\n                ) + "_" + today + ".xlsx", { compression: true });\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // OutputExcelClick\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const onSendToDBClick = async () => {\n            // console.log(selected_mail.value); // test\n            await triggerModal();\n            // console.log("The modal should be triggered by now."); // test\n            isInvalid_DB.value = false;\n            let rowsCount = 0;\n            let hasError = false;\n            // console.log(data.length); //test\n            if (data.length <= 0) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // trim the white spaces and validate safestock if non-monthly\n            for (let j = 0; j < data.length && hasError === false; j++) {\n                data[j].料號 = data[j].料號.toString().trim();\n                data[j].品名 = data[j].品名.toString().trim();\n                data[j].規格 = data[j].規格.toString().trim();\n                data[j].單價 = data[j].單價.toString().trim();\n                data[j].幣別 = data[j].幣別.toString().trim();\n                data[j].單位 = data[j].單位.toString().trim();\n                data[j].MPQ = data[j].MPQ.toString().trim();\n                data[j].MOQ = data[j].MOQ.toString().trim();\n                data[j].LT = data[j].LT.toString().trim();\n                data[j].A級資材 = data[j].A級資材.toString().trim();\n                data[j].月請購 = data[j].月請購.toString().trim();\n                data[j].發料部門 = data[j].發料部門.toString().trim();\n                if (data[j].月請購 === \'否\') {\n                    if (data[j].安全庫存 === null) {\n                        hasError = true;\n                        validation_err_msg.value =\n                            app.appContext.config.globalProperties.$t("basicInfoLang.entersafe") +\n                            " ( " + data[j].料號 + " ) ";\n                    } else {\n                        data[j].安全庫存 = data[j].安全庫存.toString().trim();\n                    } // if else\n                } else {\n                    data[j].安全庫存 = "null";\n                } // if else\n            } // for\n\n            if (hasError) {\n                isInvalid_DB.value = true;\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // prepare the data arrays to be sent\n            let pnArray = [];\n            let nameArray = [];\n            let specArray = [];\n            let priceArray = [];\n            let currencyArray = [];\n            let unitArray = [];\n            let mpqArray = [];\n            let moqArray = [];\n            let ltArray = [];\n            let gradeaArray = [];\n            let monthlyArray = [];\n            let dispatcherArray = [];\n            let safestockArray = [];\n            for (let j = 0; j < data.length; j++) {\n                pnArray.push(data[j].料號);\n                nameArray.push(data[j].品名);\n                specArray.push(data[j].規格);\n                priceArray.push(data[j].單價);\n                currencyArray.push(data[j].幣別);\n                unitArray.push(data[j].單位);\n                mpqArray.push(data[j].MPQ);\n                moqArray.push(data[j].MOQ);\n                ltArray.push(data[j].LT);\n                gradeaArray.push(data[j].A級資材);\n                monthlyArray.push(data[j].月請購);\n                dispatcherArray.push(data[j].發料部門);\n                safestockArray.push(data[j].安全庫存);\n            } // for\n\n            // console.log(pnArray, nameArray, specArray, priceArray, currencyArray, unitArray, mpqArray, moqArray, ltArray, gradeaArray, monthlyArray, dispatcherArray, safestockArray); // test\n\n            // actually updating database now\n            let start = Date.now();\n            let result = await uploadToDB(pnArray, nameArray, specArray, priceArray, unitArray, currencyArray, mpqArray, moqArray, ltArray, gradeaArray, monthlyArray, dispatcherArray, safestockArray);\n            let timeTaken = Date.now() - start;\n            console.log("Total time taken : " + timeTaken + " milliseconds");\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n\n            if (result === "success") {\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.total") + " " + JSON.parse(queryResult.value).record + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.record") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n        } // onSendToDBClick\n        \n        watch(mats, async () => {\n            await triggerModal();\n            // console.log(JSON.parse(mats.value)); // test\n            let allRowsObj = JSON.parse(mats.value);\n            // console.log(allRowsObj.datas.length);\n            for (let i = 0; i < allRowsObj.senders.length; i++) {\n                senders.push(allRowsObj.senders[i]);\n            } // for\n\n            for (let i = 0; i < allRowsObj.datas.length; i++) {\n                allRowsObj.datas[i].id = i;\n                data.push(allRowsObj.datas[i]);\n            } // for\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    isKey: true,\n                    display: function (row, i) {\n                        // console.log(row);\n                        return (\n                            \'<input type="hidden" id="number\' +\n                            row.id +\n                            \'" name="number\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.pName"\n                    ),\n                    field: "品名",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.format"\n                    ),\n                    field: "規格",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="format\' +\n                            i +\n                            \'" name="format\' +\n                            i +\n                            \'" value="\' +\n                            row.規格 +\n                            \'">\' +\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.規格 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t("basicInfoLang.price") +\n                        " & " + app.appContext.config.globalProperties.$t("basicInfoLang.money"),\n                    field: "單價_幣別",\n                    width: "19ch",\n                    sortable: false,\n                    hasInput: function (row, i) {\n                        let returnStr = "";\n                        let currencyDict = [\n                            "RMB",\n                            "USD",\n                            "JPY",\n                            "TWD",\n                            "VND",\n                            "IDR",\n                        ];\n\n                        returnStr +=\n                            \'<div class="row">\' +\n                            \'<input style="width: 7ch;" type="number" step="0.00001" id="price\' +\n                            row.id +\n                            \'"\' +\n                            \' class="col form-control text-center align-self-center p-0 m-0" name="price\' +\n                            i +\n                            \'"\' +\n                            \' value="\' +\n                            parseFloat(row.單價) +\n                            \'">\';\n\n                        returnStr +=\n                            \'<select style="width: 8ch;" class="col form-select form-select-lg ps-2 p-0 m-0" id="money\' +\n                            row.id +\n                            \'" name="money\' +\n                            i +\n                            \'">\';\n\n                        currencyDict.forEach((element) => {\n                            if (row.幣別 === element) {\n                                returnStr +=\n                                    \'<option \' + \'value="\' + element + \'" selected>\' + element + \'</option>\';\n                            } // if\n                            else {\n                                returnStr += \'<option \' + \'value="\' + element + \'">\' + element + "</option>";\n                            } // else\n                        }); // for each in sender array\n                        returnStr += "</select></div>";\n                        return returnStr;\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.unit"\n                    ),\n                    field: "單位",\n                    width: "8ch",\n                    sortable: true,\n                    hasInput: function (row, i) {\n                        return (\n                            \'<input style="width:5ch;" type="text" id="unit\' +\n                            row.id +\n                            \'"\' +\n                            \' name="unit\' +\n                            i +\n                            \'" value="\' +\n                            row.單位 +\n                            \'"\' +\n                            \' class="form-control text-center p-0 m-0">\'\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.mpq"\n                    ),\n                    field: "MPQ",\n                    width: "9ch",\n                    sortable: true,\n                    hasInput: function (row, i) {\n                        return (\n                            \'<div class="row">\' +\n                            \'<input style="width:5ch;" type="number" id="mpq\' +\n                            row.id +\n                            \'"\' +\n                            \' name="mpq\' +\n                            i +\n                            \'" value="\' +\n                            row.MPQ +\n                            \'"\' +\n                            \' class="form-control text-center col p-0 m-0" min="0">\' +\n                            \'<div class="col input-group-text overflow-scroll py-0 px-1 m-0" style="width: 4ch;">\' +\n                            "<small>" + row.單位 + "</small>" +\n                            \'</div></div>\'\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.moq"\n                    ),\n                    field: "MOQ",\n                    width: "9ch",\n                    sortable: true,\n                    hasInput: function (row, i) {\n                        return (\n                            \'<div class="row">\' +\n                            \'<input style="width:5ch;" type="number" id="moq\' +\n                            row.id +\n                            \'"\' +\n                            \' name="moq\' +\n                            i +\n                            \'" value="\' +\n                            row.MOQ +\n                            \'"\' +\n                            \' class="form-control text-center col p-0 m-0" min="0">\' +\n                            \'<div class="col input-group-text overflow-scroll py-0 px-1 m-0" style="width: 4ch;">\' +\n                            "<small>" + row.單位 + "</small>" +\n                            \'</div></div>\'\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.lt"\n                    ),\n                    field: "LT",\n                    width: "8ch",\n                    sortable: true,\n                    hasInput: function (row, i) {\n                        return (\n                            \'<input style="width:8ch;" type="number" id="lt\' +\n                            row.id +\n                            \'"\' +\n                            \' name="lt\' +\n                            i +\n                            \'" value="\' +\n                            Math.round(row.LT) +\n                            \'"\' +\n                            \' class="form-control text-center p-0 m-0" min="0">\'\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.month"\n                    ),\n                    field: "月請購",\n                    width: "12ch",\n                    sortable: true,\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.gradea"\n                    ),\n                    field: "A級資材",\n                    width: "9ch",\n                    sortable: true,\n                    hasInput: function (row, i) {\n                        let returnStr = "";\n                        // console.log(row); // test\n                        if (row.A級資材 === "是") {\n                            returnStr =\n                                \'<select style="width: 7ch;" class="col col-auto form-select form-select-lg ps-2 p-0 m-0"\' +\n                                \' id="gradea\' +\n                                row.id +\n                                \'" name="gradea\' +\n                                i +\n                                \'">\' +\n                                \'<option value="是" selected>\' +\n                                app.appContext.config.globalProperties.$t(\n                                    "basicInfoLang.yes"\n                                ) +\n                                "</option>" +\n                                \'<option value="否">\' +\n                                app.appContext.config.globalProperties.$t(\n                                    "basicInfoLang.no"\n                                ) +\n                                "</option>" +\n                                "</select>";\n                        } // if\n                        else {\n                            returnStr =\n                                \'<select style="width: 7ch;" class="col col-auto form-select form-select-lg ps-2 p-0 m-0"\' +\n                                \' id="gradea\' +\n                                row.id +\n                                \'" name="gradea\' +\n                                i +\n                                \'">\' +\n                                \'<option value="是">\' +\n                                app.appContext.config.globalProperties.$t(\n                                    "basicInfoLang.yes"\n                                ) +\n                                "</option>" +\n                                \'<option value="否" selected>\' +\n                                app.appContext.config.globalProperties.$t(\n                                    "basicInfoLang.no"\n                                ) +\n                                "</option>" +\n                                "</select>";\n                        } // else\n\n                        return returnStr;\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.senddep"\n                    ),\n                    field: "發料部門",\n                    width: "10ch",\n                    sortable: true,\n                    hasInput: function (row, i) {\n                        let returnStr = "";\n                        returnStr +=\n                            \'<select style="width: 10ch;" class="form-select form-select-lg ps-2 p-0 m-0" id="send\' +\n                            row.id +\n                            \'" name="send\' +\n                            i +\n                            \'">\';\n                        senders.forEach((element) => {\n                            if (row.發料部門 === element) {\n                                returnStr +=\n                                    \'<option \' + \'value="\' + element + \'" selected>\' + element + \'</option>\';\n                            } // if\n                            else {\n                                returnStr += \'<option \' + \'value="\' + element + \'">\' + element + "</option>";\n                            } // else\n                        }); // for each in sender array\n                        returnStr += "</select>";\n                        return returnStr; // return\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.safe"\n                    ),\n                    field: "安全庫存",\n                    width: "13ch",\n                    sortable: true,\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            // console.log(rowsKey); // test\n            checkedRows = rowsKey;\n        };\n\n        const rowUserInput = (row, rowNum) => {\n            // console.log(document.getElementById("unitConsumption" + rowNum).value);\n            data[row.id].單價 = document.getElementById("price" + row.id).value;\n            data[row.id].幣別 = document.getElementById("money" + row.id).value;\n            data[row.id].單位 = document.getElementById("unit" + row.id).value;\n            data[row.id].MPQ = document.getElementById("mpq" + row.id).value;\n            data[row.id].MOQ = document.getElementById("moq" + row.id).value;\n            data[row.id].LT = document.getElementById("lt" + row.id).value;\n            data[row.id].月請購 = document.getElementById("month" + row.id).value;\n            data[row.id].A級資材 = document.getElementById("gradea" + row.id).value;\n            data[row.id].發料部門 = document.getElementById("send" + row.id).value;\n            if (document.getElementById("safe" + row.id) == null) {\n                data[row.id].安全庫存 = null;\n            } else {\n                data[row.id].安全庫存 = document.getElementById("safe" + row.id).value;\n            } // if else\n\n            // console.log(data); // test\n        };\n\n        return {\n            searchTerm,\n            table,\n            isInvalid_DB,\n            validation_err_msg,\n            updateCheckedRows,\n            deleteRow,\n            OutputExcelClick,\n            rowUserInput,\n            onSendToDBClick,\n        };\n    }, // setup\n});\n<\/script>\n\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>\n'],sourceRoot:""}]);const l=i},8677:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-ec460f3a] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/MatsInfoUploadTable.vue"],names:[],mappings:"AA0iCA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="card">\n        <div class="card-header">\n            <h3>{{ $t("basicInfoLang.upload") }}</h3>\n        </div>\n        <div class="card-body">\n            <div class="row justify-content-center mb-3">\n                <div class="col col-auto ">\n                    <a :href="exampleUrl" download>\n                        {{ $t(\'inboundpageLang.exampleExcel\') }}\n                    </a>\n                </div>\n\n                <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <label class="col col-auto form-label">{{ $t(\'inboundpageLang.plz_upload\') }}</label>\n                <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="col col-auto">\n                    <input class="form-control" :class="{ \'is-invalid\': isInvalid }" id="excel_input" type="file"\n                        name="select_file" @change="onInputChange" />\n                    <span v-if="isInvalid" class="invalid-feedback d-block" role="alert">\n                        <strong>{{ validation_err_msg }}</strong>\n                    </span>\n                </div>\n                <div class="w-100" style="height: 2ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="row justify-content-center">\n                    <button type="submit" name="upload" class="col col-auto btn btn-lg btn-primary"\n                        @click="onUploadClick">\n                        {{ $t(\'basicInfoLang.upload1\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <button id="togglebtn" class="btn btn-primary col col-auto" type="button" data-bs-toggle="collapse"\n        data-bs-target="#importedtable" aria-expanded="false" aria-controls="importedtable" style="display: none;">\n    </button>\n\n    <div class="card collapse" id="importedtable">\n        <div class="card-body">\n            <div class="row justify-content-between">\n                <div class="row col col-auto">\n                    <div class="col col-auto">\n                        <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n                    </div>\n                    <div class="col col-6 p-0 m-0">\n                        <input id="pnInput" class="text-center form-control form-control-lg"\n                            v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n                    </div>\n                </div>\n            </div>\n            <div class="w-100" style="height: 1ch"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n            <span v-if="isInvalid_DB" class="invalid-feedback d-block" role="alert">\n                <strong>{{ validation_err_msg }}</strong>\n            </span>\n            <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="false"\n                :isLoading="table.isLoading" :messages="table.messages" :columns="table.columns" :rows="table.rows"\n                :total="table.totalRecordCount" :page-options="table.pageOptions" :sortable="table.sortable"\n                @is-finished="table.isLoading = false" @return-checked-rows="updateCheckedRows">\n            </table-lite>\n            <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n            <div class="row justify-content-center">\n                <div class="col col-auto">\n                    <button v-if="uploadToDBReady" type="submit" name="upload"\n                        class="col col-auto fs-3 text-center btn btn-lg btn-info" @click="onSendToDBClick">\n                        <i class="bi bi-cloud-upload-fill"></i>\n                        {{ $t(\'inboundpageLang.upload1\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useConsumptiveMaterials from "../../composables/ConsumptiveMaterials.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        let exampleUrl = ref(window.location.origin + \'/download/MaterialExample.xlsx\');\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const { mats, queryResult, uploadToDB, getDispatchers } = useConsumptiveMaterials(); // axios get the mats data\n\n        // onBeforeMount();\n\n        let isInvalid = ref(false); // validation\n        let isInvalid_DB = ref(false); // add to DB validation\n        let validation_err_msg = ref("");\n        let uploadToDBReady = ref(false); // validation\n        let dispatchers = [];\n        const file = ref();\n        let input_data;\n\n        const findDuplicates = (arr) => {\n            let sorted_arr = arr.slice().sort(); // You can define the comparing function here. \n            // JS by default uses a crappy string compare.\n            // (we use slice to clone the array so the original array won\'t be modified)\n            let results = [];\n            for (let i = 0; i < sorted_arr.length - 1; i++) {\n                if (sorted_arr[i + 1] == sorted_arr[i]) {\n                    results.push(sorted_arr[i]);\n                } // if\n            } // for\n            return results;\n        } // findDuplicates\n\n        const onUploadClick = async () => {\n            isInvalid_DB.value = false;\n            mats.value = "";\n            await triggerModal();\n            if (file.value) {\n                // console.log(file.value); // test\n                if (file.value.type == "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || file.value.type == "application/vnd.ms-excel" || file.value.type == "application/vnd.ms-excel" || file.value.type == ".csv") {\n                    const reader = new FileReader();\n                    reader.onload = async (e) => {\n                        /* Parse data */\n                        const bstr = e.target.result;\n                        const wb = XLSX.read(bstr, { type: \'binary\' });\n                        /* Get first worksheet */\n                        const wsname = wb.SheetNames[0];\n                        const ws = wb.Sheets[wsname];\n                        /* Convert array of arrays */\n                        input_data = XLSX.utils.sheet_to_json(ws, { header: 1 });\n                        // console.log(input_data); // data[row#][col#]  test\n                        if (input_data === undefined || input_data[0] === undefined || input_data[0][0] === undefined || input_data[0][1] === undefined || input_data[0][2] === undefined) {\n                            isInvalid.value = true;\n                            validation_err_msg.value = app.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors");\n                        } else if (input_data[0][0].trim() !== "料號" || input_data[0][1].trim() !== "品名" || input_data[0][2].trim() !== "規格") {\n                            isInvalid.value = true;\n                            validation_err_msg.value = app.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors");\n                        } else {\n                            let tempArr = Array();\n                            for (let i = 1; i < input_data.length; i++) {\n                                if (input_data[i][0] != undefined && input_data[i].length > 2 && input_data[i][0].trim() != "" && input_data[i][0].trim() != null) {\n                                    tempArr.push(input_data[i][0].trim());\n                                } // if\n                                else {\n                                    input_data.splice(i, 1); // remove the empty row\n                                    i = i - 1;\n                                } // else\n                            } // for\n\n                            // console.log(tempArr); // test\n                            await triggerModal();\n                            await getDispatchers();\n                        } // else\n                    };\n\n                    reader.readAsBinaryString(file.value);\n                } // if\n                else {\n                    isInvalid.value = true;\n                    validation_err_msg.value = app.appContext.config.globalProperties.$t("validation.mimetypes");\n                } // else\n            } // if\n            else {\n                isInvalid.value = true;\n                validation_err_msg.value = app.appContext.config.globalProperties.$t("validation.required");\n            } // else\n\n            file.value = null;\n            document.getElementById(\'excel_input\').value = "";\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // onUploadClick\n\n        const onInputChange = (event) => {\n            isInvalid.value = false;\n            data.splice(0); // cleanup data from previous upload\n            queryResult.value = "";\n            file.value = event.target.files ? event.target.files[0] : null;\n            if ($("#importedtable").hasClass("show")) {\n                $("#togglebtn").click();\n            } // if\n        } // onInputChange\n\n        const searchTerm = ref(""); // Search text\n\n        // pour the data in\n        const data = reactive([]);\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const onSendToDBClick = async () => {\n            await triggerModal();\n            isInvalid_DB.value = false;\n            let rowsCount = 0;\n            let hasError = false;\n            // console.log(data.length); //test\n            if (data.length <= 0) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n\n            // validate if there\'s duplicate values in excel\n            let duplicatedArray = Array();\n            for (let i = 0; i < data.length; i++) {\n                // console.log(data[i].料號.trim() + "_" + data[i].儲位.toString().trim()); // test\n                if (data[i].料號 != null && data[i].料號.trim() != "") {\n                    duplicatedArray.push(data[i].料號.toString().trim());\n                } // if\n            } // for\n\n            let findDuplicatesResult = findDuplicates(duplicatedArray);\n            // console.log(findDuplicatesResult); // test\n            if (findDuplicatesResult.length > 0) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.repeated_isn") +\n                    " : " + findDuplicatesResult[0];\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // validate if theres any \'text-danger\' in class names\n\n            if (document.getElementsByClassName("text-danger").length > 0) {\n                let idStr = document.getElementsByClassName("text-danger")[0].parentNode.childNodes[0].getAttribute("id");\n                rowsCount = idStr.replace(/[^0-9]/g, "");\n                hasError = true;\n                console.log(idStr, rowsCount); // test\n            } // if\n\n            if (hasError) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    "Excel " +\n                    app.appContext.config.globalProperties.$t("barcodeGenerator.temp_save_error") + " " +\n                    app.appContext.config.globalProperties.$t("inboundpageLang.row") +\n                    " " + rowsCount + " " +\n                    "(" + document.getElementById("number" + rowsCount).value + ") ";\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // prepare the data arrays to be sent\n            let pnArray = [];\n            let nameArray = [];\n            let specArray = [];\n            let priceArray = [];\n            let currencyArray = [];\n            let unitArray = [];\n            let mpqArray = [];\n            let moqArray = [];\n            let ltArray = [];\n            let gradeaArray = [];\n            let monthlyArray = [];\n            let dispatcherArray = [];\n            let safestockArray = [];\n            for (let j = 0; j < data.length; j++) {\n                pnArray.push(data[j].料號);\n                nameArray.push(data[j].品名);\n                specArray.push(data[j].規格);\n                priceArray.push(data[j].單價);\n                currencyArray.push(data[j].幣別);\n                unitArray.push(data[j].單位);\n                mpqArray.push(data[j].MPQ);\n                moqArray.push(data[j].MOQ);\n                ltArray.push(data[j].LT);\n                if (data[j].A級資材.trim() === "是" || data[j].A級資材.trim().toLowerCase() === "yes") {\n                    gradeaArray.push("是");\n                } else {\n                    gradeaArray.push("否");\n                } // if else\n\n                if (data[j].月請購.trim() === "是" || data[j].月請購.trim().toLowerCase() === "yes") {\n                    monthlyArray.push("是");\n                } else {\n                    monthlyArray.push("否");\n                } // if else\n\n                dispatcherArray.push(data[j].發料部門);\n\n                if (data[j].月請購.trim() === "是" || data[j].月請購.trim().toLowerCase() === "yes") {\n                    safestockArray.push("null");\n                } else {\n                    safestockArray.push(data[j].安全庫存);\n                } // if else\n            } // for\n\n            // console.log(pnArray, nameArray, specArray, priceArray, currencyArray, unitArray, mpqArray, moqArray, ltArray, gradeaArray, monthlyArray, dispatcherArray, safestockArray); // test\n            // actually updating database now\n            let start = Date.now();\n            let result = await uploadToDB(pnArray, nameArray, specArray, priceArray, unitArray, currencyArray, mpqArray, moqArray, ltArray, gradeaArray, monthlyArray, dispatcherArray, safestockArray);\n            let timeTaken = Date.now() - start;\n            console.log("Total time taken : " + timeTaken + " milliseconds");\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n\n            if (result === "success") {\n                uploadToDBReady.value = false;\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("inboundpageLang.change") + " " + app.appContext.config.globalProperties.$t("inboundpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n        } // onSendToDBClick\n\n        watch(queryResult, async () => {\n            await triggerModal();\n            if (queryResult.value === "" || queryResult.value == null || JSON.parse(queryResult.value).data === undefined) {\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            for (let i = 0; i < JSON.parse(queryResult.value).data.length; i++) {\n                dispatchers.push(JSON.parse(queryResult.value).data[i].發料部門);\n            } // for\n\n            let singleEntry = {};\n\n            for (let i = 1; i < input_data.length; i++) {\n                if (input_data[i][0] !== undefined && input_data[i][1] !== undefined &&\n                    input_data[i][2] !== undefined && input_data[i][3] !== undefined &&\n                    input_data[i][4] !== undefined && input_data[i][5] !== undefined &&\n                    input_data[i][6] !== undefined && input_data[i][7] !== undefined &&\n                    input_data[i][8] !== undefined && input_data[i][9] !== undefined &&\n                    input_data[i][10] !== undefined && input_data[i][11] !== undefined) {\n\n                    singleEntry.料號 = input_data[i][0].toString().trim();\n                    singleEntry.品名 = input_data[i][1].toString().trim();\n                    singleEntry.規格 = input_data[i][2].toString().trim();\n                    singleEntry.單價 = parseFloat(input_data[i][3]);\n                    singleEntry.幣別 = input_data[i][4].toString().trim();\n                    singleEntry.單位 = input_data[i][5].toString().trim();\n                    singleEntry.MPQ = parseInt(input_data[i][6]);\n                    singleEntry.MOQ = parseInt(input_data[i][7]);\n                    singleEntry.LT = parseFloat(input_data[i][8]);\n                    singleEntry.月請購 = input_data[i][9].toString().trim();\n                    singleEntry.A級資材 = input_data[i][10].toString().trim();\n                    singleEntry.發料部門 = input_data[i][11].toString().trim();\n                    singleEntry.安全庫存 = parseInt(input_data[i][12]);\n\n                    if (dispatchers.includes(singleEntry.發料部門)) {\n                        singleEntry.dispatcherError = false;\n                    } else {\n                        singleEntry.dispatcherError = true;\n                    } // if else\n\n                    singleEntry.id = i + 1;\n\n                    data.push(singleEntry);\n                    singleEntry = {};\n                } // if\n            } // for\n\n            // console.log(data); // test\n            if (!$("#importedtable").hasClass("show")) {\n                $("#togglebtn").click();\n            } // if\n\n            uploadToDBReady.value = true;\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        watch(data, () => {\n            document.getElementsByClassName("vtl-table")[0].scrollIntoView({ behavior: "smooth" });\n        });\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.料號 === "" || row.料號 === null) {\n                            return (\n                                \'<input type="hidden" id="number\' +\n                                row.id +\n                                \'" name="number\' +\n                                i +\n                                \'" value="">\' +\n                                \'<div class="text-nowrap text-danger CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                \'Missing\' +\n                                "</div>"\n                            );\n                        } else {\n                            return (\n                                \'<input type="hidden" id="number\' +\n                                row.id +\n                                \'" name="number\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.pName"\n                    ),\n                    field: "品名",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.品名 === "" || row.品名 === null) {\n                            return (\n                                \'<input type="hidden" id="name\' +\n                                row.id +\n                                \'" name="name\' +\n                                i +\n                                \'" value="\' +\n                                row.品名 +\n                                \'">\' +\n                                \'<div class="text-nowrap text-danger CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                "Missing" +\n                                "</div>"\n                            );\n                        } else {\n                            return (\n                                \'<input type="hidden" id="name\' +\n                                row.id +\n                                \'" name="name\' +\n                                i +\n                                \'" value="\' +\n                                row.品名 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.品名 +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.format"\n                    ),\n                    field: "規格",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.規格 === "" || row.規格 === null) {\n                            return (\n                                \'<input type="hidden" id="format\' +\n                                row.id +\n                                \'" name="format\' +\n                                i +\n                                \'" value="\' +\n                                row.規格 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                "Missing" +\n                                "</div>"\n                            );\n                        } else {\n                            return (\n                                \'<input type="hidden" id="format\' +\n                                row.id +\n                                \'" name="format\' +\n                                i +\n                                \'" value="\' +\n                                row.規格 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.規格 +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.price"\n                    ),\n                    field: "單價",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (Number.isNaN(row.單價)) {\n                            return (\n                                \'<input type="hidden" id="price\' +\n                                row.id +\n                                \'" name="price\' +\n                                i +\n                                \'" value="">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                parseFloat(row.單價) +\n                                "</div>"\n                            );\n                        } else {\n                            return (\n                                \'<input type="hidden" id="price\' +\n                                row.id +\n                                \'" name="price\' +\n                                i +\n                                \'" value="\' +\n                                parseFloat(row.單價) +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                parseFloat(row.單價) +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.money"\n                    ),\n                    field: "幣別",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        let currencyExist = false;\n                        let currencyDict = [\n                            "RMB",\n                            "USD",\n                            "JPY",\n                            "TWD",\n                            "VND",\n                            "IDR",\n                        ];\n\n                        let returnStr = "";\n                        returnStr +=\n                            \'<input type="hidden" id="money\' +\n                            row.id +\n                            \'" name="money\' +\n                            i;\n\n                        currencyDict.forEach((element) => {\n                            if (row.幣別.toString().trim().toLowerCase() === element.toLowerCase()) {\n                                returnStr +=\n                                    \'" value="\' +\n                                    element +\n                                    \'">\' +\n                                    \'<div class="CustomScrollbar text-nowrap"\' +\n                                    \' style="overflow-x: auto; width: 100%;">\' +\n                                    element +\n                                    "</div>";\n                                currencyExist = true;\n                            } // if\n                        }); // for each in sender array\n\n                        if (!currencyExist) {\n                            returnStr +=\n                                \'" value="">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.幣別 +\n                                "</div>";\n                        } // if\n\n                        return returnStr;\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.unit"\n                    ),\n                    field: "單位",\n                    width: "8ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.單位 === "" || row.單位 === null) {\n                            return (\n                                \'<input type="hidden" id="unit\' +\n                                row.id +\n                                \'" name="unit\' +\n                                i +\n                                \'" value="">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                "Missing" +\n                                "</div>"\n                            );\n                        } else {\n                            return (\n                                \'<input type="hidden" id="unit\' +\n                                row.id +\n                                \'" name="unit\' +\n                                i +\n                                \'" value="\' +\n                                row.單位 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.單位 +\n                                "</div>"\n                            );\n                        }\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.mpq"\n                    ),\n                    field: "MPQ",\n                    width: "8ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (Number.isNaN(row.MPQ)) {\n                            return (\n                                \'<input type="hidden" id="mpq\' +\n                                row.id +\n                                \'" name="mpq\' +\n                                i +\n                                \'" value="">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.MPQ + " <small>" + row.單位 + "</small>" +\n                                "</div>"\n                            );\n                        } else {\n                            return (\n                                \'<input type="hidden" id="mpq\' +\n                                row.id +\n                                \'" name="mpq\' +\n                                i +\n                                \'" value="\' +\n                                row.MPQ +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.MPQ + " <small>" + row.單位 + "</small>" +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.moq"\n                    ),\n                    field: "MOQ",\n                    width: "8ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (Number.isNaN(row.MOQ)) {\n                            return (\n                                \'<input type="hidden" id="moq\' +\n                                row.id +\n                                \'" name="moq\' +\n                                i +\n                                \'" value="">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.MOQ + " <small>" + row.單位 + "</small>" +\n                                "</div>"\n                            );\n                        } else {\n                            return (\n                                \'<input type="hidden" id="moq\' +\n                                row.id +\n                                \'" name="moq\' +\n                                i +\n                                \'" value="\' +\n                                row.MOQ +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.MOQ + " <small>" + row.單位 + "</small>" +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.lt"\n                    ),\n                    field: "LT",\n                    width: "8ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (Number.isNaN(row.LT)) {\n                            return (\n                                \'<input type="hidden" id="lt\' +\n                                row.id +\n                                \'" name="lt\' +\n                                i +\n                                \'" value="">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.LT +\n                                "</div>"\n                            );\n                        } else {\n                            return (\n                                \'<input type="hidden" id="lt\' +\n                                row.id +\n                                \'" name="lt\' +\n                                i +\n                                \'" value="\' +\n                                row.LT +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.LT +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.month"\n                    ),\n                    field: "月請購",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購.trim() === "是" || row.月請購.trim().toLowerCase() === "yes") {\n                            return (\n                                \'<input type="hidden" id="monthly\' +\n                                row.id +\n                                \'" name="monthly\' +\n                                i +\n                                \'" value="是">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("basicInfoLang.yes") +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<input type="hidden" id="monthly\' +\n                                row.id +\n                                \'" name="monthly\' +\n                                i +\n                                \'" value="否">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("basicInfoLang.no") +\n                                "</div>"\n                            );\n                        } // else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.gradea"\n                    ),\n                    field: "A級資材",\n                    width: "7ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.A級資材.trim() === "是" || row.A級資材.trim().toLowerCase() === "yes") {\n                            return (\n                                \'<input type="hidden" id="gradea\' +\n                                row.id +\n                                \'" name="gradea\' +\n                                i +\n                                \'" value="是">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("basicInfoLang.yes") +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<input type="hidden" id="gradea\' +\n                                row.id +\n                                \'" name="gradea\' +\n                                i +\n                                \'" value="否">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("basicInfoLang.no") +\n                                "</div>"\n                            );\n                        } // else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.senddep"\n                    ),\n                    field: "發料部門",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.dispatcherError) { // if 發料部門 not exist in 發料部門 table\n                            if (row.發料部門 === "" || row.發料部門 === null) {\n                                return (\n                                    \'<input type="hidden" id="send\' +\n                                    row.id +\n                                    \'" name="send\' +\n                                    i +\n                                    \'" value="">\' +\n                                    \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                    \' style="overflow-x: auto; width: 100%;">\' +\n                                    "Missing" +\n                                    "</div>"\n                                );\n                            } else {\n                                return (\n                                    \'<input type="hidden" id="send\' +\n                                    row.id +\n                                    \'" name="send\' +\n                                    i +\n                                    \'" value="">\' +\n                                    \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                    \' style="overflow-x: auto; width: 100%;">\' +\n                                    row.發料部門 +\n                                    "</div>"\n                                );\n                            } // if else\n                        } else {\n                            return (\n                                \'<input type="hidden" id="send\' +\n                                row.id +\n                                \'" name="send\' +\n                                i +\n                                \'" value="\' +\n                                row.發料部門 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.發料部門 +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.safe"\n                    ),\n                    field: "安全庫存",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購.trim() === "是" || row.月請購.trim().toLowerCase() === "yes") {\n                            return (\n                                \'<input type="hidden" id="safe\' +\n                                row.id +\n                                \'" name="safe\' +\n                                i +\n                                \'" value="">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("basicInfoLang.differ_by_client") +\n                                "</div>"\n                            );\n                        } else {\n                            if (Number.isNaN(row.安全庫存)) {\n                                return (\n                                    \'<input type="hidden" id="safe\' +\n                                    row.id +\n                                    \'" name="safe\' +\n                                    i +\n                                    \'" value="">\' +\n                                    \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                    \' style="overflow-x: auto; width: 100%;">\' +\n                                    row.安全庫存 +\n                                    "</div>"\n                                );\n                            } else {\n                                return (\n                                    \'<input type="hidden" id="safe\' +\n                                    row.id +\n                                    \'" name="safe\' +\n                                    i +\n                                    \'" value="\' +\n                                    row.安全庫存 +\n                                    \'">\' +\n                                    \'<div class="CustomScrollbar text-nowrap"\' +\n                                    \' style="overflow-x: auto; width: 100%;">\' +\n                                    row.安全庫存 +\n                                    "</div>"\n                                );\n                            } // if else\n                        } // if else\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            // console.log(rowsKey);\n        };\n\n        return {\n            exampleUrl,\n            isInvalid,\n            isInvalid_DB,\n            validation_err_msg,\n            uploadToDBReady,\n            searchTerm,\n            table,\n            updateCheckedRows,\n            onUploadClick,\n            onInputChange,\n            onSendToDBClick,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},6115:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-62fd8e97] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/MonthlyPRImportTable.vue"],names:[],mappings:"AAy0BA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="card">\n        <div class="card-header">\n            <div class="row">\n                <h3 class="col col-auto m-0">{{ $t("monthlyPRpageLang.importMonthlyData") }}</h3>\n                <button class="col col-auto btn btn-light m-0 p-0 flip-btn" @click="(flip = !flip)">\n                    <i class="bi bi-arrow-left-right"> </i>\n                    {{ $t("monthlyPRpageLang.search") }}\n                </button>\n            </div>\n        </div>\n\n        <div class="card-body">\n            <div class="row justify-content-center mb-3">\n                <div class="col col-auto">\n                    <a :href="exampleUrl" download>\n                        {{ $t(\'monthlyPRpageLang.exampleExcel\') }}\n                    </a>\n                </div>\n\n                <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <label class="col col-auto form-label">{{ $t(\'monthlyPRpageLang.plz_upload\') }}</label>\n                <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="col col-auto">\n                    <input class="form-control" :class="{ \'is-invalid\': isInvalid }" id="excel_input" type="file"\n                        name="select_file" @change="onInputChange" />\n                    <span v-if="isInvalid" class="invalid-feedback d-block" role="alert">\n                        <strong>{{ validation_err_msg }}</strong>\n                    </span>\n                </div>\n                <div class="w-100" style="height: 2ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="row justify-content-center">\n                    <button type="submit" name="upload" class="col col-auto btn btn-lg btn-primary" @click="onUploadClick">\n                        {{ $t(\'monthlyPRpageLang.upload1\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <button id="togglebtn" class="btn btn-primary col col-auto" type="button" data-bs-toggle="collapse"\n        data-bs-target="#importedtable" aria-expanded="false" aria-controls="importedtable" style="display: none;">\n    </button>\n\n    <div class="card collapse" id="importedtable">\n        <div class="card-body">\n            <div class="row justify-content-between">\n                <div class="row col col-auto">\n                    <div class="col col-auto">\n                        <label for="pnInput1" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }}\n                            :</label>\n                    </div>\n                    <div class="col col-auto p-0 m-0">\n                        <input id="pnInput1" class="text-center form-control form-control-lg"\n                            v-bind:placeholder="$t(\'monthlyPRpageLang.enter90isn\')" v-model="searchTerm" />\n                    </div>\n                </div>\n                <div class="col col-auto">\n                    <button v-if="uploadToDBReady" id="delete" name="delete" class="col col-auto btn btn-lg btn-danger"\n                        :value="$t(\'basicInfoLang.delete\')" @click="deleteRow">\n                        <i class="bi bi-trash3-fill fs-4"></i>\n                    </button>\n                </div>\n            </div>\n            <div class="w-100" style="height: 1ch"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n            <span v-if="isInvalid_DB" class="invalid-feedback d-block" role="alert">\n                <strong>{{ validation_err_msg }}</strong>\n            </span>\n            <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="true"\n                :isLoading="table.isLoading" :messages="table.messages" :columns="table.columns" :rows="table.rows"\n                :total="table.totalRecordCount" :page-options="table.pageOptions" :sortable="table.sortable"\n                @is-finished="table.isLoading = false" @return-checked-rows="updateCheckedRows"></table-lite>\n\n            <div class="w-100" style="height: 2ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n            <div class="row justify-content-center">\n                <div class="col col-auto">\n                    <button v-if="uploadToDBReady" type="submit" name="upload"\n                        class="col col-auto fs-3 text-center btn btn-lg btn-info" @click="onSendToDBClick">\n                        <i class="bi bi-cloud-upload-fill"></i>\n                        {{ $t(\'monthlyPRpageLang.upload1\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useMonthlyPRSearch from "../../composables/MonthlyPRSearch.ts";\nimport useCommonlyUsedFunctions from "../../composables/CommonlyUsedFunctions.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        let exampleUrl = ref(window.location.origin + \'/download/ImportMonthExample.xlsx\');\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const { mats, uc, uploadMonthlyToDB, validate_UnitConsume } = useMonthlyPRSearch();\n        const { queryResult, validateISN } = useCommonlyUsedFunctions();\n\n        let isInvalid = ref(false); // validation\n        let isInvalid_DB = ref(false); // add to DB validation\n        let validation_err_msg = ref("");\n        let uploadToDBReady = ref(false); // validation\n        const file = ref();\n        let input_data;\n        let checkedRows = [];\n\n        const deleteRow = () => {\n            // console.log(checkedRows); // test\n            for (let i = 0; i < checkedRows.length; i++) {\n                let indexOfObject = data.findIndex(object => {\n                    return parseInt(object.excel_row_num) === parseInt(checkedRows[i].excel_row_num);\n                });\n\n                if (indexOfObject != -1) {\n                    data.splice(indexOfObject, 1);\n                } // if\n            } // for\n\n            document.querySelectorAll(\'.vtl-tbody-checkbox\').forEach(el => el.checked = false);\n\n            if (document.querySelector(".vtl-thead-checkbox").checked) {\n                document.querySelector(".vtl-thead-checkbox").click();\n            } // if\n\n            checkedRows = [];\n            // console.log(data); // test\n        } // deleteRow\n\n        const findDuplicates = (arr) => {\n            let sorted_arr = arr.slice().sort(); // You can define the comparing function here. \n            // JS by default uses a crappy string compare.\n            // (we use slice to clone the array so the original array won\'t be modified)\n            let results = [];\n            for (let i = 0; i < sorted_arr.length - 1; i++) {\n                if (sorted_arr[i + 1] == sorted_arr[i]) {\n                    results.push(sorted_arr[i]);\n                } // if\n            } // for\n            return results;\n        } // findDuplicates\n\n        const onUploadClick = async () => {\n            isInvalid_DB.value = false;\n            mats.value = "";\n            await triggerModal();\n            if (file.value) {\n                // console.log(file.value); // test\n                if (file.value.type == "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || file.value.type == "application/vnd.ms-excel" || file.value.type == "application/vnd.ms-excel" || file.value.type == ".csv") {\n                    const reader = new FileReader();\n                    reader.onload = async (e) => {\n                        /* Parse data */\n                        const bstr = e.target.result;\n                        const wb = XLSX.read(bstr, { type: \'binary\' });\n                        /* Get first worksheet */\n                        const wsname = wb.SheetNames[0];\n                        const ws = wb.Sheets[wsname];\n                        /* Convert array of arrays */\n                        input_data = XLSX.utils.sheet_to_json(ws, { header: 1 });\n                        // console.log(input_data); // data[row#][col#]  test\n                        if (input_data === undefined || input_data[0] === undefined || input_data[0][0] === undefined || input_data[0][1] === undefined || input_data[0][2] === undefined) {\n                            isInvalid.value = true;\n                            validation_err_msg.value = app.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors");\n                        } else if (input_data[0][0].toString().trim() !== "90料號" || input_data[0][1].toString().trim() !== "料號" || !input_data[0][2].toString().trim().toLowerCase().includes("mps")) {\n                            isInvalid.value = true;\n                            validation_err_msg.value = app.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors");\n                        } else {\n                            let tempArr = Array();\n                            let tempArr90 = Array();\n                            for (let i = 1; i < input_data.length; i++) {\n                                if (input_data[i][0] != undefined && input_data[i].length > 2 && input_data[i][0].toString().trim() != "" && input_data[i][0].toString().trim() != null) {\n                                    tempArr.push(input_data[i][1].toString().trim());\n                                    tempArr90.push(input_data[i][0].toString().trim());\n                                } // if\n                                else {\n                                    input_data.splice(i, 1); // remove the empty row\n                                    i = i - 1;\n                                } // else\n                            } // for\n\n                            // console.log(tempArr90); // test\n                            await triggerModal();\n                            await validateISN(tempArr);\n                            await validate_UnitConsume(tempArr, tempArr90);\n                        } // else\n                    };\n\n                    reader.readAsBinaryString(file.value);\n                } // if\n                else {\n                    isInvalid.value = true;\n                    validation_err_msg.value = app.appContext.config.globalProperties.$t("validation.mimetypes");\n                } // else\n            } // if\n            else {\n                isInvalid.value = true;\n                validation_err_msg.value = app.appContext.config.globalProperties.$t("validation.required");\n            } // else\n\n            file.value = null;\n            document.getElementById(\'excel_input\').value = "";\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // onUploadClick\n\n        const onInputChange = (event) => {\n            isInvalid.value = false;\n            data.splice(0); // cleanup data from previous upload\n            queryResult.value = "";\n            file.value = event.target.files ? event.target.files[0] : null;\n            if ($("#importedtable").hasClass("show")) {\n                $("#togglebtn").click();\n            } // if\n        } // onInputChange\n\n        const searchTerm = ref(""); // Search text\n\n        // pour the data in\n        const data = reactive([]);\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const onSendToDBClick = async () => {\n            await triggerModal();\n            // console.log("The modal should be triggered by now."); // test\n            isInvalid_DB.value = false;\n            let rowsCount = 0;\n            let hasError = false;\n            // console.log(data.length); //test\n            if (data.length <= 0) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // validate if all the isn exist\n            for (let j = 0; j < data.length && hasError == false; j++) {\n                if (data[j].月請購 === "" || data[j].月請購 === null || data[j].月請購.toLowerCase() === "null") {\n                    hasError = true;\n                    rowsCount = j;\n                } // if\n            } // for\n\n            if (hasError) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    "Excel " +\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.row") +\n                    " " + data[rowsCount].excel_row_num + " " +\n                    "(" + data[rowsCount].料號 + ") " +\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.noisn");\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // validate if all the 單耗 exist\n            for (let j = 0; j < data.length && hasError == false; j++) {\n                if (data[j].單耗 === "" || data[j].單耗 === null || data[j].單耗.toLowerCase() === "null" ||\n                    data[j].狀態 !== "已完成") {\n                    hasError = true;\n                    rowsCount = j;\n                } // if\n            } // for\n\n            if (hasError) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    "Excel " +\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.row") +\n                    " " + data[rowsCount].excel_row_num + ": " + data[rowsCount].料號90 +\n                    "(" + data[rowsCount].料號 + ") " +\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.nounitconsumption");\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // validate if there\'s duplicate values in excel\n            let duplicatedArray = Array();\n            for (let i = 0; i < data.length; i++) {\n                // console.log(data[i].料號.trim() + "_" + data[i].料號90.toString().trim()); // test\n                if (data[i].料號 != null && data[i].料號.trim() != "") {\n                    duplicatedArray.push(data[i].料號.toString().trim() + "_" + data[i].料號90.toString().trim());\n                } // if\n            } // for\n\n            let findDuplicatesResult = findDuplicates(duplicatedArray);\n            // console.log(findDuplicatesResult); // test\n            if (findDuplicatesResult.length > 0) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    app.appContext.config.globalProperties.$t("inboundpageLang.repeated_isn_90_pair") +\n                    " : " + findDuplicatesResult[0].split("_")[0] +\n                    " (" + findDuplicatesResult[0].split("_")[1] + ")";\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n            // ----------------------------------------------\n            // actually updating database now\n            let number = [];\n            let number90 = [];\n            let nextmps = [];\n            let nextday = [];\n            let nowmps = [];\n            let nowday = [];\n            for (let i = 0; i < data.length; i++) {\n                number.push(data[i].料號);\n                number90.push(data[i].料號90);\n                nextmps.push(data[i].下月MPS);\n                nextday.push(data[i].下月生產天數);\n                nowmps.push(data[i].本月MPS);\n                nowday.push(data[i].本月生產天數);\n            } // for\n\n            // console.log(number); // test\n            let start = Date.now();\n            let result = await uploadMonthlyToDB(number, number90, nextmps, nextday, nowmps, nowday);\n            let timeTaken = Date.now() - start;\n            console.log("Total time taken : " + timeTaken + " milliseconds");\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n\n            if (result === "success") {\n                uploadToDBReady.value = false;\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.total") + " " + data.length + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.record") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // if\n            else {\n                if (result.response.status == 420) {\n                    isInvalid_DB.value = true;\n                    let PR_ALREADY = JSON.parse(result.response.data.PR_ALREADY);\n                    // console.log(PR_ALREADY); // test\n                    let row_sep = 1; // just here to make the output prettier\n                    validation_err_msg.value = app.appContext.config.globalProperties.$t("monthlyPRpageLang.nonmonthly_pr_already_sxb") + "\\n";\n                    for (let i = 0; i < PR_ALREADY.length; i++) {\n                        if (row_sep === 2) {\n                            validation_err_msg.value = validation_err_msg.value + PR_ALREADY[i].料號90 + \'(\' + PR_ALREADY[i].料號 + \')\' + "、\\n";\n                            row_sep = 0;\n                        } else {\n                            validation_err_msg.value = validation_err_msg.value + PR_ALREADY[i].料號90 + \'(\' + PR_ALREADY[i].料號 + \')\' + "、";\n                        } // if else\n\n                        row_sep++;\n                    } // for\n                    validation_err_msg.value = validation_err_msg.value.slice(0, -1); // Remove the last character "、"\n                } // if\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n        } // onSendToDBClick\n\n        watch(uc, async () => {\n            await triggerModal();\n            if (queryResult.value == "") {\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            let allRowsObj = JSON.parse(queryResult.value);\n            let allRowsObj_UC = JSON.parse(uc.value);\n\n            // console.log(allRowsObj_UC); // test\n            let singleEntry = {};\n\n            for (let i = 1; i < input_data.length; i++) {\n                singleEntry.料號90 = input_data[i][0].toString().trim();\n                singleEntry.料號 = input_data[i][1].toString().trim();\n                if (input_data[i][2] == undefined || input_data[i][2].toString().trim() == "") {\n                    isInvalid.value = true;\n                    validation_err_msg.value =\n                        singleEntry.料號90 + "->" + singleEntry.料號 + " " +\n                        app.appContext.config.globalProperties.$t("monthlyPRpageLang.nowmps") + " " +\n                        app.appContext.config.globalProperties.$t("validation.required");\n\n                    $("body").loadingModal("hide");\n                    $("body").loadingModal("destroy");\n                    return;\n                } // if\n                singleEntry.本月MPS = parseFloat(input_data[i][2].toString().replace(/,/g, \'\'));\n                // -------------------------------------------------------------------------------\n                if (input_data[i][3] == undefined || input_data[i][3].toString().trim() == "") {\n                    isInvalid.value = true;\n                    validation_err_msg.value =\n                        singleEntry.料號90 + "->" + singleEntry.料號 + " " +\n                        app.appContext.config.globalProperties.$t("monthlyPRpageLang.nowday") + " " +\n                        app.appContext.config.globalProperties.$t("validation.required");\n\n                    $("body").loadingModal("hide");\n                    $("body").loadingModal("destroy");\n                    return;\n                } // if\n                singleEntry.本月生產天數 = parseFloat(input_data[i][3].toString().replace(/,/g, \'\'));\n                // -------------------------------------------------------------------------------\n                if (input_data[i][4] == undefined || input_data[i][4].toString().trim() == "") {\n                    isInvalid.value = true;\n                    validation_err_msg.value =\n                        singleEntry.料號90 + "->" + singleEntry.料號 + " " +\n                        app.appContext.config.globalProperties.$t("monthlyPRpageLang.nextmps") + " " +\n                        app.appContext.config.globalProperties.$t("validation.required");\n\n                    $("body").loadingModal("hide");\n                    $("body").loadingModal("destroy");\n                    return;\n                } // if\n                singleEntry.下月MPS = parseFloat(input_data[i][4].toString().replace(/,/g, \'\'));\n                // -------------------------------------------------------------------------------\n                if (input_data[i][5] == undefined || input_data[i][5].toString().trim() == "") {\n                    isInvalid.value = true;\n                    validation_err_msg.value =\n                        singleEntry.料號90 + "->" + singleEntry.料號 + " " +\n                        app.appContext.config.globalProperties.$t("monthlyPRpageLang.nextday") + " " +\n                        app.appContext.config.globalProperties.$t("validation.required");\n\n                    $("body").loadingModal("hide");\n                    $("body").loadingModal("destroy");\n                    return;\n                } // if\n                singleEntry.下月生產天數 = parseFloat(input_data[i][5].toString().replace(/,/g, \'\'));\n                // -------------------------------------------------------------------------------\n                singleEntry.excel_row_num = i + 1;\n\n                if (data.length == 0) {\n                    singleEntry.id = 0;\n                } else {\n                    singleEntry.id = parseInt(data[data.length - 1].id) + 1;\n                } // if else\n\n                let indexOfObject = allRowsObj.data.findIndex(object => {\n                    return (object.料號 === singleEntry.料號);\n                });\n\n                if (indexOfObject != -1) { // if an existing record is found\n                    singleEntry = Object.assign(singleEntry, allRowsObj.data[indexOfObject]);\n                    // console.log(singleEntry); // test\n                } // if\n                else {\n                    singleEntry.月請購 = "";\n                } // else\n\n                // check if Unit Consumption Exist and Approved\n                indexOfObject = allRowsObj_UC.data.findIndex(object => {\n                    return (object.料號 === singleEntry.料號 && object.料號90 === singleEntry.料號90);\n                });\n\n                if (indexOfObject != -1) { // if an existing record is found\n                    singleEntry.單耗 = allRowsObj_UC.data[indexOfObject].單耗;\n                    singleEntry.狀態 = allRowsObj_UC.data[indexOfObject].狀態;\n                } // if\n                else {\n                    singleEntry.單耗 = null;\n                    singleEntry.狀態 = null;\n                } // else\n\n                data.push(singleEntry);\n                singleEntry = {};\n            } // for\n\n            if (!$("#importedtable").hasClass("show")) {\n                $("#togglebtn").click();\n            } // if\n\n            console.log(data); // test\n            uploadToDBReady.value = true;\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        watch(data, () => {\n            document.getElementsByClassName("vtl-table")[0].scrollIntoView({ behavior: "smooth" });\n        });\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.90isn"\n                    ),\n                    field: "料號90",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.單耗 === null) { // if isn not exist in consumptive_material table\n                            return (\n                                \'<input type="hidden" id="ninetyisn\' +\n                                row.excel_row_num +\n                                \'" name="ninetyisn\' +\n                                i +\n                                \'" value="\' +\n                                row.料號90 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號90 +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<input type="hidden" id="ninetyisn\' +\n                                row.excel_row_num +\n                                \'" name="ninetyisn\' +\n                                i +\n                                \'" value="\' +\n                                row.料號90 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號90 +\n                                "</div>"\n                            );\n                        } // else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購 === "" || row.月請購 === null || row.月請購.toLowerCase() === "null" || row.單耗 === null) { // if isn not exist in consumptive_material table\n                            return (\n                                \'<input type="hidden" id="isn\' +\n                                row.excel_row_num +\n                                \'" name="isn\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<input type="hidden" id="isn\' +\n                                row.excel_row_num +\n                                \'" name="isn\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } // else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.nowmps"\n                    ),\n                    field: "本月MPS",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="nowmps\' +\n                            i +\n                            \'" name="nowmps\' +\n                            i +\n                            \'" value="\' +\n                            row.本月MPS +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.本月MPS).toLocaleString(\'en\', { useGrouping: true }) +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.nowday"\n                    ),\n                    field: "本月生產天數",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="nowday\' +\n                            i +\n                            \'" name="nowday\' +\n                            i +\n                            \'" value="\' +\n                            row.本月生產天數 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.本月生產天數).toLocaleString(\'en\', { useGrouping: true }) +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.nextmps"\n                    ),\n                    field: "下月MPS",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="nextmps\' +\n                            i +\n                            \'" name="nextmps\' +\n                            i +\n                            \'" value="\' +\n                            row.下月MPS +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.下月MPS).toLocaleString(\'en\', { useGrouping: true }) +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.nextday"\n                    ),\n                    field: "下月生產天數",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="nextday\' +\n                            i +\n                            \'" name="nextday\' +\n                            i +\n                            \'" value="\' +\n                            row.下月生產天數 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.下月生產天數).toLocaleString(\'en\', { useGrouping: true }) +\n                            "</div>"\n                        );\n                    },\n                }\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號90\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase())\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            // console.log(rowsKey); // test\n            checkedRows = rowsKey;\n        };\n\n        const rowUserInput = (row, rowNum) => {\n            // console.log(document.getElementById("unitConsumption" + rowNum).value);\n            data[row.excel_row_num].單耗 = document.getElementById("unitConsumption" + row.excel_row_num).value;\n            // console.log(data); // test\n        };\n\n        return {\n            flip: ref(false),\n            exampleUrl,\n            isInvalid,\n            isInvalid_DB,\n            validation_err_msg,\n            uploadToDBReady,\n            searchTerm,\n            table,\n            updateCheckedRows,\n            rowUserInput,\n            onUploadClick,\n            onInputChange,\n            onSendToDBClick,\n            deleteRow\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},384:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,".flip-card[data-v-8cf998e4]{background-color:transparent;height:75vh;overflow-y:auto;perspective:1000px}.flip-card[data-v-8cf998e4]::-webkit-scrollbar-track{background-color:#f5f5f5;border-radius:4px;-webkit-box-shadow:0 0 1px hsla(0,0%,100%,.5)}.flip-card[data-v-8cf998e4]::-webkit-scrollbar{-webkit-appearance:none;width:4px}.flip-card[data-v-8cf998e4]::-webkit-scrollbar-thumb{background-color:rgba(0,0,0,.3);border-radius:4px;-webkit-box-shadow:0 0 1px hsla(0,0%,100%,.5)}.flip-card-inner[data-v-8cf998e4]{position:relative;transform-style:preserve-3d;transition:transform .5s}.flip-card.transition .flip-card-inner[data-v-8cf998e4]{transform:rotateY(180deg)}.flip-card-back[data-v-8cf998e4],.flip-card-front[data-v-8cf998e4]{backface-visibility:hidden;position:absolute}.flip-card-back[data-v-8cf998e4]{transform:rotateY(180deg)}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/MonthlyPRTable.vue"],names:[],mappings:"AAmGA,4BACI,4BAA6B,CAG7B,WAAY,CACZ,eAAgB,CAHhB,kBAIJ,CAEA,qDAGI,wBAAyB,CADzB,iBAAkB,CADlB,6CAGJ,CAEA,+CAEI,uBAAwB,CADxB,SAEJ,CAEA,qDAGI,+BAAoC,CAFpC,iBAAkB,CAClB,6CAEJ,CAGA,kCACI,iBAAkB,CAElB,2BAA4B,CAD5B,wBAEJ,CAGA,wDACI,yBACJ,CAGA,mEAII,0BAA2B,CAF3B,iBAGJ,CAEA,iCACI,yBACJ",sourcesContent:['<template>\n    <div class="flip-card" ref="detectclasschange">\n        <div class="flip-card-inner row w-100">\n            <div class="flip-card-front col col-12" id="cardFront">\n                <MonthlyPRImportTable ref="myChild"></MonthlyPRImportTable>\n            </div>\n            <div class="flip-card-back col col-12" id="cardBack">\n                <MonthlyPRSearchTable ref="myChild2"></MonthlyPRSearchTable>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, nextTick, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onBeforeUnmount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\n// import TableLite from "./TableLite.vue";\nimport MonthlyPRImportTable from "./MonthlyPRImportTable.vue";\nimport MonthlyPRSearchTable from "./MonthlyPRSearchTable.vue";\nexport default defineComponent({\n    name: "App",\n    components: { MonthlyPRImportTable, MonthlyPRSearchTable },\n    setup() {\n        const myChild = ref(null);\n        const myChild2 = ref(null);\n        const detectclasschange = ref(null);\n\n        const observer = new MutationObserver(mutations => {\n            // Whenever the search page is shown,\n            // update the table using "onclasschange"\n            // and trigger child component\'s function "triggerSearchUpdate"\n            for (const m of mutations) {\n                const newValue = m.target.getAttribute(m.attributeName);\n                nextTick(() => {\n                    onclasschange(newValue, m.oldValue);\n                });\n            } // for\n        });\n\n        onBeforeUnmount(observer.disconnect());\n\n        onMounted(() => {\n            observer.observe(detectclasschange.value, {\n                attributes: true,\n                attributeOldValue: true,\n                attributeFilter: [\'class\'],\n            });\n\n            watch(\n                () => myChild.value.flip,\n                (newVal) => {\n                    $(\'.flip-card\').toggleClass(\'transition\');\n                }\n            );\n\n            watch(\n                () => myChild2.value.flip,\n                (newVal) => {\n                    $(\'.flip-card\').toggleClass(\'transition\');\n                }\n            );\n        });\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const onclasschange = async (classattrvalue) => {\n            await triggerModal();\n            const classlist = classattrvalue.split(\' \');\n            if (classlist.includes(\'transition\')) {\n                await myChild2.value.triggerSearchUpdate();\n            } // if\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // onclasschange\n\n        return {\n            myChild,\n            myChild2,\n            detectclasschange,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n.flip-card {\n    background-color: transparent;\n    perspective: 1000px;\n    /* Remove this if you don\'t want the 3D effect */\n    height: 75vh;\n    overflow-y: auto;\n}\n\n.flip-card::-webkit-scrollbar-track {\n    -webkit-box-shadow: 0 0 1px hsla(0, 0%, 100%, .5);\n    border-radius: 4px;\n    background-color: #F5F5F5;\n}\n\n.flip-card::-webkit-scrollbar {\n    width: 4px;\n    -webkit-appearance: none;\n}\n\n.flip-card::-webkit-scrollbar-thumb {\n    border-radius: 4px;\n    -webkit-box-shadow: 0 0 1px hsla(0, 0%, 100%, .5);\n    background-color: rgba(0, 0, 0, 0.3);\n}\n\n/* This container is needed to position the front and back side */\n.flip-card-inner {\n    position: relative;\n    transition: transform 0.5s;\n    transform-style: preserve-3d;\n}\n\n/* Do an horizontal flip when you move the mouse over the flip box container */\n.flip-card.transition .flip-card-inner {\n    transform: rotateY(180deg);\n}\n\n/* Position the front and back side */\n.flip-card-front,\n.flip-card-back {\n    position: absolute;\n    -webkit-backface-visibility: hidden;\n    backface-visibility: hidden;\n}\n\n.flip-card-back {\n    transform: rotateY(180deg);\n}\n</style>'],sourceRoot:""}]);const l=i},7441:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-2b865b76] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/NonMonthlyPRImportTable.vue"],names:[],mappings:"AA6xBA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="card">\n        <div class="card-header">\n            <div class="row">\n                <h3 class="col col-auto m-0">{{ $t("monthlyPRpageLang.importNonMonthlyData") }}</h3>\n                <button class="col col-auto btn btn-light m-0 p-0 flip-btn" @click="(flip = !flip)">\n                    <i class="bi bi-arrow-left-right"> </i>\n                    {{ $t("monthlyPRpageLang.search") }}\n                </button>\n            </div>\n        </div>\n\n        <div class="card-body">\n            <div class="row justify-content-center mb-3">\n                <div class="col col-auto">\n                    <a :href="exampleUrl" download>\n                        {{ $t(\'monthlyPRpageLang.exampleExcel\') }}\n                    </a>\n                </div>\n\n                <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <label class="col col-auto form-label">{{ $t(\'monthlyPRpageLang.plz_upload\') }}</label>\n                <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="col col-auto">\n                    <input class="form-control" :class="{ \'is-invalid\': isInvalid }" id="excel_input" type="file"\n                        name="select_file" @change="onInputChange" />\n                    <span v-if="isInvalid" class="invalid-feedback d-block" role="alert">\n                        <strong>{{ validation_err_msg }}</strong>\n                    </span>\n                </div>\n                <div class="w-100" style="height: 2ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="row justify-content-center">\n                    <button type="submit" name="upload" class="col col-auto btn btn-lg btn-primary"\n                        @click="onUploadClick">\n                        {{ $t(\'monthlyPRpageLang.upload1\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <button id="togglebtn" class="btn btn-primary col col-auto" type="button" data-bs-toggle="collapse"\n        data-bs-target="#importedtable" aria-expanded="false" aria-controls="importedtable" style="display: none;">\n    </button>\n\n    <div class="card collapse" id="importedtable">\n        <div class="card-body">\n            <div class="row justify-content-between">\n                <div class="row col col-auto">\n                    <div class="col col-auto">\n                        <label for="pnInput1" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }}:\n                        </label>\n                    </div>\n                    <div class="col col-auto p-0 m-0">\n                        <input id="pnInput1" class="text-center form-control form-control-lg"\n                            v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n                    </div>\n                </div>\n                <div class="col col-auto">\n                    <button v-if="uploadToDBReady" id="delete" name="delete" class="col col-auto btn btn-lg btn-danger"\n                        :value="$t(\'basicInfoLang.delete\')" @click="deleteRow">\n                        <i class="bi bi-trash3-fill fs-4"></i>\n                    </button>\n                </div>\n            </div>\n            <div class="w-100" style="height: 1ch"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n            <span v-if="isInvalid_DB" class="invalid-feedback d-block" role="alert">\n                <strong style="white-space: pre-wrap;">{{ validation_err_msg }}</strong>\n            </span>\n            <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="true"\n                :isLoading="table.isLoading" :messages="table.messages" :columns="table.columns" :rows="table.rows"\n                :total="table.totalRecordCount" :page-options="table.pageOptions" :sortable="table.sortable"\n                @is-finished="table.isLoading = false" @return-checked-rows="updateCheckedRows"></table-lite>\n\n            <div class="w-100" style="height: 2ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n            <div class="row justify-content-center">\n                <div class="col col-auto">\n                    <button v-if="uploadToDBReady" type="submit" name="upload"\n                        class="col col-auto fs-3 text-center btn btn-lg btn-info" @click="onSendToDBClick">\n                        <i class="bi bi-cloud-upload-fill"></i>\n                        {{ $t(\'monthlyPRpageLang.upload1\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useMonthlyPRSearch from "../../composables/MonthlyPRSearch.ts";\nimport useCommonlyUsedFunctions from "../../composables/CommonlyUsedFunctions.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        let exampleUrl = ref(window.location.origin + \'/download/ImportNotmonthExample.xlsx\');\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const { mats, uploadNonMonthlyToDB } = useMonthlyPRSearch();\n        const { queryResult, validateISN } = useCommonlyUsedFunctions();\n\n        let isInvalid = ref(false); // validation\n        let isInvalid_DB = ref(false); // add to DB validation\n        let validation_err_msg = ref("");\n        let uploadToDBReady = ref(false); // validation\n        const file = ref();\n        let input_data;\n        let checkedRows = [];\n\n        const deleteRow = () => {\n            // console.log(checkedRows); // test\n            for (let i = 0; i < checkedRows.length; i++) {\n                let indexOfObject = data.findIndex(object => {\n                    return parseInt(object.excel_row_num) === parseInt(checkedRows[i].excel_row_num);\n                });\n\n                if (indexOfObject != -1) {\n                    data.splice(indexOfObject, 1);\n                } // if\n            } // for\n\n            document.querySelectorAll(\'.vtl-tbody-checkbox\').forEach(el => el.checked = false);\n\n            if (document.querySelector(".vtl-thead-checkbox").checked) {\n                document.querySelector(".vtl-thead-checkbox").click();\n            } // if\n\n            checkedRows = [];\n        } // deleteRow\n\n        const findDuplicates = (arr) => {\n            let sorted_arr = arr.slice().sort(); // You can define the comparing function here. \n            // JS by default uses a crappy string compare.\n            // (we use slice to clone the array so the original array won\'t be modified)\n            let results = [];\n            for (let i = 0; i < sorted_arr.length - 1; i++) {\n                if (sorted_arr[i + 1] == sorted_arr[i]) {\n                    results.push(sorted_arr[i]);\n                } // if\n            } // for\n            return results;\n        } // findDuplicates\n\n        const onUploadClick = async () => {\n            isInvalid_DB.value = false;\n            mats.value = "";\n            await triggerModal();\n            if (file.value) {\n                // console.log(file.value); // test\n                if (file.value.type == "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || file.value.type == "application/vnd.ms-excel" || file.value.type == "application/vnd.ms-excel" || file.value.type == ".csv") {\n                    const reader = new FileReader();\n                    reader.onload = async (e) => {\n                        /* Parse data */\n                        const bstr = e.target.result;\n                        const wb = XLSX.read(bstr, { type: \'binary\', WTF: true });\n                        /* Get first worksheet */\n                        const wsname = wb.SheetNames[0];\n                        const ws = wb.Sheets[wsname];\n                        // console.log(ws); // test\n                        /* Convert array of arrays */\n                        input_data = XLSX.utils.sheet_to_json(ws, { header: 1 });\n                        // console.log(input_data); // data[row#][col#]  test\n                        if (input_data === undefined || input_data[0] === undefined || input_data[0][0] === undefined || input_data[0][1] === undefined || input_data[0][2] === undefined) {\n                            isInvalid.value = true;\n                            validation_err_msg.value = app.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors");\n                        } else if (input_data[0][0].trim() !== "料號" || !input_data[0][1].trim().toLowerCase().includes("當月需求")) {\n                            isInvalid.value = true;\n                            validation_err_msg.value = app.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors");\n                        } else {\n                            let tempArr = Array();\n                            for (let i = 1; i < input_data.length; i++) {\n                                if (input_data[i][0] != undefined && input_data[i].length > 2 && input_data[i][0].trim() != "" && input_data[i][0].trim() != null) {\n                                    tempArr.push(input_data[i][0].trim());\n                                } // if\n                                else {\n                                    input_data.splice(i, 1); // remove the empty row\n                                    i = i - 1;\n                                } // else\n\n                                if (input_data[i][3] === null || input_data[i][3] === undefined) {\n                                    input_data[i][3] = input_data[i][1] + input_data[i][2];\n                                } // if\n                            } // for\n\n                            // console.log(tempArr); // test\n                            await triggerModal();\n                            await validateISN(tempArr);\n                            // console.log(input_data); // test\n\n                        } // else\n                    };\n\n                    reader.readAsBinaryString(file.value);\n                } // if\n                else {\n                    isInvalid.value = true;\n                    validation_err_msg.value = app.appContext.config.globalProperties.$t("validation.mimetypes");\n                } // else\n            } // if\n            else {\n                isInvalid.value = true;\n                validation_err_msg.value = app.appContext.config.globalProperties.$t("validation.required");\n            } // else\n\n            file.value = null;\n            document.getElementById(\'excel_input\').value = "";\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // onUploadClick\n\n        const onInputChange = (event) => {\n            isInvalid.value = false;\n            data.splice(0); // cleanup data from previous upload\n            queryResult.value = "";\n            file.value = event.target.files ? event.target.files[0] : null;\n            if ($("#importedtable").hasClass("show")) {\n                $("#togglebtn").click();\n            } // if\n        } // onInputChange\n\n        const searchTerm = ref(""); // Search text\n\n        // pour the data in\n        const data = reactive([]);\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const onSendToDBClick = async () => {\n            await triggerModal();\n            isInvalid_DB.value = false;\n            let rowsCount = 0;\n            let hasError = false;\n            // console.log(data.length); //test\n            if (data.length <= 0) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // validate if all the isn exist\n            for (let j = 0; j < data.length && hasError == false; j++) {\n                if (data[j].月請購 === "" || data[j].月請購 === null || data[j].月請購.toLowerCase() === "null") {\n                    hasError = true;\n                    rowsCount = j;\n                } // if\n            } // for\n\n            if (hasError) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    "Excel " +\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.row") +\n                    " " + data[rowsCount].excel_row_num + " " +\n                    "(" + data[rowsCount].料號 + ") " +\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.noisn");\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // validate if there\'s duplicate values in excel\n            let duplicatedArray = Array();\n            for (let i = 0; i < data.length; i++) {\n                if (data[i].料號 != null && data[i].料號.trim() != "") {\n                    duplicatedArray.push(data[i].料號.toString().trim());\n                } // if\n            } // for\n\n            let findDuplicatesResult = findDuplicates(duplicatedArray);\n            // console.log(findDuplicatesResult); // test\n            if (findDuplicatesResult.length > 0) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.repeated_isn") +\n                    " : " + findDuplicatesResult[0];\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n            // ----------------------------------------------\n            // actually updating database now\n            let number = [];\n            let thisMonthDemand = [];\n            let nextMonthDemand = [];\n            let amount = [];\n            let desc = [];\n            for (let i = 0; i < data.length; i++) {\n                number.push(data[i].料號);\n                thisMonthDemand.push(parseInt(data[i].當月需求));\n                nextMonthDemand.push(parseInt(data[i].下月需求));\n                amount.push(parseInt(data[i].請購數量));\n                desc.push(data[i].說明);\n            } // for\n\n            // console.log(number); // test\n            let start = Date.now();\n            let result = await uploadNonMonthlyToDB(number, thisMonthDemand, nextMonthDemand, amount, desc);\n            let timeTaken = Date.now() - start;\n            console.log("Total time taken : " + timeTaken + " milliseconds");\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n\n            if (result === "success") {\n                uploadToDBReady.value = false;\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.total") + " " + data.length + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.record") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // if\n            else {\n                // console.log(result.response.data); // test\n                if (result.response.status == 420) {\n                    isInvalid_DB.value = true;\n                    let PR_ALREADY = JSON.parse(result.response.data.PR_ALREADY);\n                    // console.log(PR_ALREADY); // test\n                    let row_sep = 1; // just here to make the output prettier\n                    validation_err_msg.value = app.appContext.config.globalProperties.$t("monthlyPRpageLang.nonmonthly_pr_already_sxb") + "\\n";\n                    for (let i = 0; i < PR_ALREADY.length; i++) {\n                        if (row_sep === 4) {\n                            validation_err_msg.value = validation_err_msg.value + PR_ALREADY[i].料號 + "、\\n";\n                            row_sep = 0;\n                        } else {\n                            validation_err_msg.value = validation_err_msg.value + PR_ALREADY[i].料號 + "、";\n                        } // if else\n\n                        row_sep++;\n                    } // for\n                    validation_err_msg.value = validation_err_msg.value.slice(0, -1); // Remove the last character "、"\n                } // if\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n        } // onSendToDBClick\n\n        watch(queryResult, async () => {\n            validation_err_msg.value =\n                app.appContext.config.globalProperties.$t("barcodeGenerator.temp_save_error") +\n                " Excel " +\n                app.appContext.config.globalProperties.$t("monthlyPRpageLang.row");\n            await triggerModal();\n            if (queryResult.value == "") {\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            let allRowsObj = JSON.parse(queryResult.value);\n            let singleEntry = {};\n\n            for (let i = 1; i < input_data.length; i++) {\n                try {\n                    singleEntry.料號 = input_data[i][0].toString().trim();\n                    // console.log(input_data); //test\n                    if (input_data[i][1] == undefined || input_data[i][1].toString().trim() == "") {\n                        isInvalid.value = true;\n                        validation_err_msg.value =\n                            singleEntry.料號 + " " +\n                            app.appContext.config.globalProperties.$t("monthlyPRpageLang.nowneed") + " " +\n                            app.appContext.config.globalProperties.$t("validation.required");\n\n                        $("body").loadingModal("hide");\n                        $("body").loadingModal("destroy");\n                        return;\n                    } // if\n                    singleEntry.當月需求 = parseFloat(input_data[i][1].toString().replace(/,/g, \'\'));\n                    // -------------------------------------------------------------------------------\n                    if (input_data[i][2] == undefined || input_data[i][2].toString().trim() == "") {\n                        isInvalid.value = true;\n                        validation_err_msg.value =\n                            singleEntry.料號 + " " +\n                            app.appContext.config.globalProperties.$t("monthlyPRpageLang.nextneed") + " " +\n                            app.appContext.config.globalProperties.$t("validation.required");\n\n                        $("body").loadingModal("hide");\n                        $("body").loadingModal("destroy");\n                        return;\n                    } // if\n                    singleEntry.下月需求 = parseFloat(input_data[i][2].toString().replace(/,/g, \'\'));\n                    // -------------------------------------------------------------------------------\n                    if (input_data[i][3] == undefined || input_data[i][3].toString().trim() == "") {\n                        isInvalid.value = true;\n                        validation_err_msg.value =\n                            singleEntry.料號 + " " +\n                            app.appContext.config.globalProperties.$t("monthlyPRpageLang.buyamount1") + " " +\n                            app.appContext.config.globalProperties.$t("validation.required");\n\n                        $("body").loadingModal("hide");\n                        $("body").loadingModal("destroy");\n                        return;\n                    } // if\n                    singleEntry.請購數量 = parseInt(input_data[i][3].toString().replace(/,/g, \'\'), 10);\n                    // -------------------------------------------------------------------------------\n                    // console.log(input_data[i][4]); // test\n                    if (input_data[i][4] === undefined || input_data[i][4] === null) {\n                        singleEntry.說明 = "";\n                    } else {\n                        singleEntry.說明 = input_data[i][4].toString().trim();\n                    } // if else\n                    // -------------------------------------------------------------------------------\n                    singleEntry.excel_row_num = i + 1;\n                    if (data.length == 0) {\n                        singleEntry.id = 0;\n                    } else {\n                        singleEntry.id = parseInt(data[data.length - 1].id) + 1;\n                    } // if else\n\n                    let indexOfObject = allRowsObj.data.findIndex(object => {\n                        return (object.料號 === singleEntry.料號);\n                    });\n\n                    if (indexOfObject != -1) { // if an existing record is found\n                        singleEntry = Object.assign(singleEntry, allRowsObj.data[indexOfObject]);\n                    } // if\n                    else {\n                        singleEntry.月請購 = "";\n                    } // else\n\n                    data.push(singleEntry);\n                } catch (error) {\n                    console.log(error); // test\n                    validation_err_msg.value = validation_err_msg.value + " " + i + "、";\n                    isInvalid_DB.value = true;\n                } // try - catch\n\n                singleEntry = {};\n            } // for\n\n            validation_err_msg.value = validation_err_msg.value.slice(0, -1); // Remove the last character "、"\n\n            if (!$("#importedtable").hasClass("show")) {\n                $("#togglebtn").click();\n            } // if\n\n            // console.log(data); // test\n            uploadToDBReady.value = true;\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        watch(data, () => {\n            document.getElementsByClassName("vtl-table")[0].scrollIntoView({ behavior: "smooth" });\n        });\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購 === "" || row.月請購 === null || row.月請購.toLowerCase() === "null") { // if isn not exist in consumptive_material table\n                            return (\n                                \'<input type="hidden" id="isn\' +\n                                row.excel_row_num +\n                                \'" name="isn\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<input type="hidden" id="isn\' +\n                                row.excel_row_num +\n                                \'" name="isn\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } // else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購 === "" || row.月請購 === null || row.月請購.toLowerCase() === "null") { // if isn not exist in consumptive_material table\n                            return (\n                                \'<input type="hidden" id="name\' +\n                                i +\n                                \'" name="name\' +\n                                i +\n                                \'" value="\' +\n                                row.品名 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("inboundpageLang.row") +\n                                " " + row.excel_row_num +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<input type="hidden" id="name\' +\n                                i +\n                                \'" name="name\' +\n                                i +\n                                \'" value="\' +\n                                row.品名 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.品名 +\n                                "</div>"\n                            );\n                        } // else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.nowneed"\n                    ),\n                    field: "當月需求",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="nowneed\' +\n                            i +\n                            \'" name="nowneed\' +\n                            i +\n                            \'" value="\' +\n                            row.當月需求 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.當月需求).toLocaleString(\'en\', { useGrouping: true }) +\n                            " <small>" + row.單位 + "</small>" + "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.nextneed"\n                    ),\n                    field: "下月需求",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="nextneed\' +\n                            row.id +\n                            \'" name="nextneed\' +\n                            i +\n                            \'" value="\' +\n                            row.下月需求 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.下月需求).toLocaleString(\'en\', { useGrouping: true }) +\n                            " <small>" + row.單位 + "</small>" + "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buyamount1"\n                    ),\n                    field: "請購數量",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="buyamount\' +\n                            i +\n                            \'" name="buyamount\' +\n                            i +\n                            \'" value="\' +\n                            row.請購數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseInt(row.請購數量).toLocaleString(\'en\', { useGrouping: true }) +\n                            " <small>" + row.單位 + "</small>" + "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.description"\n                    ),\n                    field: "說明",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.說明 === null) row.說明 = "";\n                        return (\n                            \'<input type="hidden" id="remark\' +\n                            i +\n                            \'" name="remark\' +\n                            i +\n                            \'" value="\' +\n                            row.說明 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.說明 +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            // console.log(rowsKey); // test\n            checkedRows = rowsKey;\n        };\n\n        const rowUserInput = (row, rowNum) => {\n            // console.log(document.getElementById("unitConsumption" + rowNum).value);\n            data[row.excel_row_num].單耗 = document.getElementById("unitConsumption" + row.excel_row_num).value;\n            // console.log(data); // test\n        };\n\n        return {\n            flip: ref(false),\n            exampleUrl,\n            isInvalid,\n            isInvalid_DB,\n            validation_err_msg,\n            uploadToDBReady,\n            searchTerm,\n            table,\n            updateCheckedRows,\n            rowUserInput,\n            onUploadClick,\n            onInputChange,\n            onSendToDBClick,\n            deleteRow,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},8136:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,".flip-card[data-v-57b1c3ff]{background-color:transparent;height:75vh;overflow-y:auto;perspective:1000px}.flip-card[data-v-57b1c3ff]::-webkit-scrollbar-track{background-color:#f5f5f5;border-radius:4px;-webkit-box-shadow:0 0 1px hsla(0,0%,100%,.5)}.flip-card[data-v-57b1c3ff]::-webkit-scrollbar{-webkit-appearance:none;width:4px}.flip-card[data-v-57b1c3ff]::-webkit-scrollbar-thumb{background-color:rgba(0,0,0,.3);border-radius:4px;-webkit-box-shadow:0 0 1px hsla(0,0%,100%,.5)}.flip-card-inner[data-v-57b1c3ff]{position:relative;transform-style:preserve-3d;transition:transform .5s}.flip-card.transition .flip-card-inner[data-v-57b1c3ff]{transform:rotateY(180deg)}.flip-card-back[data-v-57b1c3ff],.flip-card-front[data-v-57b1c3ff]{backface-visibility:hidden;position:absolute}.flip-card-back[data-v-57b1c3ff]{transform:rotateY(180deg)}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/NonMonthlyPRTable.vue"],names:[],mappings:"AAmGA,4BACI,4BAA6B,CAG7B,WAAY,CACZ,eAAgB,CAHhB,kBAIJ,CAEA,qDAGI,wBAAyB,CADzB,iBAAkB,CADlB,6CAGJ,CAEA,+CAEI,uBAAwB,CADxB,SAEJ,CAEA,qDAGI,+BAAoC,CAFpC,iBAAkB,CAClB,6CAEJ,CAGA,kCACI,iBAAkB,CAElB,2BAA4B,CAD5B,wBAEJ,CAGA,wDACI,yBACJ,CAGA,mEAII,0BAA2B,CAF3B,iBAGJ,CAEA,iCACI,yBACJ",sourcesContent:['<template>\n    <div class="flip-card" ref="detectclasschange">\n        <div class="flip-card-inner row w-100">\n            <div class="flip-card-front col col-12" id="cardFront" style="height: auto !important;">\n                <NonMonthlyPRImportTable ref="myChild"></NonMonthlyPRImportTable>\n            </div>\n            <div class="flip-card-back col col-12" id="cardBack">\n                <NonMonthlyPRSearchTable ref="myChild2"></NonMonthlyPRSearchTable>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, nextTick, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onBeforeUnmount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\n// import TableLite from "./TableLite.vue";\nimport NonMonthlyPRImportTable from "./NonMonthlyPRImportTable.vue";\nimport NonMonthlyPRSearchTable from "./NonMonthlyPRSearchTable.vue";\nexport default defineComponent({\n    name: "App",\n    components: { NonMonthlyPRImportTable, NonMonthlyPRSearchTable },\n    setup() {\n        const myChild = ref(null);\n        const myChild2 = ref(null);\n        const detectclasschange = ref(null);\n\n        const observer = new MutationObserver(mutations => {\n            // Whenever the search page is shown,\n            // update the table using "onclasschange"\n            // and trigger child component\'s function "triggerSearchUpdate"\n            for (const m of mutations) {\n                const newValue = m.target.getAttribute(m.attributeName);\n                nextTick(() => {\n                    onclasschange(newValue, m.oldValue);\n                });\n            } // for\n        });\n\n        onBeforeUnmount(observer.disconnect());\n\n        onMounted(() => {\n            observer.observe(detectclasschange.value, {\n                attributes: true,\n                attributeOldValue: true,\n                attributeFilter: [\'class\'],\n            });\n\n            watch(\n                () => myChild.value.flip,\n                (newVal) => {\n                    $(\'.flip-card\').toggleClass(\'transition\');\n                }\n            );\n\n            watch(\n                () => myChild2.value.flip,\n                (newVal) => {\n                    $(\'.flip-card\').toggleClass(\'transition\');\n                }\n            );\n        });\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const onclasschange = async (classattrvalue) => {\n            await triggerModal();\n            const classlist = classattrvalue.split(\' \');\n            if (classlist.includes(\'transition\')) {\n                await myChild2.value.triggerSearchUpdate();\n            } // if\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // onclasschange\n\n        return {\n            myChild,\n            myChild2,\n            detectclasschange,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n.flip-card {\n    background-color: transparent;\n    perspective: 1000px;\n    /* Remove this if you don\'t want the 3D effect */\n    height: 75vh;\n    overflow-y: auto;\n}\n\n.flip-card::-webkit-scrollbar-track {\n    -webkit-box-shadow: 0 0 1px hsla(0, 0%, 100%, .5);\n    border-radius: 4px;\n    background-color: #F5F5F5;\n}\n\n.flip-card::-webkit-scrollbar {\n    width: 4px;\n    -webkit-appearance: none;\n}\n\n.flip-card::-webkit-scrollbar-thumb {\n    border-radius: 4px;\n    -webkit-box-shadow: 0 0 1px hsla(0, 0%, 100%, .5);\n    background-color: rgba(0, 0, 0, 0.3);\n}\n\n/* This container is needed to position the front and back side */\n.flip-card-inner {\n    position: relative;\n    transition: transform 0.5s;\n    transform-style: preserve-3d;\n}\n\n/* Do an horizontal flip when you move the mouse over the flip box container */\n.flip-card.transition .flip-card-inner {\n    transform: rotateY(180deg);\n}\n\n/* Position the front and back side */\n.flip-card-front,\n.flip-card-back {\n    position: absolute;\n    -webkit-backface-visibility: hidden;\n    backface-visibility: hidden;\n}\n\n.flip-card-back {\n    transform: rotateY(180deg);\n}\n</style>'],sourceRoot:""}]);const l=i},1383:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-f13f1bc2] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/OboundBackrecordTable.vue"],names:[],mappings:"AA8mBA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="row" style="text-align: left">\n        <div class="col col-auto">\n            <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n        </div>\n        <div class="col col-3 p-0 m-0">\n            <input id="pnInput" class="text-center form-control form-control-lg"\n                v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n        </div>\n    </div>\n    <div class="w-100" style="height: 1ch"></div>\n    \x3c!-- </div>breaks cols to a new line--\x3e\n    <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="false" :isLoading="table.isLoading"\n        :messages="table.messages" :columns="table.columns" :rows="table.rows" :total="table.totalRecordCount"\n        :page-options="table.pageOptions" :sortable="table.sortable" @is-finished="table.isLoading = false"\n        @return-checked-rows="updateCheckedRows"></table-lite>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport TableLite from "./TableLite.vue";\nimport useOboundBackrecord from "../../composables/OboundBackRecordSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        const { mats, getMats } = useOboundBackrecord(); // axios get the mats data\n\n        onBeforeMount(getMats);\n\n        const searchTerm = ref(""); // Search text\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        // pour the data in\n        const data = reactive([]);\n        // const senders = reactive([]); // access the value by senders[0], senders[1] ...\n\n        watch(mats, () => {\n            console.log(JSON.parse(mats.value)); // test\n            let allRowsObj = JSON.parse(mats.value);\n            //console.log(allRowsObj.datas.length);\n            for (let i = 0; i < allRowsObj.datas.length; i++) {\n                data.push(allRowsObj.datas[i]);\n            } // for\n\n            document\n                .getElementById("QueryFlag")\n                .click();\n                \n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t("oboundpageLang.client"),\n                    field: "客戶別",\n                    width: "12ch",\n                    sortable: true,\n                    isKey: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="client\' +\n                            i +\n                            \'" name="client\' +\n                            i +\n                            \'" value="\' +\n                            row.客戶別 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.客戶別 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.machine"\n                    ),\n                    field: "機種",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="machine\' +\n                            i +\n                            \'" name="machine\' +\n                            i +\n                            \'" value="\' +\n                            row.機種 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.機種 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.process"\n                    ),\n                    field: "製程",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="production\' +\n                            i +\n                            \'" name="production\' +\n                            i +\n                            \'" value="\' +\n                            row.製程 +\n                            \'">\' +\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.製程 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.backreason"\n                    ),\n                    field: "退回原因",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="backreason\' +\n                            i +\n                            \'" name="backreason\' +\n                            i +\n                            \'" value="\' +\n                            row.退回原因 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.退回原因 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.line"\n                    ),\n                    field: "線別",\n                    width: "9ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="line\' +\n                            i +\n                            \'" name="line\' +\n                            i +\n                            \'" value="\' +\n                            row.線別 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.線別 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="number\' +\n                            i +\n                            \'" name="number\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.format"\n                    ),\n                    field: "規格",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="format\' +\n                            i +\n                            \'" name="format\' +\n                            i +\n                            \'" value="\' +\n                            row.規格 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.規格 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.backamount"\n                    ),\n                    field: "預退數量",\n                    width: "15ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="backamount\' +\n                            i +\n                            \'" name="backamount\' +\n                            i +\n                            \'" value="\' +\n                            row.預退數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.預退數量 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.realbackamount"\n                    ),\n                    field: "實際退回數量",\n                    width: "22ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="realbackamount\' +\n                            i +\n                            \'" name="realbackamount\' +\n                            i +\n                            \'" value="\' +\n                            row.實際退回數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.實際退回數量 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.mark"\n                    ),\n                    field: "備註",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.備註 === null) row.備註 = "";\n                        return (\n                            \'<input type="hidden" id="remark\' +\n                            i +\n                            \'" name="remark\' +\n                            i +\n                            \'" value="\' +\n                            row.備註 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.備註 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.backdiffreason"\n                    ),\n                    field: "實退差異原因",\n                    width: "25ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.實退差異原因 === null) row.實退差異原因 = "";\n                        return (\n                            \'<input type="hidden" id="backdiffreason\' +\n                            i +\n                            \'" name="backdiffreason\' +\n                            i +\n                            \'" value="\' +\n                            row.實退差異原因 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.實退差異原因 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.bound"\n                    ),\n                    field: "庫別",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="bound\' +\n                            i +\n                            \'" name="bound\' +\n                            i +\n                            \'" value="\' +\n                            row.庫別 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.庫別 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.receivepeople"\n                    ),\n                    field: "收料人員",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="receivepeople\' +\n                            i +\n                            \'" name="receivepeople\' +\n                            i +\n                            \'" value="\' +\n                            row.收料人員 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.收料人員 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.receivepeoplenum"\n                    ),\n                    field: "收料人員工號",\n                    width: "17ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="receivepeoplenum\' +\n                            i +\n                            \'" name="receivepeoplenum\' +\n                            i +\n                            \'" value="\' +\n                            row.收料人員工號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.收料人員工號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.backpeople"\n                    ),\n                    field: "退料人員",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="backpeople\' +\n                            i +\n                            \'" name="backpeople\' +\n                            i +\n                            \'" value="\' +\n                            row.退料人員 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.退料人員 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.backpeoplenum"\n                    ),\n                    field: "退料人員工號",\n                    width: "17ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="backpeoplenum\' +\n                            i +\n                            \'" name="backpeoplenum\' +\n                            i +\n                            \'" value="\' +\n                            row.退料人員工號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.退料人員工號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.backlistnum"\n                    ),\n                    field: "退料單號",\n                    width: "17ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="backlist\' +\n                            i +\n                            \'" name="backlist\' +\n                            i +\n                            \'" value="\' +\n                            row.退料單號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.退料單號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.opentime"\n                    ),\n                    field: "開單時間",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="opentime\' +\n                            i +\n                            \'" name="opentime\' +\n                            i +\n                            \'" value="\' +\n                            row.開單時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.開單時間 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.inboundtime"\n                    ),\n                    field: "入庫時間",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="inboundtime\' +\n                            i +\n                            \'" name="inboundtime\' +\n                            i +\n                            \'" value="\' +\n                            row.入庫時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.入庫時間 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.status"\n                    ),\n                    field: "功能狀況",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="status\' +\n                            i +\n                            \'" name="status\' +\n                            i +\n                            \'" value="\' +\n                            row.功能狀況 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.功能狀況 +\n                            "</div>"\n                        );\n                    },\n                },\n\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t("basicInfoLang.record") +\n                    ", " +\n                    app.appContext.config.globalProperties.$t("basicInfoLang.total") +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t("basicInfoLang.record"),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            console.log(rowsKey)\n        }\n        return {\n            searchTerm,\n            table,\n            updateCheckedRows,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},6547:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-4df1ae5a] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/OboundINSearchTable.vue"],names:[],mappings:"AAoZA,sDAEE,wBAAyB,CACzB,oBAAqB,CAFrB,UAGF",sourcesContent:['<template>\n  <div class="row" style="text-align: left">\n    <div class="col col-auto">\n      <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n    </div>\n    <div class="col col-3 p-0 m-0">\n      <input id="pnInput" class="text-center form-control form-control-lg"\n        v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n    </div>\n  </div>\n  <div class="w-100" style="height: 1ch"></div>\n  \x3c!-- </div>breaks cols to a new line--\x3e\n  <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="true" :isLoading="table.isLoading"\n    :messages="table.messages" :columns="table.columns" :rows="table.rows" :total="table.totalRecordCount"\n    :page-options="table.pageOptions" :sortable="table.sortable" @is-finished="table.isLoading = false"\n    @return-checked-rows="updateCheckedRows"></table-lite>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n  getCurrentInstance,\n  onBeforeMount,\n  onMounted,\n  watch,\n} from "@vue/runtime-core";\nimport TableLite from "./TableLite.vue";\nimport useOboundInboundSearch from "../../composables/OboundINSearch.ts";\nexport default defineComponent({\n  name: "App",\n  components: { TableLite },\n  setup() {\n    const { mats, getMats } = useOboundInboundSearch(); // axios get the mats data\n\n    onBeforeMount(getMats);\n\n    const searchTerm = ref(""); // Search text\n    const app = getCurrentInstance(); // get the current instance\n    let thisHtmlLang = document\n      .getElementsByTagName("HTML")[0]\n      .getAttribute("lang");\n    // get the current locale from html tag\n    app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n    // pour the data in\n    const data = reactive([]);\n    // const senders = reactive([]); // access the value by senders[0], senders[1] ...\n\n    watch(mats, () => {\n      console.log(JSON.parse(mats.value)); // test\n      let allRowsObj = JSON.parse(mats.value);\n      //console.log(allRowsObj.datas.length);\n      for (let i = 0; i < allRowsObj.datas.length; i++) {\n        data.push(allRowsObj.datas[i]);\n      } // for\n\n      document\n        .getElementById("QueryFlag")\n        .click();\n      table.isLoading = false;\n    }); // watch for data change\n\n    // Table config\n    const table = reactive({\n      isLoading: true,\n      columns: [\n        {\n          label: app.appContext.config.globalProperties.$t("oboundpageLang.inlist"),\n          field: "入庫單號",\n          width: "14ch",\n          sortable: true,\n          isKey: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="inboundlist\' +\n              i +\n              \'" name="inboundlist\' +\n              i +\n              \'" value="\' +\n              row.入庫單號 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.入庫單號 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.isn"\n          ),\n          field: "料號",\n          width: "14ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="number\' +\n              i +\n              \'" name="number\' +\n              i +\n              \'" value="\' +\n              row.料號 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.料號 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.pName"\n          ),\n          field: "品名",\n          width: "15ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="name\' +\n              i +\n              \'" name="name\' +\n              i +\n              \'" value="\' +\n              row.品名 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.品名 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.format"\n          ),\n          field: "規格",\n          width: "15ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="format\' +\n              i +\n              \'" name="format\' +\n              i +\n              \'" value="\' +\n              row.規格 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.規格 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.client"\n          ),\n          field: "客戶別",\n          width: "12ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="client\' +\n              i +\n              \'" name="client\' +\n              i +\n              \'" value="\' +\n              row.客戶別 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.客戶別 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.bound"\n          ),\n          field: "庫別",\n          width: "12ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="bound\' +\n              i +\n              \'" name="bound\' +\n              i +\n              \'" value="\' +\n              row.庫別 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.庫別 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.inboundnum"\n          ),\n          field: "入庫數量",\n          width: "14ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="inboundnum\' +\n              i +\n              \'" name="inboundnum\' +\n              i +\n              \'" value="\' +\n              row.數量 +\n              \'">\' +\n              \'<div class="CustomScrollbar text-nowrap"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.數量 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.inpeople"\n          ),\n          field: "入庫人員",\n          width: "14ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="inboundpeople\' +\n              i +\n              \'" name="inboundpeople\' +\n              i +\n              \'" value="\' +\n              row.入庫人員 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.入庫人員 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.inboundtime"\n          ),\n          field: "入庫時間",\n          width: "12ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="inboundtime\' +\n              i +\n              \'" name="inboundtime\' +\n              i +\n              \'" value="\' +\n              row.時間 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.時間 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.mark"\n          ),\n          field: "備註",\n          width: "10ch",\n          sortable: true,\n          display: function (row, i) {\n            if (row.備註 === null) row.備註 = "";\n            return (\n              \'<input type="hidden" id="remark\' +\n              i +\n              \'" name="remark\' +\n              i +\n              \'" value="\' +\n              row.備註 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.備註 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.inreason"\n          ),\n          field: "入庫原因",\n          width: "15ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="inboundreason\' +\n              i +\n              \'" name="inboundreason\' +\n              i +\n              \'" value="\' +\n              row.入庫原因 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.入庫原因 +\n              "</div>"\n            );\n          },\n        },\n      ],\n      rows: computed(() => {\n        return data.filter((x) =>\n          x.料號\n            .toLowerCase()\n            .includes(searchTerm.value.toLowerCase()) ||\n          x.品名\n            .includes(searchTerm.value)\n        );\n      }),\n      totalRecordCount: computed(() => {\n        return table.rows.length;\n      }),\n      sortable: {\n        order: "id",\n        sort: "asc",\n      },\n      messages: {\n        pagingInfo:\n          app.appContext.config.globalProperties.$t(\n            "basicInfoLang.now_showing"\n          ) +\n          " {0} ~ {1} " +\n          app.appContext.config.globalProperties.$t("basicInfoLang.record") +\n          ", " +\n          app.appContext.config.globalProperties.$t("basicInfoLang.total") +\n          " {2} " +\n          app.appContext.config.globalProperties.$t("basicInfoLang.record"),\n        pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n          "basicInfoLang.records_per_page"\n        ),\n        gotoPageLabel: app.appContext.config.globalProperties.$t(\n          "basicInfoLang.go_to_page"\n        ),\n        noDataAvailable: app.appContext.config.globalProperties.$t(\n          "basicInfoLang.search_with_no_data_returned"\n        ),\n      },\n      pageOptions: [\n        {\n          value: 10,\n          text: 10,\n        },\n        {\n          value: 20,\n          text: 20,\n        },\n        {\n          value: 40,\n          text: 40,\n        },\n        {\n          value: 100,\n          text: 100,\n        },\n      ],\n    });\n\n    const updateCheckedRows = (rowsKey) => {\n      console.log(rowsKey)\n      // only check one\n      let count = ($(\'.vtl-paging-count-dropdown\').val());\n      rowsKey = parseInt(rowsKey);\n      for (let i = 0; i < count; i++) {\n        if (i !== rowsKey) {\n          $("#checkbox" + i).prop("disabled", true);\n        }\n        else {\n          $("#checkbox" + i).prop("disabled", false);\n        }\n      };\n      if (isNaN(rowsKey)) {\n        console.log(1);\n        $(\'.vtl-tbody-checkbox\').prop("disabled", false);\n      }\n    }\n    return {\n      searchTerm,\n      table,\n      updateCheckedRows,\n    };\n  }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n  color: #fff;\n  background-color: #196241;\n  border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},5691:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-9b60d964] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/OboundISNSearch.vue"],names:[],mappings:"AA6MA,sDAEE,wBAAyB,CACzB,oBAAqB,CAFrB,UAGF",sourcesContent:['<template>\n  <div class="row" style="text-align: left">\n    <div class="col col-auto">\n      <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n    </div>\n    <div class="col col-3 p-0 m-0">\n      <input id="pnInput" class="text-center form-control form-control-lg"\n        v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n    </div>\n  </div>\n  <div class="w-100" style="height: 1ch"></div>\n  \x3c!-- </div>breaks cols to a new line--\x3e\n  <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="false" :isLoading="table.isLoading"\n    :messages="table.messages" :columns="table.columns" :rows="table.rows" :total="table.totalRecordCount"\n    :page-options="table.pageOptions" :sortable="table.sortable" @is-finished="table.isLoading = false"\n    @return-checked-rows="updateCheckedRows"></table-lite>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n  getCurrentInstance,\n  onBeforeMount,\n  onMounted,\n  watch,\n} from "@vue/runtime-core";\nimport TableLite from "./TableLite.vue";\nimport useOboundISNSearch from "../../composables/OboundISNSearch.ts";\nexport default defineComponent({\n  name: "App",\n  components: { TableLite },\n  setup() {\n    const { mats, getMats } = useOboundISNSearch(); // axios get the mats data\n\n    onBeforeMount(getMats);\n\n    const searchTerm = ref(""); // Search text\n    const app = getCurrentInstance(); // get the current instance\n    let thisHtmlLang = document\n      .getElementsByTagName("HTML")[0]\n      .getAttribute("lang");\n    // get the current locale from html tag\n    app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n    // pour the data in\n    const data = reactive([]);\n    // const senders = reactive([]); // access the value by senders[0], senders[1] ...\n\n    watch(mats, () => {\n      console.log(JSON.parse(mats.value)); // test\n      let allRowsObj = JSON.parse(mats.value);\n      //console.log(allRowsObj.datas.length);\n      for (let i = 0; i < allRowsObj.datas.length; i++) {\n        data.push(allRowsObj.datas[i]);\n      } // for\n\n      document\n        .getElementById("QueryFlag")\n        .click();\n      table.isLoading = false;\n    }); // watch for data change\n\n    // Table config\n    const table = reactive({\n      isLoading: true,\n      columns: [\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.isn"\n          ),\n          field: "料號",\n          width: "14ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="number\' +\n              i +\n              \'" name="number\' +\n              i +\n              \'" value="\' +\n              row.料號 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.料號 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.pName"\n          ),\n          field: "品名",\n          width: "15ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="name\' +\n              i +\n              \'" name="name\' +\n              i +\n              \'" value="\' +\n              row.品名 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.品名 +\n              "</div>"\n            );\n          },\n        },\n        {\n          label: app.appContext.config.globalProperties.$t(\n            "oboundpageLang.format"\n          ),\n          field: "規格",\n          width: "15ch",\n          sortable: true,\n          display: function (row, i) {\n            return (\n              \'<input type="hidden" id="format\' +\n              i +\n              \'" name="format\' +\n              i +\n              \'" value="\' +\n              row.規格 +\n              \'">\' +\n              \'<div class="text-nowrap CustomScrollbar"\' +\n              \' style="overflow-x: auto; width: 100%;">\' +\n              row.規格 +\n              "</div>"\n            );\n          },\n        },\n      ],\n      rows: computed(() => {\n        return data.filter((x) =>\n          x.料號\n            .toLowerCase()\n            .includes(searchTerm.value.toLowerCase()) ||\n          x.品名\n            .includes(searchTerm.value)\n        );\n      }),\n      totalRecordCount: computed(() => {\n        return table.rows.length;\n      }),\n      sortable: {\n        order: "id",\n        sort: "asc",\n      },\n      messages: {\n        pagingInfo:\n          app.appContext.config.globalProperties.$t(\n            "basicInfoLang.now_showing"\n          ) +\n          " {0} ~ {1} " +\n          app.appContext.config.globalProperties.$t("basicInfoLang.record") +\n          ", " +\n          app.appContext.config.globalProperties.$t("basicInfoLang.total") +\n          " {2} " +\n          app.appContext.config.globalProperties.$t("basicInfoLang.record"),\n        pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n          "basicInfoLang.records_per_page"\n        ),\n        gotoPageLabel: app.appContext.config.globalProperties.$t(\n          "basicInfoLang.go_to_page"\n        ),\n        noDataAvailable: app.appContext.config.globalProperties.$t(\n          "basicInfoLang.search_with_no_data_returned"\n        ),\n      },\n      pageOptions: [\n        {\n          value: 10,\n          text: 10,\n        },\n        {\n          value: 20,\n          text: 20,\n        },\n        {\n          value: 40,\n          text: 40,\n        },\n        {\n          value: 100,\n          text: 100,\n        },\n      ],\n    });\n\n    const updateCheckedRows = (rowsKey) => {\n      console.log(rowsKey)\n    }\n    return {\n      searchTerm,\n      table,\n      updateCheckedRows,\n    };\n  }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n  color: #fff;\n  background-color: #196241;\n  border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},9770:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-5a6cb164] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/OboundPickrecordTable.vue"],names:[],mappings:"AAslBA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="row" style="text-align: left">\n        <div class="col col-auto">\n            <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n        </div>\n        <div class="col col-3 p-0 m-0">\n            <input id="pnInput" class="text-center form-control form-control-lg"\n                v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n        </div>\n    </div>\n    <div class="w-100" style="height: 1ch"></div>\n    \x3c!-- </div>breaks cols to a new line--\x3e\n    <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="false" :isLoading="table.isLoading"\n        :messages="table.messages" :columns="table.columns" :rows="table.rows" :total="table.totalRecordCount"\n        :page-options="table.pageOptions" :sortable="table.sortable" @is-finished="table.isLoading = false"\n        @return-checked-rows="updateCheckedRows"></table-lite>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport TableLite from "./TableLite.vue";\nimport useOboundPickrecord from "../../composables/OboundPickRecordSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        const { mats, getMats } = useOboundPickrecord(); // axios get the mats data\n\n        onBeforeMount(getMats);\n\n        const searchTerm = ref(""); // Search text\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        // pour the data in\n        const data = reactive([]);\n        // const senders = reactive([]); // access the value by senders[0], senders[1] ...\n\n        watch(mats, () => {\n            console.log(JSON.parse(mats.value)); // test\n            let allRowsObj = JSON.parse(mats.value);\n            //console.log(allRowsObj.datas.length);\n            for (let i = 0; i < allRowsObj.datas.length; i++) {\n                data.push(allRowsObj.datas[i]);\n            } // for\n\n            document\n                .getElementById("QueryFlag")\n                .click();\n\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t("oboundpageLang.client"),\n                    field: "客戶別",\n                    width: "12ch",\n                    sortable: true,\n                    isKey: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="client\' +\n                            i +\n                            \'" name="client\' +\n                            i +\n                            \'" value="\' +\n                            row.客戶別 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.客戶別 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.machine"\n                    ),\n                    field: "機種",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="machine\' +\n                            i +\n                            \'" name="machine\' +\n                            i +\n                            \'" value="\' +\n                            row.機種 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.機種 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.process"\n                    ),\n                    field: "製程",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="production\' +\n                            i +\n                            \'" name="production\' +\n                            i +\n                            \'" value="\' +\n                            row.製程 +\n                            \'">\' +\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.製程 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.usereason"\n                    ),\n                    field: "領用原因",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="usereason\' +\n                            i +\n                            \'" name="usereason\' +\n                            i +\n                            \'" value="\' +\n                            row.領用原因 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.領用原因 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.line"\n                    ),\n                    field: "線別",\n                    width: "9ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="line\' +\n                            i +\n                            \'" name="line\' +\n                            i +\n                            \'" value="\' +\n                            row.線別 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.線別 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="number\' +\n                            i +\n                            \'" name="number\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.format"\n                    ),\n                    field: "規格",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="format\' +\n                            i +\n                            \'" name="format\' +\n                            i +\n                            \'" value="\' +\n                            row.規格 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.規格 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.pickamount"\n                    ),\n                    field: "預領數量",\n                    width: "15ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="pickamount\' +\n                            i +\n                            \'" name="pickamount\' +\n                            i +\n                            \'" value="\' +\n                            row.預領數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.預領數量 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.realpickamount"\n                    ),\n                    field: "實際領用數量",\n                    width: "22ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="realpickamount\' +\n                            i +\n                            \'" name="realpickamount\' +\n                            i +\n                            \'" value="\' +\n                            row.實際領用數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.實際領用數量 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.mark"\n                    ),\n                    field: "備註",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.備註 === null) row.備註 = "";\n                        return (\n                            \'<input type="hidden" id="remark\' +\n                            i +\n                            \'" name="remark\' +\n                            i +\n                            \'" value="\' +\n                            row.備註 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.備註 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.diffreason"\n                    ),\n                    field: "實領差異原因",\n                    width: "25ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.實領差異原因 === null) row.實領差異原因 = "";\n                        return (\n                            \'<input type="hidden" id="diffreason\' +\n                            i +\n                            \'" name="diffreason\' +\n                            i +\n                            \'" value="\' +\n                            row.實領差異原因 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.實領差異原因 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.bound"\n                    ),\n                    field: "庫別",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="bound\' +\n                            i +\n                            \'" name="bound\' +\n                            i +\n                            \'" value="\' +\n                            row.庫別 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.庫別 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.pickpeople"\n                    ),\n                    field: "領料人員",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="pickpeople\' +\n                            i +\n                            \'" name="pickpeople\' +\n                            i +\n                            \'" value="\' +\n                            row.領料人員 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.領料人員 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.pickpeoplenum"\n                    ),\n                    field: "領料人員工號",\n                    width: "17ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="pickpeoplenum\' +\n                            i +\n                            \'" name="pickpeoplenum\' +\n                            i +\n                            \'" value="\' +\n                            row.領料人員工號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.領料人員工號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.sendpeople"\n                    ),\n                    field: "發料人員",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="sendpeople\' +\n                            i +\n                            \'" name="sendpeople\' +\n                            i +\n                            \'" value="\' +\n                            row.發料人員 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.發料人員 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.sendpeoplenum"\n                    ),\n                    field: "發料人員工號",\n                    width: "17ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="sendpeoplenum\' +\n                            i +\n                            \'" name="sendpeoplenum\' +\n                            i +\n                            \'" value="\' +\n                            row.發料人員工號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.發料人員工號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.picklistnum"\n                    ),\n                    field: "領料單號",\n                    width: "17ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="picklist\' +\n                            i +\n                            \'" name="picklist\' +\n                            i +\n                            \'" value="\' +\n                            row.領料單號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.領料單號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.opentime"\n                    ),\n                    field: "開單時間",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="opentime\' +\n                            i +\n                            \'" name="opentime\' +\n                            i +\n                            \'" value="\' +\n                            row.開單時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.開單時間 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.outboundtime"\n                    ),\n                    field: "出庫時間",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="outboundtime\' +\n                            i +\n                            \'" name="outboundtime\' +\n                            i +\n                            \'" value="\' +\n                            row.出庫時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.出庫時間 +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t("basicInfoLang.record") +\n                    ", " +\n                    app.appContext.config.globalProperties.$t("basicInfoLang.total") +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t("basicInfoLang.record"),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            console.log(rowsKey)\n        }\n        return {\n            searchTerm,\n            table,\n            updateCheckedRows,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},3186:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-9060e7aa] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/OboundStockTable.vue"],names:[],mappings:"AA+SA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="row" style="text-align: left">\n        <div class="col col-auto">\n            <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n        </div>\n        <div class="col col-3 p-0 m-0">\n            <input id="pnInput" class="text-center form-control form-control-lg"\n                v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n        </div>\n    </div>\n    <div class="w-100" style="height: 1ch"></div>\n    \x3c!-- </div>breaks cols to a new line--\x3e\n    <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="false" :isLoading="table.isLoading"\n        :messages="table.messages" :columns="table.columns" :rows="table.rows" :total="table.totalRecordCount"\n        :page-options="table.pageOptions" :sortable="table.sortable" @is-finished="table.isLoading = false"\n        @return-checked-rows="updateCheckedRows"></table-lite>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport TableLite from "./TableLite.vue";\nimport useOboundStockSearch from "../../composables/OboundStockSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n\n    setup() {\n        const { mats, getMats } = useOboundStockSearch(); // axios get the mats data\n        onBeforeMount(getMats);\n\n        const searchTerm = ref(""); // Search text\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        // pour the data in\n        const data = reactive([]);\n        // const senders = reactive([]); // access the value by senders[0], senders[1] ...\n        watch(mats, () => {\n            console.log(JSON.parse(mats.value)); // test\n            let allRowsObj = JSON.parse(mats.value);\n            //console.log(allRowsObj.datas.length);\n            for (let i = 0; i < allRowsObj.datas.length; i++) {\n                data.push(allRowsObj.datas[i]);\n            } // for\n\n            document.getElementById("QueryFlag").click();\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    isKey: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="isn\' +\n                            i +\n                            \'" name="isn\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.nowstock"\n                    ),\n                    field: "現有庫存",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="stock\' +\n                            i +\n                            \'" name="stock\' +\n                            i +\n                            \'" value="\' +\n                            row.現有庫存 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.現有庫存 + " <small>" + row.單位 + "</small>" +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.client"\n                    ),\n                    field: "客戶別",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="client\' +\n                            i +\n                            \'" name="client\' +\n                            i +\n                            \'" value="\' +\n                            row.客戶別 +\n                            \'">\' +\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.客戶別 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.bound"\n                    ),\n                    field: "庫別",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="bound\' +\n                            i +\n                            \'" name="bound\' +\n                            i +\n                            \'" value="\' +\n                            row.庫別 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.庫別 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.updatetime"\n                    ),\n                    field: "最後更新時間",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="updatetime\' +\n                            i +\n                            \'" name="updatetime\' +\n                            i +\n                            \'" value="\' +\n                            row.最後更新時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.最後更新時間 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="pName\' +\n                            i +\n                            \'" name="pName\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "oboundpageLang.format"\n                    ),\n                    field: "規格",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="format\' +\n                            i +\n                            \'" name="format\' +\n                            i +\n                            \'" value="\' +\n                            row.規格 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.規格 +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            console.log(rowsKey);\n        };\n\n        return {\n            searchTerm,\n            table,\n            updateCheckedRows,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},2552:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-26c90384] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/OutboundBackrecordTable.vue"],names:[],mappings:"AA6iBA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="row" style="text-align: left">\n        <div class="col col-auto">\n            <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n        </div>\n        <div class="col col-3 p-0 m-0">\n            <input id="pnInput" class="text-center form-control form-control-lg"\n                v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n        </div>\n    </div>\n    <div class="w-100" style="height: 1ch"></div>\n    \x3c!-- </div>breaks cols to a new line--\x3e\n    <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="false" :isLoading="table.isLoading"\n        :messages="table.messages" :columns="table.columns" :rows="table.rows" :total="table.totalRecordCount"\n        :page-options="table.pageOptions" :sortable="table.sortable" @is-finished="table.isLoading = false"\n        @return-checked-rows="updateCheckedRows"></table-lite>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport TableLite from "./TableLite.vue";\nimport useOutboundBackrecord from "../../composables/OutboundBackRecordSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        const { mats, getMats } = useOutboundBackrecord(); // axios get the mats data\n\n        onBeforeMount(getMats);\n\n        const searchTerm = ref(""); // Search text\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        // pour the data in\n        const data = reactive([]);\n        // const senders = reactive([]); // access the value by senders[0], senders[1] ...\n\n        watch(mats, () => {\n            console.log(JSON.parse(mats.value)); // test\n            let allRowsObj = JSON.parse(mats.value);\n            //console.log(allRowsObj.datas.length);\n            for (let i = 0; i < allRowsObj.datas.length; i++) {\n                data.push(allRowsObj.datas[i]);\n            } // for\n\n            document.getElementById("QueryFlag").click();\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="number\' +\n                            i +\n                            \'" name="number\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.backreason"\n                    ),\n                    field: "退回原因",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="backreason\' +\n                            i +\n                            \'" name="backreason\' +\n                            i +\n                            \'" value="\' +\n                            row.退回原因 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.退回原因 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.line"\n                    ),\n                    field: "線別",\n                    width: "8ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="line\' +\n                            i +\n                            \'" name="line\' +\n                            i +\n                            \'" value="\' +\n                            row.線別 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.線別 +\n                            "</div>"\n                        );\n                    },\n                },\n\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.format"\n                    ),\n                    field: "規格",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="format\' +\n                            i +\n                            \'" name="format\' +\n                            i +\n                            \'" value="\' +\n                            row.規格 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.規格 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.backamount"\n                    ),\n                    field: "預退數量",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="backamount\' +\n                            i +\n                            \'" name="backamount\' +\n                            i +\n                            \'" value="\' +\n                            row.預退數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.預退數量 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.realbackamount"\n                    ),\n                    field: "實際退回數量",\n                    width: "15ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="realbackamount\' +\n                            i +\n                            \'" name="realbackamount\' +\n                            i +\n                            \'" value="\' +\n                            row.實際退回數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.實際退回數量 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.mark"\n                    ),\n                    field: "備註",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.備註 === null) row.備註 = "";\n                        return (\n                            \'<input type="hidden" id="remark\' +\n                            i +\n                            \'" name="remark\' +\n                            i +\n                            \'" value="\' +\n                            row.備註 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.備註 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.backdiffreason"\n                    ),\n                    field: "實退差異原因",\n                    width: "23ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.實退差異原因 === null) row.實退差異原因 = "";\n                        return (\n                            \'<input type="hidden" id="backdiffreason\' +\n                            i +\n                            \'" name="backdiffreason\' +\n                            i +\n                            \'" value="\' +\n                            row.實退差異原因 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.實退差異原因 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.loc"\n                    ),\n                    field: "儲位",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="location\' +\n                            i +\n                            \'" name="location\' +\n                            i +\n                            \'" value="\' +\n                            row.儲位 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.儲位 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.receivepeople"\n                    ),\n                    field: "收料人員",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="receivepeople\' +\n                            i +\n                            \'" name="receivepeople\' +\n                            i +\n                            \'" value="\' +\n                            row.收料人員 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.收料人員 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.receivepeoplenum"\n                    ),\n                    field: "收料人員工號",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="receivepeoplenum\' +\n                            i +\n                            \'" name="receivepeoplenum\' +\n                            i +\n                            \'" value="\' +\n                            row.收料人員工號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.收料人員工號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.backpeople"\n                    ),\n                    field: "退料人員",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="backpeople\' +\n                            i +\n                            \'" name="backpeople\' +\n                            i +\n                            \'" value="\' +\n                            row.退料人員 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.退料人員 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.backpeoplenum"\n                    ),\n                    field: "退料人員工號",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="backpeoplenum\' +\n                            i +\n                            \'" name="backpeoplenum\' +\n                            i +\n                            \'" value="\' +\n                            row.退料人員工號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.退料人員工號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.backlistnum"\n                    ),\n                    field: "退料單號",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="backlistnum\' +\n                            i +\n                            \'" name="backlistnum\' +\n                            i +\n                            \'" value="\' +\n                            row.退料單號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.退料單號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.opentime"\n                    ),\n                    field: "開單時間",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="opentime\' +\n                            i +\n                            \'" name="opentime\' +\n                            i +\n                            \'" value="\' +\n                            row.開單時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.開單時間 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.inboundtime"\n                    ),\n                    field: "入庫時間",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="inboundtime\' +\n                            i +\n                            \'" name="inboundtime\' +\n                            i +\n                            \'" value="\' +\n                            row.入庫時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.入庫時間 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.status"\n                    ),\n                    field: "功能狀況",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="status\' +\n                            i +\n                            \'" name="status\' +\n                            i +\n                            \'" value="\' +\n                            row.功能狀況 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.功能狀況 +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            console.log(rowsKey);\n        };\n        return {\n            searchTerm,\n            table,\n            updateCheckedRows,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},9780:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-fd2c4972] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/OutboundPickrecordTable.vue"],names:[],mappings:"AAshBA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="row" style="text-align: left">\n        <div class="col col-auto">\n            <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n        </div>\n        <div class="col col-3 p-0 m-0">\n            <input id="pnInput" class="text-center form-control form-control-lg"\n                v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n        </div>\n    </div>\n    <div class="w-100" style="height: 1ch"></div>\n    \x3c!-- </div>breaks cols to a new line--\x3e\n    <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="false" :isLoading="table.isLoading"\n        :messages="table.messages" :columns="table.columns" :rows="table.rows" :total="table.totalRecordCount"\n        :page-options="table.pageOptions" :sortable="table.sortable" @is-finished="table.isLoading = false"\n        @return-checked-rows="updateCheckedRows"></table-lite>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport TableLite from "./TableLite.vue";\nimport useOutboundPickrecord from "../../composables/OutboundPickRecordSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        const { mats, getMats } = useOutboundPickrecord(); // axios get the mats data\n\n        onBeforeMount(getMats);\n        const searchTerm = ref(""); // Search text\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        // pour the data in\n        const data = reactive([]);\n        // const senders = reactive([]); // access the value by senders[0], senders[1] ...\n\n        watch(mats, () => {\n            console.log(JSON.parse(mats.value)); // test\n            let allRowsObj = JSON.parse(mats.value);\n            //console.log(allRowsObj.datas.length);\n            for (let i = 0; i < allRowsObj.datas.length; i++) {\n                data.push(allRowsObj.datas[i]);\n            } // for\n\n            document.getElementById("QueryFlag").click();\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="number\' +\n                            i +\n                            \'" name="number\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.usereason"\n                    ),\n                    field: "領用原因",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="usereason\' +\n                            i +\n                            \'" name="usereason\' +\n                            i +\n                            \'" value="\' +\n                            row.領用原因 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.領用原因 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.line"\n                    ),\n                    field: "線別",\n                    width: "8ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="line\' +\n                            i +\n                            \'" name="line\' +\n                            i +\n                            \'" value="\' +\n                            row.線別 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.線別 +\n                            "</div>"\n                        );\n                    },\n                },\n\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.format"\n                    ),\n                    field: "規格",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="format\' +\n                            i +\n                            \'" name="format\' +\n                            i +\n                            \'" value="\' +\n                            row.規格 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.規格 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.pickamount"\n                    ),\n                    field: "預領數量",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="pickamount\' +\n                            i +\n                            \'" name="pickamount\' +\n                            i +\n                            \'" value="\' +\n                            row.預領數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.預領數量 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.realpickamount"\n                    ),\n                    field: "實際領用數量",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="realpickamount\' +\n                            i +\n                            \'" name="realpickamount\' +\n                            i +\n                            \'" value="\' +\n                            row.實際領用數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.實際領用數量 + \'&nbsp;<small>\' + row.單位 + \'</small>\' +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.mark"\n                    ),\n                    field: "備註",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.備註 === null) row.備註 = "";\n                        return (\n                            \'<input type="hidden" id="remark\' +\n                            i +\n                            \'" name="remark\' +\n                            i +\n                            \'" value="\' +\n                            row.備註 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.備註 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.diffreason"\n                    ),\n                    field: "實領差異原因",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.實領差異原因 === null) row.實領差異原因 = "";\n                        return (\n                            \'<input type="hidden" id="diffreason\' +\n                            i +\n                            \'" name="diffreason\' +\n                            i +\n                            \'" value="\' +\n                            row.實領差異原因 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.實領差異原因 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.loc"\n                    ),\n                    field: "儲位",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="location\' +\n                            i +\n                            \'" name="location\' +\n                            i +\n                            \'" value="\' +\n                            row.儲位 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.儲位 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.pickpeople"\n                    ),\n                    field: "領料人員",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="pickpeople\' +\n                            i +\n                            \'" name="pickpeople\' +\n                            i +\n                            \'" value="\' +\n                            row.領料人員 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.領料人員 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.pickpeoplenum"\n                    ),\n                    field: "領料人員工號",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="pickpeoplenum\' +\n                            i +\n                            \'" name="pickpeoplenum\' +\n                            i +\n                            \'" value="\' +\n                            row.領料人員工號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.領料人員工號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.sendpeople"\n                    ),\n                    field: "發料人員",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="sendpeople\' +\n                            i +\n                            \'" name="sendpeople\' +\n                            i +\n                            \'" value="\' +\n                            row.發料人員 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.發料人員 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.sendpeoplenum"\n                    ),\n                    field: "發料人員工號",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="sendpeoplenum\' +\n                            i +\n                            \'" name="sendpeoplenum\' +\n                            i +\n                            \'" value="\' +\n                            row.發料人員工號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.發料人員工號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.picklistnum"\n                    ),\n                    field: "領料單號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="picklist\' +\n                            i +\n                            \'" name="picklist\' +\n                            i +\n                            \'" value="\' +\n                            row.領料單號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.領料單號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.opentime"\n                    ),\n                    field: "開單時間",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="opentime\' +\n                            i +\n                            \'" name="opentime\' +\n                            i +\n                            \'" value="\' +\n                            row.開單時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.開單時間 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "outboundpageLang.outboundtime"\n                    ),\n                    field: "出庫時間",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="outboundtime\' +\n                            i +\n                            \'" name="outboundtime\' +\n                            i +\n                            \'" value="\' +\n                            row.出庫時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.出庫時間 +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            console.log(rowsKey);\n        };\n        return {\n            searchTerm,\n            table,\n            updateCheckedRows,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},9120:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-5f859c9f] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/SxbSearchTable.vue"],names:[],mappings:"AAkqBA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="row justify-content-between">\n        <div class="row col col-auto">\n            <div class="col col-auto">\n                <label for="sxbInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n            </div>\n            <div class="col col-auto p-0 m-0">\n                <input id="sxbInput" class="text-center form-control form-control-lg"\n                    v-bind:placeholder="$t(\'monthlyPRpageLang.entersxb\')" v-model="searchTerm" />\n            </div>\n        </div>\n        <div class="col col-auto">\n            <button id="download" name="download" class="col col-auto btn btn-lg btn-success"\n                :value="$t(\'monthlyPRpageLang.download\')" @click="OutputExcelClick(\'All\')">\n                <i class="bi bi-file-earmark-arrow-down-fill fs-4"></i>\n            </button>\n        </div>\n    </div>\n    <div class="w-100" style="height: 1ch"></div>\n    \x3c!-- </div>breaks cols to a new line--\x3e\n    <table-lite :is-static-mode="true" :isSlotMode="true" :hasCheckbox="false" :messages="table.messages"\n        :columns="table.columns" :rows="table.rows" :total="table.totalRecordCount" :page-options="table.pageOptions"\n        :sortable="table.sortable" :is-fixed-first-column="false">\n        <template v-slot:SXB單號="{ row, key }">\n            <div class="col col-auto align-items-center m-0 p-0">\n                <button @click="openSXBDetails(row.SXB單號)" type="button" data-bs-toggle="modal"\n                    data-bs-target="#detailTable" class="btn btn-outline-info btn-sm ms-1 my-0 px-1 py-0"\n                    style="border-radius: 20px;" :id="\'sxb\' + row.id" :name="\'sxb\' + key">More</button>\n            </div>\n        </template>\n        <template v-slot:狀態="{ row, key }">\n            <div class="col col-auto align-items-center m-0 p-0">\n                <a v-if="row.狀態 === \'未簽核\'" @click="openSXBDetails(row.SXB單號)" data-bs-toggle="modal"\n                    data-bs-target="#detailTable" class="m-0 p-0" style="color: #dca120;">\n                    {{ $t("monthlyPRpageLang.review_pending") }}\n                </a>\n                <a v-else-if="row.狀態 === \'已退單\'" @click="openSXBDetails(row.SXB單號)" data-bs-toggle="modal"\n                    data-bs-target="#detailTable" class="m-0 p-0" style="color: #808080;">\n                    {{ $t("monthlyPRpageLang.review_cancel") }}\n                </a>\n                <a v-else class="m-0 p-0" @click="openSXBDetails(row.SXB單號)" data-bs-toggle="modal"\n                    data-bs-target="#detailTable" style="color: #2bb91b;">\n                    {{ $t("monthlyPRpageLang.review_complete") }}\n                </a>\n            </div>\n        </template>\n    </table-lite>\n\n    \x3c!-- Modal --\x3e\n    <div class="modal fade" id="detailTable" tabindex="-1" aria-labelledby="detailTable" aria-hidden="true">\n        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">\n            <div class="modal-content">\n                <div class="modal-header justify-content-center">\n                    <h1 class="col col-auto modal-title m-0 p-0 fs-4">\n                        {{ modalTitle }}\n                    </h1>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n                    <div class="row justify-content-between">\n                        <div class="row col col-auto">\n                            <div class="col col-auto">\n                                <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }}\n                                    :</label>\n                            </div>\n                            <div class="col col-auto p-0 m-0">\n                                <input id="pnInput" class="text-center form-control form-control-lg"\n                                    v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')"\n                                    v-model="searchTerm2" />\n                            </div>\n                        </div>\n                        <div class="col col-auto">\n                            <button id="download" name="download" class="col col-auto btn btn-lg btn-success"\n                                :value="$t(\'monthlyPRpageLang.download\')" @click="OutputExcelClick(modalTitle)">\n                                <i class="bi bi-file-earmark-arrow-down-fill fs-4"></i>\n                            </button>\n                        </div>\n                    </div>\n                    <div class="w-100" style="height: 1ch"></div>\n                    \x3c!-- </div>breaks cols to a new line--\x3e\n                    <table-lite :is-static-mode="true" :isSlotMode="true" :hasCheckbox="false"\n                        :messages="table2.messages" :columns="table2.columns" :rows="table2.rows"\n                        :total="table2.totalRecordCount" :page-options="table2.pageOptions" :sortable="table2.sortable"\n                        :is-fixed-first-column="false" @row-clicked="rowClicked">\n                    </table-lite>\n                </div>\n                <div v-if="showFooter" class="modal-footer justify-content-between">\n                    <button @click="sxb_reject" type="button" class="btn btn-lg btn-danger" style="border-radius: 5px;">\n                        {{ $t(\'monthlyPRpageLang.review_cancel\') }}\n                    </button>\n                    <button @click="sxb_approve" type="button" class="btn btn-lg btn-success"\n                        style="border-radius: 5px;">\n                        {{ $t(\'monthlyPRpageLang.review_complete\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useSxbSearch from "../../composables/SxbSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        const { mats_SXB, inTransit, getMats, SXB_Reject, SXB_Approve, getTransit } = useSxbSearch(); // axios get the mats_SXB data\n\n        onBeforeMount(getMats);\n\n        const searchTerm = ref(""); // Search text\n        const searchTerm2 = ref(""); // Search text for modal table\n        const modalTitle = ref("");\n        let showFooter = ref(false);\n        let AllRecords = [];\n\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        // pour the data in\n        const data = reactive([]);\n        const data2 = reactive([]);\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const OutputExcelClick = async (output_range) => {\n            await triggerModal();\n\n            // get today\'s date for filename\n            let today = new Date();\n            let dd = String(today.getDate()).padStart(2, \'0\');\n            let mm = String(today.getMonth() + 1).padStart(2, \'0\'); //January is 0!\n            let yyyy = today.getFullYear();\n            today = yyyy + "_" + mm + \'_\' + dd;\n\n            if (output_range === \'All\') {\n                let rows = Array();\n                for (let i = 0; i < AllRecords.length; i++) {\n                    let tempObj = new Object;\n                    tempObj.單號 = AllRecords[i].SXB單號;\n                    tempObj.料號 = AllRecords[i].料號;\n                    tempObj.品名 = AllRecords[i].品名;\n                    tempObj.MOQ = AllRecords[i].MOQ;\n                    tempObj.本次請購數量 = AllRecords[i].本次請購數量;\n                    tempObj.總價 = parseFloat(AllRecords[i].請購金額).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",") + " " + AllRecords[i].幣別;\n                    tempObj.請購時間 = AllRecords[i].請購時間;\n\n                    rows.push(tempObj);\n                } // for\n\n                const worksheet = XLSX.utils.json_to_sheet(rows);\n                const workbook = XLSX.utils.book_new();\n                XLSX.utils.book_append_sheet(workbook, worksheet, \'ALL\');\n                XLSX.writeFile(workbook,\n                    app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.SXB_search"\n                    ) + "(ALL)_" + today + ".xlsx", { compression: true });\n            } else {\n                let rows = Array();\n                for (let i = 0; i < data2.length; i++) {\n                    let tempObj = new Object;\n                    tempObj.單號 = data2[i].SXB單號;\n                    tempObj.料號 = data2[i].料號;\n                    tempObj.品名 = data2[i].品名;\n                    tempObj.MOQ = data2[i].MOQ;\n                    tempObj.本次請購數量 = data2[i].本次請購數量;\n                    tempObj.總價 = parseFloat(data2[i].請購金額).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",") + " " + data2[i].幣別;\n                    tempObj.請購時間 = data2[i].請購時間;\n\n                    rows.push(tempObj);\n                } // for\n\n                const worksheet = XLSX.utils.json_to_sheet(rows);\n                const workbook = XLSX.utils.book_new();\n                XLSX.utils.book_append_sheet(workbook, worksheet, data2[0].SXB單號);\n                XLSX.writeFile(workbook,\n                    app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.SXB_search"\n                    ) + "(" + data2[0].SXB單號 + ")_" + today + ".xlsx", { compression: true });\n            } // if else\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // OutputExcelClick\n\n        const openSXBDetails = (SXB) => {\n            // console.log("clicked!"); // test\n            modalTitle.value = SXB;\n            data2.splice(0);\n            for (let i = 0; i < AllRecords.length; i++) {\n                if (AllRecords[i].SXB單號 === SXB) {\n                    data2.push(AllRecords[i]);\n                } // if\n            } // for\n\n            if (data2[0].狀態 === \'未簽核\') {\n                showFooter.value = true;\n            } // if\n            else {\n                showFooter.value = false;\n            } // else\n        } // openSXBDetails\n\n        const sxb_reject = async () => {\n            await triggerModal();\n            let result = await SXB_Reject(data2[0].SXB單號);\n            if (result === "success") {\n                showFooter.value = false;\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                await getMats();\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // sxb_reject\n\n        const sxb_approve = async () => {\n            await triggerModal();\n            let temp_isn = [];\n            for (let i = 0; i < data2.length; i++) {\n                temp_isn.push(data2[i].料號);\n            } // for\n\n            await getTransit(temp_isn); // get existing in-transit data\n            let existing = JSON.parse(inTransit.value).data;\n            // console.log(existing); // test\n            // return ; // test\n            let isn = [];\n            let amount = [];\n            for (let i = 0; i < data2.length; i++) {\n                isn.push(data2[i].料號);\n\n                let indexOfObject = existing.findIndex(object => {\n                    return (object.料號 === data2[i].料號);\n                });\n\n                if (indexOfObject === -1) {\n                    amount.push(parseInt(data2[i].本次請購數量));\n                } // if\n                else {\n                    amount.push(parseInt(data2[i].本次請購數量) + parseInt(existing[indexOfObject].請購數量));\n                } // else\n            } // for\n\n            // console.log(amount, isn); // test\n\n            let result = await SXB_Approve(data2[0].SXB單號, isn, amount);\n            if (result === "success") {\n                showFooter.value = false;\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                await getMats();\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // sxb_approve\n\n        watch(mats_SXB, async () => {\n            await triggerModal();\n\n            // console.log(JSON.parse(mats_SXB.value)); // test\n            let allRowsObj = JSON.parse(mats_SXB.value);\n            data.splice(0);\n            AllRecords = [];\n            // console.log(allRowsObj.datas); // test\n            for (let i = 0; i < allRowsObj.datas.length; i++) {\n                allRowsObj.datas[i].本次請購數量 = parseInt(\n                    allRowsObj.datas[i].本次請購數量\n                );\n\n                allRowsObj.datas[i].狀態 = allRowsObj.datas[i].SRM單號;\n                allRowsObj.datas[i].id = i + 1;\n                AllRecords.push(allRowsObj.datas[i]);\n                let indexOfObject = data.findIndex(object => {\n                    return (object.SXB單號 === allRowsObj.datas[i].SXB單號);\n                });\n\n                if (indexOfObject === -1) {\n                    data.push(allRowsObj.datas[i]);\n                } // if\n            } // for\n\n            // console.log(allRowsObj.datas); // test\n            // console.log(AllRecords); // test\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buytime"\n                    ),\n                    field: "請購時間",\n                    width: "15ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        let returnStr = "";\n                        // console.log(row); // test\n                        returnStr =\n                            \'<input type="hidden" id="srm\' +\n                            i +\n                            \'" name="srm\' +\n                            i +\n                            \'" value="\' +\n                            row.請購時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.請購時間 +\n                            "</div>";\n\n                        return returnStr;\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.status"\n                    ),\n                    field: "狀態",\n                    width: "6ch",\n                    sortable: true,\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.info"\n                    ),\n                    field: "SXB單號",\n                    width: "4ch",\n                    sortable: false,\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.SXB單號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase())\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const table2 = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    isKey: true,\n                    display: function (row, i) {\n                        // console.log(row);\n                        return (\n                            \'<input type="hidden" id="number\' +\n                            row.id +\n                            \'" name="number\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.pName"\n                    ),\n                    field: "品名",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.moq"\n                    ),\n                    field: "MOQ",\n                    width: "8ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="moq\' +\n                            row.id +\n                            \'" name="moq\' +\n                            i +\n                            \'" value="\' +\n                            row.MOQ +\n                            \'">\' +\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.MOQ + " <small>" + row.單位 + "</small>" +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buyamount"\n                    ),\n                    field: "本次請購數量",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="buyamount\' +\n                            row.id +\n                            \'" name="buyamount\' +\n                            i +\n                            \'" value="\' +\n                            row.本次請購數量 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseInt(row.本次請購數量).toLocaleString("en-US") +\n                            " <small>" + row.單位 + "</small>" + "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.buyprice"\n                    ),\n                    field: "請購金額",\n                    width: "11ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="buyprice\' +\n                            row.id +\n                            \'" name="buyprice\' +\n                            i +\n                            \'" value="\' +\n                            row.請購金額 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            parseFloat(row.請購金額).toFixed(2).replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, ",") +\n                            " <small>" + row.幣別 + "</small>" +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data2.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm2.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm2.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table2.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        /**\n        * Row clicked event\n        */\n        const rowClicked = (row) => {\n            // console.log("Row clicked!", row);\n        };\n\n        return {\n            searchTerm,\n            searchTerm2,\n            table,\n            table2,\n            modalTitle,\n            showFooter,\n            rowClicked,\n            openSXBDetails,\n            sxb_approve,\n            sxb_reject,\n            OutputExcelClick,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},7762:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,'.vtl-checkbox-td[data-v-1c4b483e],.vtl-checkbox-th[data-v-1c4b483e]{min-width:38px;width:3.5ch}.vtl-both[data-v-1c4b483e]{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAQAAADYWf5HAAAAkElEQVQoz7X QMQ5AQBCF4dWQSJxC5wwax1Cq1e7BAdxD5SL+Tq/QCM1oNiJidwox0355mXnG/DrEtIQ6azioNZQxI0ykPhTQIwhCR+BmBYtlK7kLJYwWCcJA9M4qdrZrd8pPjZWPtOqdRQy320YSV17OatFC4euts6z39GYMKRPCTKY9UnPQ6P+GtMRfGtPnBCiqhAeJPmkqAAAAAElFTkSuQmCC")}.vtl-sortable[data-v-1c4b483e]{background-position:100%;background-repeat:no-repeat;cursor:pointer}.vtl-asc[data-v-1c4b483e]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAZ0lEQVQ4y2NgGLKgquEuFxBPAGI2ahhWCsS/gDibUoO0gPgxEP8H4ttArEyuQYxAPBdqEAxPBImTY5gjEL9DM+wTENuQahAvEO9DMwiGdwAxOymGJQLxTyD+jgWDxCMZRsEoGAVoAADeemwtPcZI2wAAAABJRU5ErkJggg==)}.vtl-desc[data-v-1c4b483e]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAZUlEQVQ4y2NgGAWjYBSggaqGu5FA/BOIv2PBIPFEUgxjB+IdQPwfC94HxLykus4GiD+hGfQOiB3J8SojEE9EM2wuSJzcsFMG4ttQgx4DsRalkZENxL+AuJQaMcsGxBOAmGvopk8AVz1sLZgg0bsAAAAASUVORK5CYII=)}.vtl-loading-mask[data-v-1c4b483e]{background-color:rgba(0,0,0,.5);display:flex;flex-flow:column;height:100%;left:0;position:absolute;top:0;transition:opacity .3s ease;width:100%;z-index:3}.vtl-loading-content[data-v-1c4b483e]{align-items:center;display:flex;flex:1;justify-content:center}.vtl-card[data-v-1c4b483e]{word-wrap:break-word;background-clip:border-box;display:flex;flex-direction:column;min-width:0;position:relative}.vtl-card[data-v-1c4b483e],select[data-v-1c4b483e]{background-color:#fff}select[data-v-1c4b483e]{border:1px solid #ccc;height:auto;margin-bottom:0;padding:0;width:auto}table[data-v-1c4b483e]{table-layout:fixed!important}div.dataTables_wrapper div.dataTables_paginate[data-v-1c4b483e]{margin:0;text-align:right;white-space:nowrap}div.dataTables_wrapper div.dataTables_paginate ul.pagination[data-v-1c4b483e]{justify-content:flex-end;margin:2px 0;white-space:nowrap}.pagination[data-v-1c4b483e]{display:flex;list-style:none;padding-left:0}.pagination a[data-v-1c4b483e]:hover:not(.disabled){background-color:#ddd;border-radius:5px}.vtl-table[data-v-1c4b483e]{border-collapse:collapse;color:#212529;margin-bottom:1rem;width:100%}th[data-v-1c4b483e]{text-align:inherit}tr[data-v-1c4b483e]{border-color:inherit;display:table-row;vertical-align:inherit}.vtl-table-bordered thead td[data-v-1c4b483e],.vtl-table-bordered thead th[data-v-1c4b483e]{border-bottom-width:2px}.vtl-table thead th[data-v-1c4b483e]{background-color:#343a40;border-color:#454d55;border-bottom:2px solid #dee2e6;color:#fff;vertical-align:bottom}.vtl-table-bordered td[data-v-1c4b483e],.vtl-table-bordered th[data-v-1c4b483e]{border:1px solid #dee2e6}.vtl-table td[data-v-1c4b483e],.vtl-table th[data-v-1c4b483e]{border-top:1px solid #dee2e6;padding:.75rem;vertical-align:top;vertical-align:middle}.vtl-table-responsive[data-v-1c4b483e]{-webkit-overflow-scrolling:touch;display:block;overflow-x:auto;width:100%}.vtl-table-responsive>.vtl-table-bordered[data-v-1c4b483e]{border:0}.vtl-row[data-v-1c4b483e]{display:flex;flex-wrap:wrap}.vtl-pagination[data-v-1c4b483e]{border-radius:.25rem;display:flex;justify-content:flex-end;list-style:none;margin:2px 0;padding-left:0;white-space:nowrap}.page-item.disabled .page-link[data-v-1c4b483e]{background-color:#fff;border-color:#dee2e6;color:#6c757d;cursor:auto;pointer-events:none}.page-item:first-child .page-link[data-v-1c4b483e]{border-bottom-left-radius:.25rem;border-top-left-radius:.25rem;margin-left:0}.page-link[data-v-1c4b483e]{background-color:#fff;color:#000;display:block;line-height:1.25;margin-left:-1px;padding:.5rem .75rem;position:relative}.sr-only[data-v-1c4b483e]{clip:rect(0,0,0,0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}*[data-v-1c4b483e],[data-v-1c4b483e]:after,[data-v-1c4b483e]:before{box-sizing:border-box}.col-sm-12[data-v-1c4b483e]{flex:0 0 100%;max-width:100%}.text-center[data-v-1c4b483e]{text-align:center}@media (min-width:576px){.vtl-table-responsive-sm[data-v-1c4b483e]{-webkit-overflow-scrolling:touch;display:block;overflow-x:auto;width:100%}.vtl-table-responsive-sm>.table-bordered[data-v-1c4b483e]{border:0}.col-md-4[data-v-1c4b483e]{flex:0 0 33.333333%;max-width:33.333333%}}.vtl-table thead th[data-v-1c4b483e]{position:sticky;top:0;z-index:1}.vtl-table tbody th[data-v-1c4b483e]{left:0;position:sticky;z-index:1}.fixed-first-column[data-v-1c4b483e]{overflow-x:auto}.fixed-first-column tr th[data-v-1c4b483e]:first-child{left:0;position:sticky;z-index:2}.fixed-first-column tr td[data-v-1c4b483e]:first-child{left:0;position:sticky}.fixed-first-column tr .vtl-checkbox-th[data-v-1c4b483e]:first-child:before,.fixed-first-column tr th[data-v-1c4b483e]:first-child:before,.fixed-first-second-column tr th[data-v-1c4b483e]:nth-child(2):before{border-right:1px solid #454d55;content:"";height:102%;left:0;position:absolute;top:0;width:102%}.fixed-first-column tr td[data-v-1c4b483e]:first-child:before{border-right:1px solid #dee2e6;content:"";height:102%;left:0;position:absolute;top:0;width:102%}.fixed-first-column tr .vtl-checkbox-td[data-v-1c4b483e]:first-child:before{border-right:1px solid #dee2e6;content:"";height:102%;left:0;position:absolute;top:0;width:103%}.fixed-first-second-column tr td[data-v-1c4b483e]:nth-child(2),.fixed-first-second-column tr th[data-v-1c4b483e]:nth-child(2){left:38px;position:sticky}.fixed-first-second-column tr th[data-v-1c4b483e]:nth-child(2){z-index:2}.fixed-first-column tr td[data-v-1c4b483e]:first-child,.fixed-first-second-column tr td[data-v-1c4b483e]:nth-child(2){background-color:#fff}.flex[data-v-1c4b483e]{display:flex}.animation[data-v-1c4b483e]{transform:rotate(0deg);transition:transform .3s}.cursor-pointer[data-v-1c4b483e]{cursor:pointer}.rotated-90[data-v-1c4b483e]{transform:rotate(-90deg)}.hidden[data-v-1c4b483e]{display:none}.ml-2[data-v-1c4b483e]{margin-left:.5rem}td[data-v-1c4b483e]{text-align:center}',"",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/TableLite.vue"],names:[],mappings:"AA68BA,oEAEE,cAAe,CADf,WAEF,CAEA,2BACE,2TACF,CAEA,+BAEE,wBAA0B,CAC1B,2BAA4B,CAF5B,cAIF,CAEA,0BACE,oQACF,CAEA,2BACE,gQACF,CAEA,mCAOE,+BAAoC,CACpC,YAAa,CACb,gBAAiB,CAHjB,WAAY,CAFZ,MAAO,CAHP,iBAAkB,CAElB,KAAM,CAON,2BAA6B,CAL7B,UAAW,CAHX,SASF,CAEA,sCAGE,kBAAmB,CADnB,YAAa,CADb,MAAO,CAGP,sBACF,CAEA,2BAOE,oBAAqB,CAErB,0BAA2B,CAN3B,YAAa,CAEb,qBAAsB,CACtB,WAAY,CALZ,iBASF,CAEA,mDAJE,qBAWF,CAPA,wBAEE,qBAAyB,CAEzB,WAAY,CAEZ,eAAgB,CADhB,SAAU,CAJV,UAMF,CAEA,uBACE,4BACF,CAEA,gEACE,QAAS,CAET,gBAAiB,CADjB,kBAEF,CAEA,8EAGE,wBAAyB,CAFzB,YAAa,CACb,kBAEF,CAEA,6BACE,YAAa,CAEb,eAAgB,CADhB,cAEF,CAEA,oDACE,qBAAsB,CACtB,iBACF,CAEA,4BAIE,wBAAyB,CADzB,aAAc,CADd,kBAAmB,CADnB,UAIF,CAEA,oBACE,kBACF,CAEA,oBAGE,oBAAqB,CAFrB,iBAAkB,CAClB,sBAEF,CAEA,4FAEE,uBACF,CAEA,qCAGE,wBAAyB,CACzB,oBAAqB,CACrB,+BAAgC,CAHhC,UAAW,CADX,qBAKF,CAEA,gFAEE,wBACF,CAEA,8DAIE,4BAA6B,CAF7B,cAAgB,CAChB,kBAAmB,CAEnB,qBACF,CAEA,uCAIE,gCAAiC,CAHjC,aAAc,CAEd,eAAgB,CADhB,UAGF,CAEA,2DACE,QACF,CAEA,0BAEE,YAAa,CAEb,cACF,CAEA,iCAQE,oBAAsB,CAHtB,YAAa,CAFb,wBAAyB,CAIzB,eAAgB,CANhB,YAAa,CAKb,cAAe,CAJf,kBAOF,CAEA,gDAIE,qBAAsB,CACtB,oBAAqB,CAJrB,aAAc,CAEd,WAAY,CADZ,mBAIF,CAEA,mDAGE,gCAAkC,CADlC,6BAA+B,CAD/B,aAGF,CAEA,4BAOE,qBAAsB,CADtB,UAAc,CAJd,aAAc,CAGd,gBAAiB,CADjB,gBAAiB,CADjB,oBAAuB,CAFvB,iBAOF,CAEA,0BAOE,kBAAsB,CAEtB,QAAS,CANT,UAAW,CAEX,WAAY,CACZ,eAAgB,CAFhB,SAAU,CAHV,iBAAkB,CAOlB,kBAAmB,CANnB,SAQF,CAEA,oEAGE,qBACF,CAEA,4BAEE,aAAc,CACd,cACF,CAEA,8BACE,iBACF,CAEA,yBACE,0CAIE,gCAAiC,CAHjC,aAAc,CAEd,eAAgB,CADhB,UAGF,CAEA,0DACE,QACF,CAEA,2BAEE,mBAAoB,CACpB,oBACF,CACF,CAEA,qCACE,eAAgB,CAChB,KAAM,CACN,SACF,CAEA,qCAEE,MAAO,CADP,eAAgB,CAEhB,SACF,CAEA,qCACE,eACF,CAEA,uDAEE,MAAO,CADP,eAAgB,CAEhB,SACF,CAEA,uDAEE,MAAO,CADP,eAEF,CAcA,gNAPE,8BAA+B,CAF/B,UAAW,CAMX,WAAY,CAHZ,MAAO,CAFP,iBAAkB,CAGlB,KAAM,CACN,UAYF,CAEA,8DAGE,8BAA+B,CAF/B,UAAW,CAMX,WAAY,CAHZ,MAAO,CAFP,iBAAkB,CAGlB,KAAM,CACN,UAEF,CAEA,4EAGE,8BAA+B,CAF/B,UAAW,CAMX,WAAY,CAHZ,MAAO,CAFP,iBAAkB,CAGlB,KAAM,CACN,UAEF,CAEA,8HAGE,SAAU,CADV,eAEF,CAEA,+DACE,SACF,CAEA,sHAEE,qBACF,CAEA,uBACE,YACF,CAEA,4BACE,sBAAuB,CACvB,wBACF,CAEA,iCACE,cACF,CAEA,6BACE,wBACF,CAEA,yBACE,YACF,CAEA,uBACE,iBACF,CAEA,oBACE,iBACF",sourcesContent:['<template>\n  <div class="vtl vtl-card p-2">\n    <div class="vtl-card-title" v-if="title">{{ title }}</div>\n    <div class="vtl-card-body">\n      <div class="vtl-row">\n        <div class="col-sm-12 dataTables_wrapper CustomScrollbar" :class="{\n          \'fixed-first-column\': isFixedFirstColumn,\n          \'fixed-first-second-column\': isFixedFirstColumn && hasCheckbox,\n        }">\n          <div v-if="isLoading" class="vtl-loading-mask">\n            <div class="vtl-loading-content">\n              <span style="color: white">Loading...</span>\n            </div>\n          </div>\n          <table\n            class="vtl-table vtl-table-bordered table table-hover align-items-center align-middle text-center justify-content-center"\n            ref="localTable" :style="\'max-height: \' + maxHeight + \'px;\'">\n            <thead class="vtl-thead">\n              <tr class="vtl-thead-tr m-0 p-0">\n                <th v-if="hasCheckbox" class="vtl-thead-th vtl-checkbox-th m-0 p-0 align-items-center align-middle"\n                  @click="clickChild($event)">\n                  <input type="checkbox" class="vtl-thead-checkbox" v-model="setting.isCheckAll" />\n                </th>\n                <th v-for="(col, index) in columns" class="vtl-thead-th m-0 p-0" :class="col.headerClasses" :key="index"\n                  :style="Object.assign(\n                    {\n                      width: col.width ? col.width : \'auto\',\n                    },\n                    col.headerStyles\n                  )\n                    " @click="clickChild($event)">\n                  <div class="vtl-thead-column" :class="{\n                    \'vtl-sortable\': col.sortable,\n                    \'vtl-both\': col.sortable,\n                    \'vtl-asc\':\n                      setting.order === col.field && setting.sort === \'asc\',\n                    \'vtl-desc\':\n                      setting.order === col.field && setting.sort === \'desc\',\n                  }" @click.prevent="col.sortable ? doSort(col.field) : false" v-html="col.label">\n                  </div>\n                </th>\n              </tr>\n            </thead>\n            <template v-if="rows.length > 0">\n              <tbody v-if="isStaticMode" class="vtl-tbody"\n                :set="(templateRows = groupingKey == \'\' ? [localRows] : localRows)">\n                <template v-for="(rows, groupingIndex) in templateRows">\n                  <tr :key="groupingIndex" v-if="groupingKey != \'\'" class="vtl-tbody-tr vtl-group-tr m-0 p-0">\n                    <td :colspan="hasCheckbox ? 2 : 1" class="vtl-tbody-td vtl-group-td m-0 p-0">\n                      <div class="flex">\n                        <div v-if="hasGroupToggle" class="animation">\n                          <a :ref="(el) => (toggleButtonRefs[groupingIndex] = el)" class="cursor-pointer"\n                            style="text-decoration: none; /* no underline */"\n                            @click.prevent="toggleGroup(groupingIndex)">▼</a>\n                        </div>\n                        <div class="ml-2" v-html="groupingDisplay ? groupingDisplay(groupingIndex) : groupingIndex"></div>\n                      </div>\n                    </td>\n                  </tr>\n                  <tr v-for="(row, i) in rows" :key="row[setting.keyColumn] ? row[setting.keyColumn] : i" :ref="(el) => {\n                    if (!groupingRowsRefs[groupingIndex]) {\n                      groupingRowsRefs[groupingIndex] = [];\n                    }\n                    groupingRowsRefs[groupingIndex][i] = el;\n                  }" :name="\'vtl-group-\' + groupingIndex" class="vtl-tbody-tr m-0 p-0"\n                    :class="typeof rowClasses === \'function\' ? rowClasses(row) : rowClasses"\n                    @click="$emit(\'row-clicked\', row)">\n                    <td v-if="hasCheckbox" class="vtl-tbody-td vtl-checkbox-td m-0 p-0" @click="clickChild($event)">\n                      <input type="checkbox" class="vtl-tbody-checkbox" :id="\'checkbox\' + i" @click="checked(row, $event)"\n                        :ref="(el) => { rowCheckbox.push(el); }" :value="row[setting.keyColumn]" />\n                    </td>\n                    <td v-for="(col, j) in columns" :key="j" class="vtl-tbody-td px-1 py-0"\n                      :class="[\'vtl-tbody-td\' + j].concat(col.columnClasses)" :style="col.columnStyles">\n                      <div v-if="col.display" v-html="col.display(row, i)"></div>\n                      <div v-else-if="col.hasInput" style="width: max-content; margin: 0 auto;"\n                        @change="$emit(\'row-input\', row, i)" v-html="col.hasInput(row, i)">\n                      </div>\n                      <div v-else style="width: max-content; margin: 0 auto;">\n                        <div v-if="setting.isSlotMode && slots[col.field]" style="width: max-content; margin: 0 auto;">\n                          <slot :name="col.field" :row="row" :key="i"></slot>\n                        </div>\n                        <span v-else>{{ row[col.field] }}</span>\n                      </div>\n                    </td>\n                  </tr>\n                </template>\n              </tbody>\n              <tbody v-else :set="(templateRows = groupingKey == \'\' ? [rows] : groupingRows)">\n                <template v-for="(rows, groupingIndex) in templateRows">\n                  <tr v-if="groupingKey != \'\'" class="vtl-tbody-tr vtl-group-tr m-0 p-0" :key="groupingIndex">\n                    <td :colspan="hasCheckbox ? columns.length + 1 : columns.length"\n                      class="vtl-tbody-td vtl-group-td m-0 p-0">\n                      <div class="flex">\n                        <div v-if="hasGroupToggle" class="animation">\n                          <a :ref="(el) => (toggleButtonRefs[groupingIndex] = el)" class="cursor-pointer"\n                            style="text-decoration: none; /* no underline */"\n                            @click.prevent="toggleGroup(groupingIndex)">▼</a>\n                        </div>\n                        <div class="ml-2" v-html="groupingDisplay\n                          ? groupingDisplay(groupingIndex)\n                          : groupingIndex\n                          "></div>\n                      </div>\n                    </td>\n                  </tr>\n                  <tr v-for="(row, i) in rows" :ref="(el) => {\n                    if (!groupingRowsRefs[groupingIndex]) {\n                      groupingRowsRefs[groupingIndex] = [];\n                    }\n                    groupingRowsRefs[groupingIndex][i] = el;\n                  }\n                    " :name="\'vtl-group-\' + groupingIndex" :key="row[setting.keyColumn] ? row[setting.keyColumn] : i"\n                    class="vtl-tbody-tr m-0 p-0" :class="typeof rowClasses === \'function\' ? rowClasses(row) : rowClasses"\n                    @click="$emit(\'row-clicked\', row)">\n                    <td v-if="hasCheckbox" class="vtl-tbody-td vtl-checkbox-td m-0 p-0" @click="clickChild($event)">\n                      <input type="checkbox" class="vtl-tbody-checkbox" :id="\'checkbox\' + i"\n                        :ref="(el) => { rowCheckbox.push(el); }" :value="row[setting.keyColumn]"\n                        @click="checked(row, $event)" />\n                    </td>\n                    <td v-for="(col, j) in columns" :key="j" class="vtl-tbody-td px-1 py-0"\n                      :class="[\'vtl-tbody-td\' + j].concat(col.columnClasses)" :style="col.columnStyles">\n                      <div v-if="col.display" v-html="col.display(row, i)"></div>\n                      <div v-else-if="col.hasInput" style="width: max-content; margin: 0 auto;"\n                        @change="$emit(\'row-input\', row, i)" v-html="col.hasInput(row, i)">\n                      </div>\n                      <div v-else style="width: max-content; margin: 0 auto;">\n                        <div v-if="setting.isSlotMode && slots[col.field]" style="width: max-content; margin: 0 auto;">\n                          <slot :name="col.field" :row="row" :key="i"></slot>\n                        </div>\n                        <span v-else>{{ row[col.field] }}</span>\n                      </div>\n                    </td>\n                  </tr>\n                </template>\n              </tbody>\n            </template>\n          </table>\n        </div>\n      </div>\n      <div class="vtl-paging vtl-row" v-if="rows.length > 0">\n        <template v-if="!setting.isHidePaging">\n          <div class="vtl-paging-info col col-auto p-0 m-0">\n            <div role="status" aria-live="polite">\n              {{\n                stringFormat(\n                  messages.pagingInfo,\n                  setting.offset,\n                  setting.limit,\n                  total\n                )\n              }}\n            </div>\n          </div>\n          <div class="w-100" style="height: 1ch;"></div>\n          \x3c!-- </div>breaks cols to a new line--\x3e\n          <div class="row w-100 justify-content-between align-items-center p-0 m-0">\n            <div class="vtl-paging-change-div col col-auto p-0 m-0">\n              <span class="vtl-paging-count-label col col-auto">{{\n                messages.pageSizeChangeLabel\n              }}</span>\n              <select class="vtl-paging-count-dropdown" v-model="setting.pageSize">\n                <option v-for="pageOption in pageOptions" :value="pageOption.value" :key="pageOption.value">\n                  {{ pageOption.text }}\n                </option>\n              </select>\n              &nbsp;&nbsp;\n              <span class="vtl-paging-page-label col col-auto">{{\n                messages.gotoPageLabel\n              }}</span>\n              <select class="vtl-paging-page-dropdown col col-auto" v-model="setting.page">\n                <option v-for="n in setting.maxPage" :key="n" :value="parseInt(n)">\n                  {{ n }}\n                </option>\n              </select>\n            </div>\n\n            <div class="\n                vtl-paging-pagination-div\n                align-items-center\n                col col-auto\n                p-0\n                m-0\n              ">\n              <div class="dataTables_paginate">\n                <ul class="vtl-paging-pagination-ul vtl-pagination p-0 m-0">\n                  <li class="\n                      vtl-paging-pagination-page-li\n                      vtl-paging-pagination-page-li-first\n                      page-item\n                    " :class="{ disabled: setting.page <= 1 }">\n                    <a class="\n                        vtl-paging-pagination-page-link\n                        vtl-paging-pagination-page-link-first\n                        page-link cursor-pointer\n                      " href="javascript:void(0)" aria-label="Previous" @click.prevent="setting.page = 1">\n                      <span aria-hidden="true">\n                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"\n                          class="bi bi-skip-start-fill" viewBox="0 0 16 16">\n                          <path\n                            d="M4 4a.5.5 0 0 1 1 0v3.248l6.267-3.636c.54-.313 1.232.066 1.232.696v7.384c0 .63-.692 1.01-1.232.697L5 8.753V12a.5.5 0 0 1-1 0V4z" />\n                        </svg>\n                      </span>\n                      <span class="sr-only">First</span>\n                    </a>\n                  </li>\n                  <li class="\n                      vtl-paging-pagination-page-li\n                      vtl-paging-pagination-page-li-prev\n                      page-item\n                    " :class="{ disabled: setting.page <= 1 }">\n                    <a class="\n                        vtl-paging-pagination-page-link\n                        vtl-paging-pagination-page-link-prev\n                        page-link cursor-pointer\n                      " href="javascript:void(0)" aria-label="Previous" @click.prevent="prevPage">\n                      <span aria-hidden="true">\n                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"\n                          class="bi bi-caret-left-fill" viewBox="0 0 16 16">\n                          <path\n                            d="m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z" />\n                        </svg>\n                      </span>\n                      <span class="sr-only">Prev</span>\n                    </a>\n                  </li>\n                  <li class="\n                      vtl-paging-pagination-page-li\n                      vtl-paging-pagination-page-li-number\n                      page-item\n                    " v-for="n in setting.paging" :key="n" :class="{ disabled: setting.page === n }">\n                    <a class="\n                        vtl-paging-pagination-page-link\n                        vtl-paging-pagination-page-link-number\n                        page-link cursor-pointer\n                      " href="javascript:void(0)" @click.prevent="movePage(n)">{{ n }}</a>\n                  </li>\n                  <li class="\n                      vtl-paging-pagination-page-li\n                      vtl-paging-pagination-page-li-next\n                      page-item\n                    " :class="{ disabled: setting.page >= setting.maxPage }">\n                    <a class="\n                        vtl-paging-pagination-page-link\n                        vtl-paging-pagination-page-link-next\n                        page-link cursor-pointer\n                      " href="javascript:void(0)" aria-label="Next" @click.prevent="nextPage">\n                      <span aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"\n                          fill="currentColor" class="bi bi-caret-right-fill" viewBox="0 0 16 16">\n                          <path\n                            d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z" />\n                        </svg>\n                      </span>\n                      <span class="sr-only">Next</span>\n                    </a>\n                  </li>\n                  <li class="\n                      vtl-paging-pagination-page-li\n                      vtl-paging-pagination-page-li-last\n                      page-item\n                    " :class="{ disabled: setting.page >= setting.maxPage }">\n                    <a class="\n                        vtl-paging-pagination-page-link\n                        vtl-paging-pagination-page-link-last\n                        page-link cursor-pointer\n                      " href="javascript:void(0)" aria-label="Next" @click.prevent="setting.page = setting.maxPage">\n                      <span aria-hidden="true">\n                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"\n                          class="bi bi-skip-end-fill" viewBox="0 0 16 16">\n                          <path\n                            d="M12.5 4a.5.5 0 0 0-1 0v3.248L5.233 3.612C4.693 3.3 4 3.678 4 4.308v7.384c0 .63.692 1.01 1.233.697L11.5 8.753V12a.5.5 0 0 0 1 0V4z" />\n                        </svg>\n                      </span>\n                      <span class="sr-only">Last</span>\n                    </a>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </template>\n      </div>\n      <div class="vtl-row" v-else>\n        <div class="vtl-empty-msg col-12 text-center">\n          {{ messages.noDataAvailable }}\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {\n  defineComponent,\n  ref,\n  reactive,\n  computed,\n  watch,\n  onBeforeUpdate,\n  nextTick,\n  onMounted,\n} from "vue";\n\nexport default defineComponent({\n  name: "my-table",\n  emits: [\n    "return-checked-rows",\n    "do-search",\n    "is-finished",\n    "get-now-page",\n    "row-clicked",\n    "row-toggled",\n    "row-input",\n  ],\n  props: {\n    // 是否讀取中 (is data loading)\n    isLoading: {\n      type: Boolean,\n      require: true,\n    },\n    // 是否執行了重新查詢 (Whether to perform a re-query)\n    isReSearch: {\n      type: Boolean,\n      require: true,\n    },\n    // 有無Checkbox (Presence of Checkbox)\n    hasCheckbox: {\n      type: Boolean,\n      default: false,\n    },\n    // Checkbox勾選後返回資料的型態 (Returns data type for checked of Checkbox)\n    checkedReturnType: {\n      type: String,\n      default: "row",\n    },\n    // 標題 (title)\n    title: {\n      type: String,\n      default: "",\n    },\n    // 是否鎖定第一欄位位置 (Fixed first column\'s position)\n    isFixedFirstColumn: {\n      type: Boolean,\n      default: false,\n    },\n    // 欄位 (Field)\n    columns: {\n      type: Array,\n      default: () => {\n        return [];\n      },\n    },\n    // 資料 (data)\n    rows: {\n      type: Array,\n      default: () => {\n        return [];\n      },\n    },\n    // 資料列類別 (data row classes)\n    rowClasses: {\n      type: [Array, Function],\n      default: () => {\n        return [];\n      },\n    },\n    // 一頁顯示筆數 (Display the number of items on one page)\n    pageSize: {\n      type: Number,\n      default: 10,\n    },\n    // 總筆數 (Total number of transactions)\n    total: {\n      type: Number,\n      default: 100,\n    },\n    // 現在頁數 (Current page number)\n    page: {\n      type: Number,\n      default: 1,\n    },\n    // 排序條件 (Sort condition)\n    sortable: {\n      type: Object,\n      default: () => {\n        return {\n          order: "id",\n          sort: "asc",\n        };\n      },\n    },\n    // 顯示文字 (Display text)\n    messages: {\n      type: Object,\n      default: () => {\n        return {\n          pagingInfo: "Showing {0}-{1} of {2}",\n          pageSizeChangeLabel: "Row count:",\n          gotoPageLabel: "Go to page:",\n          noDataAvailable: "No data",\n        };\n      },\n    },\n    // 靜態模式 (Static mode(no refresh server data))\n    isStaticMode: {\n      type: Boolean,\n      default: false,\n    },\n    // 插槽模式 (V-slot mode)\n    isSlotMode: {\n      type: Boolean,\n      default: false,\n    },\n    // 是否隱藏換頁資訊 (Hide paging)\n    isHidePaging: {\n      type: Boolean,\n      default: false,\n    },\n    // 一頁顯示筆數下拉選單 (Dropdown of Display the number of items on one page)\n    pageOptions: {\n      type: Array,\n      default: () => [\n        {\n          value: 10,\n          text: 10,\n        },\n        {\n          value: 25,\n          text: 25,\n        },\n        {\n          value: 50,\n          text: 50,\n        },\n      ],\n    },\n\n    // 分類條件 (Key of grouping)\n    groupingKey: {\n      type: String,\n      default: "",\n    },\n    // 是否顯示隱藏分類開關 (Has hide group rows toggle)\n    hasGroupToggle: {\n      type: Boolean,\n      default: false,\n    },\n    // 客製化分類顯示 (Customize grouping title)\n    groupingDisplay: {\n      type: Function,\n      default: null,\n    },\n    // 設定表格高度 (Table\'s max height)\n    maxHeight: {\n      default: "auto",\n    },\n    // 預設群組顯示時為折疊 (Grouping collapsed on start)\n    startCollapsed: {\n      type: Boolean,\n      default: false,\n    },\n    // 保持刷新後折疊狀態 (Keep collapsed status after refresh)\n    isKeepCollapsed: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  setup(props, { emit, slots }) {\n    let localTable = ref(null);\n\n    // 檢查下拉選單中是否包含預設一頁顯示筆數 (Validate dropdown\'s values have page-size value or not)\n    let defaultPageSize =\n      props.pageOptions.length > 0\n        ? ref(props.pageOptions[0].value)\n        : ref(props.pageSize);\n    if (props.pageOptions.length > 0) {\n      props.pageOptions.forEach((v) => {\n        if (\n          Object.prototype.hasOwnProperty.call(v, "value") &&\n          Object.prototype.hasOwnProperty.call(v, "text") &&\n          props.pageSize == v.value\n        ) {\n          defaultPageSize.value = v.value;\n        }\n      });\n    }\n\n    // 組件用內部設定值 (Internal set value for components)\n    const setting = reactive({\n      // 是否啟用Slot模式 (Enable slot mode)\n      isSlotMode: props.isSlotMode,\n      // 是否全選 (Whether to select all)\n      isCheckAll: false,\n      // 是否隱藏換頁資訊 (Hide paging)\n      isHidePaging: props.isHidePaging,\n      // KEY欄位名稱 (KEY field name)\n      keyColumn: computed(() => {\n        let key = "";\n        Object.assign(props.columns).forEach((col) => {\n          if (col.isKey) {\n            key = col.field;\n          }\n        });\n        return key;\n      }),\n      // 當前頁數 (current page number)\n      page: props.page,\n      // 每頁顯示筆數 (Display count per page)\n      pageSize: defaultPageSize.value,\n      // 最大頁數 (Maximum number of pages)\n      maxPage: computed(() => {\n        if (props.total <= 0) {\n          return 0;\n        }\n        let maxPage = Math.floor(props.total / setting.pageSize);\n        let mod = props.total % setting.pageSize;\n        if (mod > 0) {\n          maxPage++;\n        }\n        return maxPage;\n      }),\n      // 該頁數起始值 (The starting value of the page number)\n      offset: computed(() => {\n        return (setting.page - 1) * setting.pageSize + 1;\n      }),\n      // 該頁數最大值 (Maximum number of pages0\n      limit: computed(() => {\n        let limit = setting.page * setting.pageSize;\n        return props.total >= limit ? limit : props.total;\n      }),\n      // 換頁陣列 (Paging array)\n      paging: computed(() => {\n        let startPage = setting.page - 2 <= 0 ? 1 : setting.page - 2;\n        if (setting.maxPage - setting.page <= 2) {\n          startPage = setting.maxPage - 4;\n        }\n        startPage = startPage <= 0 ? 1 : startPage;\n        let pages = [];\n        for (let i = startPage; i <= setting.maxPage; i++) {\n          if (pages.length < 5) {\n            pages.push(i);\n          }\n        }\n        return pages;\n      }),\n      // 組件內用排序 (Sortable for local)\n      order: props.sortable.order,\n      sort: props.sortable.sort,\n      pageOptions: props.pageOptions,\n    });\n\n    // 已選擇中的資料 (Checked rows)\n    const isChecked = ref([]);\n\n    // 組件內用資料 (Data rows for local)\n    const localRows = computed(() => {\n      let rows = props.rows;\n      // refs https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Collator/compare\n      var collator = new Intl.Collator(undefined, {\n        numeric: true,\n        sensitivity: "base",\n      });\n      let sortOrder = setting.sort === "desc" ? -1 : 1;\n      rows.sort(function (a, b) {\n        return collator.compare(a[setting.order], b[setting.order]) * sortOrder;\n      });\n\n      // return sorted and offset rows\n\n      let result = null;\n      if (props.groupingKey) {\n        // If have set grouping-key create group temp data\n        let tmp = {};\n        rows.forEach((v) => {\n          if (!tmp[v[props.groupingKey]]) {\n            tmp[v[props.groupingKey]] = [];\n          }\n          tmp[v[props.groupingKey]].push(v);\n        });\n\n        result = {};\n        for (let index = setting.offset - 1; index < setting.limit; index++) {\n          result[rows[index][props.groupingKey]] = tmp[rows[index][props.groupingKey]];\n        }\n      } else {\n        result = [];\n        for (let index = setting.offset - 1; index < setting.limit; index++) {\n          result.push(rows[index]);\n        }\n      }\n\n      nextTick(function () {\n        // 資料完成渲染後回傳私有元件\n        callIsFinished();\n      });\n\n      return result;\n    });\n\n    ////////////////////////////\n    //\n    //  Checkbox 相關操作\n    //  (Checkbox related operations)\n    //\n\n    // 定義Checkbox參照 (Define Checkbox reference)\n    const rowCheckbox = ref([]);\n\n    /**\n     * 重新渲染前執行 (Execute before re-rendering)\n     */\n    onBeforeUpdate(() => {\n      // 每次更新前都把值全部清空 (Clear all values before each update)\n      rowCheckbox.value = [];\n    });\n\n    /**\n     * 監聽全勾選Checkbox (Check all checkboxes for monitoring)\n     */\n    watch(\n      () => setting.isCheckAll,\n      (state) => {\n        if (props.hasCheckbox) {\n          isChecked.value = [];\n          if (state) {\n            let tmpRows = (props.isStaticMode) ? props.rows.slice((setting.offset - 1), setting.limit) : props.rows;\n            if (props.checkedReturnType == "row") {\n              isChecked.value = tmpRows;\n            } else {\n              tmpRows.forEach((val) => {\n                isChecked.value.push(val[setting.keyColumn]);\n              });\n            }\n          }\n          rowCheckbox.value.forEach((val) => {\n            if (val) {\n              val.checked = state;\n            }\n          });\n          // 回傳畫面上選上的資料 (Return the selected data on the screen)\n          emit("return-checked-rows", isChecked.value);\n        }\n      }\n    );\n\n    /**\n     * 監控有無顯示Checkbox變化 (hasCeckbox props for monitoring)\n     */\n    watch(\n      () => props.hasCheckbox,\n      (v) => {\n        if (!v) {\n          setting.isCheckAll = false;\n        }\n      }\n    );\n\n    // z-index of Fixed Columns cause click event being eaten by parent element, so I need to do this instead (Vincent)\n    const clickChild = (event) => {\n      // console.log(event.target.firstChild); // test\n      if (props.isFixedFirstColumn && event.target.firstElementChild !== null) {\n        event.target.firstElementChild.click();\n      } // if\n    } // clickChild\n\n    /**\n     * Checkbox點擊事件 (Checkbox click event)\n     */\n    const checked = (row, event) => {\n      event.stopPropagation();\n      let checkboxValue = row[setting.keyColumn];\n      if (props.checkedReturnType == "row") {\n        checkboxValue = row;\n      }\n      if (event.target.checked) {\n        isChecked.value.push(checkboxValue);\n      } else {\n        const index = isChecked.value.indexOf(checkboxValue);\n        if (index >= 0) {\n          isChecked.value.splice(index, 1);\n        }\n      }\n      if (isChecked.value.length == props.rows.length) {\n        setting.isCheckAll = true;\n      } else {\n        // 回傳畫面上選上的資料 (Return the selected data on the screen)\n        emit("return-checked-rows", isChecked.value);\n      }\n    };\n\n    /**\n     * 清空畫面上所有選擇資料 (Clear all selected data on the screen)\n     */\n    const clearChecked = () => {\n      isChecked.value = [];\n      rowCheckbox.value.forEach((val) => {\n        if (val && val.checked) {\n          val.checked = false;\n        }\n      });\n      // 回傳畫面上選上的資料 (Return the selected data on the screen)\n      emit("return-checked-rows", isChecked.value);\n    };\n\n    ////////////////////////////\n    //\n    //  排序·換頁等 相關操作\n    //  (Sorting, page change, etc. related operations)\n    //\n\n    /**\n     * 呼叫執行排序 (Call execution sequencing)\n     */\n    const doSort = (order) => {\n      let sort = "asc";\n      if (order == setting.order) {\n        // 排序中的項目時 (When sorting items)\n        if (setting.sort == "asc") {\n          sort = "desc";\n        }\n      }\n      let offset = (setting.page - 1) * setting.pageSize;\n      let limit = setting.pageSize;\n      setting.order = order;\n      setting.sort = sort;\n      emit("do-search", offset, limit, order, sort);\n\n      // 清空畫面上選擇的資料 (Clear the selected data on the screen)\n      if (setting.isCheckAll) {\n        // 取消全選時自然會清空 (It will be cleared when you cancel all selections)\n        setting.isCheckAll = false;\n      } else {\n        if (props.hasCheckbox) {\n          clearChecked();\n        }\n      }\n    };\n\n    /**\n     * 切換頁碼 (Switch page number)\n     *\n     * @param page      number  新頁碼    (New page number)\n     * @param prevPage  number  現在頁碼  (Current page number)\n     */\n    const changePage = (page, prevPage) => {\n      setting.isCheckAll = false;\n      if (props.hasCheckbox) {\n        isChecked.value = [];\n      }\n      let order = setting.order;\n      let sort = setting.sort;\n      let offset = (page - 1) * setting.pageSize;\n      let limit = setting.pageSize;\n      if (!props.isReSearch || page > 1 || page == prevPage) {\n        // 非重新查詢發生的頁碼變動才執行呼叫查詢 (Call query will only be executed if the page number is changed without re-query)\n        emit("do-search", offset, limit, order, sort);\n      }\n    };\n    // 監聽頁碼切換 (Monitor page switching)\n    watch(() => setting.page, changePage);\n    // 監聽手動頁碼切換 (Monitor manual page switching)\n    watch(\n      () => props.page,\n      (val) => {\n        if (val <= 1) {\n          setting.page = 1;\n          emit("get-now-page", setting.page);\n        } else if (val >= setting.maxPage) {\n          setting.page = setting.maxPage;\n          emit("get-now-page", setting.page);\n        } else {\n          setting.page = val;\n        }\n      }\n    );\n\n    /**\n     * 切換顯示筆數 (Switch display number)\n     */\n    const changePageSize = () => {\n      if (setting.page === 1) {\n        // 沒自動觸發 changePage()，所以手動觸發\n        changePage(setting.page, setting.page);\n      } else {\n        // 強制返回第一頁,並自動觸發 changePage()\n        setting.page = 1;\n        setting.isCheckAll = false;\n      }\n    };\n    // 監聽組件內顯示筆數切換 (Monitor display number switch from component)\n    watch(() => setting.pageSize, changePageSize);\n    // 監聽來自Prop的顯示筆數切換 (Monitor display number switch from prop)\n    watch(\n      () => props.pageSize,\n      (newPageSize) => {\n        setting.pageSize = newPageSize;\n      }\n    );\n\n    /**\n     * 上一頁 (Previous page)\n     */\n    const prevPage = () => {\n      if (setting.page == 1) {\n        // 如果是第一頁，不予執行 (If it is the first page, it will not be executed)\n        return false;\n      }\n      setting.page--;\n    };\n\n    /**\n     * 移動至指定頁數 (Move to the specified number of pages)\n     */\n    const movePage = (page) => {\n      setting.page = page;\n    };\n\n    /**\n     * 下一頁 (Next page)\n     */\n    const nextPage = () => {\n      if (setting.page >= setting.maxPage) {\n        // 如果等於大於最大頁數，不與執行 (If it is equal to or greater than the maximum number of pages, no execution)\n        return false;\n      }\n      setting.page++;\n    };\n\n    // 監聽資料變更 (Monitoring data changes)\n    watch(\n      () => props.rows,\n      () => {\n        if (props.isReSearch || props.isStaticMode) {\n          setting.page = 1;\n        }\n        nextTick(function () {\n          // 資料完成渲染後回傳私有元件 (Return the private components after the data is rendered)\n          if (!props.isStaticMode) {\n            callIsFinished();\n          }\n        });\n      }\n    );\n\n    const stringFormat = (template, ...args) => {\n      return template.replace(/{(\\d+)}/g, function (match, number) {\n        return typeof args[number] != "undefined" ? args[number] : match;\n      });\n    };\n\n    // Call 「is-finished」 Method\n    const callIsFinished = () => {\n      if (localTable.value) {\n        let localElement =\n          localTable.value.getElementsByClassName("is-rows-el");\n        emit("is-finished", localElement);\n      }\n      emit("get-now-page", setting.page);\n    };\n\n    // Toggle button elements\n    const toggleButtonRefs = ref({});\n    // Grouping rows\n    const groupingRowsRefs = ref({});\n    // Saved toggle status\n    const groupingToggleStatus = ref({});\n\n    // Data rows for grouping (Default-mode only)\n    const groupingRows = computed(() => {\n      let result = {};\n      props.rows.forEach((v) => {\n        if (!result[v[props.groupingKey]]) {\n          result[v[props.groupingKey]] = [];\n        }\n        result[v[props.groupingKey]].push(v);\n      });\n\n      nextTick(function () {\n        if (props.startCollapsed || props.isKeepCollapsed) {\n          for (const [groupIndex, el] of Object.entries(toggleButtonRefs.value)) {\n            if (el) {\n              let isOpen = !props.startCollapsed;\n              if (\n                props.isKeepCollapsed &&\n                groupingToggleStatus.value[groupIndex] !== undefined\n              ) {\n                isOpen = !groupingToggleStatus.value[groupIndex];\n              }\n              if (\n                (isOpen && el.parentElement.classList.contains("rotated-90")) ||\n                (!isOpen && !el.parentElement.classList.contains("rotated-90"))\n              ) {\n                el.parentElement.classList.toggle("rotated-90");\n              }\n              if (!isOpen) {\n                groupingRowsRefs.value[groupIndex].forEach((element) => {\n                  if (element) {\n                    element.classList.add("hidden");\n                  }\n                });\n              }\n            }\n          }\n        }\n        callIsFinished();\n      });\n\n      return result;\n    });\n\n    /**\n     * Toggle Group rows\n     *\n     * @param {String} groupIndex\n     */\n    const toggleGroup = (groupIndex) => {\n      let targetEl = toggleButtonRefs.value[groupIndex];\n      if (targetEl) {\n        targetEl.parentElement.classList.toggle("rotated-90");\n        const isClose = targetEl.parentElement.classList.contains("rotated-90");\n        groupingRowsRefs.value[groupIndex].forEach((element) => {\n          if (element) {\n            if (isClose) {\n              element.classList.add("hidden");\n            } else {\n              element.classList.remove("hidden");\n            }\n          }\n        });\n        groupingToggleStatus.value[groupIndex] = isClose;\n        emit("row-toggled", groupingRows.value[groupIndex], isClose);\n      }\n    };\n\n    /**\n     * 組件掛載後事件 (Mounted Event)\n     */\n    onMounted(() => {\n      nextTick(() => {\n        if (props.rows.length > 0) {\n          callIsFinished();\n        }\n      });\n    });\n\n    return {\n      slots,\n      localTable,\n      localRows,\n      setting,\n      rowCheckbox,\n      clickChild,\n      checked,\n      clearChecked,\n      doSort,\n      prevPage,\n      movePage,\n      nextPage,\n      stringFormat,\n      toggleButtonRefs,\n      groupingRowsRefs,\n      groupingRows,\n      toggleGroup,\n    };\n  },\n});\n<\/script>\n\n<style scoped>\n.vtl-checkbox-th {\n  width: 3.5ch;\n  min-width: 38px;\n}\n\n.vtl-checkbox-td {\n  width: 3.5ch;\n  min-width: 38px;\n}\n\n.vtl-both {\n  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAQAAADYWf5HAAAAkElEQVQoz7X QMQ5AQBCF4dWQSJxC5wwax1Cq1e7BAdxD5SL+Tq/QCM1oNiJidwox0355mXnG/DrEtIQ6azioNZQxI0ykPhTQIwhCR+BmBYtlK7kLJYwWCcJA9M4qdrZrd8pPjZWPtOqdRQy320YSV17OatFC4euts6z39GYMKRPCTKY9UnPQ6P+GtMRfGtPnBCiqhAeJPmkqAAAAAElFTkSuQmCC");\n}\n\n.vtl-sortable {\n  cursor: pointer;\n  background-position: right;\n  background-repeat: no-repeat;\n  /* padding-right: 30px !important; */\n}\n\n.vtl-asc {\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAZ0lEQVQ4y2NgGLKgquEuFxBPAGI2ahhWCsS/gDibUoO0gPgxEP8H4ttArEyuQYxAPBdqEAxPBImTY5gjEL9DM+wTENuQahAvEO9DMwiGdwAxOymGJQLxTyD+jgWDxCMZRsEoGAVoAADeemwtPcZI2wAAAABJRU5ErkJggg==);\n}\n\n.vtl-desc {\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAZUlEQVQ4y2NgGAWjYBSggaqGu5FA/BOIv2PBIPFEUgxjB+IdQPwfC94HxLykus4GiD+hGfQOiB3J8SojEE9EM2wuSJzcsFMG4ttQgx4DsRalkZENxL+AuJQaMcsGxBOAmGvopk8AVz1sLZgg0bsAAAAASUVORK5CYII=);\n}\n\n.vtl-loading-mask {\n  position: absolute;\n  z-index: 3;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  flex-flow: column;\n  transition: opacity 0.3s ease;\n}\n\n.vtl-loading-content {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.vtl-card {\n  position: relative;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-direction: column;\n  flex-direction: column;\n  min-width: 0;\n  word-wrap: break-word;\n  background-color: #fff;\n  background-clip: border-box;\n}\n\nselect {\n  width: auto;\n  border: 1px solid #cccccc;\n  background-color: #ffffff;\n  height: auto;\n  padding: 0;\n  margin-bottom: 0;\n}\n\ntable {\n  table-layout: fixed !important;\n}\n\ndiv.dataTables_wrapper div.dataTables_paginate {\n  margin: 0;\n  white-space: nowrap;\n  text-align: right;\n}\n\ndiv.dataTables_wrapper div.dataTables_paginate ul.pagination {\n  margin: 2px 0;\n  white-space: nowrap;\n  justify-content: flex-end;\n}\n\n.pagination {\n  display: flex;\n  padding-left: 0;\n  list-style: none;\n}\n\n.pagination a:hover:not(.disabled) {\n  background-color: #ddd;\n  border-radius: 5px;\n}\n\n.vtl-table {\n  width: 100%;\n  margin-bottom: 1rem;\n  color: #212529;\n  border-collapse: collapse;\n}\n\nth {\n  text-align: inherit;\n}\n\ntr {\n  display: table-row;\n  vertical-align: inherit;\n  border-color: inherit;\n}\n\n.vtl-table-bordered thead td,\n.vtl-table-bordered thead th {\n  border-bottom-width: 2px;\n}\n\n.vtl-table thead th {\n  vertical-align: bottom;\n  color: #fff;\n  background-color: #343a40;\n  border-color: #454d55;\n  border-bottom: 2px solid #dee2e6;\n}\n\n.vtl-table-bordered td,\n.vtl-table-bordered th {\n  border: 1px solid #dee2e6;\n}\n\n.vtl-table td,\n.vtl-table th {\n  padding: 0.75rem;\n  vertical-align: top;\n  border-top: 1px solid #dee2e6;\n  vertical-align: middle;\n}\n\n.vtl-table-responsive {\n  display: block;\n  width: 100%;\n  overflow-x: auto;\n  -webkit-overflow-scrolling: touch;\n}\n\n.vtl-table-responsive>.vtl-table-bordered {\n  border: 0;\n}\n\n.vtl-row {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-wrap: wrap;\n  flex-wrap: wrap;\n}\n\n.vtl-pagination {\n  margin: 2px 0;\n  white-space: nowrap;\n  justify-content: flex-end;\n  display: -ms-flexbox;\n  display: flex;\n  padding-left: 0;\n  list-style: none;\n  border-radius: 0.25rem;\n}\n\n.page-item.disabled .page-link {\n  color: #6c757d;\n  pointer-events: none;\n  cursor: auto;\n  background-color: #fff;\n  border-color: #dee2e6;\n}\n\n.page-item:first-child .page-link {\n  margin-left: 0;\n  border-top-left-radius: 0.25rem;\n  border-bottom-left-radius: 0.25rem;\n}\n\n.page-link {\n  position: relative;\n  display: block;\n  padding: 0.5rem 0.75rem;\n  margin-left: -1px;\n  line-height: 1.25;\n  color: #000000;\n  background-color: #fff;\n}\n\n.sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border: 0;\n}\n\n*,\n::after,\n::before {\n  box-sizing: border-box;\n}\n\n.col-sm-12 {\n  -ms-flex: 0 0 100%;\n  flex: 0 0 100%;\n  max-width: 100%;\n}\n\n.text-center {\n  text-align: center;\n}\n\n@media (min-width: 576px) {\n  .vtl-table-responsive-sm {\n    display: block;\n    width: 100%;\n    overflow-x: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n\n  .vtl-table-responsive-sm>.table-bordered {\n    border: 0;\n  }\n\n  .col-md-4 {\n    -ms-flex: 0 0 33.333333%;\n    flex: 0 0 33.333333%;\n    max-width: 33.333333%;\n  }\n}\n\n.vtl-table thead th {\n  position: sticky;\n  top: 0;\n  z-index: 1;\n}\n\n.vtl-table tbody th {\n  position: sticky;\n  left: 0;\n  z-index: 1;\n}\n\n.fixed-first-column {\n  overflow-x: auto;\n}\n\n.fixed-first-column tr th:first-child {\n  position: sticky;\n  left: 0;\n  z-index: 2;\n}\n\n.fixed-first-column tr td:first-child {\n  position: sticky;\n  left: 0;\n}\n\n\n.fixed-first-column tr th:first-child::before,\n.fixed-first-second-column tr th:nth-child(2)::before {\n  content: "";\n  position: absolute;\n  border-right: 1px solid #454d55;\n  left: 0;\n  top: 0;\n  width: 102%;\n  height: 102%;\n}\n\n.fixed-first-column tr .vtl-checkbox-th:first-child::before {\n  content: "";\n  position: absolute;\n  border-right: 1px solid #454d55;\n  left: 0;\n  top: 0;\n  width: 102%;\n  height: 102%;\n}\n\n.fixed-first-column tr td:first-child::before {\n  content: "";\n  position: absolute;\n  border-right: 1px solid #dee2e6;\n  left: 0;\n  top: 0;\n  width: 102%;\n  height: 102%;\n}\n\n.fixed-first-column tr .vtl-checkbox-td:first-child::before {\n  content: "";\n  position: absolute;\n  border-right: 1px solid #dee2e6;\n  left: 0;\n  top: 0;\n  width: 103%;\n  height: 102%;\n}\n\n.fixed-first-second-column tr th:nth-child(2),\n.fixed-first-second-column tr td:nth-child(2) {\n  position: sticky;\n  left: 38px;\n}\n\n.fixed-first-second-column tr th:nth-child(2) {\n  z-index: 2;\n}\n\n.fixed-first-column tr td:first-child,\n.fixed-first-second-column tr td:nth-child(2) {\n  background-color: white;\n}\n\n.flex {\n  display: flex;\n}\n\n.animation {\n  transform: rotate(0deg);\n  transition: transform 0.3s;\n}\n\n.cursor-pointer {\n  cursor: pointer;\n}\n\n.rotated-90 {\n  transform: rotate(-90deg);\n}\n\n.hidden {\n  display: none;\n}\n\n.ml-2 {\n  margin-left: 0.5rem;\n}\n\ntd {\n  text-align: center;\n}\n</style>\n'],sourceRoot:""}]);const l=i},4701:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-304fd098] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/TransitSearchTable.vue"],names:[],mappings:"AAweA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="row justify-content-between">\n        <div class="row col col-auto">\n            <div class="col col-auto">\n                <label for="sxbInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n            </div>\n            <div class="col col-auto p-0 m-0">\n                <input id="sxbInput" class="text-center form-control form-control-lg"\n                    v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n            </div>\n        </div>\n        <div class="col col-auto">\n            <button id="download" name="download" class="col col-auto btn btn-lg btn-success"\n                :value="$t(\'monthlyPRpageLang.download\')" @click="OutputExcelClick(\'All\')">\n                <i class="bi bi-file-earmark-arrow-down-fill fs-4"></i>\n            </button>\n        </div>\n    </div>\n    <div class="w-100" style="height: 1ch"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n    <table-lite id="searchTable" :is-fixed-first-column="true" :hasCheckbox="false" :isStaticMode="true"\n        :isSlotMode="true" :messages="table.messages" :columns="table.columns" :rows="table.rows"\n        :total="table.totalRecordCount" :page-options="table.pageOptions" :sortable="table.sortable"\n        @return-checked-rows="updateCheckedRows">\n        <template v-slot:請購數量="{ row, key }">\n            <div class="col col-auto align-items-center m-0 p-0">\n                <span class="m-0 p-0" style="width: 12ch;">\n                    {{ parseInt(row.請購數量).toLocaleString(\'en\', { useGrouping: true }) }}&nbsp;<small>{{ row.單位\n                        }}</small>\n                </span>\n                <button @click="openQtyDetails(row)" type="button" data-bs-toggle="modal" data-bs-target="#detailTable"\n                    class="btn btn-outline-info btn-sm ms-1 my-0 px-1 py-0" style="border-radius: 20px;"\n                    :id="\'sxb\' + row.id" :name="\'sxb\' + key">Edit</button>\n            </div>\n        </template>\n    </table-lite>\n\n    \x3c!-- Modal --\x3e\n    <div class="modal fade" id="detailTable" tabindex="-1" aria-labelledby="detailTable" aria-hidden="true">\n        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">\n            <div class="modal-content">\n                <div class="modal-header justify-content-center">\n                    <h1 class="col col-auto modal-title m-0 p-0 fs-4">\n                        {{ modalTitle }}\n                    </h1>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n                    <div class="row g-3">\n                        <div class="col-md-4">\n                            <label for="inputQty" class="form-label">{{ $t("monthlyPRpageLang.on_the_way_search")\n                                }}</label>\n                            <div class="input-group">\n                                <input v-model="inputQty" type="number" :class="{ \'is-invalid\': isInvalid }"\n                                    class="form-control" id="inputQty" :placeholder="originalQty" min="0">\n                                <div class="input-group-text">{{ unit }}</div>\n                            </div>\n                            <span v-if="isInvalid" class="invalid-feedback d-block" role="alert">\n                                <strong>{{ validation_err_msg }}</strong>\n                            </span>\n                        </div>\n                        <div class="col-md-8">\n                            <label for="inputDescr" class="form-label">{{ $t("monthlyPRpageLang.description") }}</label>\n                            <input v-model="inputDescr" type="text" :class="{ \'is-invalid\': isInvalid2 }"\n                                class="form-control" id="inputDescr">\n                            <span v-if="isInvalid2" class="invalid-feedback d-block" role="alert">\n                                <strong>{{ validation_err_msg2 }}</strong>\n                            </span>\n                        </div>\n                    </div>\n                </div>\n                <div class="modal-footer justify-content-between">\n                    <button type="button" class="btn btn-lg btn-danger" style="border-radius: 5px;"\n                        data-bs-dismiss="modal" aria-label="Close">\n                        {{ $t(\'templateWords.cancel\') }}\n                    </button>\n                    <button @click="sxb_approve" type="button" class="btn btn-lg btn-success"\n                        style="border-radius: 5px;">\n                        {{ $t(\'checkInvLang.edit\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useTransitSearch from "../../composables/TransitSearch.ts";\nimport useCommonlyUsedFunctions from "../../composables/CommonlyUsedFunctions.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const { mats_inTransit, getTransit, updateInTransit } = useTransitSearch(); // axios get the mats_inTransit data\n\n        onBeforeMount(getTransit);\n\n        let isInvalid = ref(false); // edit to DB validation for Qty\n        let isInvalid2 = ref(false); // edit to DB validation for descr\n        let validation_err_msg = ref("");\n        let validation_err_msg2 = ref("");\n        const modalTitle = ref("");\n        const originalQty = ref("");\n        const unit = ref("");\n        const inputQty = ref("");\n        const inputDescr = ref("");\n        const file = ref();\n        let checkedRows = [];\n        const searchTerm = ref(""); // Search text\n\n        // pour the data in\n        const data = reactive([]);\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const OutputExcelClick = async () => {\n            await triggerModal();\n\n            // get today\'s date for filename\n            let today = new Date();\n            let dd = String(today.getDate()).padStart(2, \'0\');\n            let mm = String(today.getMonth() + 1).padStart(2, \'0\'); //January is 0!\n            let yyyy = today.getFullYear();\n            today = yyyy + "_" + mm + \'_\' + dd;\n\n            let rows = Array();\n            for (let i = 0; i < data.length; i++) {\n                let tempObj = new Object;\n                tempObj.料號 = data[i].料號;\n                tempObj.在途數量 = data[i].請購數量;\n                tempObj.說明 = data[i].說明;\n                tempObj.修改人員 = data[i].修改人員;\n                tempObj.最後更新時間 = data[i].最後更新時間;\n\n                rows.push(tempObj);\n            } // for\n\n            const worksheet = XLSX.utils.json_to_sheet(rows);\n            const workbook = XLSX.utils.book_new();\n            XLSX.utils.book_append_sheet(workbook, worksheet, app.appContext.config.globalProperties.$t("monthlyPRpageLang.on_the_way_search"));\n            XLSX.writeFile(workbook,\n                app.appContext.config.globalProperties.$t(\n                    "monthlyPRpageLang.on_the_way_search"\n                ) + "_" + today + ".xlsx", { compression: true });\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // OutputExcelClick\n\n        const openQtyDetails = (row) => {\n            // console.log("clicked!"); // test\n            modalTitle.value = row.料號;\n            unit.value = row.單位;\n            originalQty.value = parseInt(row.請購數量).toLocaleString(\'en\', { useGrouping: true });\n        } // openSXBDetails\n\n        const sxb_approve = async () => {\n            isInvalid.value = false;\n            isInvalid2.value = false;\n            if (inputQty.value.toString().trim() === "" || inputQty.value === null || inputQty.value === undefined) {\n                validation_err_msg.value =\n                    app.appContext.config.globalProperties.$t(\n                        "validation.required"\n                    );\n\n                isInvalid.value = true;\n            } // if\n\n            if (inputDescr.value.trim() === "" || inputDescr.value === null || inputDescr.value === undefined) {\n                validation_err_msg2.value =\n                    app.appContext.config.globalProperties.$t(\n                        "validation.required"\n                    );\n\n                isInvalid2.value = true;\n            } // if\n\n            // console.log(inputQty.value); // test\n            // console.log(inputDescr.value); // test\n\n            if (isInvalid.value === true || isInvalid2.value === true) {\n                return;\n            } // if\n\n            await triggerModal();\n\n            let isnArr = [modalTitle.value];\n            let qtyArr = [inputQty.value];\n            let descrArr = [inputDescr.value];\n            let result = await updateInTransit(isnArr, qtyArr, descrArr);\n            await getTransit();\n\n            if (result === "success") {\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // sxb_approve\n\n        watch(mats_inTransit, async () => {\n            await triggerModal();\n            data.splice(0);\n            if (mats_inTransit.value == "") {\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            let allRowsObj = JSON.parse(mats_inTransit.value);\n            // console.log(allRowsObj.data); // test\n            for (let i = 0; i < allRowsObj.data.length; i++) {\n                allRowsObj.data[i].id = i;\n                data.push(allRowsObj.data[i]);\n            } // for\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="isn\' +\n                            row.id +\n                            \'" name="isn\' +\n                            row.id +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.transit"\n                    ),\n                    field: "請購數量",\n                    width: "12ch",\n                    sortable: true,\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.transit_reviser"\n                    ),\n                    field: "修改人員",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.修改人員 === null || row.修改人員 === undefined) row.修改人員 = "N/A";\n                        return (\n                            \'<input type="hidden" id="reviser\' +\n                            i +\n                            \'" name="reviser\' +\n                            i +\n                            \'" value="\' +\n                            row.修改人員 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.修改人員 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.description"\n                    ),\n                    field: "說明",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.說明 === null || row.說明 === undefined) row.說明 = "N/A";\n                        return (\n                            \'<input type="hidden" id="remark\' +\n                            i +\n                            \'" name="remark\' +\n                            i +\n                            \'" value="\' +\n                            row.說明 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.說明 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "inboundpageLang.updatetime"\n                    ),\n                    field: "最後更新時間",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.最後更新時間 === null || row.最後更新時間 === undefined) row.最後更新時間 = "N/A";\n                        return (\n                            \'<input type="hidden" id="updatetime\' +\n                            i +\n                            \'" name="updatetime\' +\n                            i +\n                            \'" value="\' +\n                            row.最後更新時間 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.最後更新時間 +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            // console.log(rowsKey); // test\n            checkedRows = rowsKey;\n        };\n\n        return {\n            isInvalid,\n            isInvalid2,\n            validation_err_msg,\n            validation_err_msg2,\n            searchTerm,\n            modalTitle,\n            unit,\n            originalQty,\n            inputQty,\n            inputDescr,\n            table,\n            updateCheckedRows,\n            OutputExcelClick,\n            openQtyDetails,\n            sxb_approve,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},8667:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-3cc05342] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/UnitConsumptionSearchTable.vue"],names:[],mappings:"AAinBA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="card">\n        <div class="card-header">\n            <h3>{{ $t(\'monthlyPRpageLang.isnConsumeUpdate\') }}</h3>\n        </div>\n        <div class="card-body">\n            <div class="row justify-content-between">\n                <div class="row col col-auto">\n                    <div class="col col-auto">\n                        <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n                    </div>\n                    <div class="col col-6 p-0 m-0">\n                        <input id="pnInput" class="text-center form-control form-control-lg"\n                            v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_90pn_or_descr\')" v-model="searchTerm" />\n                    </div>\n                </div>\n                <div class="col col-auto">\n                    <button type="submit" id="delete" name="delete" class="col col-auto btn btn-lg btn-danger"\n                        @click="deleteRow">\n                        <i class="bi bi-trash3-fill fs-4"></i>\n                    </button>\n                    &nbsp;\n                    <button id="download" name="download" class="col col-auto btn btn-lg btn-success"\n                        :value="$t(\'monthlyPRpageLang.download\')" @click="OutputExcelClick">\n                        <i class="bi bi-file-earmark-arrow-down-fill fs-4"></i>\n                    </button>\n                </div>\n            </div>\n            <div class="w-100" style="height: 1ch"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n            <span v-if="isInvalid_DB" class="invalid-feedback d-block" role="alert">\n                <strong>{{ validation_err_msg }}</strong>\n            </span>\n            <table-lite :is-fixed-first-column="true" :is-static-mode="true" :isSlotMode="true" :hasCheckbox="true"\n                :isLoading="table.isLoading" :messages="table.messages" :columns="table.columns" :rows="table.rows"\n                :rowClasses="table.rowClasses" :total="table.totalRecordCount" :page-options="table.pageOptions"\n                :sortable="table.sortable" @is-finished="table.isLoading = false"\n                @return-checked-rows="updateCheckedRows" @row-input="rowUserInput">\n                <template v-slot:單耗="{ row, key }">\n                    <input style="width:13ch;" type="number" :id="\'unitConsumption\' + row.id"\n                        :name="\'unitConsumption\' + row.id" :value="ScientificNotaionToFixed(parseFloat(row.單耗))"\n                        v-model="row.單耗" @input="CheckCurrentRow($event)" class="form-control text-center p-0 m-0"\n                        step="0.000001" min="0">\n                </template>\n            </table-lite>\n\n            <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n\n            <div class="row justify-content-between align-items-center">\n                <label class="form-label col col-auto">{{ $t(\'monthlyPRpageLang.surepeopleemail\') }}:</label>\n                <div class="w-100" style="height: 0ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="col col-auto">\n                    <div class="input-group">\n                        <select class="form-select form-select-lg col col-auto text-center" v-model="selected_mail">\n                            <option style="display: none;" disabled selected value="">\n                                {{ $t("monthlyPRpageLang.noemail") }}\n                            </option>\n                            <option v-for="mail in all_mails" :value="mail.email">{{ mail.姓名 }}</option>\n                        </select>\n                        <span class="input-group-text input-group-text-lg" id="emailTail">{{ selected_mail }}</span>\n                    </div>\n                </div>\n                <div class="col col-auto">\n                    <button v-if="uploadToDBReady" name="upload"\n                        class="col col-auto fs-3 text-center btn btn-lg btn-info" @click="onSendToDBClick">\n                        <i class="bi bi-envelope-check-fill"></i>\n                        {{ $t(\'monthlyPRpageLang.submit\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useUnitConsumptionSearch from "../../composables/UnitConsumptionSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        let exampleUrl = ref(window.location.origin + \'/download/ConsumeExample.xlsx\');\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const { mats, mails, recordCount, getAll, getCheckersMails, uploadToDB, deleteUC } = useUnitConsumptionSearch();\n\n        onBeforeMount(async () => {\n            await getCheckersMails();\n            await getAll();\n        });\n\n        let isInvalid = ref(false); // file input validation\n        let isInvalid_DB = ref(false); // add to DB validation\n        let validation_err_msg = ref("");\n        let uploadToDBReady = ref(false); // validation\n        const all_mails = reactive([]);\n        const file = ref();\n        let checkedRows = [];\n        const searchTerm = ref(""); // Search text\n        const selected_mail = ref(""); // Mail reciever name\n        const data = reactive([]); // pour the data into table\n\n        const OutputExcelClick = async () => {\n            await triggerModal();\n            await getAll();\n            // get today\'s date for filename\n            let today = new Date();\n            let dd = String(today.getDate()).padStart(2, \'0\');\n            let mm = String(today.getMonth() + 1).padStart(2, \'0\'); //January is 0!\n            let yyyy = today.getFullYear();\n            today = yyyy + "_" + mm + \'_\' + dd;\n\n            let rows = Array();\n            for (let i = 0; i < data.length; i++) {\n                let tempObj = new Object;\n                tempObj[app.appContext.config.globalProperties.$t("monthlyPRpageLang.isn")] = data[i].料號;\n                tempObj[app.appContext.config.globalProperties.$t("monthlyPRpageLang.90isn")] = data[i].料號90;\n                tempObj[app.appContext.config.globalProperties.$t("monthlyPRpageLang.pName")] = data[i].品名;\n                tempObj[app.appContext.config.globalProperties.$t("monthlyPRpageLang.format")] = data[i].規格;\n                tempObj[app.appContext.config.globalProperties.$t("monthlyPRpageLang.consume")] = data[i].單耗;\n                tempObj[app.appContext.config.globalProperties.$t("monthlyPRpageLang.email")] = data[i].畫押信箱;\n                if (data[i].狀態 === "已完成") {\n                    tempObj[app.appContext.config.globalProperties.$t("monthlyPRpageLang.status")] = app.appContext.config.globalProperties.$t("monthlyPRpageLang.review_complete");\n                } // if\n                else { // 待畫押, 待重畫\n                    tempObj[app.appContext.config.globalProperties.$t("monthlyPRpageLang.status")] = app.appContext.config.globalProperties.$t("monthlyPRpageLang.review_pending");\n                } // else\n\n                rows.push(tempObj);\n            } // for\n\n            const worksheet = XLSX.utils.json_to_sheet(rows);\n            const workbook = XLSX.utils.book_new();\n            XLSX.utils.book_append_sheet(workbook, worksheet, app.appContext.config.globalProperties.$t("monthlyPRpageLang.consume"));\n            XLSX.writeFile(workbook,\n                app.appContext.config.globalProperties.$t(\n                    "monthlyPRpageLang.consume"\n                ) + "_" + today + ".xlsx", { compression: true });\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // OutputExcelClick\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const deleteRow = async () => {\n            await triggerModal();\n            let pnArray = [];\n            let pn90Array = [];\n            for (let i = 0; i < checkedRows.length; i++) {\n                pnArray.push(checkedRows[i].料號);\n                pn90Array.push(checkedRows[i].料號90);\n            } // for\n\n            let result = await deleteUC(pnArray, pn90Array);\n            if (result === "success") {\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.total") + " " + JSON.parse(recordCount.value).record + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.record") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.delete") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                for (let i = 0; i < checkedRows.length; i++) {\n                    let indexOfObject = data.findIndex(object => {\n                        return parseInt(object.id) === parseInt(checkedRows[i].id);\n                    });\n\n                    if (indexOfObject != -1) {\n                        data.splice(indexOfObject, 1);\n                    } // if\n                } // for\n\n                document.querySelectorAll(\'.vtl-tbody-checkbox\').forEach(el => el.checked = false);\n\n                if (document.querySelector(".vtl-thead-checkbox").checked) {\n                    document.querySelector(".vtl-thead-checkbox").click();\n                } // if\n\n                checkedRows = [];\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // deleteRow\n\n        const onSendToDBClick = async () => {\n            // console.log(selected_mail.value); // test\n            await triggerModal();\n            // console.log("The modal should be triggered by now."); // test\n            isInvalid_DB.value = false;\n            let rowsCount = 0;\n            let hasError = false;\n            // console.log(data.length); //test\n            if (checkedRows.length <= 0) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n\n            // prepare the data arrays to be sent\n            let pnArray = [];\n            let pn90Array = [];\n            let ucArray = [];\n            for (let j = 0; j < checkedRows.length; j++) {\n                pnArray.push(checkedRows[j].料號);\n                pn90Array.push(checkedRows[j].料號90);\n                ucArray.push(checkedRows[j].單耗.toString());\n            } // for\n\n            // console.log(ucArray); // test\n            // actually updating database now\n            let start = Date.now();\n            let result = await uploadToDB(pnArray, pn90Array, ucArray, selected_mail.value);\n            let timeTaken = Date.now() - start;\n            console.log("Total time taken : " + timeTaken + " milliseconds");\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n\n            await getAll();\n\n            if (result === "success") {\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.total") + " " + JSON.parse(recordCount.value).record + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.record") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n        } // onSendToDBClick\n\n        watch(mats, async () => {\n            await triggerModal();\n            data.splice(0);\n            uploadToDBReady.value = false;\n            selected_mail.value = "";\n            if (mats.value == "") {\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            let allRowsObj = JSON.parse(mats.value);\n            // console.log(allRowsObj.data); // test\n            let singleEntry = {};\n            for (let i = 0; i < allRowsObj.data.length; i++) {\n                // console.log(allRowsObj.data[i].料號90); // test\n                singleEntry = allRowsObj.data[i];\n                singleEntry.id = i;\n\n                data.push(singleEntry);\n                singleEntry = {};\n            } // for\n\n            // console.log(data); // test\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        watch(mails, async () => {\n            let allRowsObj = JSON.parse(mails.value);\n            // console.log(allRowsObj.data.length);\n            for (let i = 0; i < allRowsObj.data.length; i++) {\n                all_mails.push(allRowsObj.data[i]);\n            } // for\n        });\n\n        watch(selected_mail, () => {\n            if (selected_mail.value != undefined && selected_mail.value != "" && selected_mail.value != null) {\n                uploadToDBReady.value = true;\n            } // if\n        });\n\n        function ScientificNotaionToFixed(x) {\n            // toFixed\n            if (Math.abs(x) < 1.0) {\n                var e = parseInt(x.toString().split("e-")[1]);\n                if (e) {\n                    x *= Math.pow(10, e - 1);\n                    x = "0." + new Array(e).join("0") + x.toString().substring(2);\n                } // if\n            } else {\n                var e = parseInt(x.toString().split("+")[1]);\n                if (e > 20) {\n                    e -= 20;\n                    x /= Math.pow(10, e);\n                    x += new Array(e + 1).join("0");\n                } // if\n            } // if-else\n\n            return x;\n        } // to prevent scientific notaion\n\n        function CheckCurrentRow(e) {\n            // console.log(e.target.closest(\'tr\').firstChild.firstChild); // test\n            if (!e.target.closest(\'tr\').firstChild.firstChild.checked) {\n                e.target.closest(\'tr\').firstChild.firstChild.click();\n            } // if\n        } // CheckCurrentRow\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="number\' +\n                            i +\n                            \'" name="number\' +\n                            i +\n                            \'" value="\' +\n                            row.料號 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.90isn"\n                    ),\n                    field: "料號90",\n                    width: "15ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="number90\' +\n                            i +\n                            \'" name="number90\' +\n                            i +\n                            \'" value="\' +\n                            row.料號90 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.料號90 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.consume"\n                    ),\n                    field: "單耗",\n                    width: "12ch",\n                    sortable: true,\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="name\' +\n                            i +\n                            \'" name="name\' +\n                            i +\n                            \'" value="\' +\n                            row.品名 +\n                            \'">\' +\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.品名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.format"\n                    ),\n                    field: "規格",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="format\' +\n                            i +\n                            \'" name="format\' +\n                            i +\n                            \'" value="\' +\n                            row.規格 +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto !important; width: 100%; -ms-overflow-style: none !important;">\' +\n                            row.規格 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.surepeopleemail"\n                    ),\n                    field: "畫押信箱",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto !important; width: 100%; -ms-overflow-style: none !important;">\' +\n                            row.畫押信箱 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.remark"\n                    ),\n                    field: "狀態",\n                    width: "8ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.狀態 === "已完成") {\n                            return (\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("monthlyPRpageLang.review_complete") +\n                                "</div>"\n                            );\n                        } // if\n                        else { // 待畫押, 待重畫\n                            return (\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("monthlyPRpageLang.review_pending") +\n                                "</div>"\n                            );\n                        } // else\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.料號90\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            rowClasses: function (x) {\n                if (x.狀態 === "已完成") {\n                    return ["table-success"];\n                } // if\n                else {\n                    return ["table-danger"];\n                } // else\n            },\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            // console.log(rowsKey); // test\n            checkedRows = rowsKey;\n        };\n\n        const rowUserInput = (row, rowNum) => {\n            // console.log(document.getElementById("unitConsumption" + rowNum).value);\n            data[row.id].單耗 = document.getElementById("unitConsumption" + row.id).value;\n            // console.log(data); // test\n        };\n\n        return {\n            isInvalid,\n            isInvalid_DB,\n            validation_err_msg,\n            uploadToDBReady,\n            searchTerm,\n            table,\n            all_mails,\n            selected_mail,\n            updateCheckedRows,\n            rowUserInput,\n            onSendToDBClick,\n            deleteRow,\n            ScientificNotaionToFixed,\n            CheckCurrentRow,\n            OutputExcelClick\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},9875:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"[data-v-3ee34f82] .vtl-table .vtl-thead .vtl-thead-th{background-color:#196241;border-color:#196241;color:#fff}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/UnitConsumptionUploadTable.vue"],names:[],mappings:"AAk2BA,sDAEI,wBAAyB,CACzB,oBAAqB,CAFrB,UAGJ",sourcesContent:['<template>\n    <div class="card">\n        <div class="card-header">\n            <h3>{{ $t(\'monthlyPRpageLang.isnConsumeAdd\') }}</h3>\n        </div>\n        <div class="card-body">\n            <div class="row justify-content-center mb-3">\n                <div class="col col-auto">\n                    <a :href="exampleUrl" download>\n                        {{ $t(\'monthlyPRpageLang.exampleExcel\') }}\n                    </a>\n                </div>\n\n                <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <label class="col col-auto form-label">{{ $t(\'monthlyPRpageLang.plz_upload\') }}</label>\n                <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="col col-auto">\n                    <input class="form-control" :class="{ \'is-invalid\': isInvalid }" id="excel_input" type="file"\n                        name="select_file" @change="onInputChange" />\n                    <span v-if="isInvalid" class="invalid-feedback d-block" role="alert">\n                        <strong>{{ validation_err_msg }}</strong>\n                    </span>\n                </div>\n                <div class="w-100" style="height: 2ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="row justify-content-center">\n                    <button type="submit" name="upload" class="col col-auto btn btn-lg btn-primary"\n                        @click="onUploadClick">\n                        {{ $t(\'monthlyPRpageLang.upload1\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="card">\n        <div class="card-body">\n            <div class="row justify-content-between">\n                <div class="row col col-auto">\n                    <div class="col col-auto">\n                        <label for="pnInput" class="col-form-label">{{ $t("basicInfoLang.quicksearch") }} :</label>\n                    </div>\n                    <div class="col col-6 p-0 m-0">\n                        <input id="pnInput" class="text-center form-control form-control-lg"\n                            v-bind:placeholder="$t(\'monthlyPRpageLang.enterisn_or_descr\')" v-model="searchTerm" />\n                    </div>\n                </div>\n                <div class="col col-auto">\n                    <button class="col col-auto btn btn-lg btn-warning" @click="addRejectedToTable">\n                        <span class="fs-4">{{ $t(\'monthlyPRpageLang.loadconsume\') }}</span>\n                    </button>\n                    &nbsp;\n                    <button id="delete" name="delete" class="col col-auto btn btn-lg btn-danger" @click="deleteRow">\n                        <i class="bi bi-trash3-fill fs-4"></i>\n                    </button>\n                </div>\n            </div>\n            <div class="w-100" style="height: 1ch"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n            <span v-if="isInvalid_DB" class="invalid-feedback d-block" role="alert">\n                <strong>{{ validation_err_msg }}</strong>\n            </span>\n            <table-lite :is-fixed-first-column="true" :is-static-mode="true" :hasCheckbox="true"\n                :isLoading="table.isLoading" :messages="table.messages" :columns="table.columns" :rows="table.rows"\n                :total="table.totalRecordCount" :page-options="table.pageOptions" :sortable="table.sortable"\n                @is-finished="table.isLoading = false" @return-checked-rows="updateCheckedRows"\n                @row-input="rowUserInput"></table-lite>\n\n            <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n\n            <div class="row justify-content-between align-items-center">\n                <label class="form-label col col-auto">{{ $t(\'monthlyPRpageLang.surepeopleemail\') }}:</label>\n                <div class="w-100" style="height: 0ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                <div class="col col-auto">\n                    <div class="input-group">\n                        <select class="form-select form-select-lg col col-auto text-center" v-model="selected_mail">\n                            <option style="display: none;" disabled selected value="">\n                                {{ $t("monthlyPRpageLang.noemail") }}\n                            </option>\n                            <option v-for="mail in all_mails" :value="mail.email">{{ mail.姓名 }}</option>\n                        </select>\n                        <span class="input-group-text input-group-text-lg" id="emailTail">{{ selected_mail }}</span>\n                    </div>\n                </div>\n                <div class="col col-auto">\n                    <button v-if="uploadToDBReady" name="upload"\n                        class="col col-auto fs-3 text-center btn btn-lg btn-info" @click="onSendToDBClick">\n                        <i class="bi bi-envelope-check-fill"></i>\n                        {{ $t(\'monthlyPRpageLang.submit\') }}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useUnitConsumptionSearch from "../../composables/UnitConsumptionSearch.ts";\nimport useCommonlyUsedFunctions from "../../composables/CommonlyUsedFunctions.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        let exampleUrl = ref(window.location.origin + \'/download/ConsumeExample.xlsx\');\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        const { mats, mails, recordCount, getRejected, getCheckersMails, uploadToDB } = useUnitConsumptionSearch();\n        const { queryResult, manualResult, validateISN, validateISN_manual } = useCommonlyUsedFunctions();\n\n        onBeforeMount(getCheckersMails);\n\n        let isInvalid = ref(false); // file input validation\n        let isInvalid_DB = ref(false); // add to DB validation\n        let validation_err_msg = ref("");\n        let uploadToDBReady = ref(false); // validation\n        const all_mails = reactive([]);\n        const file = ref();\n        let input_data;\n        let checkedRows = [];\n        const searchTerm = ref(""); // Search text\n        const selected_mail = ref(""); // Mail reciever name\n        const data = reactive([]); // pour the data into table\n\n        const findDuplicates = (arr) => {\n            let sorted_arr = arr.slice().sort(); // You can define the comparing function here. \n            // JS by default uses a crappy string compare.\n            // (we use slice to clone the array so the original array won\'t be modified)\n            let results = [];\n            for (let i = 0; i < sorted_arr.length - 1; i++) {\n                if (sorted_arr[i + 1] == sorted_arr[i]) {\n                    results.push(sorted_arr[i]);\n                } // if\n            } // for\n            return results;\n        } // findDuplicates\n\n        const addRejectedToTable = async () => {\n            await getRejected();\n            if (JSON.parse(mats.value).datas.length < 1) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.noload"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // if\n            else {\n                // remove all the old rejected data in table\n                for (let i = 0; i < data.length; i++) {\n                    if (data[i].doubleCheck) {\n                        data.splice(i, 1);\n                    } // if\n                } // for\n\n                let allRowsObj = JSON.parse(mats.value);\n                for (let i = 0; i < allRowsObj.datas.length; i++) {\n                    if (data.length == 0) {\n                        allRowsObj.datas[i].id = 0;\n                    } else {\n                        allRowsObj.datas[i].id = parseInt(data[data.length - 1].id) + 1;\n                    } // if else\n                    allRowsObj.datas[i].doubleCheck = true;\n\n                    // remove duplicate data from other input\n                    let indexOfObject = data.findIndex(object => {\n                        return (object.料號90 === allRowsObj.datas[i].料號90 && object.料號 === allRowsObj.datas[i].料號);\n                    });\n\n                    if (indexOfObject != -1) { // if an existing record is found in table\n                        data.splice(indexOfObject, 1);\n                    } // if\n\n                    data.push(allRowsObj.datas[i]);\n                } // for\n\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.total") + " " + allRowsObj.datas.length + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.record") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.loadsuccess"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n        } // addRejectedToTable\n\n        const onUploadClick = async () => {\n            isInvalid_DB.value = false;\n            await triggerModal();\n            if (file.value) {\n                // console.log(file.value); // test\n                if (file.value.type == "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || file.value.type == "application/vnd.ms-excel" || file.value.type == "application/vnd.ms-excel" || file.value.type == ".csv") {\n                    const reader = new FileReader();\n                    reader.onload = async (e) => {\n                        /* Parse data */\n                        const bstr = e.target.result;\n                        const wb = XLSX.read(bstr, { type: \'binary\' });\n                        /* Get first worksheet */\n                        const wsname = wb.SheetNames[0];\n                        const ws = wb.Sheets[wsname];\n                        /* Convert array of arrays */\n                        input_data = XLSX.utils.sheet_to_json(ws, { header: 1 });\n                        // console.log(input_data); // data[row#][col#]  test\n                        if (input_data === undefined || input_data[0] === undefined || input_data[0][0] === undefined || input_data[0][1] === undefined || input_data[0][2] === undefined) {\n                            isInvalid.value = true;\n                            validation_err_msg.value = app.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors");\n                        } else if (input_data[0][0].trim() !== "90料號" || input_data[0][1].trim() !== "料號" || input_data[0][2].trim() !== "單耗") {\n                            isInvalid.value = true;\n                            validation_err_msg.value = app.appContext.config.globalProperties.$t("fileUploadErrors.Content_errors");\n                        } else {\n                            let tempArr = Array();\n\n                            for (let i = 1; i < input_data.length; i++) {\n                                if (input_data[i][1] != undefined && input_data[i].length > 2 && input_data[i][0].trim() != "" && input_data[i][0].trim() != null) {\n                                    tempArr.push(input_data[i][1].trim());\n                                } // if\n                                else {\n                                    input_data.splice(i, 1); // remove the empty row\n                                    i = i - 1;\n                                } // else\n                            } // for\n\n                            // console.log(tempArr); // test\n                            await triggerModal();\n                            await validateISN(tempArr);\n                        } // else\n                    };\n\n                    reader.readAsBinaryString(file.value);\n                } // if\n                else {\n                    isInvalid.value = true;\n                    validation_err_msg.value = app.appContext.config.globalProperties.$t("validation.mimetypes");\n                } // else\n            } // if\n            else {\n                isInvalid.value = true;\n                validation_err_msg.value = app.appContext.config.globalProperties.$t("validation.required");\n            } // else\n\n            file.value = null;\n            document.getElementById(\'excel_input\').value = "";\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // onUploadClick\n\n        const onInputChange = (event) => {\n            isInvalid.value = false;\n            // data.splice(0); // cleanup data from previous upload\n            queryResult.value = "";\n            file.value = event.target.files ? event.target.files[0] : null;\n        } // onInputChange\n\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const deleteRow = () => {\n            // console.log(checkedRows); // test\n            for (let i = 0; i < checkedRows.length; i++) {\n                let indexOfObject = data.findIndex(object => {\n                    return parseInt(object.id) === parseInt(checkedRows[i].id);\n                });\n\n                if (indexOfObject != -1) {\n                    data.splice(indexOfObject, 1);\n                } // if\n            } // for\n\n            document.querySelectorAll(\'.vtl-tbody-checkbox\').forEach(el => el.checked = false);\n\n            if (document.querySelector(".vtl-thead-checkbox").checked) {\n                document.querySelector(".vtl-thead-checkbox").click();\n            } // if\n\n            checkedRows = [];\n        } // deleteRow\n\n        const onSendToDBClick = async () => {\n            // console.log(selected_mail.value); // test\n            await triggerModal();\n            // console.log("The modal should be triggered by now."); // test\n            isInvalid_DB.value = false;\n            let rowsCount = 0;\n            let hasError = false;\n            // console.log(data.length); //test\n            if (data.length <= 0) {\n                notyf.open({\n                    type: "warning",\n                    message: app.appContext.config.globalProperties.$t("basicInfoLang.nodata"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // validate if all the isn exist\n            for (let j = 0; j < data.length && hasError == false; j++) {\n                if (data[j].月請購 === "" || data[j].月請購 === null || data[j].月請購.toLowerCase() === "null") {\n                    hasError = true;\n                    rowsCount = j;\n                } // if\n            } // for\n\n            if (hasError) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    data[rowsCount].料號 + " " +\n                    app.appContext.config.globalProperties.$t("monthlyPRpageLang.noisn");\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n\n            // ----------------------------------------------\n            // validate if there\'s duplicate values in table\n            let duplicatedArray = Array();\n            for (let i = 0; i < data.length; i++) {\n                if (data[i].料號 != null && data[i].料號.trim() != "") {\n                    duplicatedArray.push(data[i].料號.toString().trim() + "_" + data[i].料號90.toString().trim());\n                } // if\n            } // for\n\n            let findDuplicatesResult = findDuplicates(duplicatedArray);\n            // console.log(findDuplicatesResult); // test\n            if (findDuplicatesResult.length > 0) {\n                isInvalid_DB.value = true;\n                validation_err_msg.value =\n                    app.appContext.config.globalProperties.$t("inboundpageLang.repeated_isn_90_pair") +\n                    " : " + findDuplicatesResult[0].split("_")[0] +\n                    " (" + findDuplicatesResult[0].split("_")[1] + ")";\n\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                return;\n            } // if\n            // ----------------------------------------------\n            // prepare the data arrays to be sent\n            let pnArray = [];\n            let pn90Array = [];\n            let ucArray = [];\n            for (let j = 0; j < data.length; j++) {\n                pnArray.push(data[j].料號);\n                pn90Array.push(data[j].料號90);\n                ucArray.push(data[j].單耗);\n            } // for\n            // console.log(ucArray); //test\n            // actually updating database now\n            let start = Date.now();\n            let result = await uploadToDB(pnArray, pn90Array, ucArray, selected_mail.value);\n            let timeTaken = Date.now() - start;\n            console.log("Total time taken : " + timeTaken + " milliseconds");\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n\n            if (result === "success") {\n                uploadToDBReady.value = false;\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.total") + " " + JSON.parse(recordCount.value).record + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.record") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n        } // onSendToDBClick\n\n        watch(queryResult, async () => {\n            // console.log(queryResult.value); // test\n            await triggerModal();\n            if (queryResult.value == "") {\n                $("body").loadingModal("hide");\n                $("body").loadingModal("destroy");\n                table.isLoading = false;\n                return;\n            } // if\n\n            let allRowsObj = JSON.parse(queryResult.value);\n            // console.log(allRowsObj.data); // test\n            let singleEntry = {};\n\n            for (let i = 1; i < input_data.length; i++) {\n                singleEntry.料號90 = input_data[i][0].toString().trim();\n                singleEntry.料號 = input_data[i][1].toString().trim();\n                singleEntry.單耗 = input_data[i][2];\n                singleEntry.doubleCheck = false;\n\n                if (data.length == 0) {\n                    singleEntry.id = 0;\n                } else {\n                    singleEntry.id = parseInt(data[data.length - 1].id) + 1;\n                } // if else\n\n                let indexOfObject = allRowsObj.data.findIndex(object => {\n                    return (object.料號 === singleEntry.料號);\n                });\n\n                if (indexOfObject != -1) { // if an existing record is found\n                    singleEntry = Object.assign(singleEntry, allRowsObj.data[indexOfObject]);\n                    // console.log(singleEntry); // test\n                } // if\n                else {\n                    singleEntry.月請購 = "";\n                } // else\n\n                data.push(singleEntry);\n                singleEntry = {};\n            } // for\n\n            // console.log(data); // test\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        watch(mails, async () => {\n            let allRowsObj = JSON.parse(mails.value);\n            // console.log(allRowsObj.data.length);\n            for (let i = 0; i < allRowsObj.data.length; i++) {\n                all_mails.push(allRowsObj.data[i]);\n            } // for\n            table.isLoading = false;\n        });\n\n        watch(selected_mail, () => {\n            if (selected_mail.value != undefined && selected_mail.value != "" && selected_mail.value != null) {\n                uploadToDBReady.value = true;\n            } // if\n        });\n\n        watch(data, () => {\n            document.getElementsByClassName("vtl-table")[0].scrollIntoView({ behavior: "smooth" });\n        });\n\n        function initialScientificNotaionToFixed(x) {\n            // toFixed\n            if (Math.abs(x) < 1.0) {\n                var e = parseInt(x.toString().split("e-")[1]);\n                if (e) {\n                    x *= Math.pow(10, e - 1);\n                    x = "0." + new Array(e).join("0") + x.toString().substring(2);\n                } // if\n            } else {\n                var e = parseInt(x.toString().split("+")[1]);\n                if (e > 20) {\n                    e -= 20;\n                    x /= Math.pow(10, e);\n                    x += new Array(e + 1).join("0");\n                } // if\n            } // if-else\n\n            return x;\n        } // to prevent scientific notaion\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.isn"\n                    ),\n                    field: "料號",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購 === "" || row.月請購 === null || row.月請購.toLowerCase() === "null") { // if isn not exist in consumptive_material table\n                            return (\n                                \'<input type="hidden" id="number\' +\n                                i +\n                                \'" name="number\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="text-nowrap text-danger CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } else if (row.doubleCheck) {\n                            return (\n                                \'<input type="hidden" id="number\' +\n                                i +\n                                \'" name="number\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%; color: #e67300;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } else { // isn exist in database\n                            return (\n                                \'<input type="hidden" id="number\' +\n                                i +\n                                \'" name="number\' +\n                                i +\n                                \'" value="\' +\n                                row.料號 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號 +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.90isn"\n                    ),\n                    field: "料號90",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購 === "" || row.月請購 === null || row.月請購.toLowerCase() === "null") { // if isn not exist in consumptive_material table\n                            return (\n                                \'<input type="hidden" id="number90\' +\n                                i +\n                                \'" name="number90\' +\n                                i +\n                                \'" value="\' +\n                                row.料號90 +\n                                \'">\' +\n                                \'<div class="text-nowrap text-danger CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號90 +\n                                "</div>"\n                            );\n                        } else if (row.doubleCheck) {\n                            return (\n                                \'<input type="hidden" id="number90\' +\n                                i +\n                                \'" name="number90\' +\n                                i +\n                                \'" value="\' +\n                                row.料號90 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%; color: #e67300;">\' +\n                                row.料號90 +\n                                "</div>"\n                            );\n                        } else { // isn exist in database\n                            return (\n                                \'<input type="hidden" id="number90\' +\n                                i +\n                                \'" name="number90\' +\n                                i +\n                                \'" value="\' +\n                                row.料號90 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.料號90 +\n                                "</div>"\n                            );\n                        } // if else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.consume"\n                    ),\n                    field: "單耗",\n                    width: "13ch",\n                    sortable: true,\n                    hasInput: function (row, i) {\n                        return (\n                            \'<input style="width:10ch; display:inline;" type="number" \' +\n                            \'oninput="ScientificNotaionToFixed(this)" \' +\n                            \'id="unitConsumption\' +\n                            row.id +\n                            \'"\' +\n                            \' name="unitConsumption\' +\n                            row.id +\n                            \'" value="\' +\n                            initialScientificNotaionToFixed(row.單耗) +\n                            \'"\' +\n                            \' class="form-control text-center p-0 m-0" step="0.000001">\' +\n                            \'&nbsp;<small>\' + row.單位 + \'</small>\'\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.pName"\n                    ),\n                    field: "品名",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購 === "" || row.月請購 === null || row.月請購.toLowerCase() === "null") { // if isn not exist in consumptive_material table\n                            return (\n                                \'<input type="hidden" id="name\' +\n                                i +\n                                \'" name="name\' +\n                                i +\n                                \'" value="\' +\n                                row.品名 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("monthlyPRpageLang.noisn") +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<input type="hidden" id="name\' +\n                                i +\n                                \'" name="name\' +\n                                i +\n                                \'" value="\' +\n                                row.品名 +\n                                \'">\' +\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.品名 +\n                                "</div>"\n                            );\n                        } // else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.format"\n                    ),\n                    field: "規格",\n                    width: "14ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.月請購 === "" || row.月請購 === null || row.月請購.toLowerCase() === "null") { // if isn not exist in consumptive_material table\n                            return (\n                                \'<input type="hidden" id="format\' +\n                                i +\n                                \'" name="format\' +\n                                i +\n                                \'" value="\' +\n                                row.規格 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar text-danger"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                app.appContext.config.globalProperties.$t("monthlyPRpageLang.noisn") +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<input type="hidden" id="format\' +\n                                i +\n                                \'" name="format\' +\n                                i +\n                                \'" value="\' +\n                                row.規格 +\n                                \'">\' +\n                                \'<div class="text-nowrap CustomScrollbar"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.規格 +\n                                "</div>"\n                            );\n                        } // else\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "monthlyPRpageLang.lt"\n                    ),\n                    field: "LT",\n                    width: "8ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<input type="hidden" id="lt\' +\n                            i +\n                            \'" name="lt\' +\n                            i +\n                            \'" value="\' +\n                            Math.round(row.LT) +\n                            \'">\' +\n                            \'<div class="text-nowrap CustomScrollbar"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            Math.round(row.LT) +\n                            "</div>"\n                        );\n                    },\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.料號\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.品名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        const updateCheckedRows = (rowsKey) => {\n            // console.log(rowsKey); // test\n            checkedRows = rowsKey;\n        };\n\n        const rowUserInput = (row, rowNum) => {\n            // console.log(document.getElementById("unitConsumption" + rowNum).value);\n            data[row.id].單耗 = document.getElementById("unitConsumption" + row.id).value;\n            // console.log(data); // test\n        };\n\n        return {\n            exampleUrl,\n            isInvalid,\n            isInvalid_DB,\n            validation_err_msg,\n            uploadToDBReady,\n            searchTerm,\n            table,\n            all_mails,\n            selected_mail,\n            updateCheckedRows,\n            rowUserInput,\n            addRejectedToTable,\n            onUploadClick,\n            onInputChange,\n            onSendToDBClick,\n            deleteRow,\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\n::v-deep(.vtl-table .vtl-thead .vtl-thead-th) {\n    color: #fff;\n    background-color: #196241;\n    border-color: #196241;\n}\n</style>'],sourceRoot:""}]);const l=i},4475:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(4015),a=n.n(o),r=n(3645),i=n.n(r)()(a());i.push([e.id,"td[data-v-25769560],th[data-v-25769560]{text-align:center;vertical-align:middle}#siteListPicker[data-v-25769560]::-webkit-scrollbar-track{background-color:#f5f5f5;border-radius:4px;-webkit-box-shadow:0 0 1px hsla(0,0%,100%,.5)}#siteListPicker[data-v-25769560]::-webkit-scrollbar{-webkit-appearance:none;width:4px}#siteListPicker[data-v-25769560]::-webkit-scrollbar-thumb{background-color:rgba(0,0,0,.3);border-radius:4px;-webkit-box-shadow:0 0 1px hsla(0,0%,100%,.5)}","",{version:3,sources:["webpack://./resources/js/components/reusableUtilities/UserTable.vue"],names:[],mappings:"AAqeA,wCAEI,iBAAkB,CAClB,qBACJ,CAEA,0DAGI,wBAAyB,CADzB,iBAAkB,CADlB,6CAGJ,CAEA,oDAEI,uBAAwB,CADxB,SAEJ,CAEA,0DAGI,+BAAoC,CAFpC,iBAAkB,CAClB,6CAEJ",sourcesContent:['<template>\n    <div class="card-header align-items-center">\n        <h3 class="col col-auto align-middle">\n            {{ $t(\'templateWords.UserInfo\') }}\n        </h3>\n    </div>\n    <div class="card-body">\n        <div class="row justify-content-between">\n            <div class="col col-auto">\n                <input id="pnInput" class="text-center form-control form-control-lg"\n                    v-bind:placeholder="$t(\'loginPageLang.username_search\')" v-model="searchTerm" />\n            </div>\n        </div>\n        <div class="w-100" style="height: 1ch"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n        <table-lite id="searchTable" :is-fixed-first-column="true" :isStaticMode="true" :isSlotMode="true"\n            :hasCheckbox="false" :messages="table.messages" :columns="table.columns" :rows="table.rows"\n            :total="table.totalRecordCount" :page-options="table.pageOptions" :sortable="table.sortable"\n            @is-finished="table.isLoading = false">\n            <template v-slot:priority="{ row, key }">\n                <div v-if="row.current_user_priority == 0" class="m-0 p-0">\n                    <select class="form-select text-center m-0 p-0" :id="row.username" style="width: 8ch;"\n                        @change="priorityChange(row.username, $event.target.value)">\n                        <option v-for="item in [0, 1, 2, 3, 4]" :value="item" :selected="row.priority == item">{{ item\n                            }}</option>\n                    </select>\n                </div>\n                <div v-else-if="row.current_user_priority == 1" class="m-0 p-0">\n                    <select class="form-select text-center m-0 p-0" :id="row.username" style="width: 8ch;"\n                        @change="priorityChange(row.username, $event.target.value)"\n                        :disabled="row.priority <= row.current_user_priority">\n                        <option v-for="item in [1, 2, 3, 4]" :value="item" :selected="row.priority == item">{{ item\n                            }}</option>\n                    </select>\n                </div>\n                <div v-else>\n                    {{ row.priority }}\n                </div>\n            </template>\n            <template v-slot:available_dblist="{ row, key }">\n                <button :value="row.available_dblist" type="button" style="border-radius: 20px;"\n                    class="btn btn-outline-info dbInfo btn-sm m-0 px-3 py-0" data-bs-toggle="modal"\n                    data-bs-target="#siteListPicker"\n                    @click="InfoBtClicked(row.username, row.姓名, row.available_dblist)">Info</button>\n            </template>\n        </table-lite>\n    </div>\n\n    \x3c!-- Modal --\x3e\n    <div class="modal fade" id="siteListPicker" aria-hidden="true" aria-labelledby="siteListPicker" tabindex="-1">\n        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3 class="modal-title">Available Databases for {{ clickedUser }}</h3>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body CustomScrollbar">\n                    <div class="row justify-content-center">\n                        <div v-for="db in db_list" class="form-check form-switch col-9">\n                            <input class="form-check-input dbCheckbox" type="checkbox" role="switch"\n                                v-bind:id="`${(db.replace(\'Consumables management\', \'\')).trim()}`"\n                                :value="`${(db.replace(\'Consumables management\', \'\')).trim()}`" v-model="checkedDBs" />\n                            <label class="form-check-label"\n                                :for="`${(db.replace(\'Consumables management\', \'\')).trim()}`">\n                                {{ db }}\n                            </label>\n                        </div>\n                    </div>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" id="DeleteUser" class="btn btn-danger" data-bs-target="#AreYouSureModal"\n                        data-bs-toggle="modal">Delete\n                        This User</button>\n                    <button type="button" id="ListConfirm" class="btn btn-success" @click="submitNewDBList()">\n                        Save Changes\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="modal fade" id="AreYouSureModal" aria-hidden="true" aria-labelledby="AreYouSureModal" tabindex="-1">\n        <div class="modal-dialog modal-dialog-centered">\n            <div class="modal-content">\n                <div class="modal-body row justify-content-center">\n                    <span class="col col-auto">Are You Sure ?</span>\n                    <div class="w-100" style="height: 1ch;"></div>\x3c!-- </div>breaks cols to a new line--\x3e\n                    <button id="ImSure" class="col col-auto btn btn-outline-danger" data-bs-dismiss="modal"\n                        @click="DeleteUser()">YES</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent, reactive, ref, computed } from "vue";\nimport {\n    getCurrentInstance,\n    onBeforeMount,\n    onMounted,\n    watch,\n} from "@vue/runtime-core";\nimport * as XLSX from \'xlsx\';\nimport TableLite from "./TableLite.vue";\nimport useUserSearch from "../../composables/UserSearch.ts";\nexport default defineComponent({\n    name: "App",\n    components: { TableLite },\n    setup() {\n        const { users, getUsers, staffs, getStaffs, current_user, getCurrentUser, db_list, getDBList, setPriority, setDBList, delUser } = useUserSearch(); // axios get the mats data\n\n        onBeforeMount(async () => {\n            await getDBList();\n            await getCurrentUser();\n            await getStaffs();\n            await getUsers();\n        });\n\n        const triggerModal = async () => {\n            $("body").loadingModal({\n                text: "Loading...",\n                animation: "circle",\n            });\n\n            return new Promise((resolve, reject) => {\n                resolve();\n            });\n        } // triggerModal\n\n        const searchTerm = ref(""); // Search text\n        const app = getCurrentInstance(); // get the current instance\n        let thisHtmlLang = document\n            .getElementsByTagName("HTML")[0]\n            .getAttribute("lang");\n        // get the current locale from html tag\n        app.appContext.config.globalProperties.$lang.setLocale(thisHtmlLang); // set the current locale to vue package\n\n        // pour the data in\n        const data = reactive([]);\n\n        const clickedUser = ref("");\n        const checkedDBs = ref([]);\n        function InfoBtClicked(username, name, available_dblist) {\n            clickedUser.value = username + "(" + name + ")";\n            checkedDBs.value = available_dblist.split("_");\n        } // InfoBtClicked\n\n        async function priorityChange(username, priority) {\n            await triggerModal();\n            let result = await setPriority(username, priority);\n            if (result === "success") {\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n        } // priorityChange\n\n        async function submitNewDBList() {\n            let dblist_str = "";\n            let username = (clickedUser.value).split("(")[0];\n            checkedDBs.value.forEach((db) => {\n                dblist_str = dblist_str + "_" + db;\n            });\n\n            if (checkedDBs.value.length > 0) {\n                dblist_str = dblist_str.slice(1);\n            } // if\n\n            await triggerModal();\n            let result = await setDBList(username, dblist_str);\n            if (result === "success") {\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            await getUsers();\n        } // submitNewDBList\n\n        async function DeleteUser() {\n            let username = (clickedUser.value).split("(")[0];\n            await triggerModal();\n            let result = await delUser(username);\n            if (result === "success") {\n                notyf.open({\n                    type: "success",\n                    message: app.appContext.config.globalProperties.$t("monthlyPRpageLang.change") + " " + app.appContext.config.globalProperties.$t("monthlyPRpageLang.success"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // if\n            else {\n                notyf.open({\n                    type: "error",\n                    message: app.appContext.config.globalProperties.$t("checkInvLang.update_failed"),\n                    duration: 3000, //miliseconds, use 0 for infinite duration\n                    ripple: true,\n                    dismissible: true,\n                    position: {\n                        x: "right",\n                        y: "bottom",\n                    },\n                });\n            } // else\n\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n\n            await getUsers();\n        } // DeleteUser\n\n        watch(current_user, async () => {\n            if (current_user.value.priority > 0) {\n                table.columns.splice(5, 2);\n            } // if\n        }); // watch for data change\n\n        watch(users, async () => {\n            data.splice(0); // clean up previous data\n            await triggerModal();\n            let allRowsObj = JSON.parse(users.value);\n            // console.log(allRowsObj.datas); // test\n\n            if (current_user.value.priority > 0) {\n                for (let i = 0; i < allRowsObj.datas.length; i++) {\n                    if (allRowsObj.datas[i].priority != 0) {\n                        allRowsObj.datas[i].current_user_priority = current_user.value.priority;\n                        data.push(allRowsObj.datas[i]);\n                    } // if\n                } // for\n            } else {\n                for (let i = 0; i < allRowsObj.datas.length; i++) {\n                    allRowsObj.datas[i].current_user_priority = current_user.value.priority;\n                    data.push(allRowsObj.datas[i]);\n                } // for\n            } // if else\n\n            // console.log(data); // test\n            $("body").loadingModal("hide");\n            $("body").loadingModal("destroy");\n            table.isLoading = false;\n        }); // watch for data change\n\n        // Table config\n        const table = reactive({\n            isLoading: true,\n            columns: [\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "loginPageLang.username"\n                    ),\n                    field: "username",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.username +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "loginPageLang.priority"\n                    ),\n                    field: "priority",\n                    width: "10ch",\n                    sortable: true,\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "loginPageLang.name"\n                    ),\n                    field: "姓名",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.姓名 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "loginPageLang.dep"\n                    ),\n                    field: "部門",\n                    width: "13ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.部門 +\n                            "</div>"\n                        );\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "loginPageLang.mail"\n                    ),\n                    field: "email",\n                    width: "12ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        if (row.email === null || row.email == "null") {\n                            return (\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                \'N/A\' +\n                                "</div>"\n                            );\n                        } // if\n                        else {\n                            return (\n                                \'<div class="CustomScrollbar text-nowrap"\' +\n                                \' style="overflow-x: auto; width: 100%;">\' +\n                                row.email +\n                                "</div>"\n                            );\n                        }\n                    },\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "loginPageLang.database_list"\n                    ),\n                    field: "available_dblist",\n                    width: "10ch",\n                    sortable: false,\n                },\n                {\n                    label: app.appContext.config.globalProperties.$t(\n                        "loginPageLang.latest_login_time"\n                    ),\n                    field: "last_login_time",\n                    width: "10ch",\n                    sortable: true,\n                    display: function (row, i) {\n                        return (\n                            \'<div class="CustomScrollbar text-nowrap"\' +\n                            \' style="overflow-x: auto; width: 100%;">\' +\n                            row.last_login_time +\n                            "</div>"\n                        );\n                    }\n                },\n            ],\n            rows: computed(() => {\n                return data.filter((x) =>\n                    x.username\n                        .toLowerCase()\n                        .includes(searchTerm.value.toLowerCase()) ||\n                    x.姓名\n                        .includes(searchTerm.value)\n                );\n            }),\n            totalRecordCount: computed(() => {\n                return table.rows.length;\n            }),\n            sortable: {\n                order: "id",\n                sort: "asc",\n            },\n            messages: {\n                pagingInfo:\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.now_showing"\n                    ) +\n                    " {0} ~ {1} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ) +\n                    ", " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.total"\n                    ) +\n                    " {2} " +\n                    app.appContext.config.globalProperties.$t(\n                        "basicInfoLang.record"\n                    ),\n                pageSizeChangeLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.records_per_page"\n                ),\n                gotoPageLabel: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.go_to_page"\n                ),\n                noDataAvailable: app.appContext.config.globalProperties.$t(\n                    "basicInfoLang.search_with_no_data_returned"\n                ),\n            },\n            pageOptions: [\n                {\n                    value: 10,\n                    text: 10,\n                },\n                {\n                    value: 20,\n                    text: 20,\n                },\n                {\n                    value: 40,\n                    text: 40,\n                },\n                {\n                    value: 100,\n                    text: 100,\n                },\n            ],\n        });\n\n        return {\n            db_list,\n            searchTerm,\n            table,\n            clickedUser,\n            InfoBtClicked,\n            current_user,\n            priorityChange,\n            checkedDBs,\n            submitNewDBList,\n            DeleteUser\n        };\n    }, // setup\n});\n<\/script>\n<style scoped>\ntd,\nth {\n    text-align: center;\n    vertical-align: middle;\n}\n\n#siteListPicker::-webkit-scrollbar-track {\n    -webkit-box-shadow: 0 0 1px hsla(0, 0%, 100%, .5);\n    border-radius: 4px;\n    background-color: #F5F5F5;\n}\n\n#siteListPicker::-webkit-scrollbar {\n    width: 4px;\n    -webkit-appearance: none;\n}\n\n#siteListPicker::-webkit-scrollbar-thumb {\n    border-radius: 4px;\n    -webkit-box-shadow: 0 0 1px hsla(0, 0%, 100%, .5);\n    background-color: rgba(0, 0, 0, 0.3);\n}\n</style>'],sourceRoot:""}]);const l=i},6521:()=>{},9405:()=>{},67:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[170,898],(()=>(t(6650),t(6521),t(9405))));e.O()}]);
//# sourceMappingURL=app.js.map